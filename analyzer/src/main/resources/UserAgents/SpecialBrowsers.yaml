#
# Yet Another UserAgent Analyzer
# Copyright (C) 2013-2019 Niels Basjes
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# https://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an AS IS BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

config:

# These are known robots that do not have words like bot, crawler, spider in their name.
- set:
    name: 'NamedSpecials'
    values:
    - 'IntelliJ IDEA'

- matcher:
    require:
    - 'agent.(1)text?NamedSpecials'
    extract:
    - '__Set_ALL_Fields__                  :     14 :"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'AgentClass                          :     15 :"Special"'
    - 'AgentName                           :     15 :agent'
    - 'AgentVersion                        :     15 :"??"'

- matcher:
    require:
    - 'IsNull[agent.(1)product.(1)name="Mozilla"]'
    extract:
    - 'AgentClass                          :      5 :"Special"'
    - 'AgentName                           :      5 :agent.(1)product.name'

- matcher:
    require:
    - 'IsNull[agent.(1)product.(1)name="Mozilla"]'
    extract:
    - 'AgentClass                          :      6 :"Special"'
    - 'AgentName                           :      6 :agent.(1)product.url'

- matcher:
    require:
    - 'IsNull[agent.(1)product.(1)name="Mozilla"]'
    extract:
    - 'AgentVersion                        :      5 :agent.(1)product.(1)comments.(1)entry.(1)text'

- matcher:
    require:
    - 'IsNull[agent.(1)product.(1)name="Mozilla"]'
    extract:
    - 'AgentVersion                        :      6 :agent.(1)product.version'

# ================================
# Specific browser rules

- matcher:
    extract:
    - 'AgentClass                          :   2010 :"Browser"'
    - 'AgentName                           :   2010 :"Crazy Browser"'
    - 'AgentVersion                        :   2010 :agent.(1)product.(1)comments.entry.product.name="Crazy Browser"^.version'

- matcher:
    variable:
    - 'WebKitGTK:agent.product.(1)name="WebKitGTK"^'
    extract:
    - 'LayoutEngineClass                   :    100 :"Browser"'
    - 'LayoutEngineName                    :    100 :"WebKitGTK"'
    - 'LayoutEngineVersion                 :    100 :@WebKitGTK.version'

- matcher:
    variable:
    - 'WebKitGTK:agent.product.(1)name="WebKitGTK"^'
    extract:
    - 'LayoutEngineClass                   :    100 :"Browser"'
    - 'LayoutEngineName                    :    100 :"WebKitGTK"'
    - 'LayoutEngineVersion                 :    100 :@WebKitGTK.version'
    - 'AgentClass                          :    100 :"Browser"'
    - 'AgentName                           :    100 :@WebKitGTK>.name'
    - 'AgentVersion                        :    100 :@WebKitGTK>.version'

- matcher:
    variable:
    - 'WebKitGTK:agent.product.(1)name="WebKitGTK"^'
    extract:
    - 'LayoutEngineClass                   :    100 :"Browser"'
    - 'LayoutEngineName                    :    100 :"WebKitGTK"'
    - 'LayoutEngineVersion                 :    100 :@WebKitGTK.version'
    - 'AgentClass                          :    100 :"Browser"'
    - 'AgentName                           :    100 :@WebKitGTK>.text'
    - 'AgentVersion                        :    100 :"??"'


# ================================

- test:
    input:
      user_agent_string: 'Links (2.1pre15; Linux 2.4.26 i686; 128x48)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '2.4.26'
      OperatingSystemVersionMajor          : '2'
      OperatingSystemNameVersion           : 'Linux 2.4.26'
      OperatingSystemNameVersionMajor      : 'Linux 2'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'Links'
      AgentVersion                         : '2.1pre15'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Links 2.1pre15'
      AgentNameVersionMajor                : 'Links 2'

- test:
    input:
      user_agent_string: 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0; brip1; RainBird 1.01/HT; Crazy Browser 1.0.5; .NET CLR 1.1.4322)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '2000'
      OperatingSystemVersionMajor          : '2000'
      OperatingSystemNameVersion           : 'Windows 2000'
      OperatingSystemNameVersionMajor      : 'Windows 2000'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Internet Explorer'
      LayoutEngineVersion                  : '6.0'
      LayoutEngineVersionMajor             : '6'
      LayoutEngineNameVersion              : 'Internet Explorer 6.0'
      LayoutEngineNameVersionMajor         : 'Internet Explorer 6'
      AgentClass                           : 'Browser'
      AgentName                            : 'Crazy Browser'
      AgentVersion                         : '1.0.5'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Crazy Browser 1.0.5'
      AgentNameVersionMajor                : 'Crazy Browser 1'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; FreeBSD; U; Viera; nl-NL) AppleWebKit/537.11 (KHTML, like Gecko) Viera/3.10.14 Chrome/23.0.1271.97 Safari/537.11'
    expected:
      DeviceClass                          : 'TV'
      DeviceName                           : 'Panasonic Viera'
      DeviceBrand                          : 'Panasonic'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'FreeBSD'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'FreeBSD ??'
      OperatingSystemNameVersionMajor      : 'FreeBSD ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.11'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.11'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'Viera'
      AgentVersion                         : '3.10.14'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Viera 3.10.14'
      AgentNameVersionMajor                : 'Viera 3'
      AgentLanguage                        : 'Dutch (Netherlands)'
      AgentLanguageCode                    : 'nl-nl'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPad; CPU OS 8.1.2 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) 1Password/5.1.2 (like Version/12B440 Mobile/8.1.2 Safari/8536.25)'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Apple iPad'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPad'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '8.1.2'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'iOS 8.1.2'
      OperatingSystemNameVersionMajor      : 'iOS 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '536.26'
      LayoutEngineVersionMajor             : '536'
      LayoutEngineNameVersion              : 'AppleWebKit 536.26'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 536'
      AgentClass                           : 'Browser'
      AgentName                            : '1Password'
      AgentVersion                         : '5.1.2'
      AgentVersionMajor                    : '5'
      AgentNameVersion                     : '1Password 5.1.2'
      AgentNameVersionMajor                : '1Password 5'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU OS 11_4 like Mac OS X) AppleWebKit/600.1.4 (KHTML, like Gecko) 1Password/7.0.6 (like Version/11.4 Mobile/15F5049c Safari/600.1.4)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '11.4'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'iOS 11.4'
      OperatingSystemNameVersionMajor      : 'iOS 11'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '600.1.4'
      LayoutEngineVersionMajor             : '600'
      LayoutEngineNameVersion              : 'AppleWebKit 600.1.4'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 600'
      AgentClass                           : 'Browser'
      AgentName                            : '1Password'
      AgentVersion                         : '7.0.6'
      AgentVersionMajor                    : '7'
      AgentNameVersion                     : '1Password 7.0.6'
      AgentNameVersionMajor                : '1Password 7'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPad; CPU OS 11_3 like Mac OS X) AppleWebKit/600.1.4 (KHTML, like Gecko) 1Password/7.0.6 (like Version/11.3 Mobile/15E216 Safari/600.1.4'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Apple iPad'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPad'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '11.3'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'iOS 11.3'
      OperatingSystemNameVersionMajor      : 'iOS 11'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '600.1.4'
      LayoutEngineVersionMajor             : '600'
      LayoutEngineNameVersion              : 'AppleWebKit 600.1.4'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 600'
      AgentClass                           : 'Browser'
      AgentName                            : '1Password'
      AgentVersion                         : '7.0.6'
      AgentVersionMajor                    : '7'
      AgentNameVersion                     : '1Password 7.0.6'
      AgentNameVersionMajor                : '1Password 7'

# If the BASE64 minimal size gets too small this becomes a parse error
- test:
    input:
      user_agent_string: 'AndroidDownloadManager/5.0.1 (Linux; U; Android 5.0.1; HUAWEI GRA-L09 Build/HUAWEIGRA-L09)'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Huawei GRA-L09'
      DeviceBrand                          : 'Huawei'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '5.0.1'
      OperatingSystemVersionMajor          : '5'
      OperatingSystemNameVersion           : 'Android 5.0.1'
      OperatingSystemNameVersionMajor      : 'Android 5'
      OperatingSystemVersionBuild          : 'HUAWEIGRA-L09'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'AndroidDownloadManager'
      AgentVersion                         : '5.0.1'
      AgentVersionMajor                    : '5'
      AgentNameVersion                     : 'AndroidDownloadManager 5.0.1'
      AgentNameVersionMajor                : 'AndroidDownloadManager 5'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'http://Anonymouse.org/ (Unix)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Anonymouse Robot'
      DeviceBrand                          : 'Anonymouse'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'http://Anonymouse.org'
      AgentVersion                         : 'Unix'
      AgentVersionMajor                    : 'Unix'
      AgentNameVersion                     : 'http://Anonymouse.org Unix'
      AgentNameVersionMajor                : 'http://Anonymouse.org Unix'
      AgentInformationUrl                  : 'http://Anonymouse.org'

- matcher:
    extract:
    - 'DeviceClass                         :    100 :"Robot"'
    - 'DeviceBrand                         :    100 :"CloudFlare"'
    - 'DeviceName                          :    100 :"CloudFlare AlwaysOnline"'
    - 'AgentClass                          :    100 :"Robot"'
    - 'AgentName                           :    100 :"CloudFlare AlwaysOnline"'
    - 'AgentVersion                        :    100 :agent.(1)product.(1)comments.entry.(1)product.(1)name="CloudFlare-AlwaysOnline"^.version'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; CloudFlare-AlwaysOnline/1.0; +http://www.cloudflare.com/always-online) AppleWebKit/534.34'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'CloudFlare AlwaysOnline'
      DeviceBrand                          : 'CloudFlare'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '534.34'
      LayoutEngineVersionMajor             : '534'
      LayoutEngineNameVersion              : 'AppleWebKit 534.34'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 534'
      AgentClass                           : 'Robot'
      AgentName                            : 'CloudFlare AlwaysOnline'
      AgentVersion                         : '1.0'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'CloudFlare AlwaysOnline 1.0'
      AgentNameVersionMajor                : 'CloudFlare AlwaysOnline 1'
      AgentInformationUrl                  : 'http://www.cloudflare.com/always-online'

- test:
    input:
      user_agent_string: 'Mobitest 1.8 (iPhone; iPhone OS 7.1.2; nl_NL)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '7.1.2'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'iOS 7.1.2'
      OperatingSystemNameVersionMajor      : 'iOS 7'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'Mobitest'
      AgentVersion                         : '1.8'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Mobitest 1.8'
      AgentNameVersionMajor                : 'Mobitest 1'
      AgentLanguage                        : 'Dutch (Netherlands)'
      AgentLanguageCode                    : 'nl-nl'

- test:
    input:
      user_agent_string: 'Airmail%202.0.3%20rv:286%20(Macintosh;%20Mac%20OS%20X%2010.9.5;%20ja_JP)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Apple Macintosh'
      DeviceBrand                          : 'Apple'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Mac OS X'
      OperatingSystemVersion               : '10.9.5'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Mac OS X 10.9.5'
      OperatingSystemNameVersionMajor      : 'Mac OS X 10'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'Airmail'
      AgentVersion                         : '2.0.3'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Airmail 2.0.3'
      AgentNameVersionMajor                : 'Airmail 2'
      AgentLanguage                        : 'Japanese (Japan)'
      AgentLanguageCode                    : 'ja-jp'

- test:
    input:
      user_agent_string: 'curl/7.19.4%20(i386-redhat-linux-gnu)%20libcurl/7.19.4%20NSS/3.12.2.0%20zlib/1.2.3%20libidn/0.6.14%20libssh2/0.18'
    expected:
      DeviceClass                          : 'Unknown'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i386'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Unknown'
      OperatingSystemName                  : 'Unknown'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Unknown ??'
      OperatingSystemNameVersionMajor      : 'Unknown ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'curl'
      AgentVersion                         : '7.19.4'
      AgentVersionMajor                    : '7'
      AgentNameVersion                     : 'curl 7.19.4'
      AgentNameVersionMajor                : 'curl 7'

- test:
    input:
      user_agent_string: 'Chromeless 1.3.0'
    expected:
      DeviceClass                          : 'Unknown'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Unknown'
      OperatingSystemName                  : 'Unknown'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Unknown ??'
      OperatingSystemNameVersionMajor      : 'Unknown ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'Chromeless'
      AgentVersion                         : '1.3.0'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Chromeless 1.3.0'
      AgentNameVersionMajor                : 'Chromeless 1'

- test:
    input:
      user_agent_string: 'IntelliJ IDEA/162.1447.26'
    expected:
      DeviceClass                          : 'Unknown'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Unknown'
      OperatingSystemName                  : 'Unknown'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Unknown ??'
      OperatingSystemNameVersionMajor      : 'Unknown ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'IntelliJ IDEA'
      AgentVersion                         : '162.1447.26'
      AgentVersionMajor                    : '162'
      AgentNameVersion                     : 'IntelliJ IDEA 162.1447.26'
      AgentNameVersionMajor                : 'IntelliJ IDEA 162'


- test:
    input:
      user_agent_string: 'IntelliJ IDEA'
    expected:
      DeviceClass                          : 'Unknown'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Unknown'
      OperatingSystemName                  : 'Unknown'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Unknown ??'
      OperatingSystemNameVersionMajor      : 'Unknown ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'IntelliJ IDEA'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'IntelliJ IDEA ??'
      AgentNameVersionMajor                : 'IntelliJ IDEA ??'


- matcher:
    extract:
    - 'AgentVersion                        :      1 : agent.(1)product.(1)name="R"^.(1)comments.(1)entry.(1)product.(1)name'

- test:
    input:
      user_agent_string: 'R (3.3.3 x86_64-redhat-linux-gnu x86_64 linux-gnu)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Linux ??'
      OperatingSystemNameVersionMajor      : 'Linux ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'R'
      AgentVersion                         : '3.3.3'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'R 3.3.3'
      AgentNameVersionMajor                : 'R 3'

- test:
    input:
      user_agent_string: 'R (3.3.2 x86_64-w64-mingw32 x86_64 mingw32)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Windows NT ??'
      OperatingSystemNameVersionMajor      : 'Windows NT ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'R'
      AgentVersion                         : '3.3.2'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'R 3.3.2'
      AgentNameVersionMajor                : 'R 3'


# Puffin on an Android 6 phone is incorrectly reported as a Linux desktop
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; U; Linux x86_64; en-gb) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/30.0.1599.114 Safari/537.36 Puffin/4.8.0.2790AP'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : 'Intel x86_64'
      OperatingSystemVersionMajor          : 'Intel x86'
      OperatingSystemNameVersion           : 'Linux Intel x86_64'
      OperatingSystemNameVersionMajor      : 'Linux Intel x86'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '30.0'
      LayoutEngineVersionMajor             : '30'
      LayoutEngineNameVersion              : 'Blink 30.0'
      LayoutEngineNameVersionMajor         : 'Blink 30'
      AgentClass                           : 'Browser'
      AgentName                            : 'Puffin'
      AgentVersion                         : '4.8.0.2790AP'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Puffin 4.8.0.2790AP'
      AgentNameVersionMajor                : 'Puffin 4'
      AgentLanguage                        : 'English (United Kingdom)'
      AgentLanguageCode                    : 'en-gb'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.83 Safari/537.1 AvantBrowser/Tri-Core'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.1'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'AvantBrowser'
      AgentVersion                         : 'Tri-Core'
      AgentVersionMajor                    : 'Tri'
      AgentNameVersion                     : 'AvantBrowser Tri-Core'
      AgentNameVersionMajor                : 'AvantBrowser Tri'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.19 (KHTML, like Gecko) Chrome/18.0.1025.152 Safari/535.19 CoolNovo/2.0.3.55'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '535.19'
      LayoutEngineVersionMajor             : '535'
      LayoutEngineNameVersion              : 'AppleWebKit 535.19'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 535'
      AgentClass                           : 'Browser'
      AgentName                            : 'CoolNovo'
      AgentVersion                         : '2.0.3.55'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'CoolNovo 2.0.3.55'
      AgentNameVersionMajor                : 'CoolNovo 2'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_2) AppleWebKit/537.4 (KHTML, like Gecko) Chrome/22.0.1229.94 Safari/537.4 AlexaToolbar/alxg-3.1'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Apple Macintosh'
      DeviceBrand                          : 'Apple'
      DeviceCpu                            : 'Intel'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Mac OS X'
      OperatingSystemVersion               : '10.8.2'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Mac OS X 10.8.2'
      OperatingSystemNameVersionMajor      : 'Mac OS X 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.4'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.4'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '22.0.1229.94'
      AgentVersionMajor                    : '22'
      AgentNameVersion                     : 'Chrome 22.0.1229.94'
      AgentNameVersionMajor                : 'Chrome 22'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US) AppleWebKit/534.7 (KHTML, like Gecko) Chrome/22.0.1229.94 Safari/534.7 ZemanaAID/FFFF0089'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '534.7'
      LayoutEngineVersionMajor             : '534'
      LayoutEngineNameVersion              : 'AppleWebKit 534.7'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 534'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '22.0.1229.94'
      AgentVersionMajor                    : '22'
      AgentNameVersion                     : 'Chrome 22.0.1229.94'
      AgentNameVersionMajor                : 'Chrome 22'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux i686) AppleWebKit/537.13 (KHTML, like Gecko) Chrome/24.0.1290.0 Safari/537.13 SUSE/24.0.1290.0'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'SUSE'
      OperatingSystemVersion               : '24.0.1290.0'
      OperatingSystemVersionMajor          : '24'
      OperatingSystemNameVersion           : 'SUSE 24.0.1290.0'
      OperatingSystemNameVersionMajor      : 'SUSE 24'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.13'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.13'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '24.0.1290.0'
      AgentVersionMajor                    : '24'
      AgentNameVersion                     : 'Chrome 24.0.1290.0'
      AgentNameVersionMajor                : 'Chrome 24'

- matcher:
    require:
    - 'agent.product="Profile/MIDP-2.1"'
    - 'agent.product.(1)name="Browser"'
    extract:
    - 'LayoutEngineClass                   :     10 :"Browser"'
    - 'LayoutEngineName                    :     10 :agent.product.(1)name="Browser"^.(1)version'
    - 'LayoutEngineVersion                 :     10 :agent.product.(1)name="Browser"^.(2)version'
    - 'AgentClass                          :   1000 :"Browser"'
    - 'AgentName                           :   1000 :agent.product.(1)name="Browser"^.(1)version'
    - 'AgentVersion                        :   1000 :agent.product.(1)name="Browser"^.(2)version'

- test:
    input:
      user_agent_string: 'Mozilla/4.0 SonyEricssonW910iv/R1FA Browser/NetFront/3.4 Profile/MIDP-2.1 Configuration/CLDC-1.1'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'SonyEricsson W910IV'
      DeviceBrand                          : 'SonyEricsson'
      DeviceVersion                        : '4.0'
      OperatingSystemClass                 : 'Unknown'
      OperatingSystemName                  : 'Unknown'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Unknown ??'
      OperatingSystemNameVersionMajor      : 'Unknown ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'NetFront'
      LayoutEngineVersion                  : '3.4'
      LayoutEngineVersionMajor             : '3'
      LayoutEngineNameVersion              : 'NetFront 3.4'
      LayoutEngineNameVersionMajor         : 'NetFront 3'
      AgentClass                           : 'Browser'
      AgentName                            : 'NetFront'
      AgentVersion                         : '3.4'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'NetFront 3.4'
      AgentNameVersionMajor                : 'NetFront 3'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 2.3.4; nl-nl; SonyEricssonLT15i Build/4.0.2.A.0.62) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'SonyEricsson LT15I'
      DeviceBrand                          : 'SonyEricsson'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '2.3.4'
      OperatingSystemVersionMajor          : '2'
      OperatingSystemNameVersion           : 'Android 2.3.4'
      OperatingSystemNameVersionMajor      : 'Android 2'
      OperatingSystemVersionBuild          : '4.0.2.A.0.62'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '533.1'
      LayoutEngineVersionMajor             : '533'
      LayoutEngineNameVersion              : 'AppleWebKit 533.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 533'
      AgentClass                           : 'Browser'
      AgentName                            : 'Stock Android Browser'
      AgentVersion                         : '4.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Stock Android Browser 4.0'
      AgentNameVersionMajor                : 'Stock Android Browser 4'
      AgentLanguage                        : 'Dutch (Netherlands)'
      AgentLanguageCode                    : 'nl-nl'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'SonyEricssonW960i/R100 Mozilla/4.0 (compatible; MSIE 6.0; Symbian OS; 768) Opera 8.65 [en]'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'SonyEricsson W960I'
      DeviceBrand                          : 'SonyEricsson'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'SymbianOS'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'SymbianOS ??'
      OperatingSystemNameVersionMajor      : 'SymbianOS ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '1'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Presto 1'
      LayoutEngineNameVersionMajor         : 'Presto 1'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera'
      AgentVersion                         : '8.65'
      AgentVersionMajor                    : '8'
      AgentNameVersion                     : 'Opera 8.65'
      AgentNameVersionMajor                : 'Opera 8'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'


- test:
    input:
      user_agent_string: 'python-requests/2.1.0 CPython/2.7.3 Linux/3.2.0-4-amd64'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '3.2.0-4-amd64'
      OperatingSystemVersionMajor          : '3'
      OperatingSystemNameVersion           : 'Linux 3.2.0-4-amd64'
      OperatingSystemNameVersionMajor      : 'Linux 3'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'python-requests'
      AgentVersion                         : '2.1.0'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'python-requests 2.1.0'
      AgentNameVersionMajor                : 'python-requests 2'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 4.4.2; SM-G355HN Build/KOT49H) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/47.0.2526.0 MobileIron/1.9.0 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung SM-G355HN'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.4.2'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.4.2'
      OperatingSystemNameVersionMajor      : 'Android 4'
      OperatingSystemVersionBuild          : 'KOT49H'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '47.0'
      LayoutEngineVersionMajor             : '47'
      LayoutEngineNameVersion              : 'Blink 47.0'
      LayoutEngineNameVersionMajor         : 'Blink 47'
      AgentClass                           : 'Browser'
      AgentName                            : 'MobileIron'
      AgentVersion                         : '1.9.0'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'MobileIron 1.9.0'
      AgentNameVersionMajor                : 'MobileIron 1'

# Sometimes the name of the agent is BETWEEN the "Mobile" and "Version" products.
- matcher:
    require:
    - 'agent.product.(1)name="Version"' # Performance trick
    variable:
    - 'Product: agent.product.(1)name="Mobile"^>>.name="Version"^<'
    extract:
    - 'AgentClass                          :    100 :"Browser"'
    - 'AgentName                           :    100 :@Product.name'
    - 'AgentVersion                        :    100 :@Product.version'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 8_3 like Mac OS X) AppleWebKit/600.1.4 (KHTML, like Gecko) Mobile/12F70 MobileIron/1.7.1 Version/8.3 Safari/600.1.4'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '12F70'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '8.3'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'iOS 8.3'
      OperatingSystemNameVersionMajor      : 'iOS 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '600.1.4'
      LayoutEngineVersionMajor             : '600'
      LayoutEngineNameVersion              : 'AppleWebKit 600.1.4'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 600'
      AgentClass                           : 'Browser'
      AgentName                            : 'MobileIron'
      AgentVersion                         : '1.7.1'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'MobileIron 1.7.1'
      AgentNameVersionMajor                : 'MobileIron 1'

# Sometimes the name of the agent is BETWEEN the "Mobile" and "(Mobile) Safari" products.
- matcher:
    require:
    - 'agent.product.(1)name="Safari"' # Performance trick
    variable:
    - 'Product: agent.product.(1)name="Mobile"^>>.name="Safari"^<'
    extract:
    - 'AgentClass                          :   2049 :"Browser"'
    - 'AgentName                           :   2049 :@Product.name!="Version"'
    - 'AgentVersion                        :   2049 :@Product.version'

- matcher:
    require:
    - 'agent.product.(1)name="Mobile Safari"' # Performance trick
    variable:
    - 'Product: agent.product.(1)name="Mobile"^>>.name="Mobile Safari"^<'
    extract:
    - 'AgentClass                          :   2049 :"Browser"'
    - 'AgentName                           :   2049 :@Product.name!="Version"'
    - 'AgentVersion                        :   2049 :@Product.version'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPod; U; CPU iPhone OS 8_1_3 like Mac OS X; nl-nl) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8C134 NetNanny Mobile/1.0 Safari/6533.18.5'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPod'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '8C134'
      DeviceVersion                        : 'iPod'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '8.1.3'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'iOS 8.1.3'
      OperatingSystemNameVersionMajor      : 'iOS 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '533.17.9'
      LayoutEngineVersionMajor             : '533'
      LayoutEngineNameVersion              : 'AppleWebKit 533.17.9'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 533'
      AgentClass                           : 'Browser'
      AgentName                            : 'NetNanny Mobile'
      AgentVersion                         : '1.0'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'NetNanny Mobile 1.0'
      AgentNameVersionMajor                : 'NetNanny Mobile 1'
      AgentLanguage                        : 'Dutch (Netherlands)'
      AgentLanguageCode                    : 'nl-nl'
      AgentSecurity                        : 'Strong security'

# Quark on iOS
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 11_2_6 like Mac OS X; zh-cn) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/15D100 Quark/2.2.9.989 Mobile'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15D100'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '11.2.6'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'iOS 11.2.6'
      OperatingSystemNameVersionMajor      : 'iOS 11'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '601.1.46'
      LayoutEngineVersionMajor             : '601'
      LayoutEngineNameVersion              : 'AppleWebKit 601.1.46'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 601'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Quark'
      AgentVersion                         : '2.2.9.989'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Quark 2.2.9.989'
      AgentNameVersionMajor                : 'Quark 2'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'

# Sometimes the name of the agent is AFTER the "Mobile" and "(Mobile) Safari" products.
- matcher:
    require:
    - 'agent.product.(1)name="Safari"' # Performance trick
    variable:
    - 'Product: agent.product.(1)name="Mobile"^>.name="Safari"^>'
    extract:
    - 'AgentClass                          :   2049 :"Browser"'
    - 'AgentName                           :   2049 :@Product.name'
    - 'AgentVersion                        :   2049 :@Product.version'

- matcher:
    require:
    - 'agent.product.(1)name="Mobile Safari"' # Performance trick
    variable:
    - 'Product: agent.product.(1)name="Mobile"^>.name="Mobile Safari"^>'
    extract:
    - 'AgentClass                          :   2049 :"Browser"'
    - 'AgentName                           :   2049 :@Product.name'
    - 'AgentVersion                        :   2049 :@Product.version'

# Also Quark
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; U; CPU iPhone OS 4_3_2 like Mac OS X; en-us) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8H7 Safari/6533.18.5 Quark/2.4.1.985'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '8H7'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '4.3.2'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'iOS 4.3.2'
      OperatingSystemNameVersionMajor      : 'iOS 4'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '533.17.9'
      LayoutEngineVersionMajor             : '533'
      LayoutEngineNameVersion              : 'AppleWebKit 533.17.9'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 533'
      AgentClass                           : 'Browser'
      AgentName                            : 'Quark'
      AgentVersion                         : '2.4.1.985'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Quark 2.4.1.985'
      AgentNameVersionMajor                : 'Quark 2'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'



# https://www.dillo.org/
- test:
    input:
      user_agent_string: 'Dillo/0.8.5-i18n-misc'
    expected:
      DeviceClass                          : 'Unknown'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Unknown'
      OperatingSystemName                  : 'Unknown'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Unknown ??'
      OperatingSystemNameVersionMajor      : 'Unknown ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'Dillo'
      AgentVersion                         : '0.8.5-i18n-misc'
      AgentVersionMajor                    : '0'
      AgentNameVersion                     : 'Dillo 0.8.5-i18n-misc'
      AgentNameVersionMajor                : 'Dillo 0'


# TODO: A lot of special browsers

#DoCoMo    1.0    DoCoMo/1.0/D503iS/c10
#DoCoMo    1.0    DoCoMo/1.0/P502i/c10 (Google CHTML Proxy/1.0)
#DoCoMo    2.0    DoCoMo/2.0 F900i(c100;TB;W22H12),gzip(gfe) (via translate.google.com)
#DoCoMo    2.0    DoCoMo/2.0 N900i(c100;TB;W24H12)
#Doris    1.10    Doris/1.10 [en] (Symbian)
#Doris    1.17    Doris/1.17 [en] (Symbian)

#Mozilla/4.5 (compatible; iCab 2.9.7; Macintosh; U; PPC)
#Mozilla/4.5 (compatible; iCab 2.9.7; Macintosh; U; PPC; Mac OS X)
#Jakarta Commons-HttpClient/2.0.1
#Java/1.5.0
#Mozilla/5.0 (compatible; Konqueror/3.1; OpenBSD)
#Mozilla/5.0 (compatible; Konqueror/3.1; SunOS)
#Mozilla/5.0 (compatible; Konqueror/3.1.3; OpenBSD 3.4)
#Mozilla/5.0 (compatible; Konqueror/3.2; Darwin) (KHTML, like Gecko)
#
#Firefox/32.0.3 (x86 en-US); anonymized by Abelssoft 1598848102
#Firefox/34.0.5 (x86 de); anonymized by Abelssoft 1811190192
#Firefox/34.0.5 (x86 de); anonymized by Abelssoft 223791841
#
#Google-Sitemaps/1.0
#GT-I9190/V1 Linux/3.4.39 Android/4.4.4 Release/10.31.2014 Browser/AppleWebKit534.30 Mobile Safari/534.30 MBBMS/2.2 System/Android 4.4.4
#GT-I9300 Linux/3.0.13 Android/4.1.9 Release/02.02.2013 Browser/AppleWebKit534.30 Profile/MIDP-2.0 Configuration/CLDC-1.1 Mobile Safari/534.30 Android 4.0.1;
#
#JUC (D\xccFH\xa93;U; 4.0.4; zh-cn; LT28h; 720*1280) UCWEB7.9.0.94/139/352
#JUC (Linux; U; 2.3.6; zh-cn; T730; 320*480) UCWEB7.9.0.94/139/33183
#JUC (Linux; U; 4.1.2; zh-cn; GT-N7000; 800*1280) UCWEB7.9.0.94/139/352
#JUC (Linux; U; 4.1.2; zh-cn; GT-S5282; 240*320) UCWEB7.9.0.94/139/444
#JUC (Linux; U; 4.4.2; zh-cn; SM-G355H; 480*800) UCWEB7.9.0.94/139/444
#JUC(Linux;U;Android1.6;Zh_cn;E10i;240*320;)UCWEB7.8.0.95/139/355
#
#Lenovo-A820t_TD/S100 Linux/3.4.0 Android/4.1 Release/1.4.2013 Browser/AppleWebKit534.30 Mobile Safari/534.30
#Lenovo-A830/S100 Linux/3.4.0 Android/4.2 Release/01.23.2013 Browser/AppleWebKit534.30 Profile/ Configuration/ Mobile Safari/534.30
#Lenovo-A880/S100 Linux/3.4.5 Android/4.2 Release/08.07.2013 Browser/AppleWebKit 534.30 Profile/ Configuration;
#LG/KC910/V10a Browser/Obigo-Q7.1 MMS/LG-MMS-V1.0/1.2 MediaPlayer/LGPlayer/1.0 Java/ASVM/1.1 Profile/MIDP-2.1 Configuration/CLDC-1.1
#LG-KP500 Teleca/WAP2.0 MIDP-2.0/CLDC-1.1 UNTRUSTED/1.0
#LG-LG840G/V100[TF013293005745563000000017406413182] Obigo/Q7.3 Profile/MIDP-2.1 Configuration/CLDC-1.1
#
#MT6572_TD/V1 Linux/3.4.5 Android/4.2.2 Release/03.26.2013 Browser/AppleWebKit534.30 Mobile Safari/534.30 MBBMS/2.2;
#MT6572/V1 Linux/3.4.5 Android/4.2.2_OS Release/03.04.2014 Browser/AppleWebKit534.30 Profile/MIDP-2.0 Configuration/CLDC-1.1 Mobile Safari/534.30 Android 4.2.2_OS;
#
#OneBrowser/4.2.0/Adr(Linux; U; Android 2.3.5; nl-nl; GT-I9100 Build/GINGERBREAD) AppleWebKit/533.1 (KHTML, like Gecko) Mobile Safari/533.1
#
#SAMSUNG-GT-B7330/1.0 (compatible; MSIE 6.0; Windows CE; IEMobile 8.12; MSIEMobile 6.0)
#SAMSUNG-GT-C3312/1.0 NetFront/4.2 Profile/MIDP-2.0 Configuration/CLDC-1.1
#SAMSUNG-GT-S3850/S3850XEKC5 SHP/VPP/R5 Dolfin/2.0 NexPlayer/3.0 SMM-MMS/1.2.0 profile/MIDP-2.1 configuration/CLDC-1.1 OPN-B
#SAMSUNG-GT-S3850/S3850XXKC2 SHP/VPP/R5 Dolfin/2.0 NexPlayer/3.0 SMM-MMS/1.2.0 profile/MIDP-2.1 configuration/CLDC-1.1 OPN-B
#SAMSUNG-GT-S5260P/S5260PCEKJ1 SHP/VPP/R5 Dolfin/2.0 NexPlayer/3.0 SMM-MMS/1.2.0 profile/MIDP-2.1 configuration/CLDC-1.1 OPN-B
#SAMSUNG-GT-S5260/S5260XXKD1 SHP/VPP/R5 Dolfin/2.0 NexPlayer/3.0 SMM-MMS/1.2.0 profile/MIDP-2.1 configuration/CLDC-1.1 OPN-B
#SAMSUNG-S8000/S800MCEIK1 SHP/VPP/R5 Jasmine/1.0 Nextreaming SMM-MMS/1.2.0 profile/MIDP-2.1 configuration/CLDC-1.1 SS-Widget/S8000-FM
#SAMSUNG-SCH-M715/1.0 (compatible; MSIE 6.0; Windows CE; IEMobile 8.12; MSIEMobile 6.0)
#
#UCWEB/2.0(BlackBerry; U; 9.6.0.93; en-us; 9360/9.6.0.93) U2/1.0.0 UCBrowser/8.1.0.216 U2/1.0.0 Mobile
#UCWEB/2.0 (iOS; U; iPh OS 5_0_1; zh-CN; iPh4,1) U2/1.0.0 UCBrowser/9.5.1.408 U2/1.0.0 Mobile
#UCWEB/2.0 (Java; U; MIDP-2.0; en; Nokia500) U2/1.0.0 UCBrowser/9.5.0.449 U2/1.0.0 Mobile UNTRUSTED/1.0 3gpp-gba
#UCWEB/2.0 (Java; U; MIDP-2.0; en-US; Nokia501) U2/1.0.0 UCBrowser/9.5.0.449 U2/1.0.0 Mobile
#UCWEB/2.0 (Java; U; MIDP-2.0; en-US; Nokia501) U2/1.0.0 UCBrowser/9.5.0.449 U2/1.0.0 Mobile UNTRUSTED/1.0
#UCWEB/2.0 (Java; U; MIDP-2.0; en-US; Nokia6085) U2/1.0.0 UCBrowser/9.5.0.449 U2/1.0.0 Mobile
#UCWEB/2.0 (Java; U; MIDP-2.0; en-US; NokiaAsha500DualSIM) U2/1.0.0 UCBrowser/9.5.0.449 U2/1.0.0 Mobile
#UCWEB/2.0 (Java; U; MIDP-2.0; en-US; nokiac5-00.2) U2/1.0.0 UCBrowser/9.2.0.311 U2/1.0.0 Mobile 3gpp-gba
#UCWEB/2.0 (Java; U; MIDP-2.0; en-US; NokiaE63-1) U2/1.0.0 UCBrowser/9.4.1.377 U2/1.0.0 Mobile UNTRUSTED/1.0
#UCWEB/2.0 (Java; U; MIDP-2.0; en-US; SAMSUNG-GT-S3850) U2/1.0.0 UCBrowser/9.5.0.449 U2/1.0.0 Mobile UNTRUSTED/1.0
#
#UCWEB/2.0 (MIDP-2.0; U; Adr 4.4.4; en-US; SM-G530H) U2/1.0.0 UCBrowser/9.8.0.534 U2/1.0.0 Mobile
#UCWEB/2.0 (MIDP-2.0; U; Adr 4.4.4; en-US; XT1022) U2/1.0.0 UCBrowser/9.7.0.520 U2/1.0.0 Mobile
#UCWEB/2.0 (MIDP-2.0; U; Adr 4.4.4; v.smartads.com.ph; GT-I5500) U2/1.0.0 UCBrowser/9.8.0.534 U2/1.0.0 Mobile
#UCWEB/2.0 (Symbian; U; S60 V3; en-US; NOKIA6120c) U2/1.0.0 UCBrowser/9.2.0.336 U2/1.0.0 Mobile
#UCWEB/2.0 (Symbian; U; S60 V3; en-US; NokiaC5-00.2) U2/1.0.0 UCBrowser/9.2.0.336 U2/1.0.0 Mobile
#UCWEB/2.0 (Symbian; U; S60 V3; en-US; NOKIAE5-00) U2/1.0.0 UCBrowser/9.2.0.336 U2/1.0.0 Mobile
#UCWEB/2.0 (Symbian; U; S60 V3; en-US; NokiaE63) U2/1.0.0 UCBrowser/9.2.0.336 U2/1.0.0 Mobile
#
#UCWEB/2.0 (Symbian; U; S60 V5; es-LA; Nokia5233) U2/1.0.0 UCBrowser/9.2.0.336 U2/1.0.0 Mobile
#UCWEB/2.0 (Windows; U; wds 7.10; en-US; NOKIA; Lumia 610) U2/1.0.0 UCBrowser/3.2.0.340 U2/1.0.0 Mobile
#UCWEB/2.0 (Windows; U; wds 7.10; en-US; NOKIA; Lumia 710) U2/1.0.0 UCBrowser/3.2.0.340 U2/1.0.0 Mobile
#UCWEB/2.0 (Windows; U; wds 8.0; de-DE; HTC;  8S by HTC) U2/1.0.0 UCBrowser/4.2.0.524 U2/1.0.0 Mobile
#UCWEB/2.0 (Windows; U; wds 8.0; en-US; HTC;  8S by HTC) U2/1.0.0 UCBrowser/4.2.0.524 U2/1.0.0 Mobile
#UCWEB/2.0 (Windows; U; wds 8.0; en-US; HTC;  8X by HTC) U2/1.0.0 UCBrowser/4.2.1.541 U2/1.0.0 Mobile
#
#UCWEB/2.0 (Windows; U; wds 8.0; es-LA; NOKIA; RM-915_lta_lta_245) U2/1.0.0 UCBrowser/4.2.1.541 U2/1.0.0 Mobile
#UCWEB/2.0 (Windows; U; wds 8.0; pt-BR; NOKIA; RM-915_lta_brazil_211) U2/1.0.0 UCBrowser/4.1.0.504 U2/1.0.0 Mobile
#UCWEB/2.0 (Windows; U; wds 8.0; pt-BR; NOKIA; RM-915_lta_brazil_211) U2/1.0.0 UCBrowser/4.2.0.524 U2/1.0.0 Mobile
#UCWEB/2.0 (Windows; U; wds 8.10; en-IN; Microsoft; RM-1090_1001) U2/1.0.0 UCBrowser/4.2.1.541 U2/1.0.0 Mobile
#UCWEB/2.0 (Windows; U; wds 8.10; en-IN; NOKIA; RM-1040_1001) U2/1.0.0 UCBrowser/4.2.0.524 U2/1.0.0 Mobile
#UCWEB/2.0 (Windows; U; wds 8.10; en-IN; NOKIA; RM-914_im_india_269) U2/1.0.0 UCBrowser/4.2.1.541 U2/1.0.0 Mobile
#UCWEB/2.0 (Windows; U; wds 8.10; en-IN; NOKIA; RM-978_1046) U2/1.0.0 UCBrowser/4.2.1.541 U2/1.0.0 Mobile
#UCWEB/2.0 (Windows; U; wds 8.10; en-US; HUAWEI; HUAWEI W2-U00) U2/1.0.0 UCBrowser/4.2.0.524 U2/1.0.0 Mobile
#UCWEB/2.0 (Windows; U; wds 8.10; en-US; NOKIA; RM-1017_1056) U2/1.0.0 UCBrowser/4.2.1.541 U2/1.0.0 Mobile
#UCWEB/2.0 (Windows; U; wds 8.10; en-US; NOKIA; RM-1045_1063) U2/1.0.0 UCBrowser/4.2.0.524 U2/1.0.0 Mobile
#UCWEB/2.0 (Windows; U; wds 8.10; en-US; NOKIA; RM-1045_1063) U2/1.0.0 UCBrowser/4.2.1.541 U2/1.0.0 Mobile
#WebKit/3.9.4, (CE-HTML/1.0 NETTV/3.3.0 NewB) PHILIPS-AVM-2013/1.30 (Philips, BDP7750, wireless)
#WebKit/4.1.9, (CE-HTML/1.0 NETTV/3.3.0 NewB) PHILIPS-AVM-2013/1.16 (Philips, HTB5260G, wireless)
#WebKit/4.2.5, (CE-HTML/1.0 NETTV/3.3.0 NewB) PHILIPS-AVM-2013/1.35 (Philips, BDP5700, wireless)
#SAMSUNG-GT-S3333 Opera/9.80 (X11; Linux zvav; U; pt) Presto/2.12.423 Version/12.16
#SAMSUNG GT-S3570 Opera/9.80 (J2ME/MIDP; Opera Mini/6.5.30607/36.1609; U; nl) Presto/2.12.423 Version/12.16
#UCWEB/2.0 (Linux; U; Opera Mini/7.1.32052/30.3697; en-US; HTC_Desire_500) U2/1.0.0 UCBrowser/9.7.0.520 Mobile
#

#SSL Labs (https://www.ssllabs.com/about/assessment.html); on behalf of 85.17.131.202
#AlienBlue/2.9.10.0.2 CFNetwork/758.4.3 Darwin/15.6.0
#AlienBlue/2.9.5 CFNetwork/758.3.15 Darwin/15.4.0

- test:
    input:
      user_agent_string: 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1) ;  Embedded Web Browser from: http://bsalsa.com/)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : 'XP'
      OperatingSystemVersionMajor          : 'XP'
      OperatingSystemNameVersion           : 'Windows XP'
      OperatingSystemNameVersionMajor      : 'Windows XP'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Internet Explorer'
      LayoutEngineVersion                  : '6.0'
      LayoutEngineVersionMajor             : '6'
      LayoutEngineNameVersion              : 'Internet Explorer 6.0'
      LayoutEngineNameVersionMajor         : 'Internet Explorer 6'
      AgentClass                           : 'Browser'
      AgentName                            : 'Internet Explorer'
      AgentVersion                         : '6.0'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'Internet Explorer 6.0'
      AgentNameVersionMajor                : 'Internet Explorer 6'

- test:
    input:
      user_agent_string: 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; BTRS31753; Mozilla/4.0(Compatible EmbeddedWB 14.52 from: http://www.bsalsa.com/EmbeddedWB- 14.57  from: http://bsalsa.com/ ; .NET CLR 2.0.50727; OfficeLiveConnector.1.3; OfficeLivePatch.0.0; AskTbGOM2/5.11.3.15590; Windows Live Messenger 14.0.8117.0416)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : 'XP'
      OperatingSystemVersionMajor          : 'XP'
      OperatingSystemNameVersion           : 'Windows XP'
      OperatingSystemNameVersionMajor      : 'Windows XP'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Internet Explorer'
      LayoutEngineVersion                  : '7.0'
      LayoutEngineVersionMajor             : '7'
      LayoutEngineNameVersion              : 'Internet Explorer 7.0'
      LayoutEngineNameVersionMajor         : 'Internet Explorer 7'
      AgentClass                           : 'Browser'
      AgentName                            : 'Internet Explorer'
      AgentVersion                         : '7.0'
      AgentVersionMajor                    : '7'
      AgentNameVersion                     : 'Internet Explorer 7.0'
      AgentNameVersionMajor                : 'Internet Explorer 7'

# Communicators
- matcher:
    extract:
    - 'WebviewAppName                      :    150 :agent.(1)product.(1)name="Kik"'
    - 'WebviewAppVersion                   :    150 :agent.(1)product.(1)version'

- test:
    input:
      user_agent_string: 'Kik/9.4.0.4292 (Android 5.0.2) Mozilla/5.0 (Linux; Android 5.0.2; SM-G850F Build/LRX22G; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/47.0.2526.100 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung SM-G850F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '5.0.2'
      OperatingSystemVersionMajor          : '5'
      OperatingSystemNameVersion           : 'Android 5.0.2'
      OperatingSystemNameVersionMajor      : 'Android 5'
      OperatingSystemVersionBuild          : 'LRX22G'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '47.0'
      LayoutEngineVersionMajor             : '47'
      LayoutEngineNameVersion              : 'Blink 47.0'
      LayoutEngineNameVersionMajor         : 'Blink 47'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '47.0.2526.100'
      AgentVersionMajor                    : '47'
      AgentNameVersion                     : 'Chrome Webview 47.0.2526.100'
      AgentNameVersionMajor                : 'Chrome Webview 47'
      WebviewAppName                       : 'Kik'
      WebviewAppNameVersionMajor           : 'Kik 9'
      WebviewAppVersion                    : '9.4.0.4292'
      WebviewAppVersionMajor               : '9'

- matcher:
    require:
    - 'agent.(1)product.(1)name="OC"'
    extract:
    - 'DeviceClass                         :    100 : "Desktop"'
    - 'DeviceName                          :    100 : "Desktop"'
    - 'DeviceBrand                         :    100 : "Unknown"'
    - 'OperatingSystemClass                :    100 : "Desktop"'
    - 'OperatingSystemName                 :    100 : "Windows NT"'
    - 'OperatingSystemVersion              :    100 : "??"'
    - 'AgentClass                          :    100 : "Special"'
    - 'AgentName                           :    100 : "Microsoft Lync (Skype)"'
    - 'AgentVersion                        :    100 : agent.(1)product.(1)version'

- test:
    input:
      user_agent_string: 'OC/15.0.4711.1002 (Skype for Business)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Windows NT ??'
      OperatingSystemNameVersionMajor      : 'Windows NT ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'Microsoft Lync (Skype)'
      AgentVersion                         : '15.0.4711.1002'
      AgentVersionMajor                    : '15'
      AgentNameVersion                     : 'Microsoft Lync (Skype) 15.0.4711.1002'
      AgentNameVersionMajor                : 'Microsoft Lync (Skype) 15'

- matcher:
    require:
    - 'agent.(1)product.(1)name="MC"'
    - 'agent.(1)product.(1)comments.(1)entry.product.name="Microsoft Lync for Mac"'
    extract:
    - 'DeviceClass                         :    100 :"Desktop"'
    - 'DeviceName                          :    100 :"Macintosh"'
    - 'DeviceBrand                         :    100 :"Apple"'
    - 'DeviceCpu                           :    100 :"Intel"'
    - 'OperatingSystemClass                :    100 :"Desktop"'
    - 'OperatingSystemName                 :    100 :"Mac OS X"'
    - 'OperatingSystemVersion              :    100 :"10.??"'
    - 'AgentClass                          :    100 : "Special"'
    - 'AgentName                           :    100 : "Microsoft Lync (Skype)"'
    - 'AgentVersion                        :    100 : agent.(1)product.(1)version'

- test:
    input:
      user_agent_string: 'MC/14.0.0321.8 (Microsoft Lync for Mac 2011)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Apple Macintosh'
      DeviceBrand                          : 'Apple'
      DeviceCpu                            : 'Intel'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Mac OS X'
      OperatingSystemVersion               : '10.??'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Mac OS X 10.??'
      OperatingSystemNameVersionMajor      : 'Mac OS X 10'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'Microsoft Lync (Skype)'
      AgentVersion                         : '14.0.0321.8'
      AgentVersionMajor                    : '14'
      AgentNameVersion                     : 'Microsoft Lync (Skype) 14.0.0321.8'
      AgentNameVersionMajor                : 'Microsoft Lync (Skype) 14'

- test:
    input:
      user_agent_string: 'Tor Browser/8.12 (Ubuntu 3.9; nl_BE;)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '3.9'
      OperatingSystemVersionMajor          : '3'
      OperatingSystemNameVersion           : 'Ubuntu 3.9'
      OperatingSystemNameVersionMajor      : 'Ubuntu 3'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'Tor Browser'
      AgentVersion                         : '8.12'
      AgentVersionMajor                    : '8'
      AgentNameVersion                     : 'Tor Browser 8.12'
      AgentNameVersionMajor                : 'Tor Browser 8'
      AgentLanguage                        : 'Dutch (Belgium)'
      AgentLanguageCode                    : 'nl-be'

- test:
    input:
      user_agent_string: 'Iframely/0.8.5 (+http://iframely.com/;)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Iframely Robot'
      DeviceBrand                          : 'Iframely'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'Iframely'
      AgentVersion                         : '0.8.5'
      AgentVersionMajor                    : '0'
      AgentNameVersion                     : 'Iframely 0.8.5'
      AgentNameVersionMajor                : 'Iframely 0'
      AgentInformationUrl                  : 'http://iframely.com'

# The demonstration case in the web servlet
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 7.8.9; nl-nl ; Niels Ultimate 42 demo phone Build/42 ; nl-nl; https://yauaa.basjes.nl ) AppleWebKit/8.4.7.2 (KHTML, like Gecko) Yet another browser/3.1415926 Mobile Safari/6.6.6'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Niels Ultimate 42 Demo Phone'
      DeviceBrand                          : 'Niels'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.8.9'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Android 7.8.9'
      OperatingSystemNameVersionMajor      : 'Android 7'
      OperatingSystemVersionBuild          : '42'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '8.4.7.2'
      LayoutEngineVersionMajor             : '8'
      LayoutEngineNameVersion              : 'AppleWebKit 8.4.7.2'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 8'
      AgentClass                           : 'Browser'
      AgentName                            : 'Yet another browser'
      AgentVersion                         : '3.1415926'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Yet another browser 3.1415926'
      AgentNameVersionMajor                : 'Yet another browser 3'
      AgentLanguage                        : 'Dutch (Netherlands)'
      AgentLanguageCode                    : 'nl-nl'
      AgentInformationUrl                  : 'https://yauaa.basjes.nl'


# =======================================================================================
# https://justworks.ca/blog/ios-and
# Exchange ActiveSync iOS and Android User Agent Strings

- matcher:
    require:
    - 'agent.(1)product.(1)name[1-1]="Apple"'
    - 'IsNull[agent.(2)product]'
    - 'IsNull[agent.(2)text]'
    extract:
    - 'DeviceClass                         :    202 :LookUp[AppleDeviceClass;agent.(1)product.(1)name[2-2]]'
    - 'DeviceBrand                         :    202 :"Apple"'
    - 'DeviceName                          :    202 :LookUp[AppleDeviceName;agent.(1)product.(1)name[2-2]]'
    - 'DeviceVersion                       :    202 :LookUp[AppleDeviceVersion;agent.(1)product.(1)name[2-2]]'
    - 'OperatingSystemClass                :     20 :"Mobile"'
    - 'OperatingSystemName                 :     20 :"iOS"'
    - 'OperatingSystemVersion              :     20 :"??"'
    - 'AgentClass                          :     56 :"Special"'
    - 'AgentName                           :     56 :"Exchange ActiveSync"'
    - 'AgentVersion                        :     56 :agent.(1)product.(1)version'

- matcher:
    require:
    - 'agent.(1)product.(1)name[1-1]="Samsung"'
    - 'IsNull[agent.(2)product]'
    - 'IsNull[agent.(2)text]'
    extract:
    - 'DeviceClass                         :    202 :"Mobile"'
    - 'DeviceBrand                         :    202 :"Samsung"'
    - 'DeviceName                          :    202 :agent.(1)product.(1)name[2-]'
    - 'DeviceVersion                       :    202 :"??"'
    - 'OperatingSystemClass                :     20 :"Mobile"'
    - 'OperatingSystemName                 :     20 :"Android"'
    - 'OperatingSystemVersion              :     20 :"??"'
    - 'AgentClass                          :     56 :"Special"'
    - 'AgentName                           :     56 :"Exchange ActiveSync"'
    - 'AgentVersion                        :     56 :agent.(1)product.(1)version'

- test:
    input:
      user_agent_string: 'Apple-iPad2C2/1305.238'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Apple iPad'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPad 2 (GSM)'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'iOS ??'
      OperatingSystemNameVersionMajor      : 'iOS ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'Exchange ActiveSync'
      AgentVersion                         : '1305.238'
      AgentVersionMajor                    : '1305'
      AgentNameVersion                     : 'Exchange ActiveSync 1305.238'
      AgentNameVersionMajor                : 'Exchange ActiveSync 1305'

- test:
    input:
      user_agent_string: 'Apple-iPhone3C1/1104.257'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone 4 (GSM)'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'iOS ??'
      OperatingSystemNameVersionMajor      : 'iOS ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'Exchange ActiveSync'
      AgentVersion                         : '1104.257'
      AgentVersionMajor                    : '1104'
      AgentNameVersion                     : 'Exchange ActiveSync 1104.257'
      AgentNameVersionMajor                : 'Exchange ActiveSync 1104'

- test:
    input:
      user_agent_string: 'Apple-iPhone/705.18'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'iOS ??'
      OperatingSystemNameVersionMajor      : 'iOS ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'Exchange ActiveSync'
      AgentVersion                         : '705.18'
      AgentVersionMajor                    : '705'
      AgentNameVersion                     : 'Exchange ActiveSync 705.18'
      AgentNameVersionMajor                : 'Exchange ActiveSync 705'


- test:
    input:
      user_agent_string: 'Apple-iPod4C1/1002.500'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPod Touch'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPod touch (4th gen)'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'iOS ??'
      OperatingSystemNameVersionMajor      : 'iOS ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'Exchange ActiveSync'
      AgentVersion                         : '1002.500'
      AgentVersionMajor                    : '1002'
      AgentNameVersion                     : 'Exchange ActiveSync 1002.500'
      AgentNameVersionMajor                : 'Exchange ActiveSync 1002'

- test:
    input:
      user_agent_string: 'SAMSUNG-SGH-I337M/101.403'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Samsung SGH-I337M'
      DeviceBrand                          : 'Samsung'
      DeviceVersion                        : '??'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Android ??'
      OperatingSystemNameVersionMajor      : 'Android ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'Exchange ActiveSync'
      AgentVersion                         : '101.403'
      AgentVersionMajor                    : '101'
      AgentNameVersion                     : 'Exchange ActiveSync 101.403'
      AgentNameVersionMajor                : 'Exchange ActiveSync 101'

# ----------------------------------------------------------------------------------
# DuckDuckGo
- matcher:
    extract:
    - '__Set_ALL_Fields__                  :     11 :"<<<null>>>"'
    - 'DeviceClass                         :     12 :"Mobile"'
    - 'DeviceBrand                         :     12 :"Unknown"'
    - 'DeviceName                          :     12 :"Unknown"'
    - 'OperatingSystemClass                :     12 :"Mobile"'
    - 'OperatingSystemName                 :     12 :"Android"'
    - 'OperatingSystemVersion              :     12 :"??"'
    - 'LayoutEngineClass                   :     12 :"Unknown"'
    - 'LayoutEngineName                    :     12 :"Unknown"'
    - 'LayoutEngineVersion                 :     12 :"??"'
    - 'AgentClass                          :     20 :"Browser"'
    - 'AgentName                           :     20 :"DuckDuckGo"'
    - 'AgentVersion                        :     20 :agent.text[1-2]="DDG-Android"@[3-]'

- test:
    input:
      user_agent_string: 'DDG-Android-3.0.14'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Android ??'
      OperatingSystemNameVersionMajor      : 'Android ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Browser'
      AgentName                            : 'DuckDuckGo'
      AgentVersion                         : '3.0.14'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'DuckDuckGo 3.0.14'
      AgentNameVersionMajor                : 'DuckDuckGo 3'

- test:
    input:
      user_agent_string: 'DDG-Android-%version'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Android ??'
      OperatingSystemNameVersionMajor      : 'Android ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Browser'
      AgentName                            : 'DuckDuckGo'
      AgentVersion                         : '%version'
      AgentVersionMajor                    : '%version'
      AgentNameVersion                     : 'DuckDuckGo %version'
      AgentNameVersionMajor                : 'DuckDuckGo %version'


- matcher:
    extract:
    - 'DeviceClass                         :     11 :"Mobile"'
    - 'DeviceBrand                         :     11 :"Unknown"'
    - 'DeviceName                          :     11 :"Unknown"'
    - 'OperatingSystemClass                :     11 :"Mobile"'
    - 'OperatingSystemName                 :     11 :"iOS"'
    - 'OperatingSystemVersion              :     11 :"??"'
    - 'LayoutEngineClass                   :     11 :"Unknown"'
    - 'LayoutEngineName                    :     11 :"Unknown"'
    - 'LayoutEngineVersion                 :     11 :"??"'
    - 'AgentClass                          :     20 :"Browser"'
    - 'AgentName                           :     20 :"DuckDuckGo"'
    - 'AgentVersion                        :     20 :agent.text[1-2]="DDG-iOS"@[3-]'

# DuckDuckGo for iOS Version 6.0.6 (784)
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 9_3_5 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13G36; DDG-iOS-784'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '13G36'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '9.3.5'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'iOS 9.3.5'
      OperatingSystemNameVersionMajor      : 'iOS 9'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '601.1.46'
      LayoutEngineVersionMajor             : '601'
      LayoutEngineNameVersion              : 'AppleWebKit 601.1.46'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 601'
      AgentClass                           : 'Browser'
      AgentName                            : 'DuckDuckGo'
      AgentVersion                         : '784'
      AgentVersionMajor                    : '784'
      AgentNameVersion                     : 'DuckDuckGo 784'
      AgentNameVersionMajor                : 'DuckDuckGo 784'


# Coc Coc Browser (focuses on the Vietnamese market):  https://en.wikipedia.org/wiki/C%E1%BB%91c_C%E1%BB%91c
- matcher:
    extract:
    - 'AgentClass                          :   2050 :"Browser"'
    - 'AgentName                           :   2050 :"Coc Coc Browser"'
    - 'AgentVersion                        :   2050 :agent.product.name="coc_coc_browser"^.version'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) coc_coc_browser/64.4.126 Chrome/58.4.3029.126 Safari/537.36'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '8.1'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Windows 8.1'
      OperatingSystemNameVersionMajor      : 'Windows 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '58.4'
      LayoutEngineVersionMajor             : '58'
      LayoutEngineNameVersion              : 'Blink 58.4'
      LayoutEngineNameVersionMajor         : 'Blink 58'
      AgentClass                           : 'Browser'
      AgentName                            : 'Coc Coc Browser'
      AgentVersion                         : '64.4.126'
      AgentVersionMajor                    : '64'
      AgentNameVersion                     : 'Coc Coc Browser 64.4.126'
      AgentNameVersionMajor                : 'Coc Coc Browser 64'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 6.0.1; SM-G610F Build/MMB29K) AppleWebKit/537.36 (KHTML, like Gecko) coc_coc_browser/64.4.128 Mobile Chrome/58.4.3029.128 Safari/537.36'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Samsung SM-G610F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '6.0.1'
      OperatingSystemVersionMajor          : '6'
      OperatingSystemNameVersion           : 'Android 6.0.1'
      OperatingSystemNameVersionMajor      : 'Android 6'
      OperatingSystemVersionBuild          : 'MMB29K'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '58.4'
      LayoutEngineVersionMajor             : '58'
      LayoutEngineNameVersion              : 'Blink 58.4'
      LayoutEngineNameVersionMajor         : 'Blink 58'
      AgentClass                           : 'Browser'
      AgentName                            : 'Coc Coc Browser'
      AgentVersion                         : '64.4.128'
      AgentVersionMajor                    : '64'
      AgentNameVersion                     : 'Coc Coc Browser 64.4.128'
      AgentNameVersionMajor                : 'Coc Coc Browser 64'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 10_3_2 like Mac OS X) AppleWebKit/602.1.50 (KHTML, like Gecko) coc_coc_browser/64.4.130 CriOS/58.4.3029.130 Mobile/14F89 Safari/602.1'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '14F89'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '10.3.2'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'iOS 10.3.2'
      OperatingSystemNameVersionMajor      : 'iOS 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '58.4'
      LayoutEngineVersionMajor             : '58'
      LayoutEngineNameVersion              : 'Blink 58.4'
      LayoutEngineNameVersionMajor         : 'Blink 58'
      AgentClass                           : 'Browser'
      AgentName                            : 'Coc Coc Browser'
      AgentVersion                         : '64.4.130'
      AgentVersionMajor                    : '64'
      AgentNameVersion                     : 'Coc Coc Browser 64.4.130'
      AgentNameVersionMajor                : 'Coc Coc Browser 64'


- matcher:
    require:
    - 'agent.(1)product.(1)name[1]="Outlook"'
    extract:
    - 'AgentName                           :   2040 :agent.(1)product.(1)name'
    - 'AgentVersion                        :   2040 :agent.(1)product.(1)version'

- test:
    input:
      user_agent_string: 'Outlook-Express/7.0 (MSIE 7.0; Windows NT 6.2; WOW64; Trident/7.0; .NET4.0C; .NET4.0E; .NET CLR 2.0.50727; .NET CLR 3.0.30729; .NET CLR 3.5.30729; TmstmpExt)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '8'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Windows 8'
      OperatingSystemNameVersionMajor      : 'Windows 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Trident'
      LayoutEngineVersion                  : '7.0'
      LayoutEngineVersionMajor             : '7'
      LayoutEngineNameVersion              : 'Trident 7.0'
      LayoutEngineNameVersionMajor         : 'Trident 7'
      AgentClass                           : 'Browser'
      AgentName                            : 'Outlook-Express'
      AgentVersion                         : '7.0'
      AgentVersionMajor                    : '7'
      AgentNameVersion                     : 'Outlook-Express 7.0'
      AgentNameVersionMajor                : 'Outlook-Express 7'


- matcher:
    variable:
    - 'IBrowseVersion : agent.(1)product.(1)comments.entry.(1)product.(1)name="IBrowse"^.version'
    extract:
    - 'DeviceClass                         :    100 :"Desktop"'
    - 'DeviceBrand                         :    100 :"Amiga"'
    - 'DeviceName                          :    100 :"Amiga"'
    - 'OperatingSystemClass                :    100 :"Desktop"'
    - 'OperatingSystemName                 :    100 :"AmigaOS"'
    - 'OperatingSystemVersion              :      1 :"??"'
    - 'LayoutEngineClass                   :    100 :"Browser"'
    - 'LayoutEngineName                    :    100 :"IBrowse"'
    - 'LayoutEngineVersion                 :    100 :@IBrowseVersion'
    - 'AgentClass                          :    100 :"Browser"'
    - 'AgentName                           :    100 :"IBrowse"'
    - 'AgentVersion                        :    100 :@IBrowseVersion'

- matcher:
    require:
    - 'agent.(1)product.(1)comments.entry.text="AmigaOS4.0"'
    extract:
    - 'DeviceClass                         :    100 :"Desktop"'
    - 'DeviceBrand                         :    100 :"Amiga"'
    - 'DeviceName                          :    100 :"Amiga"'
    - 'OperatingSystemClass                :    100 :"Desktop"'
    - 'OperatingSystemName                 :    100 :"AmigaOS"'
    - 'OperatingSystemVersion              :    100 :"4.0"'


# IBrowse: https://www.ibrowse-dev.net/
# Quote: IBrowse is a fast, stable, classic web browser helping you surf the net with your AMIGA.
- test:
    input:
      user_agent_string: 'Mozilla/4.0 (compatible; IBrowse 2.3; AmigaOS4.0)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Amiga'
      DeviceBrand                          : 'Amiga'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'AmigaOS'
      OperatingSystemVersion               : '4.0'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'AmigaOS 4.0'
      OperatingSystemNameVersionMajor      : 'AmigaOS 4'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'IBrowse'
      LayoutEngineVersion                  : '2.3'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'IBrowse 2.3'
      LayoutEngineNameVersionMajor         : 'IBrowse 2'
      AgentClass                           : 'Browser'
      AgentName                            : 'IBrowse'
      AgentVersion                         : '2.3'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'IBrowse 2.3'
      AgentNameVersionMajor                : 'IBrowse 2'


# NetSurf 3.2 (26th August 2014) on Ubuntu 16.4
- test:
    input:
      user_agent_string: 'NetSurf/3.2 (Linux)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Linux ??'
      OperatingSystemNameVersionMajor      : 'Linux ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'NetSurf'
      AgentVersion                         : '3.2'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'NetSurf 3.2'
      AgentNameVersionMajor                : 'NetSurf 3'

# Falkon (https://www.falkon.org/about/ : Falkon is a KDE web browser using QtWebEngine rendering engine, previously known as QupZilla.)
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Falkon/3.0.0 Chrome/56.0.2924.122 Safari/537.36'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : 'Intel x86_64'
      OperatingSystemVersionMajor          : 'Intel x86'
      OperatingSystemNameVersion           : 'Linux Intel x86_64'
      OperatingSystemNameVersionMajor      : 'Linux Intel x86'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '56.0'
      LayoutEngineVersionMajor             : '56'
      LayoutEngineNameVersion              : 'Blink 56.0'
      LayoutEngineNameVersionMajor         : 'Blink 56'
      AgentClass                           : 'Browser'
      AgentName                            : 'Falkon'
      AgentVersion                         : '3.0.0'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Falkon 3.0.0'
      AgentNameVersionMajor                : 'Falkon 3'


# QupZilla (https://qupzilla.com/ -- > Now Falkon)

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; Windows NT 6.1; U; WOW64; IA64; en) QupZilla/1.6.6'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel Itanium 64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '5.0'
      LayoutEngineVersionMajor             : '5'
      LayoutEngineNameVersion              : 'Mozilla 5.0'
      LayoutEngineNameVersionMajor         : 'Mozilla 5'
      AgentClass                           : 'Browser'
      AgentName                            : 'QupZilla'
      AgentVersion                         : '1.6.6'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'QupZilla 1.6.6'
      AgentNameVersionMajor                : 'QupZilla 1'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux) AppleWebKit/538.1 (KHTML, like Gecko) QupZilla/1.8.9 Safari/538.1'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Linux ??'
      OperatingSystemNameVersionMajor      : 'Linux ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '538.1'
      LayoutEngineVersionMajor             : '538'
      LayoutEngineNameVersion              : 'AppleWebKit 538.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 538'
      AgentClass                           : 'Browser'
      AgentName                            : 'QupZilla'
      AgentVersion                         : '1.8.9'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'QupZilla 1.8.9'
      AgentNameVersionMajor                : 'QupZilla 1'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Macintosh; Intel Mac OS X) AppleWebKit/538.1 (KHTML, like Gecko) QupZilla/1.8.2 Safari/538.1'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Apple Macintosh'
      DeviceBrand                          : 'Apple'
      DeviceCpu                            : 'Intel'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Mac OS X'
      OperatingSystemVersion               : '10.?'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Mac OS X 10.?'
      OperatingSystemNameVersionMajor      : 'Mac OS X 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '538.1'
      LayoutEngineVersionMajor             : '538'
      LayoutEngineNameVersion              : 'AppleWebKit 538.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 538'
      AgentClass                           : 'Browser'
      AgentName                            : 'QupZilla'
      AgentVersion                         : '1.8.2'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'QupZilla 1.8.2'
      AgentNameVersionMajor                : 'QupZilla 1'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (N; Windows NT 5.1) AppleWebKit/534.34 (KHTML, like Gecko) QupZilla/1.6.6 Safari/534.34'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : 'XP'
      OperatingSystemVersionMajor          : 'XP'
      OperatingSystemNameVersion           : 'Windows XP'
      OperatingSystemNameVersionMajor      : 'Windows XP'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '534.34'
      LayoutEngineVersionMajor             : '534'
      LayoutEngineNameVersion              : 'AppleWebKit 534.34'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 534'
      AgentClass                           : 'Browser'
      AgentName                            : 'QupZilla'
      AgentVersion                         : '1.6.6'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'QupZilla 1.6.6'
      AgentNameVersionMajor                : 'QupZilla 1'
      AgentSecurity                        : 'No security'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (UNIX BSD/SYSV system) AppleWebKit/538.1 (KHTML, like Gecko) QupZilla/1.7.0 Safari/538.1'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Unix BSD/Sysv Desktop'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'UNIX BSD/SYSV'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'UNIX BSD/SYSV ??'
      OperatingSystemNameVersionMajor      : 'UNIX BSD/SYSV ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '538.1'
      LayoutEngineVersionMajor             : '538'
      LayoutEngineNameVersion              : 'AppleWebKit 538.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 538'
      AgentClass                           : 'Browser'
      AgentName                            : 'QupZilla'
      AgentVersion                         : '1.7.0'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'QupZilla 1.7.0'
      AgentNameVersionMajor                : 'QupZilla 1'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Unknown; UNIX BSD/SYSV system) AppleWebKit/534.34 (KHTML, like Gecko) QupZilla/1.8.6 Safari/534.34'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Unix BSD/Sysv Desktop'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'UNIX BSD/SYSV'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'UNIX BSD/SYSV ??'
      OperatingSystemNameVersionMajor      : 'UNIX BSD/SYSV ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '534.34'
      LayoutEngineVersionMajor             : '534'
      LayoutEngineNameVersion              : 'AppleWebKit 534.34'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 534'
      AgentClass                           : 'Browser'
      AgentName                            : 'QupZilla'
      AgentVersion                         : '1.8.6'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'QupZilla 1.8.6'
      AgentNameVersionMajor                : 'QupZilla 1'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Unknown; UNIX BSD/SYSV system) AppleWebKit/538.1 (KHTML, like Gecko) QupZilla/1.8.9 Version/7.0 Safari/538.1'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Unix BSD/Sysv Desktop'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'UNIX BSD/SYSV'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'UNIX BSD/SYSV ??'
      OperatingSystemNameVersionMajor      : 'UNIX BSD/SYSV ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '538.1'
      LayoutEngineVersionMajor             : '538'
      LayoutEngineNameVersion              : 'AppleWebKit 538.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 538'
      AgentClass                           : 'Browser'
      AgentName                            : 'QupZilla'
      AgentVersion                         : '1.8.9'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'QupZilla 1.8.9'
      AgentNameVersionMajor                : 'QupZilla 1'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 6.1) AppleWebKit/538.1 (KHTML, like Gecko) QupZilla/1.8.9 Safari/538.1'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '538.1'
      LayoutEngineVersionMajor             : '538'
      LayoutEngineNameVersion              : 'AppleWebKit 538.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 538'
      AgentClass                           : 'Browser'
      AgentName                            : 'QupZilla'
      AgentVersion                         : '1.8.9'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'QupZilla 1.8.9'
      AgentNameVersionMajor                : 'QupZilla 1'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.21 (KHTML, like Gecko) QupZilla/1.8.6 Safari/537.21'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.21'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.21'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'QupZilla'
      AgentVersion                         : '1.8.6'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'QupZilla 1.8.6'
      AgentNameVersionMajor                : 'QupZilla 1'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) QupZilla/2.1.2 Chrome/53.0.2785.148 Safari/537.36'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '53.0'
      LayoutEngineVersionMajor             : '53'
      LayoutEngineNameVersion              : 'Blink 53.0'
      LayoutEngineNameVersionMajor         : 'Blink 53'
      AgentClass                           : 'Browser'
      AgentName                            : 'QupZilla'
      AgentVersion                         : '2.1.2'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'QupZilla 2.1.2'
      AgentNameVersionMajor                : 'QupZilla 2'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT) AppleWebKit/538.1 (KHTML, like Gecko) QupZilla/1.8.9 Safari/538.1'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Windows NT ??'
      OperatingSystemNameVersionMajor      : 'Windows NT ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '538.1'
      LayoutEngineVersionMajor             : '538'
      LayoutEngineNameVersion              : 'AppleWebKit 538.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 538'
      AgentClass                           : 'Browser'
      AgentName                            : 'QupZilla'
      AgentVersion                         : '1.8.9'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'QupZilla 1.8.9'
      AgentNameVersionMajor                : 'QupZilla 1'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11) AppleWebKit/538.1 (KHTML, like Gecko) QupZilla/1.8.3 Safari/538.1'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Linux ??'
      OperatingSystemNameVersionMajor      : 'Linux ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '538.1'
      LayoutEngineVersionMajor             : '538'
      LayoutEngineNameVersion              : 'AppleWebKit 538.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 538'
      AgentClass                           : 'Browser'
      AgentName                            : 'QupZilla'
      AgentVersion                         : '1.8.3'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'QupZilla 1.8.3'
      AgentNameVersionMajor                : 'QupZilla 1'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; FreeBSD amd64) AppleWebKit/537.36 (KHTML, like Gecko) QupZilla/2.1.2 Chrome/49.0.2623.111 Safari/537.36'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'FreeBsd Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'AMD64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'FreeBSD'
      OperatingSystemVersion               : 'amd64'
      OperatingSystemVersionMajor          : 'amd64'
      OperatingSystemNameVersion           : 'FreeBSD amd64'
      OperatingSystemNameVersionMajor      : 'FreeBSD amd64'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '49.0'
      LayoutEngineVersionMajor             : '49'
      LayoutEngineNameVersion              : 'Blink 49.0'
      LayoutEngineNameVersionMajor         : 'Blink 49'
      AgentClass                           : 'Browser'
      AgentName                            : 'QupZilla'
      AgentVersion                         : '2.1.2'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'QupZilla 2.1.2'
      AgentNameVersionMajor                : 'QupZilla 2'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; FreeBSD) AppleWebKit/538.1 (KHTML, like Gecko) QupZilla/1.8.9 Safari/538.1'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'FreeBsd Desktop'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'FreeBSD'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'FreeBSD ??'
      OperatingSystemNameVersionMajor      : 'FreeBSD ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '538.1'
      LayoutEngineVersionMajor             : '538'
      LayoutEngineNameVersion              : 'AppleWebKit 538.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 538'
      AgentClass                           : 'Browser'
      AgentName                            : 'QupZilla'
      AgentVersion                         : '1.8.9'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'QupZilla 1.8.9'
      AgentNameVersionMajor                : 'QupZilla 1'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux) AppleWebKit/538.1 (KHTML, like Gecko) QupZilla/1.8.9 Safari/538.1'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Linux ??'
      OperatingSystemNameVersionMajor      : 'Linux ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '538.1'
      LayoutEngineVersionMajor             : '538'
      LayoutEngineNameVersion              : 'AppleWebKit 538.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 538'
      AgentClass                           : 'Browser'
      AgentName                            : 'QupZilla'
      AgentVersion                         : '1.8.9'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'QupZilla 1.8.9'
      AgentNameVersionMajor                : 'QupZilla 1'

- matcher:
    extract:
    - 'AgentClass                          :   2011 :"Browser"'
    - 'AgentName                           :   2011 :"QupZilla"'
    - 'AgentVersion                        :   2011 :agent.product.name="QupZilla"^.version'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux i686) AppleWebKit/538.1 (KHTML, like Gecko) QupZilla/1.8.9 Version/7.0 Safari/538.1'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : 'Intel i686'
      OperatingSystemVersionMajor          : 'Intel i686'
      OperatingSystemNameVersion           : 'Linux Intel i686'
      OperatingSystemNameVersionMajor      : 'Linux Intel i686'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '538.1'
      LayoutEngineVersionMajor             : '538'
      LayoutEngineNameVersion              : 'AppleWebKit 538.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 538'
      AgentClass                           : 'Browser'
      AgentName                            : 'QupZilla'
      AgentVersion                         : '1.8.9'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'QupZilla 1.8.9'
      AgentNameVersionMajor                : 'QupZilla 1'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux i686) AppleWebKit/538.1 (KHTML, like Gecko) QupZilla/1.9.0 Safari/538.1'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : 'Intel i686'
      OperatingSystemVersionMajor          : 'Intel i686'
      OperatingSystemNameVersion           : 'Linux Intel i686'
      OperatingSystemNameVersionMajor      : 'Linux Intel i686'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '538.1'
      LayoutEngineVersionMajor             : '538'
      LayoutEngineNameVersion              : 'AppleWebKit 538.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 538'
      AgentClass                           : 'Browser'
      AgentName                            : 'QupZilla'
      AgentVersion                         : '1.9.0'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'QupZilla 1.9.0'
      AgentNameVersionMajor                : 'QupZilla 1'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.21 (KHTML, like Gecko) QupZilla/1.9.9 Safari/537.21'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : 'Intel x86_64'
      OperatingSystemVersionMajor          : 'Intel x86'
      OperatingSystemNameVersion           : 'Linux Intel x86_64'
      OperatingSystemNameVersionMajor      : 'Linux Intel x86'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.21'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.21'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'QupZilla'
      AgentVersion                         : '1.9.9'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'QupZilla 1.9.9'
      AgentNameVersionMajor                : 'QupZilla 1'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) QupZilla/2.2.0 Chrome/56.0.2924.122 Safari/537.36'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : 'Intel x86_64'
      OperatingSystemVersionMajor          : 'Intel x86'
      OperatingSystemNameVersion           : 'Linux Intel x86_64'
      OperatingSystemNameVersionMajor      : 'Linux Intel x86'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '56.0'
      LayoutEngineVersionMajor             : '56'
      LayoutEngineNameVersion              : 'Blink 56.0'
      LayoutEngineNameVersionMajor         : 'Blink 56'
      AgentClass                           : 'Browser'
      AgentName                            : 'QupZilla'
      AgentVersion                         : '2.2.0'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'QupZilla 2.2.0'
      AgentNameVersionMajor                : 'QupZilla 2'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux x86_64) AppleWebKit/538.15+ (KHTML, like Gecko) WebKitGTK+/2.4.2 luakit/2012.09.13'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : 'Intel x86_64'
      OperatingSystemVersionMajor          : 'Intel x86'
      OperatingSystemNameVersion           : 'Linux Intel x86_64'
      OperatingSystemNameVersionMajor      : 'Linux Intel x86'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'WebKitGTK'
      LayoutEngineVersion                  : '2.4.2'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'WebKitGTK 2.4.2'
      LayoutEngineNameVersionMajor         : 'WebKitGTK 2'
      AgentClass                           : 'Browser'
      AgentName                            : 'luakit'
      AgentVersion                         : '2012.09.13'
      AgentVersionMajor                    : '2012'
      AgentNameVersion                     : 'luakit 2012.09.13'
      AgentNameVersionMajor                : 'luakit 2012'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux x86_64) AppleWebKit/535.4+ (KHTML, like Gecko) WebKitGTK+/1.6.1 luakit'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : 'Intel x86_64'
      OperatingSystemVersionMajor          : 'Intel x86'
      OperatingSystemNameVersion           : 'Linux Intel x86_64'
      OperatingSystemNameVersionMajor      : 'Linux Intel x86'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'WebKitGTK'
      LayoutEngineVersion                  : '1.6.1'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'WebKitGTK 1.6.1'
      LayoutEngineNameVersionMajor         : 'WebKitGTK 1'
      AgentClass                           : 'Browser'
      AgentName                            : 'luakit'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'luakit ??'
      AgentNameVersionMajor                : 'luakit ??'


- matcher:
    extract:
    - 'AgentClass                          :   2011 :"Browser"' # TODO: Or should this be 'Special'??
    - 'AgentName                           :   2011 :"Kodi"'
    - 'AgentVersion                        :   2011 :agent.product.name="Kodi"^.version'

# Kodi = XBMC Media center application = Cross platform, also on Sony Bravia
- test:
    input:
      user_agent_string:   'Kodi/17.1 (Linux; Android 6.0.1; BRAVIA 4K GB Build/MMB29V.S50) Android/6.0.1 Sys_CPU/armv7l App_Bitness/32 Version/17.1-Git:20170320-fc1619b'
    expected:
      DeviceClass                          : 'TV'
      DeviceName                           : 'Sony Bravia 4K GB'
      DeviceBrand                          : 'Sony'
      DeviceCpu                            : 'ARMv7l'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Embedded'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '6.0.1'
      OperatingSystemVersionMajor          : '6'
      OperatingSystemNameVersion           : 'Android 6.0.1'
      OperatingSystemNameVersionMajor      : 'Android 6'
      OperatingSystemVersionBuild          : 'MMB29V.S50'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Browser'
      AgentName                            : 'Kodi'
      AgentVersion                         : '17.1'
      AgentVersionMajor                    : '17'
      AgentNameVersion                     : 'Kodi 17.1'
      AgentNameVersionMajor                : 'Kodi 17'


#Chrome in Android Studio emulator
- test:
    input:
      user_agent_string:   'Mozilla/5.0 (Linux; Android 7.0; Android SDK built for x86 Build/NYC) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.90 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Google Android SDK Built FOR X86'
      DeviceBrand                          : 'Google'
      DeviceCpu                            : 'x86'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.0'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Android 7.0'
      OperatingSystemNameVersionMajor      : 'Android 7'
      OperatingSystemVersionBuild          : 'NYC'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '51.0'
      LayoutEngineVersionMajor             : '51'
      LayoutEngineNameVersion              : 'Blink 51.0'
      LayoutEngineNameVersionMajor         : 'Blink 51'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '51.0.2704.90'
      AgentVersionMajor                    : '51'
      AgentNameVersion                     : 'Chrome 51.0.2704.90'
      AgentNameVersionMajor                : 'Chrome 51'




# TODO: Review this. tb-gmx is the real useragent. Perhaps this is Thunderbird??
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; tb-gmx/2.6.12; (gmx/1.5.0.0); rv:11.0) like Gecko'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Trident'
      LayoutEngineVersion                  : '7.0'
      LayoutEngineVersionMajor             : '7'
      LayoutEngineNameVersion              : 'Trident 7.0'
      LayoutEngineNameVersionMajor         : 'Trident 7'
      AgentClass                           : 'Browser'
      AgentName                            : 'Internet Explorer'
      AgentVersion                         : '11.0'
      AgentVersionMajor                    : '11'
      AgentNameVersion                     : 'Internet Explorer 11.0'
      AgentNameVersionMajor                : 'Internet Explorer 11'



# TODO: Review this. tb-webde is the real useragent. Perhaps this is Thunderbird??
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; tb-webde/2.7.4; (webde/1.4.0.0); rv:11.0) like Gecko'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Trident'
      LayoutEngineVersion                  : '7.0'
      LayoutEngineVersionMajor             : '7'
      LayoutEngineNameVersion              : 'Trident 7.0'
      LayoutEngineNameVersionMajor         : 'Trident 7'
      AgentClass                           : 'Browser'
      AgentName                            : 'Internet Explorer'
      AgentVersion                         : '11.0'
      AgentVersionMajor                    : '11'
      AgentNameVersion                     : 'Internet Explorer 11.0'
      AgentNameVersionMajor                : 'Internet Explorer 11'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 8.0.0; SM-G950F Build/R16NW; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/69.0.3497.100 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung SM-G950F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '8.0.0'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Android 8.0.0'
      OperatingSystemNameVersionMajor      : 'Android 8'
      OperatingSystemVersionBuild          : 'R16NW'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '69.0'
      LayoutEngineVersionMajor             : '69'
      LayoutEngineNameVersion              : 'Blink 69.0'
      LayoutEngineNameVersionMajor         : 'Blink 69'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '69.0.3497.100'
      AgentVersionMajor                    : '69'
      AgentNameVersion                     : 'Chrome Webview 69.0.3497.100'
      AgentNameVersionMajor                : 'Chrome Webview 69'
      WebviewAppName                       : 'Unknown Webview App'
      WebviewAppVersion                    : '??'
      WebviewAppVersionMajor               : '??'
      WebviewAppNameVersionMajor           : 'Unknown Webview App ??'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 6.0.1; SM-G800F Build/MMB29K; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/69.0.3497.100 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung SM-G800F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '6.0.1'
      OperatingSystemVersionMajor          : '6'
      OperatingSystemNameVersion           : 'Android 6.0.1'
      OperatingSystemNameVersionMajor      : 'Android 6'
      OperatingSystemVersionBuild          : 'MMB29K'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '69.0'
      LayoutEngineVersionMajor             : '69'
      LayoutEngineNameVersion              : 'Blink 69.0'
      LayoutEngineNameVersionMajor         : 'Blink 69'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '69.0.3497.100'
      AgentVersionMajor                    : '69'
      AgentNameVersion                     : 'Chrome Webview 69.0.3497.100'
      AgentNameVersionMajor                : 'Chrome Webview 69'
      WebviewAppName                       : 'Unknown Webview App'
      WebviewAppVersion                    : '??'
      WebviewAppVersionMajor               : '??'
      WebviewAppNameVersionMajor           : 'Unknown Webview App ??'


# Cheetah Mobile : CM Browser version 5.22.xx
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 7.1.1; Nexus 6 Build/N6F27M; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/44.0.2403.119 Mobile Safari/537.36 ACHEETAHI/1'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Google Nexus 6'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.1.1'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Android 7.1.1'
      OperatingSystemNameVersionMajor      : 'Android 7'
      OperatingSystemVersionBuild          : 'N6F27M'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '44.0'
      LayoutEngineVersionMajor             : '44'
      LayoutEngineNameVersion              : 'Blink 44.0'
      LayoutEngineNameVersionMajor         : 'Blink 44'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '44.0.2403.119'
      AgentVersionMajor                    : '44'
      AgentNameVersion                     : 'Chrome Webview 44.0.2403.119'
      AgentNameVersionMajor                : 'Chrome Webview 44'
      WebviewAppName                       : 'Cheetah Mobile Browser'
      WebviewAppVersion                    : '1'
      WebviewAppVersionMajor               : '1'
      WebviewAppNameVersionMajor           : 'Cheetah Mobile Browser 1'

# Manually created edge case: Here the 'Version' is NOT the name of the browser.
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 12_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/16B92 Version/12.1 Safari/605.1.15'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '16B92'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '12.1'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'iOS 12.1'
      OperatingSystemNameVersionMajor      : 'iOS 12'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Browser'
      AgentName                            : 'Safari'
      AgentVersion                         : '12.1'
      AgentVersionMajor                    : '12'
      AgentNameVersion                     : 'Safari 12.1'
      AgentNameVersionMajor                : 'Safari 12'


# Sometimes the name of the agent is the first comment of the "(Mobile) Safari" product.
- matcher:
    variable:
    - 'Safari:agent.product.(1)name="Safari"^'
    - 'Product:@Safari.comments.(1)entry.product'
    extract:
    - 'AgentClass                          :     59 :"Browser"'
    - 'AgentName                           :     59 :@Product.name'
    - 'AgentVersion                        :     59 :@Product.version'

- matcher:
    variable:
    - 'Safari:agent.product.(1)name="Mobile Safari"^'
    - 'Product:@Safari.comments.(1)entry.product'
    extract:
    - 'AgentClass                          :     59 :"Browser"'
    - 'AgentName                           :     59 :@Product.name'
    - 'AgentVersion                        :     59 :@Product.version'

# Apparently the Airwatch Browser is a browser within the VMWare "Workspace ONE"/"AirWatch" system.
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 12_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/16B92 Version/12.1 Safari/605.1.15 (AirWatch Browser v7.1'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '16B92'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '12.1'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'iOS 12.1'
      OperatingSystemNameVersionMajor      : 'iOS 12'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Browser'
      AgentName                            : 'AirWatch Browser'
      AgentVersion                         : 'v7.1'
      AgentVersionMajor                    : 'v7'
      AgentNameVersion                     : 'AirWatch Browser v7.1'
      AgentNameVersionMajor                : 'AirWatch Browser v7'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPad; CPU OS 9_2 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13C75 Version/7.0 Safari/9537.53 (AirWatch Browser v4509)'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Apple iPad'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '13C75'
      DeviceVersion                        : 'iPad'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '9.2'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'iOS 9.2'
      OperatingSystemNameVersionMajor      : 'iOS 9'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '601.1.46'
      LayoutEngineVersionMajor             : '601'
      LayoutEngineNameVersion              : 'AppleWebKit 601.1.46'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 601'
      AgentClass                           : 'Browser'
      AgentName                            : 'AirWatch Browser'
      AgentVersion                         : 'v4509'
      AgentVersionMajor                    : 'v4509'
      AgentNameVersion                     : 'AirWatch Browser v4509'
      AgentNameVersionMajor                : 'AirWatch Browser v4509'

# Sogou Explorer (Sogou Browser?)
# https://stackoverflow.com/questions/12109356/what-is-the-browser-engine-of-the-sogou-browser

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 5.2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36 SE 2.X MetaSr 1.0'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : 'XP x64 Edition'
      OperatingSystemVersionMajor          : 'XP x64 Edition'
      OperatingSystemNameVersion           : 'Windows XP x64 Edition'
      OperatingSystemNameVersionMajor      : 'Windows XP x64 Edition'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '58.0'
      LayoutEngineVersionMajor             : '58'
      LayoutEngineNameVersion              : 'Blink 58.0'
      LayoutEngineNameVersionMajor         : 'Blink 58'
      AgentClass                           : 'Browser'
      AgentName                            : 'Sogou Explorer'
      AgentVersion                         : '2.X'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Sogou Explorer 2.X'
      AgentNameVersionMajor                : 'Sogou Explorer 2'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36 SE 2.X MetaSr 1.0'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '58.0'
      LayoutEngineVersionMajor             : '58'
      LayoutEngineNameVersion              : 'Blink 58.0'
      LayoutEngineNameVersionMajor         : 'Blink 58'
      AgentClass                           : 'Browser'
      AgentName                            : 'Sogou Explorer'
      AgentVersion                         : '2.X'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Sogou Explorer 2.X'
      AgentNameVersionMajor                : 'Sogou Explorer 2'

- matcher:
    variable:
    - 'SogouProduct: agent.product.comments.entry.(1)product.name="SE"'
    require:
    - 'agent.product.comments.entry.product.name="MSIE"'
    - 'agent.product.comments.entry.(2)product.name="MetaSr"'
    extract:
    - 'AgentClass                          :   2100 : "Browser"'
    - 'AgentName                           :   2100 : "Sogou Explorer"'
    - 'AgentVersion                        :   2100 : @SogouProduct^.version'


- test:
    input:
      user_agent_string: 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0; SE 2.X MetaSr 1.0; SE 2.X MetaSr 1.0; .NET CLR 2.0.50727; SE 2.X MetaSr 1.0)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : 'XP'
      OperatingSystemVersionMajor          : 'XP'
      OperatingSystemNameVersion           : 'Windows XP'
      OperatingSystemNameVersionMajor      : 'Windows XP'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Trident'
      LayoutEngineVersion                  : '4.0'
      LayoutEngineVersionMajor             : '4'
      LayoutEngineNameVersion              : 'Trident 4.0'
      LayoutEngineNameVersionMajor         : 'Trident 4'
      AgentClass                           : 'Browser'
      AgentName                            : 'Sogou Explorer'
      AgentVersion                         : '2.X'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Sogou Explorer 2.X'
      AgentNameVersionMajor                : 'Sogou Explorer 2'


#
# Yet Another UserAgent Analyzer
# Copyright (C) 2013-2021 Niels Basjes
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# https://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an AS IS BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

config:

# These are known robots that do not have words like bot, crawler, spider in their name.
- set:
    name: 'NamedSpecials'
    values:
    - 'IntelliJ IDEA'

- set:
    name: 'UnwantedSpecials'
    values:
    - 'Mozilla'
    - 'FakeYauaaProduct'
    - 'Dalvik'

- matcher:
    require:
    - 'agent.(1)text?NamedSpecials'
    extract:
    - '__Set_ALL_Fields__                  :     1400 :"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'AgentClass                          :     1500 :"Special"'
    - 'AgentName                           :     1500 :agent'
    - 'AgentVersion                        :     1500 :"<<<null>>>"'

- matcher:
    variable:
    - 'AgentName                           :agent.(1)product.name?!UnwantedSpecials'
    extract:
    - 'AgentClass                          :        5 :"Special"'
    - 'AgentName                           :        5 :@AgentName'

- matcher:
    require:
    - 'agent.(1)product.name?!UnwantedSpecials'
    extract:
    - 'AgentClass                          :        6 :"Special"'
    - 'AgentName                           :        6 :agent.(1)product.url'

- matcher:
    require:
    - 'agent.(1)product.name?!UnwantedSpecials'
    extract:
    - 'AgentVersion                        :        5 :agent.(1)product.(1)comments.(1)entry.(1)text'

- matcher:
    require:
    - 'agent.(1)product.name?!UnwantedSpecials'
    extract:
    - 'AgentVersion                        :        6 :agent.(1)product.version'

# ================================
# Specific browser rules

- matcher:
    variable:
    - 'WebKitGTK                           :agent.product.name="WebKitGTK"^'
    extract:
    - 'LayoutEngineClass                   :      100 :"Browser"'
    - 'LayoutEngineName                    :      100 :"WebKitGTK"'
    - 'LayoutEngineVersion                 :      100 :@WebKitGTK.version'

- matcher:
    variable:
    - 'WebKitGTK                           :agent.product.name="WebKitGTK"^'
    extract:
    - 'LayoutEngineClass                   :      100 :"Browser"'
    - 'LayoutEngineName                    :      100 :"WebKitGTK"'
    - 'LayoutEngineVersion                 :      100 :@WebKitGTK.version'
    - 'AgentClass                          :      100 :"Browser"'
    - 'AgentName                           :      100 :@WebKitGTK>.name'
    - 'AgentVersion                        :      100 :@WebKitGTK>.version'

- matcher:
    variable:
    - 'WebKitGTK                           :agent.product.name="WebKitGTK"^'
    extract:
    - 'LayoutEngineClass                   :      100 :"Browser"'
    - 'LayoutEngineName                    :      100 :"WebKitGTK"'
    - 'LayoutEngineVersion                 :      100 :@WebKitGTK.version'
    - 'AgentClass                          :      100 :"Browser"'
    - 'AgentName                           :      100 :@WebKitGTK>.text'
    - 'AgentVersion                        :      100 :"<<<null>>>"'


# ================================

- test:
    input:
      user_agent_string: 'Links (2.1pre15; Linux 2.4.26 i686; 128x48)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '2.4.26'
      OperatingSystemVersionMajor          : '2'
      OperatingSystemNameVersion           : 'Linux 2.4.26'
      OperatingSystemNameVersionMajor      : 'Linux 2'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'Links'
      AgentVersion                         : '2.1pre15'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Links 2.1pre15'
      AgentNameVersionMajor                : 'Links 2'

- test:
    input:
      user_agent_string: 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0; brip1; RainBird 1.01/HT; Crazy Browser 1.0.5; .NET CLR 1.1.4322)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '2000'
      OperatingSystemVersionMajor          : '2000'
      OperatingSystemNameVersion           : 'Windows 2000'
      OperatingSystemNameVersionMajor      : 'Windows 2000'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Internet Explorer'
      LayoutEngineVersion                  : '6.0'
      LayoutEngineVersionMajor             : '6'
      LayoutEngineNameVersion              : 'Internet Explorer 6.0'
      LayoutEngineNameVersionMajor         : 'Internet Explorer 6'
      AgentClass                           : 'Browser'
      AgentName                            : 'Crazy Browser'
      AgentVersion                         : '1.0.5'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Crazy Browser 1.0.5'
      AgentNameVersionMajor                : 'Crazy Browser 1'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; FreeBSD; U; Viera; nl-NL) AppleWebKit/537.11 (KHTML, like Gecko) Viera/3.10.14 Chrome/23.0.1271.97 Safari/537.11'
    expected:
      DeviceClass                          : 'TV'
      DeviceName                           : 'Panasonic Viera'
      DeviceBrand                          : 'Panasonic'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'FreeBSD'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'FreeBSD ??'
      OperatingSystemNameVersionMajor      : 'FreeBSD ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.11'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.11'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'Viera'
      AgentVersion                         : '3.10.14'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Viera 3.10.14'
      AgentNameVersionMajor                : 'Viera 3'
      AgentLanguage                        : 'Dutch (Netherlands)'
      AgentLanguageCode                    : 'nl-nl'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPad; CPU OS 8.1.2 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) 1Password/5.1.2 (like Version/12B440 Mobile/8.1.2 Safari/8536.25)'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Apple iPad'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPad'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '8.1.2'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'iOS 8.1.2'
      OperatingSystemNameVersionMajor      : 'iOS 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '536.26'
      LayoutEngineVersionMajor             : '536'
      LayoutEngineNameVersion              : 'AppleWebKit 536.26'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 536'
      AgentClass                           : 'Browser'
      AgentName                            : '1Password'
      AgentVersion                         : '5.1.2'
      AgentVersionMajor                    : '5'
      AgentNameVersion                     : '1Password 5.1.2'
      AgentNameVersionMajor                : '1Password 5'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU OS 11_4 like Mac OS X) AppleWebKit/600.1.4 (KHTML, like Gecko) 1Password/7.0.6 (like Version/11.4 Mobile/15F5049c Safari/600.1.4)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '11.4'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'iOS 11.4'
      OperatingSystemNameVersionMajor      : 'iOS 11'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '600.1.4'
      LayoutEngineVersionMajor             : '600'
      LayoutEngineNameVersion              : 'AppleWebKit 600.1.4'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 600'
      AgentClass                           : 'Browser'
      AgentName                            : '1Password'
      AgentVersion                         : '7.0.6'
      AgentVersionMajor                    : '7'
      AgentNameVersion                     : '1Password 7.0.6'
      AgentNameVersionMajor                : '1Password 7'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPad; CPU OS 11_3 like Mac OS X) AppleWebKit/600.1.4 (KHTML, like Gecko) 1Password/7.0.6 (like Version/11.3 Mobile/15E216 Safari/600.1.4'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Apple iPad'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPad'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '11.3'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'iOS 11.3'
      OperatingSystemNameVersionMajor      : 'iOS 11'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '600.1.4'
      LayoutEngineVersionMajor             : '600'
      LayoutEngineNameVersion              : 'AppleWebKit 600.1.4'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 600'
      AgentClass                           : 'Browser'
      AgentName                            : '1Password'
      AgentVersion                         : '7.0.6'
      AgentVersionMajor                    : '7'
      AgentNameVersion                     : '1Password 7.0.6'
      AgentNameVersionMajor                : '1Password 7'

# If the BASE64 minimal size gets too small this becomes a parse error
- test:
    input:
      user_agent_string: 'AndroidDownloadManager/5.0.1 (Linux; U; Android 5.0.1; HUAWEI GRA-L09 Build/HUAWEIGRA-L09)'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Huawei GRA-L09'
      DeviceBrand                          : 'Huawei'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '5.0.1'
      OperatingSystemVersionMajor          : '5'
      OperatingSystemNameVersion           : 'Android 5.0.1'
      OperatingSystemNameVersionMajor      : 'Android 5'
      OperatingSystemVersionBuild          : 'HUAWEIGRA-L09'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'AndroidDownloadManager'
      AgentVersion                         : '5.0.1'
      AgentVersionMajor                    : '5'
      AgentNameVersion                     : 'AndroidDownloadManager 5.0.1'
      AgentNameVersionMajor                : 'AndroidDownloadManager 5'
      AgentSecurity                        : 'Strong security'


- matcher:
    extract:
    - 'DeviceClass                         :      100 :"Robot"'
    - 'DeviceBrand                         :      100 :"CloudFlare"'
    - 'DeviceName                          :      100 :"CloudFlare AlwaysOnline"'
    - 'AgentClass                          :      100 :"Robot"'
    - 'AgentName                           :      100 :"CloudFlare AlwaysOnline"'
    - 'AgentVersion                        :      100 :agent.(1)product.(1)comments.entry.(1)product.name="CloudFlare-AlwaysOnline"^.version'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; CloudFlare-AlwaysOnline/1.0; +http://www.cloudflare.com/always-online) AppleWebKit/534.34'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'CloudFlare AlwaysOnline'
      DeviceBrand                          : 'CloudFlare'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '534.34'
      LayoutEngineVersionMajor             : '534'
      LayoutEngineNameVersion              : 'AppleWebKit 534.34'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 534'
      AgentClass                           : 'Robot'
      AgentName                            : 'CloudFlare AlwaysOnline'
      AgentVersion                         : '1.0'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'CloudFlare AlwaysOnline 1.0'
      AgentNameVersionMajor                : 'CloudFlare AlwaysOnline 1'
      AgentInformationUrl                  : 'http://www.cloudflare.com/always-online'

- test:
    input:
      user_agent_string: 'Mobitest 1.8 (iPhone; iPhone OS 7.1.2; nl_NL)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '7.1.2'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'iOS 7.1.2'
      OperatingSystemNameVersionMajor      : 'iOS 7'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'Mobitest'
      AgentVersion                         : '1.8'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Mobitest 1.8'
      AgentNameVersionMajor                : 'Mobitest 1'
      AgentLanguage                        : 'Dutch (Netherlands)'
      AgentLanguageCode                    : 'nl-nl'

- test:
    input:
      user_agent_string: 'Airmail%202.0.3%20rv:286%20(Macintosh;%20Mac%20OS%20X%2010.9.5;%20ja_JP)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Apple Macintosh'
      DeviceBrand                          : 'Apple'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Mac OS X'
      OperatingSystemVersion               : '10.9.5'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Mac OS X 10.9.5'
      OperatingSystemNameVersionMajor      : 'Mac OS X 10'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'Airmail'
      AgentVersion                         : '2.0.3'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Airmail 2.0.3'
      AgentNameVersionMajor                : 'Airmail 2'
      AgentLanguage                        : 'Japanese (Japan)'
      AgentLanguageCode                    : 'ja-jp'

- test:
    input:
      user_agent_string: 'Chromeless 1.3.0'
    expected:
      DeviceClass                          : 'Unknown'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Unknown'
      OperatingSystemName                  : 'Unknown'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Unknown ??'
      OperatingSystemNameVersionMajor      : 'Unknown ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'Chromeless'
      AgentVersion                         : '1.3.0'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Chromeless 1.3.0'
      AgentNameVersionMajor                : 'Chromeless 1'

- test:
    input:
      user_agent_string: 'IntelliJ IDEA/162.1447.26'
    expected:
      DeviceClass                          : 'Unknown'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Unknown'
      OperatingSystemName                  : 'Unknown'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Unknown ??'
      OperatingSystemNameVersionMajor      : 'Unknown ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'IntelliJ IDEA'
      AgentVersion                         : '162.1447.26'
      AgentVersionMajor                    : '162'
      AgentNameVersion                     : 'IntelliJ IDEA 162.1447.26'
      AgentNameVersionMajor                : 'IntelliJ IDEA 162'


- test:
    input:
      user_agent_string: 'IntelliJ IDEA'
    expected:
      DeviceClass                          : 'Unknown'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Unknown'
      OperatingSystemName                  : 'Unknown'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Unknown ??'
      OperatingSystemNameVersionMajor      : 'Unknown ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'IntelliJ IDEA'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'IntelliJ IDEA ??'
      AgentNameVersionMajor                : 'IntelliJ IDEA ??'


- matcher:
    extract:
    - 'AgentVersion                        :        1 : agent.(1)product.name="R"^.(1)comments.(1)entry.(1)product.name'

- test:
    input:
      user_agent_string: 'R (3.3.3 x86_64-redhat-linux-gnu x86_64 linux-gnu)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Linux ??'
      OperatingSystemNameVersionMajor      : 'Linux ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'R'
      AgentVersion                         : '3.3.3'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'R 3.3.3'
      AgentNameVersionMajor                : 'R 3'

- test:
    input:
      user_agent_string: 'R (3.3.2 x86_64-w64-mingw32 x86_64 mingw32)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Windows NT ??'
      OperatingSystemNameVersionMajor      : 'Windows NT ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'R'
      AgentVersion                         : '3.3.2'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'R 3.3.2'
      AgentNameVersionMajor                : 'R 3'


# Puffin on an Android 6 phone is incorrectly reported as a Linux desktop
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; U; Linux x86_64; en-gb) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/30.0.1599.114 Safari/537.36 Puffin/4.8.0.2790AP'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Linux ??'
      OperatingSystemNameVersionMajor      : 'Linux ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '30.0'
      LayoutEngineVersionMajor             : '30'
      LayoutEngineNameVersion              : 'Blink 30.0'
      LayoutEngineNameVersionMajor         : 'Blink 30'
      AgentClass                           : 'Browser'
      AgentName                            : 'Puffin'
      AgentVersion                         : '4.8.0.2790AP'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Puffin 4.8.0.2790AP'
      AgentNameVersionMajor                : 'Puffin 4'
      AgentLanguage                        : 'English (United Kingdom)'
      AgentLanguageCode                    : 'en-gb'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.83 Safari/537.1 AvantBrowser/Tri-Core'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.1'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'AvantBrowser'
      AgentVersion                         : 'Tri-Core'
      AgentVersionMajor                    : 'Tri'
      AgentNameVersion                     : 'AvantBrowser Tri-Core'
      AgentNameVersionMajor                : 'AvantBrowser Tri'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.19 (KHTML, like Gecko) Chrome/18.0.1025.152 Safari/535.19 CoolNovo/2.0.3.55'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '535.19'
      LayoutEngineVersionMajor             : '535'
      LayoutEngineNameVersion              : 'AppleWebKit 535.19'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 535'
      AgentClass                           : 'Browser'
      AgentName                            : 'CoolNovo'
      AgentVersion                         : '2.0.3.55'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'CoolNovo 2.0.3.55'
      AgentNameVersionMajor                : 'CoolNovo 2'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_2) AppleWebKit/537.4 (KHTML, like Gecko) Chrome/22.0.1229.94 Safari/537.4 AlexaToolbar/alxg-3.1'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Apple Macintosh'
      DeviceBrand                          : 'Apple'
      DeviceCpu                            : 'Intel'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Mac OS X'
      OperatingSystemVersion               : '10.8.2'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Mac OS X 10.8.2'
      OperatingSystemNameVersionMajor      : 'Mac OS X 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.4'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.4'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '22.0.1229.94'
      AgentVersionMajor                    : '22'
      AgentNameVersion                     : 'Chrome 22.0.1229.94'
      AgentNameVersionMajor                : 'Chrome 22'

# https://www.zemana.com/antimalware
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US) AppleWebKit/534.7 (KHTML, like Gecko) Chrome/22.0.1229.94 Safari/534.7 ZemanaAID/FFFF0089'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '534.7'
      LayoutEngineVersionMajor             : '534'
      LayoutEngineNameVersion              : 'AppleWebKit 534.7'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 534'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '22.0.1229.94'
      AgentVersionMajor                    : '22'
      AgentNameVersion                     : 'Chrome 22.0.1229.94'
      AgentNameVersionMajor                : 'Chrome 22'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux i686) AppleWebKit/537.13 (KHTML, like Gecko) Chrome/24.0.1290.0 Safari/537.13 SUSE/24.0.1290.0'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'SUSE'
      OperatingSystemVersion               : '24.0.1290.0'
      OperatingSystemVersionMajor          : '24'
      OperatingSystemNameVersion           : 'SUSE 24.0.1290.0'
      OperatingSystemNameVersionMajor      : 'SUSE 24'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.13'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.13'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '24.0.1290.0'
      AgentVersionMajor                    : '24'
      AgentNameVersion                     : 'Chrome 24.0.1290.0'
      AgentNameVersionMajor                : 'Chrome 24'

- matcher:
    variable:
    - 'Product                             :agent.product.name="Browser"^'
    - 'ProductV1                           :@Product.(1)version'
    - 'ProductV2                           :@Product.(2)version'
    - 'Profile                             :agent.product.name="Profile"'
    require:
    - '@Profile^.(1)version[1]="MIDP"'
    extract:
    - 'LayoutEngineClass                   :       10 :"Browser"'
    - 'LayoutEngineName                    :       10 :@ProductV1'
    - 'LayoutEngineVersion                 :       10 :@ProductV2'
    - 'AgentClass                          :     1000 :"Browser"'
    - 'AgentName                           :     1000 :@ProductV1'
    - 'AgentVersion                        :     1000 :@ProductV2'

- test:
    input:
      user_agent_string: 'Mozilla/4.0 SonyEricssonW910iv/R1FA Browser/NetFront/3.4 Profile/MIDP-2.1 Configuration/CLDC-1.1'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'SonyEricsson W910IV'
      DeviceBrand                          : 'SonyEricsson'
      DeviceVersion                        : '4.0'
      OperatingSystemClass                 : 'Unknown'
      OperatingSystemName                  : 'Unknown'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Unknown ??'
      OperatingSystemNameVersionMajor      : 'Unknown ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'NetFront'
      LayoutEngineVersion                  : '3.4'
      LayoutEngineVersionMajor             : '3'
      LayoutEngineNameVersion              : 'NetFront 3.4'
      LayoutEngineNameVersionMajor         : 'NetFront 3'
      AgentClass                           : 'Browser'
      AgentName                            : 'NetFront'
      AgentVersion                         : '3.4'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'NetFront 3.4'
      AgentNameVersionMajor                : 'NetFront 3'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 2.3.4; nl-nl; SonyEricssonLT15i Build/4.0.2.A.0.62) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'SonyEricsson LT15I'
      DeviceBrand                          : 'SonyEricsson'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '2.3.4'
      OperatingSystemVersionMajor          : '2'
      OperatingSystemNameVersion           : 'Android 2.3.4'
      OperatingSystemNameVersionMajor      : 'Android 2'
      OperatingSystemVersionBuild          : '4.0.2.A.0.62'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '533.1'
      LayoutEngineVersionMajor             : '533'
      LayoutEngineNameVersion              : 'AppleWebKit 533.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 533'
      AgentClass                           : 'Browser'
      AgentName                            : 'Stock Android Browser'
      AgentVersion                         : '4.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Stock Android Browser 4.0'
      AgentNameVersionMajor                : 'Stock Android Browser 4'
      AgentLanguage                        : 'Dutch (Netherlands)'
      AgentLanguageCode                    : 'nl-nl'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'SonyEricssonW960i/R100 Mozilla/4.0 (compatible; MSIE 6.0; Symbian OS; 768) Opera 8.65 [en]'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'SonyEricsson W960I'
      DeviceBrand                          : 'SonyEricsson'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'SymbianOS'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'SymbianOS ??'
      OperatingSystemNameVersionMajor      : 'SymbianOS ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '1'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Presto 1'
      LayoutEngineNameVersionMajor         : 'Presto 1'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera'
      AgentVersion                         : '8.65'
      AgentVersionMajor                    : '8'
      AgentNameVersion                     : 'Opera 8.65'
      AgentNameVersionMajor                : 'Opera 8'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'


- test:
    input:
      user_agent_string: 'python-requests/2.1.0 CPython/2.7.3 Linux/3.2.0-4-amd64'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '3.2.0-4-amd64'
      OperatingSystemVersionMajor          : '3'
      OperatingSystemNameVersion           : 'Linux 3.2.0-4-amd64'
      OperatingSystemNameVersionMajor      : 'Linux 3'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'Python-Requests'
      AgentVersion                         : '2.1.0'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Python-Requests 2.1.0'
      AgentNameVersionMajor                : 'Python-Requests 2'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 4.4.2; SM-G355HN Build/KOT49H) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/47.0.2526.0 MobileIron/1.9.0 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung SM-G355HN'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.4.2'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.4.2'
      OperatingSystemNameVersionMajor      : 'Android 4'
      OperatingSystemVersionBuild          : 'KOT49H'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '47.0'
      LayoutEngineVersionMajor             : '47'
      LayoutEngineNameVersion              : 'Blink 47.0'
      LayoutEngineNameVersionMajor         : 'Blink 47'
      AgentClass                           : 'Browser'
      AgentName                            : 'MobileIron'
      AgentVersion                         : '1.9.0'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'MobileIron 1.9.0'
      AgentNameVersionMajor                : 'MobileIron 1'

# Sometimes the name of the agent is BETWEEN the "Mobile" and "Version" products.
- matcher:
    require:
    - 'agent.product.name="Version"' # Performance trick
    variable:
    - 'Product                             :agent.product.name="Mobile"^>>.name="Version"^<'
    extract:
    - 'AgentClass                          :      100 :"Browser"'
    - 'AgentName                           :      100 :@Product.name'
    - 'AgentVersion                        :      100 :@Product.version'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 8_3 like Mac OS X) AppleWebKit/600.1.4 (KHTML, like Gecko) Mobile/12F70 MobileIron/1.7.1 Version/8.3 Safari/600.1.4'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '12F70'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '8.3'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'iOS 8.3'
      OperatingSystemNameVersionMajor      : 'iOS 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '600.1.4'
      LayoutEngineVersionMajor             : '600'
      LayoutEngineNameVersion              : 'AppleWebKit 600.1.4'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 600'
      AgentClass                           : 'Browser'
      AgentName                            : 'MobileIron'
      AgentVersion                         : '1.7.1'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'MobileIron 1.7.1'
      AgentNameVersionMajor                : 'MobileIron 1'

# Sometimes the name of the agent is BETWEEN the "Mobile" and "(Mobile) Safari" products.
- matcher:
    require:
    - 'agent.product.name="Safari"' # Performance trick
    variable:
    - 'Product                             :agent.product.name="Mobile"^>>.name="Safari"^<'
    extract:
    - 'AgentClass                          :     2049 :"Browser"'
    - 'AgentName                           :     2049 :@Product.name!="Version"'
    - 'AgentVersion                        :     2049 :@Product.version'

- matcher:
    require:
    - 'agent.product.name="Mobile Safari"' # Performance trick
    variable:
    - 'Product                             :agent.product.name="Mobile"^>>.name="Mobile Safari"^<'
    extract:
    - 'AgentClass                          :     2049 :"Browser"'
    - 'AgentName                           :     2049 :@Product.name!="Version"'
    - 'AgentVersion                        :     2049 :@Product.version'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPod; U; CPU iPhone OS 8_1_3 like Mac OS X; nl-nl) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8C134 NetNanny Mobile/1.0 Safari/6533.18.5'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPod'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '8C134'
      DeviceVersion                        : 'iPod'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '8.1.3'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'iOS 8.1.3'
      OperatingSystemNameVersionMajor      : 'iOS 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '533.17.9'
      LayoutEngineVersionMajor             : '533'
      LayoutEngineNameVersion              : 'AppleWebKit 533.17.9'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 533'
      AgentClass                           : 'Browser'
      AgentName                            : 'NetNanny Mobile'
      AgentVersion                         : '1.0'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'NetNanny Mobile 1.0'
      AgentNameVersionMajor                : 'NetNanny Mobile 1'
      AgentLanguage                        : 'Dutch (Netherlands)'
      AgentLanguageCode                    : 'nl-nl'
      AgentSecurity                        : 'Strong security'

# Quark on iOS
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 11_2_6 like Mac OS X; zh-cn) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/15D100 Quark/2.2.9.989 Mobile'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15D100'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '11.2.6'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'iOS 11.2.6'
      OperatingSystemNameVersionMajor      : 'iOS 11'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '601.1.46'
      LayoutEngineVersionMajor             : '601'
      LayoutEngineNameVersion              : 'AppleWebKit 601.1.46'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 601'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Quark'
      AgentVersion                         : '2.2.9.989'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Quark 2.2.9.989'
      AgentNameVersionMajor                : 'Quark 2'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'

# Sometimes the name of the agent is AFTER the "Mobile" and "(Mobile) Safari" products.
- matcher:
    require:
    - 'agent.product.name="Safari"' # Performance trick
    variable:
    - 'Product                             :agent.product.name="Mobile"^>.name="Safari"^>'
    extract:
    - 'AgentClass                          :     2049 :"Browser"'
    - 'AgentName                           :     2049 :@Product.name'
    - 'AgentVersion                        :     2049 :@Product.version'

- matcher:
    require:
    - 'agent.product.name="Mobile Safari"' # Performance trick
    variable:
    - 'Product                             :agent.product.name="Mobile"^>.name="Mobile Safari"^>'
    extract:
    - 'AgentClass                          :     2049 :"Browser"'
    - 'AgentName                           :     2049 :@Product.name'
    - 'AgentVersion                        :     2049 :@Product.version'

# Also Quark
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; U; CPU iPhone OS 4_3_2 like Mac OS X; en-us) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8H7 Safari/6533.18.5 Quark/2.4.1.985'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '8H7'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '4.3.2'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'iOS 4.3.2'
      OperatingSystemNameVersionMajor      : 'iOS 4'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '533.17.9'
      LayoutEngineVersionMajor             : '533'
      LayoutEngineNameVersion              : 'AppleWebKit 533.17.9'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 533'
      AgentClass                           : 'Browser'
      AgentName                            : 'Quark'
      AgentVersion                         : '2.4.1.985'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Quark 2.4.1.985'
      AgentNameVersionMajor                : 'Quark 2'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'



# https://www.dillo.org/
- test:
    input:
      user_agent_string: 'Dillo/0.8.5-i18n-misc'
    expected:
      DeviceClass                          : 'Unknown'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Unknown'
      OperatingSystemName                  : 'Unknown'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Unknown ??'
      OperatingSystemNameVersionMajor      : 'Unknown ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'Dillo'
      AgentVersion                         : '0.8.5-i18n-misc'
      AgentVersionMajor                    : '0'
      AgentNameVersion                     : 'Dillo 0.8.5-i18n-misc'
      AgentNameVersionMajor                : 'Dillo 0'


# TODO: A lot of special browsers

#DoCoMo    1.0    DoCoMo/1.0/D503iS/c10
#DoCoMo    1.0    DoCoMo/1.0/P502i/c10 (Google CHTML Proxy/1.0)
#DoCoMo    2.0    DoCoMo/2.0 F900i(c100;TB;W22H12),gzip(gfe) (via translate.google.com)
#DoCoMo    2.0    DoCoMo/2.0 N900i(c100;TB;W24H12)
#Doris    1.10    Doris/1.10 [en] (Symbian)
#Doris    1.17    Doris/1.17 [en] (Symbian)

#Mozilla/4.5 (compatible; iCab 2.9.7; Macintosh; U; PPC)
#Mozilla/4.5 (compatible; iCab 2.9.7; Macintosh; U; PPC; Mac OS X)
#Jakarta Commons-HttpClient/2.0.1
#Java/1.5.0
#Mozilla/5.0 (compatible; Konqueror/3.1; OpenBSD)
#Mozilla/5.0 (compatible; Konqueror/3.1; SunOS)
#Mozilla/5.0 (compatible; Konqueror/3.1.3; OpenBSD 3.4)
#Mozilla/5.0 (compatible; Konqueror/3.2; Darwin) (KHTML, like Gecko)
#
#Firefox/32.0.3 (x86 en-US); anonymized by Abelssoft 1598848102
#Firefox/34.0.5 (x86 de); anonymized by Abelssoft 1811190192
#Firefox/34.0.5 (x86 de); anonymized by Abelssoft 223791841
#
#Google-Sitemaps/1.0
#GT-I9190/V1 Linux/3.4.39 Android/4.4.4 Release/10.31.2014 Browser/AppleWebKit534.30 Mobile Safari/534.30 MBBMS/2.2 System/Android 4.4.4
#GT-I9300 Linux/3.0.13 Android/4.1.9 Release/02.02.2013 Browser/AppleWebKit534.30 Profile/MIDP-2.0 Configuration/CLDC-1.1 Mobile Safari/534.30 Android 4.0.1;
#
#JUC (D\xccFH\xa93;U; 4.0.4; zh-cn; LT28h; 720*1280) UCWEB7.9.0.94/139/352
#JUC (Linux; U; 2.3.6; zh-cn; T730; 320*480) UCWEB7.9.0.94/139/33183
#JUC (Linux; U; 4.1.2; zh-cn; GT-N7000; 800*1280) UCWEB7.9.0.94/139/352
#JUC (Linux; U; 4.1.2; zh-cn; GT-S5282; 240*320) UCWEB7.9.0.94/139/444
#JUC (Linux; U; 4.4.2; zh-cn; SM-G355H; 480*800) UCWEB7.9.0.94/139/444
#JUC(Linux;U;Android1.6;Zh_cn;E10i;240*320;)UCWEB7.8.0.95/139/355
#
#Lenovo-A820t_TD/S100 Linux/3.4.0 Android/4.1 Release/1.4.2013 Browser/AppleWebKit534.30 Mobile Safari/534.30
#Lenovo-A830/S100 Linux/3.4.0 Android/4.2 Release/01.23.2013 Browser/AppleWebKit534.30 Profile/ Configuration/ Mobile Safari/534.30
#Lenovo-A880/S100 Linux/3.4.5 Android/4.2 Release/08.07.2013 Browser/AppleWebKit 534.30 Profile/ Configuration;
#LG/KC910/V10a Browser/Obigo-Q7.1 MMS/LG-MMS-V1.0/1.2 MediaPlayer/LGPlayer/1.0 Java/ASVM/1.1 Profile/MIDP-2.1 Configuration/CLDC-1.1
#LG-KP500 Teleca/WAP2.0 MIDP-2.0/CLDC-1.1 UNTRUSTED/1.0
#LG-LG840G/V100[TF013293005745563000000017406413182] Obigo/Q7.3 Profile/MIDP-2.1 Configuration/CLDC-1.1
#
#MT6572_TD/V1 Linux/3.4.5 Android/4.2.2 Release/03.26.2013 Browser/AppleWebKit534.30 Mobile Safari/534.30 MBBMS/2.2;
#MT6572/V1 Linux/3.4.5 Android/4.2.2_OS Release/03.04.2014 Browser/AppleWebKit534.30 Profile/MIDP-2.0 Configuration/CLDC-1.1 Mobile Safari/534.30 Android 4.2.2_OS;
#
#OneBrowser/4.2.0/Adr(Linux; U; Android 2.3.5; nl-nl; GT-I9100 Build/GINGERBREAD) AppleWebKit/533.1 (KHTML, like Gecko) Mobile Safari/533.1
#
#SAMSUNG-GT-B7330/1.0 (compatible; MSIE 6.0; Windows CE; IEMobile 8.12; MSIEMobile 6.0)
#SAMSUNG-GT-C3312/1.0 NetFront/4.2 Profile/MIDP-2.0 Configuration/CLDC-1.1
#SAMSUNG-GT-S3850/S3850XEKC5 SHP/VPP/R5 Dolfin/2.0 NexPlayer/3.0 SMM-MMS/1.2.0 profile/MIDP-2.1 configuration/CLDC-1.1 OPN-B
#SAMSUNG-GT-S3850/S3850XXKC2 SHP/VPP/R5 Dolfin/2.0 NexPlayer/3.0 SMM-MMS/1.2.0 profile/MIDP-2.1 configuration/CLDC-1.1 OPN-B
#SAMSUNG-GT-S5260P/S5260PCEKJ1 SHP/VPP/R5 Dolfin/2.0 NexPlayer/3.0 SMM-MMS/1.2.0 profile/MIDP-2.1 configuration/CLDC-1.1 OPN-B
#SAMSUNG-GT-S5260/S5260XXKD1 SHP/VPP/R5 Dolfin/2.0 NexPlayer/3.0 SMM-MMS/1.2.0 profile/MIDP-2.1 configuration/CLDC-1.1 OPN-B
#SAMSUNG-S8000/S800MCEIK1 SHP/VPP/R5 Jasmine/1.0 Nextreaming SMM-MMS/1.2.0 profile/MIDP-2.1 configuration/CLDC-1.1 SS-Widget/S8000-FM
#SAMSUNG-SCH-M715/1.0 (compatible; MSIE 6.0; Windows CE; IEMobile 8.12; MSIEMobile 6.0)
#
#UCWEB/2.0(BlackBerry; U; 9.6.0.93; en-us; 9360/9.6.0.93) U2/1.0.0 UCBrowser/8.1.0.216 U2/1.0.0 Mobile
#UCWEB/2.0 (iOS; U; iPh OS 5_0_1; zh-CN; iPh4,1) U2/1.0.0 UCBrowser/9.5.1.408 U2/1.0.0 Mobile
#UCWEB/2.0 (Java; U; MIDP-2.0; en; Nokia500) U2/1.0.0 UCBrowser/9.5.0.449 U2/1.0.0 Mobile UNTRUSTED/1.0 3gpp-gba
#UCWEB/2.0 (Java; U; MIDP-2.0; en-US; Nokia501) U2/1.0.0 UCBrowser/9.5.0.449 U2/1.0.0 Mobile
#UCWEB/2.0 (Java; U; MIDP-2.0; en-US; Nokia501) U2/1.0.0 UCBrowser/9.5.0.449 U2/1.0.0 Mobile UNTRUSTED/1.0
#UCWEB/2.0 (Java; U; MIDP-2.0; en-US; Nokia6085) U2/1.0.0 UCBrowser/9.5.0.449 U2/1.0.0 Mobile
#UCWEB/2.0 (Java; U; MIDP-2.0; en-US; NokiaAsha500DualSIM) U2/1.0.0 UCBrowser/9.5.0.449 U2/1.0.0 Mobile
#UCWEB/2.0 (Java; U; MIDP-2.0; en-US; nokiac5-00.2) U2/1.0.0 UCBrowser/9.2.0.311 U2/1.0.0 Mobile 3gpp-gba
#UCWEB/2.0 (Java; U; MIDP-2.0; en-US; NokiaE63-1) U2/1.0.0 UCBrowser/9.4.1.377 U2/1.0.0 Mobile UNTRUSTED/1.0
#UCWEB/2.0 (Java; U; MIDP-2.0; en-US; SAMSUNG-GT-S3850) U2/1.0.0 UCBrowser/9.5.0.449 U2/1.0.0 Mobile UNTRUSTED/1.0
#
#UCWEB/2.0 (MIDP-2.0; U; Adr 4.4.4; en-US; SM-G530H) U2/1.0.0 UCBrowser/9.8.0.534 U2/1.0.0 Mobile
#UCWEB/2.0 (MIDP-2.0; U; Adr 4.4.4; en-US; XT1022) U2/1.0.0 UCBrowser/9.7.0.520 U2/1.0.0 Mobile
#UCWEB/2.0 (MIDP-2.0; U; Adr 4.4.4; v.smartads.com.ph; GT-I5500) U2/1.0.0 UCBrowser/9.8.0.534 U2/1.0.0 Mobile
#UCWEB/2.0 (Symbian; U; S60 V3; en-US; NOKIA6120c) U2/1.0.0 UCBrowser/9.2.0.336 U2/1.0.0 Mobile
#UCWEB/2.0 (Symbian; U; S60 V3; en-US; NokiaC5-00.2) U2/1.0.0 UCBrowser/9.2.0.336 U2/1.0.0 Mobile
#UCWEB/2.0 (Symbian; U; S60 V3; en-US; NOKIAE5-00) U2/1.0.0 UCBrowser/9.2.0.336 U2/1.0.0 Mobile
#UCWEB/2.0 (Symbian; U; S60 V3; en-US; NokiaE63) U2/1.0.0 UCBrowser/9.2.0.336 U2/1.0.0 Mobile
#
#UCWEB/2.0 (Symbian; U; S60 V5; es-LA; Nokia5233) U2/1.0.0 UCBrowser/9.2.0.336 U2/1.0.0 Mobile
#UCWEB/2.0 (Windows; U; wds 7.10; en-US; NOKIA; Lumia 610) U2/1.0.0 UCBrowser/3.2.0.340 U2/1.0.0 Mobile
#UCWEB/2.0 (Windows; U; wds 7.10; en-US; NOKIA; Lumia 710) U2/1.0.0 UCBrowser/3.2.0.340 U2/1.0.0 Mobile
#UCWEB/2.0 (Windows; U; wds 8.0; de-DE; HTC;  8S by HTC) U2/1.0.0 UCBrowser/4.2.0.524 U2/1.0.0 Mobile
#UCWEB/2.0 (Windows; U; wds 8.0; en-US; HTC;  8S by HTC) U2/1.0.0 UCBrowser/4.2.0.524 U2/1.0.0 Mobile
#UCWEB/2.0 (Windows; U; wds 8.0; en-US; HTC;  8X by HTC) U2/1.0.0 UCBrowser/4.2.1.541 U2/1.0.0 Mobile
#
#UCWEB/2.0 (Windows; U; wds 8.0; es-LA; NOKIA; RM-915_lta_lta_245) U2/1.0.0 UCBrowser/4.2.1.541 U2/1.0.0 Mobile
#UCWEB/2.0 (Windows; U; wds 8.0; pt-BR; NOKIA; RM-915_lta_brazil_211) U2/1.0.0 UCBrowser/4.1.0.504 U2/1.0.0 Mobile
#UCWEB/2.0 (Windows; U; wds 8.0; pt-BR; NOKIA; RM-915_lta_brazil_211) U2/1.0.0 UCBrowser/4.2.0.524 U2/1.0.0 Mobile
#UCWEB/2.0 (Windows; U; wds 8.10; en-IN; Microsoft; RM-1090_1001) U2/1.0.0 UCBrowser/4.2.1.541 U2/1.0.0 Mobile
#UCWEB/2.0 (Windows; U; wds 8.10; en-IN; NOKIA; RM-1040_1001) U2/1.0.0 UCBrowser/4.2.0.524 U2/1.0.0 Mobile
#UCWEB/2.0 (Windows; U; wds 8.10; en-IN; NOKIA; RM-914_im_india_269) U2/1.0.0 UCBrowser/4.2.1.541 U2/1.0.0 Mobile
#UCWEB/2.0 (Windows; U; wds 8.10; en-IN; NOKIA; RM-978_1046) U2/1.0.0 UCBrowser/4.2.1.541 U2/1.0.0 Mobile
#UCWEB/2.0 (Windows; U; wds 8.10; en-US; HUAWEI; HUAWEI W2-U00) U2/1.0.0 UCBrowser/4.2.0.524 U2/1.0.0 Mobile
#UCWEB/2.0 (Windows; U; wds 8.10; en-US; NOKIA; RM-1017_1056) U2/1.0.0 UCBrowser/4.2.1.541 U2/1.0.0 Mobile
#UCWEB/2.0 (Windows; U; wds 8.10; en-US; NOKIA; RM-1045_1063) U2/1.0.0 UCBrowser/4.2.0.524 U2/1.0.0 Mobile
#UCWEB/2.0 (Windows; U; wds 8.10; en-US; NOKIA; RM-1045_1063) U2/1.0.0 UCBrowser/4.2.1.541 U2/1.0.0 Mobile
#WebKit/3.9.4, (CE-HTML/1.0 NETTV/3.3.0 NewB) PHILIPS-AVM-2013/1.30 (Philips, BDP7750, wireless)
#WebKit/4.1.9, (CE-HTML/1.0 NETTV/3.3.0 NewB) PHILIPS-AVM-2013/1.16 (Philips, HTB5260G, wireless)
#WebKit/4.2.5, (CE-HTML/1.0 NETTV/3.3.0 NewB) PHILIPS-AVM-2013/1.35 (Philips, BDP5700, wireless)
#SAMSUNG-GT-S3333 Opera/9.80 (X11; Linux zvav; U; pt) Presto/2.12.423 Version/12.16
#SAMSUNG GT-S3570 Opera/9.80 (J2ME/MIDP; Opera Mini/6.5.30607/36.1609; U; nl) Presto/2.12.423 Version/12.16
#UCWEB/2.0 (Linux; U; Opera Mini/7.1.32052/30.3697; en-US; HTC_Desire_500) U2/1.0.0 UCBrowser/9.7.0.520 Mobile
#

#SSL Labs (https://www.ssllabs.com/about/assessment.html); on behalf of 85.17.131.202
#AlienBlue/2.9.10.0.2 CFNetwork/758.4.3 Darwin/15.6.0
#AlienBlue/2.9.5 CFNetwork/758.3.15 Darwin/15.4.0

- test:
    input:
      user_agent_string: 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1) ;  Embedded Web Browser from: http://bsalsa.com/)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : 'XP'
      OperatingSystemVersionMajor          : 'XP'
      OperatingSystemNameVersion           : 'Windows XP'
      OperatingSystemNameVersionMajor      : 'Windows XP'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Internet Explorer'
      LayoutEngineVersion                  : '6.0'
      LayoutEngineVersionMajor             : '6'
      LayoutEngineNameVersion              : 'Internet Explorer 6.0'
      LayoutEngineNameVersionMajor         : 'Internet Explorer 6'
      AgentClass                           : 'Browser'
      AgentName                            : 'Internet Explorer'
      AgentVersion                         : '6.0'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'Internet Explorer 6.0'
      AgentNameVersionMajor                : 'Internet Explorer 6'

- test:
    input:
      user_agent_string: 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; BTRS31753; Mozilla/4.0(Compatible EmbeddedWB 14.52 from: http://www.bsalsa.com/EmbeddedWB- 14.57  from: http://bsalsa.com/ ; .NET CLR 2.0.50727; OfficeLiveConnector.1.3; OfficeLivePatch.0.0; AskTbGOM2/5.11.3.15590; Windows Live Messenger 14.0.8117.0416)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : 'XP'
      OperatingSystemVersionMajor          : 'XP'
      OperatingSystemNameVersion           : 'Windows XP'
      OperatingSystemNameVersionMajor      : 'Windows XP'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Delphi EmbeddedWB'
      LayoutEngineVersion                  : '14.52'
      LayoutEngineVersionMajor             : '14'
      LayoutEngineNameVersion              : 'Delphi EmbeddedWB 14.52'
      LayoutEngineNameVersionMajor         : 'Delphi EmbeddedWB 14'
      AgentClass                           : 'Browser'
      AgentName                            : 'Internet Explorer'
      AgentVersion                         : '7.0'
      AgentVersionMajor                    : '7'
      AgentNameVersion                     : 'Internet Explorer 7.0'
      AgentNameVersionMajor                : 'Internet Explorer 7'

# Communicators
- matcher:
    extract:
    - 'WebviewAppName                      :      150 :agent.(1)product.name="Kik"'
    - 'WebviewAppVersion                   :      150 :agent.(1)product.(1)version'

- test:
    input:
      user_agent_string: 'Kik/9.4.0.4292 (Android 5.0.2) Mozilla/5.0 (Linux; Android 5.0.2; SM-G850F Build/LRX22G; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/47.0.2526.100 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung SM-G850F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '5.0.2'
      OperatingSystemVersionMajor          : '5'
      OperatingSystemNameVersion           : 'Android 5.0.2'
      OperatingSystemNameVersionMajor      : 'Android 5'
      OperatingSystemVersionBuild          : 'LRX22G'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '47.0'
      LayoutEngineVersionMajor             : '47'
      LayoutEngineNameVersion              : 'Blink 47.0'
      LayoutEngineNameVersionMajor         : 'Blink 47'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '47.0.2526.100'
      AgentVersionMajor                    : '47'
      AgentNameVersion                     : 'Chrome Webview 47.0.2526.100'
      AgentNameVersionMajor                : 'Chrome Webview 47'
      WebviewAppName                       : 'Kik'
      WebviewAppVersion                    : '9.4.0.4292'
      WebviewAppVersionMajor               : '9'
      WebviewAppNameVersion                : 'Kik 9.4.0.4292'
      WebviewAppNameVersionMajor           : 'Kik 9'

- matcher:
    require:
    - 'agent.(1)product.name="OC"'
    extract:
    - 'DeviceClass                         :      100 : "Desktop"'
    - 'DeviceName                          :      100 : "Desktop"'
    - 'DeviceBrand                         :      100 : "<<<null>>>"'
    - 'OperatingSystemClass                :      100 : "Desktop"'
    - 'OperatingSystemName                 :      100 : "Windows NT"'
    - 'OperatingSystemVersion              :      100 : "<<<null>>>"'
    - 'AgentClass                          :      100 : "Special"'
    - 'AgentName                           :      100 : "Microsoft Lync (Skype)"'
    - 'AgentVersion                        :      100 : agent.(1)product.(1)version'

- test:
    input:
      user_agent_string: 'OC/15.0.4711.1002 (Skype for Business)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Windows NT ??'
      OperatingSystemNameVersionMajor      : 'Windows NT ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'Microsoft Lync (Skype)'
      AgentVersion                         : '15.0.4711.1002'
      AgentVersionMajor                    : '15'
      AgentNameVersion                     : 'Microsoft Lync (Skype) 15.0.4711.1002'
      AgentNameVersionMajor                : 'Microsoft Lync (Skype) 15'

- matcher:
    require:
    - 'agent.(1)product.name="MC"'
    - 'agent.(1)product.(1)comments.(1)entry.(1)product.name="Microsoft Lync for Mac"'
    extract:
    - 'DeviceClass                         :      100 :"Desktop"'
    - 'DeviceName                          :      100 :"Macintosh"'
    - 'DeviceBrand                         :      100 :"Apple"'
    - 'DeviceCpu                           :      100 :"Intel"'
    - 'OperatingSystemClass                :      100 :"Desktop"'
    - 'OperatingSystemName                 :      100 :"Mac OS X"'
    - 'OperatingSystemVersion              :      100 :"10.??"'
    - 'AgentClass                          :      100 : "Special"'
    - 'AgentName                           :      100 : "Microsoft Lync (Skype)"'
    - 'AgentVersion                        :      100 : agent.(1)product.(1)version'

- test:
    input:
      user_agent_string: 'MC/14.0.0321.8 (Microsoft Lync for Mac 2011)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Apple Macintosh'
      DeviceBrand                          : 'Apple'
      DeviceCpu                            : 'Intel'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Mac OS X'
      OperatingSystemVersion               : '10.??'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Mac OS X 10.??'
      OperatingSystemNameVersionMajor      : 'Mac OS X 10'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'Microsoft Lync (Skype)'
      AgentVersion                         : '14.0.0321.8'
      AgentVersionMajor                    : '14'
      AgentNameVersion                     : 'Microsoft Lync (Skype) 14.0.0321.8'
      AgentNameVersionMajor                : 'Microsoft Lync (Skype) 14'

- test:
    input:
      user_agent_string: 'Tor Browser/8.12 (Ubuntu 3.9; nl_BE;)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '3.9'
      OperatingSystemVersionMajor          : '3'
      OperatingSystemNameVersion           : 'Ubuntu 3.9'
      OperatingSystemNameVersionMajor      : 'Ubuntu 3'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'Tor Browser'
      AgentVersion                         : '8.12'
      AgentVersionMajor                    : '8'
      AgentNameVersion                     : 'Tor Browser 8.12'
      AgentNameVersionMajor                : 'Tor Browser 8'
      AgentLanguage                        : 'Dutch (Belgium)'
      AgentLanguageCode                    : 'nl-be'


# Current Tor Browser (i.e. undetectable)
- test:
    input:
      user_agent_string: "Mozilla/5.0 (Android 6.0; Mobile; rv:68.0) Gecko/20100101 Firefox/68.0"
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Android Mobile'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '6.0'
      OperatingSystemVersionMajor          : '6'
      OperatingSystemNameVersion           : 'Android 6.0'
      OperatingSystemNameVersionMajor      : 'Android 6'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '68.0'
      LayoutEngineVersionMajor             : '68'
      LayoutEngineNameVersion              : 'Gecko 68.0'
      LayoutEngineNameVersionMajor         : 'Gecko 68'
      LayoutEngineBuild                    : '20100101'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '68.0'
      AgentVersionMajor                    : '68'
      AgentNameVersion                     : 'Firefox 68.0'
      AgentNameVersionMajor                : 'Firefox 68'

- test:
    input:
      user_agent_string: 'Iframely/0.8.5 (+http://iframely.com/;)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Iframely Robot'
      DeviceBrand                          : 'Iframely'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'Iframely'
      AgentVersion                         : '0.8.5'
      AgentVersionMajor                    : '0'
      AgentNameVersion                     : 'Iframely 0.8.5'
      AgentNameVersionMajor                : 'Iframely 0'
      AgentInformationUrl                  : 'http://iframely.com/'

# The demonstration case in the web servlet
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 7.8.9; nl-nl ; Niels Ultimate 42 demo phone Build/42 ; nl-nl; https://yauaa.basjes.nl ) AppleWebKit/8.4.7.2 (KHTML, like Gecko) Yet another browser/3.1415926 Mobile Safari/6.6.6'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Niels Ultimate 42 Demo Phone'
      DeviceBrand                          : 'Niels'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.8.9'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Android 7.8.9'
      OperatingSystemNameVersionMajor      : 'Android 7'
      OperatingSystemVersionBuild          : '42'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '8.4.7.2'
      LayoutEngineVersionMajor             : '8'
      LayoutEngineNameVersion              : 'AppleWebKit 8.4.7.2'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 8'
      AgentClass                           : 'Browser'
      AgentName                            : 'Yet another browser'
      AgentVersion                         : '3.1415926'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Yet another browser 3.1415926'
      AgentNameVersionMajor                : 'Yet another browser 3'
      AgentLanguage                        : 'Dutch (Netherlands)'
      AgentLanguageCode                    : 'nl-nl'
      AgentInformationUrl                  : 'https://yauaa.basjes.nl'


# =======================================================================================
# https://justworks.ca/blog/ios-and
# Exchange ActiveSync iOS and Android User Agent Strings

- matcher:
    require:
    - 'agent.(1)product.name[1-1]="Apple"'
    - 'IsNull[agent.(2)product]'
    - 'IsNull[agent.(2)text]'
    extract:
    - 'DeviceClass                         :      202 :LookUp[AppleDeviceClass;agent.(1)product.name[2-2]]'
    - 'DeviceBrand                         :      202 :"Apple"'
    - 'DeviceName                          :      202 :LookUp[AppleDeviceName;agent.(1)product.name[2-2]]'
    - 'DeviceVersion                       :      202 :LookUp[AppleDeviceVersion;agent.(1)product.name[2-2]]'
    - 'OperatingSystemClass                :       20 :"Mobile"'
    - 'OperatingSystemName                 :       20 :"iOS"'
    - 'OperatingSystemVersion              :       20 :"<<<null>>>"'
    - 'AgentClass                          :       56 :"Special"'
    - 'AgentName                           :       56 :"Exchange ActiveSync"'
    - 'AgentVersion                        :       56 :agent.(1)product.(1)version'

- matcher:
    require:
    - 'agent.(1)product.name[1]="Samsung"'
    - 'agent.(1)product.name[2]!="agent"'
    - 'IsNull[agent.(2)product]'
    - 'IsNull[agent.(2)text]'
    extract:
    - 'DeviceClass                         :      202 :"Mobile"'
    - 'DeviceBrand                         :      202 :"Samsung"'
    - 'DeviceName                          :      202 :agent.(1)product.name[2-]'
    - 'DeviceVersion                       :      202 :"<<<null>>>"'
    - 'OperatingSystemClass                :       20 :"Mobile"'
    - 'OperatingSystemName                 :       20 :"Android"'
    - 'OperatingSystemVersion              :       20 :"<<<null>>>"'
    - 'AgentClass                          :       56 :"Special"'
    - 'AgentName                           :       56 :"Exchange ActiveSync"'
    - 'AgentVersion                        :       56 :agent.(1)product.(1)version'

- test:
    input:
      user_agent_string: 'Apple-iPad2C2/1305.238'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Apple iPad'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPad 2 (GSM)'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'iOS ??'
      OperatingSystemNameVersionMajor      : 'iOS ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'Exchange ActiveSync'
      AgentVersion                         : '1305.238'
      AgentVersionMajor                    : '1305'
      AgentNameVersion                     : 'Exchange ActiveSync 1305.238'
      AgentNameVersionMajor                : 'Exchange ActiveSync 1305'

- test:
    input:
      user_agent_string: 'Apple-iPhone3C1/1104.257'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone 4 (GSM)'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'iOS ??'
      OperatingSystemNameVersionMajor      : 'iOS ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'Exchange ActiveSync'
      AgentVersion                         : '1104.257'
      AgentVersionMajor                    : '1104'
      AgentNameVersion                     : 'Exchange ActiveSync 1104.257'
      AgentNameVersionMajor                : 'Exchange ActiveSync 1104'

- test:
    input:
      user_agent_string: 'Apple-iPhone/705.18'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'iOS ??'
      OperatingSystemNameVersionMajor      : 'iOS ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'Exchange ActiveSync'
      AgentVersion                         : '705.18'
      AgentVersionMajor                    : '705'
      AgentNameVersion                     : 'Exchange ActiveSync 705.18'
      AgentNameVersionMajor                : 'Exchange ActiveSync 705'


- test:
    input:
      user_agent_string: 'Apple-iPod4C1/1002.500'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPod Touch'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPod touch (4th gen)'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'iOS ??'
      OperatingSystemNameVersionMajor      : 'iOS ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'Exchange ActiveSync'
      AgentVersion                         : '1002.500'
      AgentVersionMajor                    : '1002'
      AgentNameVersion                     : 'Exchange ActiveSync 1002.500'
      AgentNameVersionMajor                : 'Exchange ActiveSync 1002'

- test:
    input:
      user_agent_string: 'SAMSUNG-SGH-I337M/101.403'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Samsung SGH-I337M'
      DeviceBrand                          : 'Samsung'
      DeviceVersion                        : '??'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Android ??'
      OperatingSystemNameVersionMajor      : 'Android ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'Exchange ActiveSync'
      AgentVersion                         : '101.403'
      AgentVersionMajor                    : '101'
      AgentNameVersion                     : 'Exchange ActiveSync 101.403'
      AgentNameVersionMajor                : 'Exchange ActiveSync 101'

# ----------------------------------------------------------------------------------
# DuckDuckGo
- matcher:
    extract:
    - '__Set_ALL_Fields__                  :       11 :"<<<null>>>"'
    - 'DeviceClass                         :       12 :"Mobile"'
    - 'DeviceBrand                         :       12 :"<<<null>>>"'
    - 'DeviceName                          :       12 :"<<<null>>>"'
    - 'OperatingSystemClass                :       12 :"Mobile"'
    - 'OperatingSystemName                 :       12 :"Android"'
    - 'OperatingSystemVersion              :       12 :"<<<null>>>"'
    - 'LayoutEngineClass                   :       12 :"<<<null>>>"'
    - 'LayoutEngineName                    :       12 :"<<<null>>>"'
    - 'LayoutEngineVersion                 :       12 :"<<<null>>>"'
    - 'AgentClass                          :       20 :"Browser"'
    - 'AgentName                           :       20 :"DuckDuckGo"'
    - 'AgentVersion                        :       20 :agent.text[1-2]="DDG-Android"@[3-]'

- matcher:
    extract:
    - '__Set_ALL_Fields__                  :       11 :"<<<null>>>"'
    - 'DeviceClass                         :       12 :"Mobile"'
    - 'DeviceBrand                         :       12 :"<<<null>>>"'
    - 'DeviceName                          :       12 :"<<<null>>>"'
    - 'OperatingSystemClass                :       12 :"Mobile"'
    - 'OperatingSystemName                 :       12 :"Android"'
    - 'OperatingSystemVersion              :       12 :"<<<null>>>"'
    - 'LayoutEngineClass                   :       12 :"<<<null>>>"'
    - 'LayoutEngineName                    :       12 :"<<<null>>>"'
    - 'LayoutEngineVersion                 :       12 :"<<<null>>>"'
    - 'AgentClass                          :       20 :"Browser"'
    - 'AgentName                           :       20 :"DuckDuckGo"'
    - 'AgentVersion                        :       20 :agent.product.name="DDG-Android"^.version'

- test:
    input:
      user_agent_string: 'DDG-Android-3.0.14'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Android ??'
      OperatingSystemNameVersionMajor      : 'Android ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Browser'
      AgentName                            : 'DuckDuckGo'
      AgentVersion                         : '3.0.14'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'DuckDuckGo 3.0.14'
      AgentNameVersionMajor                : 'DuckDuckGo 3'

- test:
    input:
      user_agent_string: 'DDG-Android-%version'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Android ??'
      OperatingSystemNameVersionMajor      : 'Android ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Browser'
      AgentName                            : 'DuckDuckGo'
      AgentVersion                         : '%version'
      AgentVersionMajor                    : '%version'
      AgentNameVersion                     : 'DuckDuckGo %version'
      AgentNameVersionMajor                : 'DuckDuckGo %version'


- matcher:
    extract:
    - 'DeviceClass                         :       11 :"Mobile"'
    - 'DeviceBrand                         :       11 :"<<<null>>>"'
    - 'DeviceName                          :       11 :"<<<null>>>"'
    - 'OperatingSystemClass                :       11 :"Mobile"'
    - 'OperatingSystemName                 :       11 :"iOS"'
    - 'OperatingSystemVersion              :       11 :"<<<null>>>"'
    - 'LayoutEngineClass                   :       11 :"<<<null>>>"'
    - 'LayoutEngineName                    :       11 :"<<<null>>>"'
    - 'LayoutEngineVersion                 :       11 :"<<<null>>>"'
    - 'AgentClass                          :       20 :"Browser"'
    - 'AgentName                           :       20 :"DuckDuckGo"'
    - 'AgentVersion                        :       20 :agent.text[1-2]="DDG-iOS"@[3-]'

# DuckDuckGo for iOS Version 6.0.6 (784)
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 9_3_5 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13G36; DDG-iOS-784'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '13G36'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '9.3.5'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'iOS 9.3.5'
      OperatingSystemNameVersionMajor      : 'iOS 9'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '601.1.46'
      LayoutEngineVersionMajor             : '601'
      LayoutEngineNameVersion              : 'AppleWebKit 601.1.46'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 601'
      AgentClass                           : 'Browser'
      AgentName                            : 'DuckDuckGo'
      AgentVersion                         : '784'
      AgentVersionMajor                    : '784'
      AgentNameVersion                     : 'DuckDuckGo 784'
      AgentNameVersionMajor                : 'DuckDuckGo 784'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 9) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/74.0.3729.136 Mobile Safari/537.36 DuckDuckGo/5'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Android Mobile'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '9'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'Android 9'
      OperatingSystemNameVersionMajor      : 'Android 9'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '74.0'
      LayoutEngineVersionMajor             : '74'
      LayoutEngineNameVersion              : 'Blink 74.0'
      LayoutEngineNameVersionMajor         : 'Blink 74'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '74.0.3729.136'
      AgentVersionMajor                    : '74'
      AgentNameVersion                     : 'Chrome Webview 74.0.3729.136'
      AgentNameVersionMajor                : 'Chrome Webview 74'
      WebviewAppName                       : 'DuckDuckGo'
      WebviewAppVersion                    : '5'
      WebviewAppVersionMajor               : '5'
      WebviewAppNameVersion                : 'DuckDuckGo 5'
      WebviewAppNameVersionMajor           : 'DuckDuckGo 5'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 9) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/79.0.3945.116 Mobile DuckDuckGo/5 Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Android Mobile'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '9'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'Android 9'
      OperatingSystemNameVersionMajor      : 'Android 9'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '79.0'
      LayoutEngineVersionMajor             : '79'
      LayoutEngineNameVersion              : 'Blink 79.0'
      LayoutEngineNameVersionMajor         : 'Blink 79'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '79.0.3945.116'
      AgentVersionMajor                    : '79'
      AgentNameVersion                     : 'Chrome Webview 79.0.3945.116'
      AgentNameVersionMajor                : 'Chrome Webview 79'
      WebviewAppName                       : 'DuckDuckGo'
      WebviewAppVersion                    : '5'
      WebviewAppVersionMajor               : '5'
      WebviewAppNameVersion                : 'DuckDuckGo 5'
      WebviewAppNameVersionMajor           : 'DuckDuckGo 5'




# Coc Coc Browser (focuses on the Vietnamese market):  https://en.wikipedia.org/wiki/C%E1%BB%91c_C%E1%BB%91c
- matcher:
    extract:
    - 'AgentClass                          :     2050 :"Browser"'
    - 'AgentName                           :     2050 :"Coc Coc Browser"'
    - 'AgentVersion                        :     2050 :agent.product.name="coc_coc_browser"^.version'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) coc_coc_browser/64.4.126 Chrome/58.4.3029.126 Safari/537.36'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '8.1'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Windows 8.1'
      OperatingSystemNameVersionMajor      : 'Windows 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '58.4'
      LayoutEngineVersionMajor             : '58'
      LayoutEngineNameVersion              : 'Blink 58.4'
      LayoutEngineNameVersionMajor         : 'Blink 58'
      AgentClass                           : 'Browser'
      AgentName                            : 'Coc Coc Browser'
      AgentVersion                         : '64.4.126'
      AgentVersionMajor                    : '64'
      AgentNameVersion                     : 'Coc Coc Browser 64.4.126'
      AgentNameVersionMajor                : 'Coc Coc Browser 64'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 6.0.1; SM-G610F Build/MMB29K) AppleWebKit/537.36 (KHTML, like Gecko) coc_coc_browser/64.4.128 Mobile Chrome/58.4.3029.128 Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung SM-G610F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '6.0.1'
      OperatingSystemVersionMajor          : '6'
      OperatingSystemNameVersion           : 'Android 6.0.1'
      OperatingSystemNameVersionMajor      : 'Android 6'
      OperatingSystemVersionBuild          : 'MMB29K'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '58.4'
      LayoutEngineVersionMajor             : '58'
      LayoutEngineNameVersion              : 'Blink 58.4'
      LayoutEngineNameVersionMajor         : 'Blink 58'
      AgentClass                           : 'Browser'
      AgentName                            : 'Coc Coc Browser'
      AgentVersion                         : '64.4.128'
      AgentVersionMajor                    : '64'
      AgentNameVersion                     : 'Coc Coc Browser 64.4.128'
      AgentNameVersionMajor                : 'Coc Coc Browser 64'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 10_3_2 like Mac OS X) AppleWebKit/602.1.50 (KHTML, like Gecko) coc_coc_browser/64.4.130 CriOS/58.4.3029.130 Mobile/14F89 Safari/602.1'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '14F89'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '10.3.2'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'iOS 10.3.2'
      OperatingSystemNameVersionMajor      : 'iOS 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '602.1.50'
      LayoutEngineVersionMajor             : '602'
      LayoutEngineNameVersion              : 'AppleWebKit 602.1.50'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 602'
      AgentClass                           : 'Browser'
      AgentName                            : 'Coc Coc Browser'
      AgentVersion                         : '64.4.130'
      AgentVersionMajor                    : '64'
      AgentNameVersion                     : 'Coc Coc Browser 64.4.130'
      AgentNameVersionMajor                : 'Coc Coc Browser 64'


- matcher:
    variable:
    - 'IBrowseVersion                      :agent.(1)product.(1)comments.entry.(1)product.name="IBrowse"^.version'
    extract:
    - 'DeviceClass                         :      100 :"Desktop"'
    - 'DeviceBrand                         :      100 :"Amiga"'
    - 'DeviceName                          :      100 :"Amiga"'
    - 'OperatingSystemClass                :      100 :"Desktop"'
    - 'OperatingSystemName                 :      100 :"AmigaOS"'
    - 'OperatingSystemVersion              :        1 :"<<<null>>>"'
    - 'LayoutEngineClass                   :      100 :"Browser"'
    - 'LayoutEngineName                    :      100 :"IBrowse"'
    - 'LayoutEngineVersion                 :      100 :@IBrowseVersion'
    - 'AgentClass                          :      100 :"Browser"'
    - 'AgentName                           :      100 :"IBrowse"'
    - 'AgentVersion                        :      100 :@IBrowseVersion'


- matcher:
    require:
    - 'agent.(1)product.(1)comments.entry.(1-2)text="AmigaOS4.0"'
    extract:
    - 'DeviceClass                         :      100 :"Desktop"'
    - 'DeviceBrand                         :      100 :"Amiga"'
    - 'DeviceName                          :      100 :"Amiga"'
    - 'OperatingSystemClass                :      100 :"Desktop"'
    - 'OperatingSystemName                 :      100 :"AmigaOS"'
    - 'OperatingSystemVersion              :      100 :"4.0"'


# IBrowse: https://www.ibrowse-dev.net/
# Quote: IBrowse is a fast, stable, classic web browser helping you surf the net with your AMIGA.
- test:
    input:
      user_agent_string: 'Mozilla/4.0 (compatible; IBrowse 2.3; AmigaOS4.0)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Amiga'
      DeviceBrand                          : 'Amiga'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'AmigaOS'
      OperatingSystemVersion               : '4.0'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'AmigaOS 4.0'
      OperatingSystemNameVersionMajor      : 'AmigaOS 4'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'IBrowse'
      LayoutEngineVersion                  : '2.3'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'IBrowse 2.3'
      LayoutEngineNameVersionMajor         : 'IBrowse 2'
      AgentClass                           : 'Browser'
      AgentName                            : 'IBrowse'
      AgentVersion                         : '2.3'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'IBrowse 2.3'
      AgentNameVersionMajor                : 'IBrowse 2'

- test:
    input:
      user_agent_string: 'Amiga-AWeb/3.4.167SE'
    expected:
      DeviceClass                          : 'Unknown'
      DeviceName                           : 'Unknown' #FIXME: Amiga ?
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Unknown'
      OperatingSystemName                  : 'Unknown'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Unknown ??'
      OperatingSystemNameVersionMajor      : 'Unknown ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Special'
      AgentName                            : 'Amiga-AWeb'
      AgentVersion                         : '3.4.167SE'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Amiga-AWeb 3.4.167SE'
      AgentNameVersionMajor                : 'Amiga-AWeb 3'

# https://en.wikipedia.org/wiki/MorphOS
- test:
    input:
      user_agent_string: 'AmigaVoyager/3.4.4 (MorphOS/PPC native)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'MorphOs Desktop' # MorphOS runs on several kinds of devices.
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'PowerPC'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'MorphOS'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'MorphOS ??'
      OperatingSystemNameVersionMajor      : 'MorphOS ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Special'
      AgentName                            : 'AmigaVoyager'
      AgentVersion                         : '3.4.4'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'AmigaVoyager 3.4.4'
      AgentNameVersionMajor                : 'AmigaVoyager 3'




# NetSurf 3.2 (26th August 2014) on Ubuntu 16.4
- test:
    input:
      user_agent_string: 'NetSurf/3.2 (Linux)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Linux ??'
      OperatingSystemNameVersionMajor      : 'Linux ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'NetSurf'
      AgentVersion                         : '3.2'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'NetSurf 3.2'
      AgentNameVersionMajor                : 'NetSurf 3'

# Falkon (https://www.falkon.org/about/ : Falkon is a KDE web browser using QtWebEngine rendering engine, previously known as QupZilla.)
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Falkon/3.0.0 Chrome/56.0.2924.122 Safari/537.36'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Linux ??'
      OperatingSystemNameVersionMajor      : 'Linux ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '56.0'
      LayoutEngineVersionMajor             : '56'
      LayoutEngineNameVersion              : 'Blink 56.0'
      LayoutEngineNameVersionMajor         : 'Blink 56'
      AgentClass                           : 'Browser'
      AgentName                            : 'Falkon'
      AgentVersion                         : '3.0.0'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Falkon 3.0.0'
      AgentNameVersionMajor                : 'Falkon 3'


# QupZilla (https://qupzilla.com/ -- > Now Falkon)

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; Windows NT 6.1; U; WOW64; IA64; en) QupZilla/1.6.6'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel Itanium 64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '5.0'
      LayoutEngineVersionMajor             : '5'
      LayoutEngineNameVersion              : 'Mozilla 5.0'
      LayoutEngineNameVersionMajor         : 'Mozilla 5'
      AgentClass                           : 'Browser'
      AgentName                            : 'QupZilla'
      AgentVersion                         : '1.6.6'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'QupZilla 1.6.6'
      AgentNameVersionMajor                : 'QupZilla 1'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux) AppleWebKit/538.1 (KHTML, like Gecko) QupZilla/1.8.9 Safari/538.1'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Linux ??'
      OperatingSystemNameVersionMajor      : 'Linux ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '538.1'
      LayoutEngineVersionMajor             : '538'
      LayoutEngineNameVersion              : 'AppleWebKit 538.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 538'
      AgentClass                           : 'Browser'
      AgentName                            : 'QupZilla'
      AgentVersion                         : '1.8.9'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'QupZilla 1.8.9'
      AgentNameVersionMajor                : 'QupZilla 1'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Macintosh; Intel Mac OS X) AppleWebKit/538.1 (KHTML, like Gecko) QupZilla/1.8.2 Safari/538.1'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Apple Macintosh'
      DeviceBrand                          : 'Apple'
      DeviceCpu                            : 'Intel'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Mac OS X'
      OperatingSystemVersion               : '10.?'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Mac OS X 10.?'
      OperatingSystemNameVersionMajor      : 'Mac OS X 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '538.1'
      LayoutEngineVersionMajor             : '538'
      LayoutEngineNameVersion              : 'AppleWebKit 538.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 538'
      AgentClass                           : 'Browser'
      AgentName                            : 'QupZilla'
      AgentVersion                         : '1.8.2'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'QupZilla 1.8.2'
      AgentNameVersionMajor                : 'QupZilla 1'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (N; Windows NT 5.1) AppleWebKit/534.34 (KHTML, like Gecko) QupZilla/1.6.6 Safari/534.34'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : 'XP'
      OperatingSystemVersionMajor          : 'XP'
      OperatingSystemNameVersion           : 'Windows XP'
      OperatingSystemNameVersionMajor      : 'Windows XP'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '534.34'
      LayoutEngineVersionMajor             : '534'
      LayoutEngineNameVersion              : 'AppleWebKit 534.34'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 534'
      AgentClass                           : 'Browser'
      AgentName                            : 'QupZilla'
      AgentVersion                         : '1.6.6'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'QupZilla 1.6.6'
      AgentNameVersionMajor                : 'QupZilla 1'
      AgentSecurity                        : 'No security'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (UNIX BSD/SYSV system) AppleWebKit/538.1 (KHTML, like Gecko) QupZilla/1.7.0 Safari/538.1'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Unix BSD/Sysv Desktop'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'UNIX BSD/SYSV'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'UNIX BSD/SYSV ??'
      OperatingSystemNameVersionMajor      : 'UNIX BSD/SYSV ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '538.1'
      LayoutEngineVersionMajor             : '538'
      LayoutEngineNameVersion              : 'AppleWebKit 538.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 538'
      AgentClass                           : 'Browser'
      AgentName                            : 'QupZilla'
      AgentVersion                         : '1.7.0'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'QupZilla 1.7.0'
      AgentNameVersionMajor                : 'QupZilla 1'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Unknown; UNIX BSD/SYSV system) AppleWebKit/534.34 (KHTML, like Gecko) QupZilla/1.8.6 Safari/534.34'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Unix BSD/Sysv Desktop'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'UNIX BSD/SYSV'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'UNIX BSD/SYSV ??'
      OperatingSystemNameVersionMajor      : 'UNIX BSD/SYSV ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '534.34'
      LayoutEngineVersionMajor             : '534'
      LayoutEngineNameVersion              : 'AppleWebKit 534.34'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 534'
      AgentClass                           : 'Browser'
      AgentName                            : 'QupZilla'
      AgentVersion                         : '1.8.6'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'QupZilla 1.8.6'
      AgentNameVersionMajor                : 'QupZilla 1'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Unknown; UNIX BSD/SYSV system) AppleWebKit/538.1 (KHTML, like Gecko) QupZilla/1.8.9 Version/7.0 Safari/538.1'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Unix BSD/Sysv Desktop'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'UNIX BSD/SYSV'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'UNIX BSD/SYSV ??'
      OperatingSystemNameVersionMajor      : 'UNIX BSD/SYSV ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '538.1'
      LayoutEngineVersionMajor             : '538'
      LayoutEngineNameVersion              : 'AppleWebKit 538.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 538'
      AgentClass                           : 'Browser'
      AgentName                            : 'QupZilla'
      AgentVersion                         : '1.8.9'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'QupZilla 1.8.9'
      AgentNameVersionMajor                : 'QupZilla 1'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 6.1) AppleWebKit/538.1 (KHTML, like Gecko) QupZilla/1.8.9 Safari/538.1'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '538.1'
      LayoutEngineVersionMajor             : '538'
      LayoutEngineNameVersion              : 'AppleWebKit 538.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 538'
      AgentClass                           : 'Browser'
      AgentName                            : 'QupZilla'
      AgentVersion                         : '1.8.9'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'QupZilla 1.8.9'
      AgentNameVersionMajor                : 'QupZilla 1'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.21 (KHTML, like Gecko) QupZilla/1.8.6 Safari/537.21'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.21'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.21'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'QupZilla'
      AgentVersion                         : '1.8.6'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'QupZilla 1.8.6'
      AgentNameVersionMajor                : 'QupZilla 1'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) QupZilla/2.1.2 Chrome/53.0.2785.148 Safari/537.36'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '53.0'
      LayoutEngineVersionMajor             : '53'
      LayoutEngineNameVersion              : 'Blink 53.0'
      LayoutEngineNameVersionMajor         : 'Blink 53'
      AgentClass                           : 'Browser'
      AgentName                            : 'QupZilla'
      AgentVersion                         : '2.1.2'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'QupZilla 2.1.2'
      AgentNameVersionMajor                : 'QupZilla 2'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT) AppleWebKit/538.1 (KHTML, like Gecko) QupZilla/1.8.9 Safari/538.1'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Windows NT ??'
      OperatingSystemNameVersionMajor      : 'Windows NT ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '538.1'
      LayoutEngineVersionMajor             : '538'
      LayoutEngineNameVersion              : 'AppleWebKit 538.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 538'
      AgentClass                           : 'Browser'
      AgentName                            : 'QupZilla'
      AgentVersion                         : '1.8.9'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'QupZilla 1.8.9'
      AgentNameVersionMajor                : 'QupZilla 1'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11) AppleWebKit/538.1 (KHTML, like Gecko) QupZilla/1.8.3 Safari/538.1'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Linux ??'
      OperatingSystemNameVersionMajor      : 'Linux ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '538.1'
      LayoutEngineVersionMajor             : '538'
      LayoutEngineNameVersion              : 'AppleWebKit 538.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 538'
      AgentClass                           : 'Browser'
      AgentName                            : 'QupZilla'
      AgentVersion                         : '1.8.3'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'QupZilla 1.8.3'
      AgentNameVersionMajor                : 'QupZilla 1'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; FreeBSD amd64) AppleWebKit/537.36 (KHTML, like Gecko) QupZilla/2.1.2 Chrome/49.0.2623.111 Safari/537.36'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'FreeBsd Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'AMD64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'FreeBSD'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'FreeBSD ??'
      OperatingSystemNameVersionMajor      : 'FreeBSD ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '49.0'
      LayoutEngineVersionMajor             : '49'
      LayoutEngineNameVersion              : 'Blink 49.0'
      LayoutEngineNameVersionMajor         : 'Blink 49'
      AgentClass                           : 'Browser'
      AgentName                            : 'QupZilla'
      AgentVersion                         : '2.1.2'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'QupZilla 2.1.2'
      AgentNameVersionMajor                : 'QupZilla 2'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; FreeBSD) AppleWebKit/538.1 (KHTML, like Gecko) QupZilla/1.8.9 Safari/538.1'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'FreeBsd Desktop'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'FreeBSD'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'FreeBSD ??'
      OperatingSystemNameVersionMajor      : 'FreeBSD ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '538.1'
      LayoutEngineVersionMajor             : '538'
      LayoutEngineNameVersion              : 'AppleWebKit 538.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 538'
      AgentClass                           : 'Browser'
      AgentName                            : 'QupZilla'
      AgentVersion                         : '1.8.9'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'QupZilla 1.8.9'
      AgentNameVersionMajor                : 'QupZilla 1'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux) AppleWebKit/538.1 (KHTML, like Gecko) QupZilla/1.8.9 Safari/538.1'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Linux ??'
      OperatingSystemNameVersionMajor      : 'Linux ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '538.1'
      LayoutEngineVersionMajor             : '538'
      LayoutEngineNameVersion              : 'AppleWebKit 538.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 538'
      AgentClass                           : 'Browser'
      AgentName                            : 'QupZilla'
      AgentVersion                         : '1.8.9'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'QupZilla 1.8.9'
      AgentNameVersionMajor                : 'QupZilla 1'

- matcher:
    extract:
    - 'AgentClass                          :     2011 :"Browser"'
    - 'AgentName                           :     2011 :"QupZilla"'
    - 'AgentVersion                        :     2011 :agent.product.name="QupZilla"^.version'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux i686) AppleWebKit/538.1 (KHTML, like Gecko) QupZilla/1.8.9 Version/7.0 Safari/538.1'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Linux ??'
      OperatingSystemNameVersionMajor      : 'Linux ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '538.1'
      LayoutEngineVersionMajor             : '538'
      LayoutEngineNameVersion              : 'AppleWebKit 538.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 538'
      AgentClass                           : 'Browser'
      AgentName                            : 'QupZilla'
      AgentVersion                         : '1.8.9'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'QupZilla 1.8.9'
      AgentNameVersionMajor                : 'QupZilla 1'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux i686) AppleWebKit/538.1 (KHTML, like Gecko) QupZilla/1.9.0 Safari/538.1'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Linux ??'
      OperatingSystemNameVersionMajor      : 'Linux ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '538.1'
      LayoutEngineVersionMajor             : '538'
      LayoutEngineNameVersion              : 'AppleWebKit 538.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 538'
      AgentClass                           : 'Browser'
      AgentName                            : 'QupZilla'
      AgentVersion                         : '1.9.0'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'QupZilla 1.9.0'
      AgentNameVersionMajor                : 'QupZilla 1'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.21 (KHTML, like Gecko) QupZilla/1.9.9 Safari/537.21'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Linux ??'
      OperatingSystemNameVersionMajor      : 'Linux ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.21'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.21'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'QupZilla'
      AgentVersion                         : '1.9.9'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'QupZilla 1.9.9'
      AgentNameVersionMajor                : 'QupZilla 1'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) QupZilla/2.2.0 Chrome/56.0.2924.122 Safari/537.36'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Linux ??'
      OperatingSystemNameVersionMajor      : 'Linux ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '56.0'
      LayoutEngineVersionMajor             : '56'
      LayoutEngineNameVersion              : 'Blink 56.0'
      LayoutEngineNameVersionMajor         : 'Blink 56'
      AgentClass                           : 'Browser'
      AgentName                            : 'QupZilla'
      AgentVersion                         : '2.2.0'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'QupZilla 2.2.0'
      AgentNameVersionMajor                : 'QupZilla 2'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux x86_64) AppleWebKit/538.15+ (KHTML, like Gecko) WebKitGTK+/2.4.2 luakit/2012.09.13'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Linux ??'
      OperatingSystemNameVersionMajor      : 'Linux ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'WebKitGTK'
      LayoutEngineVersion                  : '2.4.2'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'WebKitGTK 2.4.2'
      LayoutEngineNameVersionMajor         : 'WebKitGTK 2'
      AgentClass                           : 'Browser'
      AgentName                            : 'Luakit'
      AgentVersion                         : '2012.09.13'
      AgentVersionMajor                    : '2012'
      AgentNameVersion                     : 'Luakit 2012.09.13'
      AgentNameVersionMajor                : 'Luakit 2012'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux x86_64) AppleWebKit/535.4+ (KHTML, like Gecko) WebKitGTK+/1.6.1 luakit'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Linux ??'
      OperatingSystemNameVersionMajor      : 'Linux ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'WebKitGTK'
      LayoutEngineVersion                  : '1.6.1'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'WebKitGTK 1.6.1'
      LayoutEngineNameVersionMajor         : 'WebKitGTK 1'
      AgentClass                           : 'Browser'
      AgentName                            : 'Luakit'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'Luakit ??'
      AgentNameVersionMajor                : 'Luakit ??'


- matcher:
    extract:
    - 'AgentClass                          :     2011 :"Browser"'
    - 'AgentName                           :     2011 :"Kodi"'
    - 'AgentVersion                        :     2011 :agent.product.name="Kodi"^.version'

# Kodi = XBMC Media center application = Cross platform, also on Sony Bravia
- test:
    input:
      user_agent_string:   'Kodi/17.1 (Linux; Android 6.0.1; BRAVIA 4K GB Build/MMB29V.S50) Android/6.0.1 Sys_CPU/armv7l App_Bitness/32 Version/17.1-Git:20170320-fc1619b'
    expected:
      DeviceClass                          : 'TV'
      DeviceName                           : 'Sony Bravia 4K GB'
      DeviceBrand                          : 'Sony'
      DeviceCpu                            : 'ARMv7l'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Embedded'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '6.0.1'
      OperatingSystemVersionMajor          : '6'
      OperatingSystemNameVersion           : 'Android 6.0.1'
      OperatingSystemNameVersionMajor      : 'Android 6'
      OperatingSystemVersionBuild          : 'MMB29V.S50'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'AppleWebKit ??'
      LayoutEngineNameVersionMajor         : 'AppleWebKit ??'
      AgentClass                           : 'Browser'
      AgentName                            : 'Kodi'
      AgentVersion                         : '17.1'
      AgentVersionMajor                    : '17'
      AgentNameVersion                     : 'Kodi 17.1'
      AgentNameVersionMajor                : 'Kodi 17'


#Chrome in Android Studio emulator
- test:
    input:
      user_agent_string:   'Mozilla/5.0 (Linux; Android 7.0; Android SDK built for x86 Build/NYC) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.90 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Google Android SDK Built FOR X86'
      DeviceBrand                          : 'Google'
      DeviceCpu                            : 'x86'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.0'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Android 7.0'
      OperatingSystemNameVersionMajor      : 'Android 7'
      OperatingSystemVersionBuild          : 'NYC'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '51.0'
      LayoutEngineVersionMajor             : '51'
      LayoutEngineNameVersion              : 'Blink 51.0'
      LayoutEngineNameVersionMajor         : 'Blink 51'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '51.0.2704.90'
      AgentVersionMajor                    : '51'
      AgentNameVersion                     : 'Chrome 51.0.2704.90'
      AgentNameVersionMajor                : 'Chrome 51'


# TODO: Review this. tb-gmx is the real useragent. Perhaps this is Thunderbird via gmx.net free email website in Germany ??
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; tb-gmx/2.6.12; (gmx/1.5.0.0); rv:11.0) like Gecko'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Trident'
      LayoutEngineVersion                  : '7.0'
      LayoutEngineVersionMajor             : '7'
      LayoutEngineNameVersion              : 'Trident 7.0'
      LayoutEngineNameVersionMajor         : 'Trident 7'
      AgentClass                           : 'Browser'
      AgentName                            : 'TB-GMX'
      AgentVersion                         : '2.6.12'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'TB-GMX 2.6.12'
      AgentNameVersionMajor                : 'TB-GMX 2'


# TODO: Review this. tb-webde is the real useragent. Perhaps this is Thunderbird via web.de free email website in Germany ??
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; tb-webde/2.7.4; (webde/1.4.0.0); rv:11.0) like Gecko'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Trident'
      LayoutEngineVersion                  : '7.0'
      LayoutEngineVersionMajor             : '7'
      LayoutEngineNameVersion              : 'Trident 7.0'
      LayoutEngineNameVersionMajor         : 'Trident 7'
      AgentClass                           : 'Browser'
      AgentName                            : 'TB-Webde'
      AgentVersion                         : '2.7.4'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'TB-Webde 2.7.4'
      AgentNameVersionMajor                : 'TB-Webde 2'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 10.0; WOW64; Trident/7.0; Touch; rv:11.0; BR-Safe-Browsing) like Gecko'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Trident'
      LayoutEngineVersion                  : '7.0'
      LayoutEngineVersionMajor             : '7'
      LayoutEngineNameVersion              : 'Trident 7.0'
      LayoutEngineNameVersionMajor         : 'Trident 7'
      AgentClass                           : 'Browser'
      AgentName                            : 'BR-Safe-Browsing'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'BR-Safe-Browsing ??'
      AgentNameVersionMajor                : 'BR-Safe-Browsing ??'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 8.0.0; SM-G950F Build/R16NW; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/69.0.3497.100 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung SM-G950F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '8.0.0'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Android 8.0.0'
      OperatingSystemNameVersionMajor      : 'Android 8'
      OperatingSystemVersionBuild          : 'R16NW'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '69.0'
      LayoutEngineVersionMajor             : '69'
      LayoutEngineNameVersion              : 'Blink 69.0'
      LayoutEngineNameVersionMajor         : 'Blink 69'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '69.0.3497.100'
      AgentVersionMajor                    : '69'
      AgentNameVersion                     : 'Chrome Webview 69.0.3497.100'
      AgentNameVersionMajor                : 'Chrome Webview 69'
      WebviewAppName                       : 'Unknown Webview App'
      WebviewAppVersion                    : '??'
      WebviewAppVersionMajor               : '??'
      WebviewAppNameVersion                : 'Unknown Webview App ??'
      WebviewAppNameVersionMajor           : 'Unknown Webview App ??'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 6.0.1; SM-G800F Build/MMB29K; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/69.0.3497.100 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung SM-G800F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '6.0.1'
      OperatingSystemVersionMajor          : '6'
      OperatingSystemNameVersion           : 'Android 6.0.1'
      OperatingSystemNameVersionMajor      : 'Android 6'
      OperatingSystemVersionBuild          : 'MMB29K'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '69.0'
      LayoutEngineVersionMajor             : '69'
      LayoutEngineNameVersion              : 'Blink 69.0'
      LayoutEngineNameVersionMajor         : 'Blink 69'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '69.0.3497.100'
      AgentVersionMajor                    : '69'
      AgentNameVersion                     : 'Chrome Webview 69.0.3497.100'
      AgentNameVersionMajor                : 'Chrome Webview 69'
      WebviewAppName                       : 'Unknown Webview App'
      WebviewAppVersion                    : '??'
      WebviewAppVersionMajor               : '??'
      WebviewAppNameVersion                : 'Unknown Webview App ??'
      WebviewAppNameVersionMajor           : 'Unknown Webview App ??'


# Cheetah Mobile : CM Browser version 5.22.xx
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 7.1.1; Nexus 6 Build/N6F27M; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/44.0.2403.119 Mobile Safari/537.36 ACHEETAHI/1'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Google Nexus 6'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.1.1'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Android 7.1.1'
      OperatingSystemNameVersionMajor      : 'Android 7'
      OperatingSystemVersionBuild          : 'N6F27M'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '44.0'
      LayoutEngineVersionMajor             : '44'
      LayoutEngineNameVersion              : 'Blink 44.0'
      LayoutEngineNameVersionMajor         : 'Blink 44'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '44.0.2403.119'
      AgentVersionMajor                    : '44'
      AgentNameVersion                     : 'Chrome Webview 44.0.2403.119'
      AgentNameVersionMajor                : 'Chrome Webview 44'
      WebviewAppName                       : 'Cheetah Mobile Browser'
      WebviewAppVersion                    : '1'
      WebviewAppVersionMajor               : '1'
      WebviewAppNameVersion                : 'Cheetah Mobile Browser 1'
      WebviewAppNameVersionMajor           : 'Cheetah Mobile Browser 1'

# Manually created edge case: Here the 'Version' is NOT the name of the browser.
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 12_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/16B92 Version/12.1 Safari/605.1.15'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '16B92'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '12.1'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'iOS 12.1'
      OperatingSystemNameVersionMajor      : 'iOS 12'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Browser'
      AgentName                            : 'Safari'
      AgentVersion                         : '12.1'
      AgentVersionMajor                    : '12'
      AgentNameVersion                     : 'Safari 12.1'
      AgentNameVersionMajor                : 'Safari 12'


# Sometimes the name of the agent is the first comment of the "(Mobile) Safari" product.
- matcher:
    variable:
    - 'Safari                              :agent.product.name="Safari"^'
    - 'Product                             :@Safari.comments.(1)entry.(1)product'
    extract:
    - 'AgentClass                          :       59 :"Browser"'
    - 'AgentName                           :       59 :@Product.name'
    - 'AgentVersion                        :       59 :@Product.version'

- matcher:
    variable:
    - 'Safari                              :agent.product.name="Mobile Safari"^'
    - 'Product                             :@Safari.comments.(1)entry.(1)product'
    extract:
    - 'AgentClass                          :       59 :"Browser"'
    - 'AgentName                           :       59 :@Product.name'
    - 'AgentVersion                        :       59 :@Product.version'

# Apparently the Airwatch Browser is a browser within the VMWare "Workspace ONE"/"AirWatch" system.
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 12_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/16B92 Version/12.1 Safari/605.1.15 (AirWatch Browser v7.1'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '16B92'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '12.1'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'iOS 12.1'
      OperatingSystemNameVersionMajor      : 'iOS 12'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Browser'
      AgentName                            : 'AirWatch Browser'
      AgentVersion                         : 'v7.1'
      AgentVersionMajor                    : 'v7'
      AgentNameVersion                     : 'AirWatch Browser v7.1'
      AgentNameVersionMajor                : 'AirWatch Browser v7'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPad; CPU OS 9_2 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13C75 Version/7.0 Safari/9537.53 (AirWatch Browser v4509)'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Apple iPad'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '13C75'
      DeviceVersion                        : 'iPad'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '9.2'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'iOS 9.2'
      OperatingSystemNameVersionMajor      : 'iOS 9'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '601.1.46'
      LayoutEngineVersionMajor             : '601'
      LayoutEngineNameVersion              : 'AppleWebKit 601.1.46'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 601'
      AgentClass                           : 'Browser'
      AgentName                            : 'AirWatch Browser'
      AgentVersion                         : 'v4509'
      AgentVersionMajor                    : 'v4509'
      AgentNameVersion                     : 'AirWatch Browser v4509'
      AgentNameVersionMajor                : 'AirWatch Browser v4509'

# Sogou Explorer (Sogou Browser?)
# https://stackoverflow.com/questions/12109356/what-is-the-browser-engine-of-the-sogou-browser

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 5.2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36 SE 2.X MetaSr 1.0'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : 'XP x64 Edition'
      OperatingSystemVersionMajor          : 'XP x64 Edition'
      OperatingSystemNameVersion           : 'Windows XP x64 Edition'
      OperatingSystemNameVersionMajor      : 'Windows XP x64 Edition'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '58.0'
      LayoutEngineVersionMajor             : '58'
      LayoutEngineNameVersion              : 'Blink 58.0'
      LayoutEngineNameVersionMajor         : 'Blink 58'
      AgentClass                           : 'Browser'
      AgentName                            : 'Sogou Explorer'
      AgentVersion                         : '2.X'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Sogou Explorer 2.X'
      AgentNameVersionMajor                : 'Sogou Explorer 2'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36 SE 2.X MetaSr 1.0'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '58.0'
      LayoutEngineVersionMajor             : '58'
      LayoutEngineNameVersion              : 'Blink 58.0'
      LayoutEngineNameVersionMajor         : 'Blink 58'
      AgentClass                           : 'Browser'
      AgentName                            : 'Sogou Explorer'
      AgentVersion                         : '2.X'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Sogou Explorer 2.X'
      AgentNameVersionMajor                : 'Sogou Explorer 2'

- matcher:
    variable:
    - 'SogouProduct                        :agent.(1-4)product.comments.entry.(1)product.name="SE"'
    require:
    - 'agent.(1-4)product.comments.entry.(1)product.name="MSIE"'
    - 'agent.(1-4)product.comments.entry.(2)product.name="MetaSr"'
    extract:
    - 'AgentClass                          :     2100 : "Browser"'
    - 'AgentName                           :     2100 : "Sogou Explorer"'
    - 'AgentVersion                        :     2100 : @SogouProduct^.version'


- test:
    input:
      user_agent_string: 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0; SE 2.X MetaSr 1.0; SE 2.X MetaSr 1.0; .NET CLR 2.0.50727; SE 2.X MetaSr 1.0)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : 'XP'
      OperatingSystemVersionMajor          : 'XP'
      OperatingSystemNameVersion           : 'Windows XP'
      OperatingSystemNameVersionMajor      : 'Windows XP'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Trident'
      LayoutEngineVersion                  : '4.0'
      LayoutEngineVersionMajor             : '4'
      LayoutEngineNameVersion              : 'Trident 4.0'
      LayoutEngineNameVersionMajor         : 'Trident 4'
      AgentClass                           : 'Browser'
      AgentName                            : 'Sogou Explorer'
      AgentVersion                         : '2.X'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Sogou Explorer 2.X'
      AgentNameVersionMajor                : 'Sogou Explorer 2'

# Testcase found on https://docs.microsoft.com/en-us/azure/kusto/query/parse-useragentfunction
#  { "Browser": { "Family": "AdobeAIR", "MajorVersion": "2", "MinorVersion": "5", "Patch": "1" } }
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows; U; en-US) AppleWebKit/531.9 (KHTML, like Gecko) AdobeAIR/2.5.1'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Windows ??'
      OperatingSystemNameVersionMajor      : 'Windows ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '531.9'
      LayoutEngineVersionMajor             : '531'
      LayoutEngineNameVersion              : 'AppleWebKit 531.9'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 531'
      AgentClass                           : 'Browser'
      AgentName                            : 'AdobeAIR'
      AgentVersion                         : '2.5.1'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'AdobeAIR 2.5.1'
      AgentNameVersionMajor                : 'AdobeAIR 2'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Android; U; nl-NL) AppleWebKit/533.19.4 (KHTML, like Gecko) AdobeAIR/18.0'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Android Mobile'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Android ??'
      OperatingSystemNameVersionMajor      : 'Android ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '533.19.4'
      LayoutEngineVersionMajor             : '533'
      LayoutEngineNameVersion              : 'AppleWebKit 533.19.4'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 533'
      AgentClass                           : 'Browser'
      AgentName                            : 'AdobeAIR'
      AgentVersion                         : '18.0'
      AgentVersionMajor                    : '18'
      AgentNameVersion                     : 'AdobeAIR 18.0'
      AgentNameVersionMajor                : 'AdobeAIR 18'
      AgentLanguage                        : 'Dutch (Netherlands)'
      AgentLanguageCode                    : 'nl-nl'
      AgentSecurity                        : 'Strong security'


# Testcase found on https://docs.microsoft.com/en-us/azure/kusto/query/parse-useragentfunction
#   {
#     "Browser": { "Family": "Nokia OSS Browser", "MajorVersion": "3", "MinorVersion": "1", "Patch": "" },
#     "OperatingSystem": { "Family": "Symbian OS", "MajorVersion": "9", "MinorVersion": "2", "Patch": "", "PatchMinor": "" },
#     "Device": { "Family": "Nokia N81", "Brand": "Nokia", "Model": "N81-3" }
#   }
# https://en.wikipedia.org/wiki/Nokia_Browser_for_Symbian
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (SymbianOS/9.2; U; Series60/3.1 NokiaN81-3/10.0.032 Profile/MIDP-2.0 Configuration/CLDC-1.1 ) AppleWebKit/413 (KHTML, like Gecko) Safari/4'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Nokia Symbian Phone'
      DeviceBrand                          : 'Nokia'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'SymbianOS'
      OperatingSystemVersion               : '9.2'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'SymbianOS 9.2'
      OperatingSystemNameVersionMajor      : 'SymbianOS 9'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '413'
      LayoutEngineVersionMajor             : '413'
      LayoutEngineNameVersion              : 'AppleWebKit 413'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 413'
      AgentClass                           : 'Browser'
      AgentName                            : 'Safari'
      AgentVersion                         : '4'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Safari 4' # FIXME: "Safari" on "Symbian" is really "Nokia Browser" ??
      AgentNameVersionMajor                : 'Safari 4'
      AgentSecurity                        : 'Strong security'


# When publishing build artifacts to a maven repo this useragent is used by Apache Maven
- test:
    input:
      user_agent_string: 'Apache-Maven/3.5.0 (Java 1.8.0_222; Linux 4.4.0-154-generic)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Apache Maven'
      DeviceBrand                          : 'Apache'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '4.4.0-154-generic'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Linux 4.4.0-154-generic'
      OperatingSystemNameVersionMajor      : 'Linux 4'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Special'
      AgentName                            : 'Apache-Maven'
      AgentVersion                         : '3.5.0'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Apache-Maven 3.5.0'
      AgentNameVersionMajor                : 'Apache-Maven 3'


- matcher:
    variable:
    - 'HawkProduct                         :agent.product.name="Hawk"^'
    extract:
    - 'AgentVersion                        :       50 : @HawkProduct.(2)version'
    - 'AgentName                           :       50 : Concat["Hawk ";@HawkProduct[2]]'

- matcher:
    require:
    - 'agent.(1-4)product.(1)comments.entry.(1)text="wv"'
    variable:
    - 'HawkProduct                         :agent.product.name="Hawk"^'
    extract:
    - 'WebviewAppVersion                   :       50 : @HawkProduct.(2)version'
    - 'WebviewAppName                      :       50 : Concat["Hawk ";@HawkProduct[2]]'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 4.2.2; nl-nl; AND1E Build/JDQ39) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Hawk/QuickBrowser/1.0.35'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Philips AND1E'
      DeviceBrand                          : 'Philips'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.2.2'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.2.2'
      OperatingSystemNameVersionMajor      : 'Android 4'
      OperatingSystemVersionBuild          : 'JDQ39'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.36'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.36'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'Hawk QuickBrowser'
      AgentVersion                         : '1.0.35'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Hawk QuickBrowser 1.0.35'
      AgentNameVersionMajor                : 'Hawk QuickBrowser 1'
      AgentLanguage                        : 'Dutch (Netherlands)'
      AgentLanguageCode                    : 'nl-nl'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 8.1.0; 5059D Build/O11019; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/69.0.3497.100 Mobile Safari/537.36 Hawk/TurboBrowser/v3.0.1.35'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Alcatel 5059D'
      DeviceBrand                          : 'Alcatel'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '8.1.0'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Android 8.1.0'
      OperatingSystemNameVersionMajor      : 'Android 8'
      OperatingSystemVersionBuild          : 'O11019'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '69.0'
      LayoutEngineVersionMajor             : '69'
      LayoutEngineNameVersion              : 'Blink 69.0'
      LayoutEngineNameVersionMajor         : 'Blink 69'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '69.0.3497.100'
      AgentVersionMajor                    : '69'
      AgentNameVersion                     : 'Chrome Webview 69.0.3497.100'
      AgentNameVersionMajor                : 'Chrome Webview 69'
      WebviewAppName                       : 'Hawk TurboBrowser'
      WebviewAppVersion                    : 'v3.0.1.35'
      WebviewAppVersionMajor               : 'v3'
      WebviewAppNameVersion                : 'Hawk TurboBrowser v3.0.1.35'
      WebviewAppNameVersionMajor           : 'Hawk TurboBrowser v3'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.1.8) Gecko/20100215 Solaris/10.1 (GNU) Superswan/3.5.8 (Byte/me)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'SUN Microsystems Linux Desktop'
      DeviceBrand                          : 'SUN Microsystems'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Solaris'
      OperatingSystemVersion               : '10.1'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Solaris 10.1'
      OperatingSystemNameVersionMajor      : 'Solaris 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '1.9.1.8'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Gecko 1.9.1.8'
      LayoutEngineNameVersionMajor         : 'Gecko 1'
      LayoutEngineBuild                    : '20100215'
      AgentClass                           : 'Browser'
      AgentName                            : 'Superswan'
      AgentVersion                         : '3.5.8'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Superswan 3.5.8'
      AgentNameVersionMajor                : 'Superswan 3'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows; U; Windows NT 6.1; ru; rv:1.9.2.10) Gecko/20100914 Firefox/3.6.10 sputnik 2.5.0.148'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '1.9.2.10'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Gecko 1.9.2.10'
      LayoutEngineNameVersionMajor         : 'Gecko 1'
      LayoutEngineBuild                    : '20100914'
      AgentClass                           : 'Browser'
      AgentName                            : 'Sputnik'
      AgentVersion                         : '2.5.0.148'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Sputnik 2.5.0.148'
      AgentNameVersionMajor                : 'Sputnik 2'
      AgentLanguage                        : 'Russian'
      AgentLanguageCode                    : 'ru'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      user_agent_string: 'Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; MRSPUTNIK 2, 4, 0, 463; MRA 5.8 (build 4156); SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; HPNTDF; .NET4.0C)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'HP Ntdf'
      DeviceBrand                          : 'HP'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Trident'
      LayoutEngineVersion                  : '4.0'
      LayoutEngineVersionMajor             : '4'
      LayoutEngineNameVersion              : 'Trident 4.0'
      LayoutEngineNameVersionMajor         : 'Trident 4'
      AgentClass                           : 'Browser'
      AgentName                            : 'Mrsputnik'
      AgentVersion                         : '2.4.0.463'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Mrsputnik 2.4.0.463'
      AgentNameVersionMajor                : 'Mrsputnik 2'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (N; Windows NT 6.2; WOW64) AppleWebKit/534.34 (KHTML, like Gecko) Google Earth/7.1.8.3036 Safari/534.34'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '8'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Windows 8'
      OperatingSystemNameVersionMajor      : 'Windows 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '534.34'
      LayoutEngineVersionMajor             : '534'
      LayoutEngineNameVersion              : 'AppleWebKit 534.34'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 534'
      AgentClass                           : 'Browser'
      AgentName                            : 'Google Earth'
      AgentVersion                         : '7.1.8.3036'
      AgentVersionMajor                    : '7'
      AgentNameVersion                     : 'Google Earth 7.1.8.3036'
      AgentNameVersionMajor                : 'Google Earth 7'
      AgentSecurity                        : 'No security'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/538.1 (KHTML, like Gecko) Google Earth Pro/7.3.2.5776 Safari/538.1'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '538.1'
      LayoutEngineVersionMajor             : '538'
      LayoutEngineNameVersion              : 'AppleWebKit 538.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 538'
      AgentClass                           : 'Browser'
      AgentName                            : 'Google Earth Pro'
      AgentVersion                         : '7.3.2.5776'
      AgentVersionMajor                    : '7'
      AgentNameVersion                     : 'Google Earth Pro 7.3.2.5776'
      AgentNameVersionMajor                : 'Google Earth Pro 7'


- matcher:
    require:
    - 'agent.product.name[1]="OnedriveMpc"'
    extract:
    - 'DeviceName                          :     1000 : "<<<null>>>"'

# A Microsoft OneDrive related useragent
# The real client is kinda unknown. It is probably the OneDrive client running on Windows 10 (i.e. Desktop)
# But it may also be a OneDrive client on a Mobile device. Because the useragent does not show this returns "Unknown".
- test:
    input:
      user_agent_string: 'OneDriveMpc-Transform_Thumbnail/1.0'
    expected:
      DeviceName                           : 'Unknown'
      AgentClass                           : 'Special'
      AgentName                            : 'OneDriveMpc-Transform_Thumbnail'
      AgentVersion                         : '1.0'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'OneDriveMpc-Transform_Thumbnail 1.0'
      AgentNameVersionMajor                : 'OneDriveMpc-Transform_Thumbnail 1'


# Tenta Browser (on Phone, Motorola/Google Nexus 6, Android 7.1.1)
# Avast Secure Browser is really IDENTICAL to the Tenta Browser
# NOTE: This one does NOT conform to the "Mobile Safari" for a "Phone" pattern.
#       Because this agent DOES NOT show the difference between Phone and Tablet they are classified as "Mobile"
- matcher:
    require:
    - 'agent.product.name="Mobile Tenta"'
    extract:
    - 'DeviceClass                         :     3100 : "Mobile"'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 7.1.1; Nexus 6; U; en) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.137 Mobile Tenta/4.0.18 Build/2471 Safari/537.36'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Google Nexus 6'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.1.1'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Android 7.1.1'
      OperatingSystemNameVersionMajor      : 'Android 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '64.0'
      LayoutEngineVersionMajor             : '64'
      LayoutEngineNameVersion              : 'Blink 64.0'
      LayoutEngineNameVersionMajor         : 'Blink 64'
      AgentClass                           : 'Browser'
      AgentName                            : 'Tenta'
      AgentVersion                         : '4.0.18'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Tenta 4.0.18'
      AgentNameVersionMajor                : 'Tenta 4'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'
      AgentSecurity                        : 'Strong security'

# Tenta Browser (on emulated Tablet in Android Studio, Android 10)
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 10; Android SDK built for x86; U; en) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.137 Mobile Tenta/4.0.18 Build/2473 Safari/537.36'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Google Android SDK Built FOR X86'
      DeviceBrand                          : 'Google'
      DeviceCpu                            : 'x86'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '10'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Android 10'
      OperatingSystemNameVersionMajor      : 'Android 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '64.0'
      LayoutEngineVersionMajor             : '64'
      LayoutEngineNameVersion              : 'Blink 64.0'
      LayoutEngineNameVersionMajor         : 'Blink 64'
      AgentClass                           : 'Browser'
      AgentName                            : 'Tenta'
      AgentVersion                         : '4.0.18'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Tenta 4.0.18'
      AgentNameVersionMajor                : 'Tenta 4'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'
      AgentSecurity                        : 'Strong security'


# NoxBrowser (on Phone, Motorola/Google Nexus 6, Android 7.1.1)
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 7.1.1; Nexus 6 Build/N6F27M) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/76.0.3809.111 NoxBrowser/2.0.0 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Google Nexus 6'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.1.1'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Android 7.1.1'
      OperatingSystemNameVersionMajor      : 'Android 7'
      OperatingSystemVersionBuild          : 'N6F27M'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '76.0'
      LayoutEngineVersionMajor             : '76'
      LayoutEngineNameVersion              : 'Blink 76.0'
      LayoutEngineNameVersionMajor         : 'Blink 76'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '76.0.3809.111'
      AgentVersionMajor                    : '76'
      AgentNameVersion                     : 'Chrome Webview 76.0.3809.111'
      AgentNameVersionMajor                : 'Chrome Webview 76'
      WebviewAppName                       : 'Noxbrowser'
      WebviewAppVersion                    : '2.0.0'
      WebviewAppVersionMajor               : '2'
      WebviewAppNameVersion                : 'Noxbrowser 2.0.0'
      WebviewAppNameVersionMajor           : 'Noxbrowser 2'


- matcher:
    variable:
    - 'XiaoMi                              :agent.product.(1)name="XiaoMi"^'
    require:
    - 'agent.product.name="Version"'
    extract:
    - 'WebviewAppName                      :       20 : Concat["XiaoMi ";@XiaoMi.(1)version]'
    - 'WebviewAppVersion                   :       20 : @XiaoMi.(2)version'

# Xiaomi Mint Browser (on Phone, Motorola/Google Nexus 6, Android 7.1.1)
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 7.1.1; en-gb; Nexus 6 Build/N6F27M) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/61.0.3163.128 Mobile Safari/537.36 XiaoMi/Mint Browser/3.4.7'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Google Nexus 6'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.1.1'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Android 7.1.1'
      OperatingSystemNameVersionMajor      : 'Android 7'
      OperatingSystemVersionBuild          : 'N6F27M'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '61.0'
      LayoutEngineVersionMajor             : '61'
      LayoutEngineNameVersion              : 'Blink 61.0'
      LayoutEngineNameVersionMajor         : 'Blink 61'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '61.0.3163.128'
      AgentVersionMajor                    : '61'
      AgentNameVersion                     : 'Chrome Webview 61.0.3163.128'
      AgentNameVersionMajor                : 'Chrome Webview 61'
      AgentLanguage                        : 'English (United Kingdom)'
      AgentLanguageCode                    : 'en-gb'
      AgentSecurity                        : 'Strong security'
      WebviewAppName                       : 'XiaoMi Mint Browser'
      WebviewAppVersion                    : '3.4.7'
      WebviewAppVersionMajor               : '3'
      WebviewAppNameVersion                : 'XiaoMi Mint Browser 3.4.7'
      WebviewAppNameVersionMajor           : 'XiaoMi Mint Browser 3'


# Epic browser (on Phone, Motorola/Google Nexus 6, Android 7.1.1)
# Undetectable
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 7.1.1; Nexus 6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/72.0.3626.121 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Google Nexus 6'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.1.1'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Android 7.1.1'
      OperatingSystemNameVersionMajor      : 'Android 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '72.0'
      LayoutEngineVersionMajor             : '72'
      LayoutEngineNameVersion              : 'Blink 72.0'
      LayoutEngineNameVersionMajor         : 'Blink 72'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '72.0.3626.121'
      AgentVersionMajor                    : '72'
      AgentNameVersion                     : 'Chrome 72.0.3626.121'
      AgentNameVersionMajor                : 'Chrome 72'

# Epic browser on Windows 10
# Undetectable
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3990.90 Safari/537.36'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '80.0'
      LayoutEngineVersionMajor             : '80'
      LayoutEngineNameVersion              : 'Blink 80.0'
      LayoutEngineNameVersionMajor         : 'Blink 80'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '80.0.3990.90'
      AgentVersionMajor                    : '80'
      AgentNameVersion                     : 'Chrome 80.0.3990.90'
      AgentNameVersionMajor                : 'Chrome 80'


- matcher:
    require:
    - 'agent.product.(2)version="TansoDL"'
    extract:
    - 'WebviewAppName                      :       10 : "Kode"'
    - 'WebviewAppVersion                   :       10 : "<<<null>>>"'

# Kode browser (on Phone, Motorola/Google Nexus 6, Android 7.1.1)
# Messed up everything
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 8.1.0; One) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/70.0.3538.110 Mobile Safari/537.36/TansoDL'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Oneplus ONE'
      DeviceBrand                          : 'Oneplus'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '8.1.0'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Android 8.1.0'
      OperatingSystemNameVersionMajor      : 'Android 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '70.0'
      LayoutEngineVersionMajor             : '70'
      LayoutEngineNameVersion              : 'Blink 70.0'
      LayoutEngineNameVersionMajor         : 'Blink 70'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '70.0.3538.110'
      AgentVersionMajor                    : '70'
      AgentNameVersion                     : 'Chrome Webview 70.0.3538.110'
      AgentNameVersionMajor                : 'Chrome Webview 70'
      WebviewAppName                       : 'Kode'
      WebviewAppVersion                    : '??'
      WebviewAppVersionMajor               : '??'
      WebviewAppNameVersion                : 'Kode ??'
      WebviewAppNameVersionMajor           : 'Kode ??'


# Cake browser (on Phone, Motorola/Google Nexus 6, Android 7.1.1)
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 7.1.1; Nexus 6 Build/N6F27M; Cake) AppleWebKit/537.36 (KHTML, like Gecko) Version/6.0.21 Chrome/83.0.4103.101 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Google Nexus 6'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.1.1'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Android 7.1.1'
      OperatingSystemNameVersionMajor      : 'Android 7'
      OperatingSystemVersionBuild          : 'N6F27M'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '83.0'
      LayoutEngineVersionMajor             : '83'
      LayoutEngineNameVersion              : 'Blink 83.0'
      LayoutEngineNameVersionMajor         : 'Blink 83'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '83.0.4103.101'
      AgentVersionMajor                    : '83'
      AgentNameVersion                     : 'Chrome Webview 83.0.4103.101'
      AgentNameVersionMajor                : 'Chrome Webview 83'
      WebviewAppName                       : 'Cake Browser'
      WebviewAppVersion                    : '??'
      WebviewAppVersionMajor               : '??'
      WebviewAppNameVersion                : 'Cake Browser ??'
      WebviewAppNameVersionMajor           : 'Cake Browser ??'

# Fake test case based upon Cake browser to check version extraction
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 7.1.1; Nexus 6 Build/N6F27M; Cake/1.2.3) AppleWebKit/537.36 (KHTML, like Gecko) Version/6.0.21 Chrome/83.0.4103.101 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Google Nexus 6'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.1.1'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Android 7.1.1'
      OperatingSystemNameVersionMajor      : 'Android 7'
      OperatingSystemVersionBuild          : 'N6F27M'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '83.0'
      LayoutEngineVersionMajor             : '83'
      LayoutEngineNameVersion              : 'Blink 83.0'
      LayoutEngineNameVersionMajor         : 'Blink 83'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '83.0.4103.101'
      AgentVersionMajor                    : '83'
      AgentNameVersion                     : 'Chrome Webview 83.0.4103.101'
      AgentNameVersionMajor                : 'Chrome Webview 83'
      WebviewAppName                       : 'Cake Browser'
      WebviewAppVersion                    : '1.2.3'
      WebviewAppVersionMajor               : '1'
      WebviewAppNameVersion                : 'Cake Browser 1.2.3'
      WebviewAppNameVersionMajor           : 'Cake Browser 1'


# Phoenix Browser  (on Phone, Motorola/Google Nexus 6, Android 7.1.1)
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 7.1.1; en-gb; Nexus 6 Build/N6F27M) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.101 Mobile Safari/537.36 PHX/5.0'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Google Nexus 6'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.1.1'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Android 7.1.1'
      OperatingSystemNameVersionMajor      : 'Android 7'
      OperatingSystemVersionBuild          : 'N6F27M'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '83.0'
      LayoutEngineVersionMajor             : '83'
      LayoutEngineNameVersion              : 'Blink 83.0'
      LayoutEngineNameVersionMajor         : 'Blink 83'
      AgentClass                           : 'Browser'
      AgentName                            : 'Phoenix'
      AgentVersion                         : '5.0'
      AgentVersionMajor                    : '5'
      AgentNameVersion                     : 'Phoenix 5.0'
      AgentNameVersionMajor                : 'Phoenix 5'
      AgentLanguage                        : 'English (United Kingdom)'
      AgentLanguageCode                    : 'en-gb'
      AgentSecurity                        : 'Strong security'


# Aloha (on Phone, Motorola/Google Nexus 6, Android 7.1.1)
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 7.1.1; MOTOROLA Nexus 6 Build/NMF26F) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.111 Mobile Safari/537.36 AlohaBrowser/2.18.1'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Motorola Nexus 6'
      DeviceBrand                          : 'Motorola'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.1.1'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Android 7.1.1'
      OperatingSystemNameVersionMajor      : 'Android 7'
      OperatingSystemVersionBuild          : 'NMF26F'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '76.0'
      LayoutEngineVersionMajor             : '76'
      LayoutEngineNameVersion              : 'Blink 76.0'
      LayoutEngineNameVersionMajor         : 'Blink 76'
      AgentClass                           : 'Browser'
      AgentName                            : 'Aloha Browser'
      AgentVersion                         : '2.18.1'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Aloha Browser 2.18.1'
      AgentNameVersionMajor                : 'Aloha Browser 2'

# Sleipnir (on Windows 10)
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.61 Safari/537.36 Sleipnir/6.4.6'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '83.0'
      LayoutEngineVersionMajor             : '83'
      LayoutEngineNameVersion              : 'Blink 83.0'
      LayoutEngineNameVersionMajor         : 'Blink 83'
      AgentClass                           : 'Browser'
      AgentName                            : 'Sleipnir'
      AgentVersion                         : '6.4.6'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'Sleipnir 6.4.6'
      AgentNameVersionMajor                : 'Sleipnir 6'

# Addons/adware/bloatware/spyware class products that put their name in the useragent
- set:
    name: 'BrowserPluginNames'
    values:
    - 'StumbleUpon'
    - 'Hotbar'
    - 'Alexa tool'
    - 'GoogleToolbar'
    - 'FunWebProducts'
    - 'StumbleUpon'
    - 'RainBird'
    - 'wbx'       # Cisco WebEx plugin related
    - 'WBXms'     # Cisco WebEx plugin related
    - 'WBXApp'    # Cisco WebEx plugin related
    - 'WBXwmswc'  # Cisco WebEx plugin related
    - 'Zoom'      # Zoom plugin related
    - 'WebConferencePro'
    - 'WCShortCut'

- set:
    name: 'GenericUnwantedNames'
    values:
    - 'OWASMIME'
    - 'anonymized'
    - 'build'


- set:
    name: 'UnwantedIEPrefixes'
    merge:
    - 'CPUArchitectures'
    - 'OSPatterns'
    - 'MobileBrands'
    - 'MobileBrandPrefixes'
    - 'ExactMatchMobileBrands'
    - 'BrowserPluginNames'
    - 'GenericUnwantedNames'
    values:
    - 'Mozilla'
    - 'compatible'
    - 'Windows'
    - 'Xbox'
    - 'Linux'
    - 'Macintosh'
    - 'MSIE'
    - 'Trident'
    - 'rv:'
    - 'InfoPath'
    - '.NET'
    - '. NET'
    - 'OfficeLive'
    - 'Media Center'
    - 'Tablet'
    - 'Touch'
    - 'CD-ROM'
    - 'CDROM'
    - 'IEMobile'
    - 'iebar'
    - 'BTRS'
    - 'GTB'
    - 'static'
    - '{'
    - '@'
    - '#'
    - 'O2'
    - 'T0'
    - 'T1'
    - 'T2'
    - 'T3'
    - 'T4'
    - 'T5'
    - 'T6'
    - 'T7'
    - 'T8'
    - 'T9'
    - 'Q0'
    - 'Q1'
    - 'Q2'
    - 'Q3' # Q312461
    - 'Q4'
    - 'Q5'
    - 'Q6'
    - 'Q7'
    - 'Q8'
    - 'Q9'
    - 'ESB'
    - 'SLCC1'
    - 'SLCC2' # Microsoft-Windows-Security-Licensing-SLCC --> https://stackoverflow.com/questions/49700209/does-anyone-know-what-slcc2-stands-for-in-the-ie-11-useragent-string/49701703

    # Internet Companies (ISP, Download sites, etc.) that put their name in the useragent string but are not browser names.
    - 'Rogers' # Rogers HI-Speed Internet
    - 'Yahoo'
    - 'World Online'
    - 'CNET'
    - 'AtHome'
    - 'ocn'
    - 'Tucows' # The Ultimate Collection Of Windows Software
    - 'by ' # Some say "By companyXYZ"

- set:
    name: 'UnwantedIENames'
    merge:
    - 'SecurityFlags'
    - 'ISOLanguageCodes'
    - 'WindowsOEMCodes'
    - 'WindowsDesktopOSName'
    values:
    - ''  # Don't want an empty name
    - 'X11'
    - 'SV1'
    - 'SLCC1'
    - 'SLCC2' # Microsoft-Windows-Security-Licensing-SLCC --> https://stackoverflow.com/questions/49700209/does-anyone-know-what-slcc2-stands-for-in-the-ie-11-useragent-string/49701703

      # https://stackoverflow.com/questions/5984880/decoding-the-ie9-user-agent
      # Bing Optimized IE8/IE9? https://www.webmasterworld.com/search_engine_spiders/4432587.htm
    - 'BOIE8'
    - 'BOIE9'
    - 'ENUSMSNIP' # EN_US : Locale (US English); MS: Microsoft; NIP: Network Intrusion Prevention
    - 'LCTE' # The LCTE part is currently still unknown. https://stackoverflow.com/questions/42500881/what-is-lcte-in-user-agent
    - 'WPDesktop'
    - 'Smartphone'
    - 'ESB'
    - 'DigExt' # DigExt is a special mark issued in IE5 "allow offline reading" mode. Although DigExt is not a crawler, it may cause a large number of server visits like a crawler.
    - 'Wine64' # Windows emulation environment on Linux

- matcher:
    variable:
    - 'AgentName                           :IsNotInLookUpPrefix[UnwantedIEPrefixes;agent.(1)product.(1)comments.entry}"Browser"]'
    require:
    - 'agent.(1)product.(1)comments.entry.(1)product.(1)name="MSIE"'
    - 'IsNull[agent.(1)product.(1)comments.entry.(1)product.(1)name="IEMobile"]'
    extract:
    - 'AgentName                           :     2007 : NormalizeBrand[@AgentName.text]'
    - 'AgentVersion                        :     2007 : "<<<null>>>"'

- matcher:
    variable:
    - 'Agent                               :IsNotInLookUpPrefix[UnwantedIEPrefixes;agent.(1)product.(1)comments.entry.product?!UnwantedIENames]'
    - 'AgentVersion                        :@Agent.version'
    require:
    - 'agent.(1)product.(1)comments.entry.(1)product.(1)name="MSIE"'
    - 'IsNull[agent.(1)product.(1)comments.entry.(1)product.(1)name="IEMobile"]'
    - 'IsNull[@AgentVersion.url]'
    - 'IsNull[@AgentVersion.uuid]'
    - 'IsNull[@AgentVersion.keyvalue]'
    extract:
    - 'AgentName                           :     2009 : NormalizeBrand[@Agent.name]'
    - 'AgentVersion                        :     2009 : CleanVersion[@AgentVersion]'

- matcher:
    variable:
    - 'Agent                               :IsNotInLookUpPrefix[UnwantedIEPrefixes;agent.(1)product.(1)comments.entry?!UnwantedIENames]'
    - 'AgentName                           :@Agent.text'
    require:
    - 'agent.(1)product.(1)comments.entry.(1)product.(1)name="Trident"'
    - 'IsNull[agent.(1)product.(1)comments.entry.(1)product.(1)name="IEMobile"]'
    - 'IsNull[agent.(1)product.(1)comments.entry.(1)product.(1)name="MSIE"]'
    extract:
    - 'AgentName                           :     2008 : NormalizeBrand[@AgentName]'
    - 'AgentVersion                        :     2008 : "<<<null>>>"'

- matcher:
    variable:
    - 'Agent                               :IsNotInLookUpPrefix[UnwantedIEPrefixes;agent.(1)product.(1)comments.entry.product?!UnwantedIENames]'
    - 'AgentVersion                        :@Agent.version'
    require:
    - 'agent.(1)product.(1)comments.entry.(1)product.(1)name="Trident"'
    - 'IsNull[agent.(1)product.(1)comments.entry.(1)product.(1)name="IEMobile"]'
    - 'IsNull[agent.(1)product.(1)comments.entry.(1)product.(1)name="MSIE"]'
    - 'IsNull[@AgentVersion.url]'
    - 'IsNull[@AgentVersion.uuid]'
    - 'IsNull[@AgentVersion.keyvalue]'
    extract:
    - 'AgentName                           :     2009 : NormalizeBrand[@Agent.name]'
    - 'AgentVersion                        :     2009 : CleanVersion[@AgentVersion]'


# GreenBrowser on Windows 10 (www.morequick.com)
- test:
    input:
      user_agent_string: 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.2; WOW64; Trident/7.0; .NET4.0C; .NET4.0E; .NET CLR 2.0.50727; .NET CLR 3.0.30729; .NET CLR 3.5.30729; GreenBrowser)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '8'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Windows 8'
      OperatingSystemNameVersionMajor      : 'Windows 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Trident'
      LayoutEngineVersion                  : '7.0'
      LayoutEngineVersionMajor             : '7'
      LayoutEngineNameVersion              : 'Trident 7.0'
      LayoutEngineNameVersionMajor         : 'Trident 7'
      AgentClass                           : 'Browser'
      AgentName                            : 'GreenBrowser'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'GreenBrowser ??'
      AgentNameVersionMajor                : 'GreenBrowser ??'
      IECompatibilityVersion               : '7.0'
      IECompatibilityVersionMajor          : '7'
      IECompatibilityNameVersion           : 'Internet Explorer 7.0'
      IECompatibilityNameVersionMajor      : 'Internet Explorer 7'


# Slimbrowser https://www.slimbrowser.net/
- test:
    input:
      user_agent_string: 'Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; MASM; .NET4.0C; BOIE9;DEDE; SlimBrowser/6.01.095)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Samsung Desktop'
      DeviceBrand                          : 'Samsung'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Trident'
      LayoutEngineVersion                  : '4.0'
      LayoutEngineVersionMajor             : '4'
      LayoutEngineNameVersion              : 'Trident 4.0'
      LayoutEngineNameVersionMajor         : 'Trident 4'
      AgentClass                           : 'Browser'
      AgentName                            : 'SlimBrowser'
      AgentVersion                         : '6.01.095'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'SlimBrowser 6.01.095'
      AgentNameVersionMajor                : 'SlimBrowser 6'
      AgentLanguage                        : 'German (Germany)'
      AgentLanguageCode                    : 'de-de'

# Lunascape 6 on Windows 10
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 10.0; WOW64; Trident/7.0; .NET4.0C; .NET4.0E; .NET CLR 2.0.50727; .NET CLR 3.0.30729; .NET CLR 3.5.30729; rv:11.0; Lunascape 6.15.2.27564) like Gecko'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Trident'
      LayoutEngineVersion                  : '7.0'
      LayoutEngineVersionMajor             : '7'
      LayoutEngineNameVersion              : 'Trident 7.0'
      LayoutEngineNameVersionMajor         : 'Trident 7'
      AgentClass                           : 'Browser'
      AgentName                            : 'Lunascape'
      AgentVersion                         : '6.15.2.27564'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'Lunascape 6.15.2.27564'
      AgentNameVersionMajor                : 'Lunascape 6'

- matcher:
    variable:
    - 'Agent                               :agent.(1)product.(1)name="Open AnyConnect VPN Agent"^'
    extract:
    - 'AgentClass                          :      100 : "Special"'
    - 'AgentName                           :      100 : "OpenConnect VPN Agent"'
    - 'AgentVersion                        :      100 : @Agent.version'

# OpenConnect VPN client over https (Ubuntu 20.04) started from commandline
- test:
    input:
      user_agent_string: 'Open AnyConnect VPN Agent v8.05-1'
    expected:
      DeviceClass                          : 'Unknown'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Unknown'
      OperatingSystemName                  : 'Unknown'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Unknown ??'
      OperatingSystemNameVersionMajor      : 'Unknown ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Special'
      AgentName                            : 'OpenConnect VPN Agent'
      AgentVersion                         : 'v8.05-1'
      AgentVersionMajor                    : 'v8'
      AgentNameVersion                     : 'OpenConnect VPN Agent v8.05-1'
      AgentNameVersionMajor                : 'OpenConnect VPN Agent v8'

- matcher:
    require:
    - 'agent.(1)product.(1)name="OpenConnect VPN Agent"'
    extract:
    - 'AgentClass                          :      100 : "Special"'
    - 'AgentName                           :      100 : "OpenConnect VPN Agent"'
    - 'AgentVersion                        :      100 : agent.(2)text'

# OpenConnect VPN client over https (Ubuntu 20.04) started by NetworkManager
- test:
    input:
      user_agent_string: 'OpenConnect VPN Agent (NetworkManager) v8.05-1'
    expected:
      DeviceClass                          : 'Unknown'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Unknown'
      OperatingSystemName                  : 'Unknown'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Unknown ??'
      OperatingSystemNameVersionMajor      : 'Unknown ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Special'
      AgentName                            : 'OpenConnect VPN Agent'
      AgentVersion                         : 'v8.05-1'
      AgentVersionMajor                    : 'v8'
      AgentNameVersion                     : 'OpenConnect VPN Agent v8.05-1'
      AgentNameVersionMajor                : 'OpenConnect VPN Agent v8'


- matcher:
    variable:
    - 'Agent                               :agent.(1)product.(1)name[1]="AnyConnect"'
    extract:
    - 'AgentClass                          :      100 : "Special"'
    - 'AgentName                           :      100 : "AnyConnect VPN Agent"'
    - 'AgentVersion                        :      100 : @Agent^.(1)version'


- matcher:
    require:
    - 'agent.(1)product.(1)name[1]="AnyConnect"'
    - 'agent.(1)product.(1)version[1]="Darwin"'
    extract:
    - 'DeviceClass                         :      100 : "Mobile"'
    - 'DeviceBrand                         :      100 : "Apple"'
    - 'OperatingSystemClass                :      100 : "Mobile"'
    - 'OperatingSystemName                 :      100 : "iOS"'
    - 'AgentClass                          :      100 : "Special"'
    - 'AgentName                           :      100 : "AnyConnect VPN Agent"'
    - 'AgentVersion                        :      101 : agent.(1)product.(2)version'

- test:
    input:
      user_agent_string: 'AnyConnect Android 4.9.00564'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Android ??'
      OperatingSystemNameVersionMajor      : 'Android ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Special'
      AgentName                            : 'AnyConnect VPN Agent'
      AgentVersion                         : '4.9.00564'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'AnyConnect VPN Agent 4.9.00564'
      AgentNameVersionMajor                : 'AnyConnect VPN Agent 4'


- test:
    input:
      user_agent_string: 'AnyConnect Darwin_i386 4.6.02074'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Apple'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'iOS ??'
      OperatingSystemNameVersionMajor      : 'iOS ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Special'
      AgentName                            : 'AnyConnect VPN Agent'
      AgentVersion                         : '4.6.02074'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'AnyConnect VPN Agent 4.6.02074'
      AgentNameVersionMajor                : 'AnyConnect VPN Agent 4'


- test:
    input:
      user_agent_string: 'AnyConnect Darwin_i386 3.1.05161'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Apple'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'iOS ??'
      OperatingSystemNameVersionMajor      : 'iOS ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Special'
      AgentName                            : 'AnyConnect VPN Agent'
      AgentVersion                         : '3.1.05161'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'AnyConnect VPN Agent 3.1.05161'
      AgentNameVersionMajor                : 'AnyConnect VPN Agent 3'

# Google Glass (~2013-2017)
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 4.0.4; en-us; Glass 1 Build/IMM76L; XE11) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30'
    expected:
      DeviceClass                          : 'Augmented Reality'
      DeviceName                           : 'Google Glass 1'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Augmented Reality'
      OperatingSystemName                  : 'Glass OS'
      OperatingSystemVersion               : '11'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'Glass OS 11'
      OperatingSystemNameVersionMajor      : 'Glass OS 11'
      OperatingSystemVersionBuild          : 'IMM76L'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '534.30'
      LayoutEngineVersionMajor             : '534'
      LayoutEngineNameVersion              : 'AppleWebKit 534.30'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 534'
      AgentClass                           : 'Browser'
      AgentName                            : 'Stock Android Browser'
      AgentVersion                         : '4.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Stock Android Browser 4.0'
      AgentNameVersionMajor                : 'Stock Android Browser 4'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 4.0.4; en-us; Glass 1 Build/IMM76L; XE16.11) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30'
    expected:
      DeviceClass                          : 'Augmented Reality'
      DeviceName                           : 'Google Glass 1'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.0.4'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.0.4'
      OperatingSystemNameVersionMajor      : 'Android 4'
      OperatingSystemVersionBuild          : 'IMM76L'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '534.30'
      LayoutEngineVersionMajor             : '534'
      LayoutEngineNameVersion              : 'AppleWebKit 534.30'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 534'
      AgentClass                           : 'Browser'
      AgentName                            : 'Stock Android Browser'
      AgentVersion                         : '4.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Stock Android Browser 4.0'
      AgentNameVersionMajor                : 'Stock Android Browser 4'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'


- matcher:
    extract:
    - 'DeviceClass                         :     1001 :"Augmented Reality"'
    - 'DeviceName                          :      100 :"Google Glass 1"'
    - 'DeviceBrand                         :      100 :"Google"'
    - 'OperatingSystemVersionBuild         :       12 :agent.(1)product.(1)comments.entry[1-3]="Glass 1 Build"@[4]'

- matcher:
    extract:
    - 'DeviceClass                         :     1001 :"Augmented Reality"'
    - 'DeviceName                          :      100 :"Google Glass 1"'
    - 'DeviceBrand                         :      100 :"Google"'
    - 'OperatingSystemVersionBuild         :       11 :agent.(1)product.(1)comments.entry[1-2]="Glass 1"@[3]'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 4.4.2; Glass 1 Build/XRX13B; XE22; 1511057; user; release-keys; 48cad1880fd0f82644ef86f5a7f6535b) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/30.0.0.0 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Augmented Reality'
      DeviceName                           : 'Google Glass 1'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Augmented Reality'
      OperatingSystemName                  : 'Glass OS'
      OperatingSystemVersion               : '22'
      OperatingSystemVersionMajor          : '22'
      OperatingSystemNameVersion           : 'Glass OS 22'
      OperatingSystemNameVersionMajor      : 'Glass OS 22'
      OperatingSystemVersionBuild          : 'XRX13B'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '30.0'
      LayoutEngineVersionMajor             : '30'
      LayoutEngineNameVersion              : 'Blink 30.0'
      LayoutEngineNameVersionMajor         : 'Blink 30'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '30.0.0.0'
      AgentVersionMajor                    : '30'
      AgentNameVersion                     : 'Chrome Webview 30.0.0.0'
      AgentNameVersionMajor                : 'Chrome Webview 30'
      WebviewAppName                       : 'Unknown Webview App'
      WebviewAppVersion                    : '??'
      WebviewAppVersionMajor               : '??'
      WebviewAppNameVersion                : 'Unknown Webview App ??'
      WebviewAppNameVersionMajor           : 'Unknown Webview App ??'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 4.4.2; Glass 1 Build/XRW85; XE21.3; 1460130; user; release-keys; d4baf10bb6dea9da4c0d249f838b9bfd) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/30.0.0.0 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Augmented Reality'
      DeviceName                           : 'Google Glass 1'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.4.2'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.4.2'
      OperatingSystemNameVersionMajor      : 'Android 4'
      OperatingSystemVersionBuild          : 'XRW85'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '30.0'
      LayoutEngineVersionMajor             : '30'
      LayoutEngineNameVersion              : 'Blink 30.0'
      LayoutEngineNameVersionMajor         : 'Blink 30'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '30.0.0.0'
      AgentVersionMajor                    : '30'
      AgentNameVersion                     : 'Chrome Webview 30.0.0.0'
      AgentNameVersionMajor                : 'Chrome Webview 30'
      WebviewAppName                       : 'Unknown Webview App'
      WebviewAppVersion                    : '??'
      WebviewAppVersionMajor               : '??'
      WebviewAppNameVersion                : 'Unknown Webview App ??'
      WebviewAppNameVersionMajor           : 'Unknown Webview App ??'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 6.3; Wine64; x64; Trident/7.0; rv:11.0) like Gecko'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Linux ??'
      OperatingSystemNameVersionMajor      : 'Linux ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Trident'
      LayoutEngineVersion                  : '7.0'
      LayoutEngineVersionMajor             : '7'
      LayoutEngineNameVersion              : 'Trident 7.0'
      LayoutEngineNameVersionMajor         : 'Trident 7'
      AgentClass                           : 'Browser'
      AgentName                            : 'Internet Explorer'
      AgentVersion                         : '11.0'
      AgentVersionMajor                    : '11'
      AgentNameVersion                     : 'Internet Explorer 11.0'
      AgentNameVersionMajor                : 'Internet Explorer 11'

# Cronet:
# https://developer.android.com/guide/topics/connectivity/cronet
# Cronet is the Chromium network stack made available to Android apps as a library.
- test:
    input:
      user_agent_string: 'com.google.android.apps.searchlite/444785 (Linux; U; Android 10; nl_BE; moto g(7) power; Build/QPOS30.52-29-7-6; Cronet/89.0.4389.90)'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Motorola Moto G(7) Power'
      DeviceBrand                          : 'Motorola'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '10'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Android 10'
      OperatingSystemNameVersionMajor      : 'Android 10'
      OperatingSystemVersionBuild          : 'QPOS30.52-29-7-6'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Special'
      AgentName                            : 'Com.google.android.apps.searchlite'
      AgentVersion                         : '444785'
      AgentVersionMajor                    : '444785'
      AgentNameVersion                     : 'Com.google.android.apps.searchlite 444785'
      AgentNameVersionMajor                : 'Com.google.android.apps.searchlite 444785'
      AgentLanguage                        : 'Dutch (Belgium)'
      AgentLanguageCode                    : 'nl-be'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'com.google.android.apps.searchlite/444787 (Linux; U; Android 10; nl; Nokia 1 Plus; Build/QP1A.190711.020; Cronet/89.0.4389.90)'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Nokia 1 Plus'
      DeviceBrand                          : 'Nokia'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '10'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Android 10'
      OperatingSystemNameVersionMajor      : 'Android 10'
      OperatingSystemVersionBuild          : 'QP1A.190711.020'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Special'
      AgentName                            : 'Com.google.android.apps.searchlite'
      AgentVersion                         : '444787'
      AgentVersionMajor                    : '444787'
      AgentNameVersion                     : 'Com.google.android.apps.searchlite 444787'
      AgentNameVersionMajor                : 'Com.google.android.apps.searchlite 444787'
      AgentLanguage                        : 'Dutch'
      AgentLanguageCode                    : 'nl'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'com.google.android.apps.searchlite/63665 (Linux; U; Android 8.1.0; en_ZA; SM-A260F; Build/OPR6; Cronet/89.0.4389.90)'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Samsung SM-A260F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '8.1.0'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Android 8.1.0'
      OperatingSystemNameVersionMajor      : 'Android 8'
      OperatingSystemVersionBuild          : 'OPR6'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Special'
      AgentName                            : 'Com.google.android.apps.searchlite'
      AgentVersion                         : '63665'
      AgentVersionMajor                    : '63665'
      AgentNameVersion                     : 'Com.google.android.apps.searchlite 63665'
      AgentNameVersionMajor                : 'Com.google.android.apps.searchlite 63665'
      AgentLanguage                        : 'English (South Africa)'
      AgentLanguageCode                    : 'en-za'
      AgentSecurity                        : 'Strong security'




- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:50.0) Gecko/20100101 Firefox/50.0@dbfdd109-daf7-4ad5-bb45-9945f7a18c04'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Apple Macintosh'
      DeviceBrand                          : 'Apple'
      DeviceCpu                            : 'Intel'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Mac OS X'
      OperatingSystemVersion               : '10.11'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Mac OS X 10.11'
      OperatingSystemNameVersionMajor      : 'Mac OS X 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '50.0'
      LayoutEngineVersionMajor             : '50'
      LayoutEngineNameVersion              : 'Gecko 50.0'
      LayoutEngineNameVersionMajor         : 'Gecko 50'
      LayoutEngineBuild                    : '20100101'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '50.0'
      AgentVersionMajor                    : '50'
      AgentNameVersion                     : 'Firefox 50.0'
      AgentNameVersionMajor                : 'Firefox 50'
      AgentUuid                            : 'dbfdd109-daf7-4ad5-bb45-9945f7a18c04'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10.12; rv:48.0) Gecko/20100101 Firefox/48.0@i-0bf85dffe1b8d659f'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Apple Macintosh'
      DeviceBrand                          : 'Apple'
      DeviceCpu                            : 'Intel'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Mac OS X'
      OperatingSystemVersion               : '10.12'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Mac OS X 10.12'
      OperatingSystemNameVersionMajor      : 'Mac OS X 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '48.0'
      LayoutEngineVersionMajor             : '48'
      LayoutEngineNameVersion              : 'Gecko 48.0'
      LayoutEngineNameVersionMajor         : 'Gecko 48'
      LayoutEngineBuild                    : '20100101'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '48.0'
      AgentVersionMajor                    : '48'
      AgentNameVersion                     : 'Firefox 48.0'
      AgentNameVersionMajor                : 'Firefox 48'


- test:
    input:
      user_agent_string: '--user-agent=Mozilla/5.0 (Linux; U; Android 4.0.3; en-gb; ARCHOS 80G9 Build/Deode@4.0.7) AppleWebKit/534.30 (KHTML,like Gecko) Version/4.0 Safari/534.30'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Archos 80G9'
      DeviceBrand                          : 'Archos'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.0.3'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.0.3'
      OperatingSystemNameVersionMajor      : 'Android 4'
      OperatingSystemVersionBuild          : 'Deode' # TODO: Unsure what to do with the @4.0.7 part.
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '534.30'
      LayoutEngineVersionMajor             : '534'
      LayoutEngineNameVersion              : 'AppleWebKit 534.30'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 534'
      AgentClass                           : 'Browser'
      AgentName                            : 'Stock Android Browser'
      AgentVersion                         : '4.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Stock Android Browser 4.0'
      AgentNameVersionMajor                : 'Stock Android Browser 4'
      AgentLanguage                        : 'English (United Kingdom)'
      AgentLanguageCode                    : 'en-gb'
      AgentSecurity                        : 'Strong security'

# https://play.google.com/store/apps/details?id=com.vivo.browser&hl=en&gl=US
# QUOTE:
#     Only Vivo phones support all the features of this app. Some functions may not work on other brand phones.
# So we ASSUME that if we do not have any brand available we assume the Vivo brand.
- matcher:
    require:
    - 'agent.product.name="VivoBrowser"'
    - 'agent.(1)product.(1)comments.(2)entry.product.name="Android"'
    extract:
    - 'DeviceBrand                         :      100 : "Vivo"'
    - 'DeviceName                          :      100 : agent.(1)product.(1)comments.(3)entry'

# https://github.com/nielsbasjes/yauaa/issues/367
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 11; V1824A; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/87.0.4280.141 Mobile Safari/537.36 VivoBrowser/10.4.0.2'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Vivo V1824A'
      DeviceBrand                          : 'Vivo'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '11'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'Android 11'
      OperatingSystemNameVersionMajor      : 'Android 11'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '87.0'
      LayoutEngineVersionMajor             : '87'
      LayoutEngineNameVersion              : 'Blink 87.0'
      LayoutEngineNameVersionMajor         : 'Blink 87'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '87.0.4280.141'
      AgentVersionMajor                    : '87'
      AgentNameVersion                     : 'Chrome Webview 87.0.4280.141'
      AgentNameVersionMajor                : 'Chrome Webview 87'
      WebviewAppName                       : 'VivoBrowser'
      WebviewAppVersion                    : '10.4.0.2'
      WebviewAppVersionMajor               : '10'
      WebviewAppNameVersion                : 'VivoBrowser 10.4.0.2'
      WebviewAppNameVersionMajor           : 'VivoBrowser 10'

# Manually tweaked alternative: If a brand IS available then that is used instead of Vivo.
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 11; SM-N960F; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/87.0.4280.141 Mobile Safari/537.36 VivoBrowser/10.4.0.2'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung SM-N960F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '11'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'Android 11'
      OperatingSystemNameVersionMajor      : 'Android 11'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '87.0'
      LayoutEngineVersionMajor             : '87'
      LayoutEngineNameVersion              : 'Blink 87.0'
      LayoutEngineNameVersionMajor         : 'Blink 87'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '87.0.4280.141'
      AgentVersionMajor                    : '87'
      AgentNameVersion                     : 'Chrome Webview 87.0.4280.141'
      AgentNameVersionMajor                : 'Chrome Webview 87'
      WebviewAppName                       : 'VivoBrowser'
      WebviewAppVersion                    : '10.4.0.2'
      WebviewAppVersionMajor               : '10'
      WebviewAppNameVersion                : 'VivoBrowser 10.4.0.2'
      WebviewAppNameVersionMajor           : 'VivoBrowser 10'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 5.1.1; vivo X7 Build/LMY47V; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 chrome/62.0.3202.84 Mobile Safari/537.36 VivoBrowser/8.4.12.0'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Vivo X7'
      DeviceBrand                          : 'Vivo'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '5.1.1'
      OperatingSystemVersionMajor          : '5'
      OperatingSystemNameVersion           : 'Android 5.1.1'
      OperatingSystemNameVersionMajor      : 'Android 5'
      OperatingSystemVersionBuild          : 'LMY47V'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '62.0'
      LayoutEngineVersionMajor             : '62'
      LayoutEngineNameVersion              : 'Blink 62.0'
      LayoutEngineNameVersionMajor         : 'Blink 62'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '62.0.3202.84'
      AgentVersionMajor                    : '62'
      AgentNameVersion                     : 'Chrome Webview 62.0.3202.84'
      AgentNameVersionMajor                : 'Chrome Webview 62'
      WebviewAppName                       : 'VivoBrowser'
      WebviewAppVersion                    : '8.4.12.0'
      WebviewAppVersionMajor               : '8'
      WebviewAppNameVersion                : 'VivoBrowser 8.4.12.0'
      WebviewAppNameVersionMajor           : 'VivoBrowser 8'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 9; vivo X21i A Build/P00610; wv) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.84 Mobile Safari/537.36 VivoBrowser/8.3.11.0'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Vivo X21I A'
      DeviceBrand                          : 'Vivo'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '9'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'Android 9'
      OperatingSystemNameVersionMajor      : 'Android 9'
      OperatingSystemVersionBuild          : 'P00610'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '62.0'
      LayoutEngineVersionMajor             : '62'
      LayoutEngineNameVersion              : 'Blink 62.0'
      LayoutEngineNameVersionMajor         : 'Blink 62'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '62.0.3202.84'
      AgentVersionMajor                    : '62'
      AgentNameVersion                     : 'Chrome Webview 62.0.3202.84'
      AgentNameVersionMajor                : 'Chrome Webview 62'
      WebviewAppName                       : 'VivoBrowser'
      WebviewAppVersion                    : '8.3.11.0'
      WebviewAppVersionMajor               : '8'
      WebviewAppNameVersion                : 'VivoBrowser 8.3.11.0'
      WebviewAppNameVersionMajor           : 'VivoBrowser 8'



- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows; U; Windows NT 5.2; en-US) AppleWebKit/537.36 (KHTML, like Gecko) Safari/537.36 VivoBrowser/6.3.0.2 Chrome/62.0.3202.84'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : 'XP x64 Edition'
      OperatingSystemVersionMajor          : 'XP x64 Edition'
      OperatingSystemNameVersion           : 'Windows XP x64 Edition'
      OperatingSystemNameVersionMajor      : 'Windows XP x64 Edition'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '62.0'
      LayoutEngineVersionMajor             : '62'
      LayoutEngineNameVersion              : 'Blink 62.0'
      LayoutEngineNameVersionMajor         : 'Blink 62'
      AgentClass                           : 'Browser'
      AgentName                            : 'VivoBrowser'
      AgentVersion                         : '6.3.0.2'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'VivoBrowser 6.3.0.2'
      AgentNameVersionMajor                : 'VivoBrowser 6'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'


# ========================================================
# Salesforce Mobile SDK
# --------------------------------------------------------

# https://github.com/forcedotcom/SalesforceMobileSDK-Android/blob/dev/libs/SalesforceSDK/src/com/salesforce/androidsdk/app/SalesforceSDKManager.java#L943
#  SalesforceMobileSDK/{salesforceSDK version} android/{android OS version} appName/appVersion {Native|Hybrid} uid_{device id}

# https://github.com/forcedotcom/SalesforceMobileSDK-Android/blob/dev/libs/SalesforceSDK/src/com/salesforce/androidsdk/app/SalesforceSDKManager.java#L969
#  SalesforceMobileSDK/{salesforceSDK version} android/{android OS version} {provideAppName()}/appVersion {Native|Hybrid} uid_{device id}

# Code does NOT match the comments !!!
#      return String.format("SalesforceMobileSDK/%s android mobile/%s (%s) %s/%s %s uid_%s ftr_%s SecurityPatch/%s",
#                     SDK_VERSION, Build.VERSION.RELEASE, Build.MODEL, appName, getAppVersion(),
#                     appTypeWithQualifier, uid, TextUtils.join(".", features),
#                     Build.VERSION.SECURITY_PATCH);

# "SalesforceMobileSDK/{SDK_VERSION} android mobile/{Build.VERSION.RELEASE} ({Build.MODEL}) {appName}/{getAppVersion} {appTypeWithQualifier} uid_{uid} ftr_{. separated features} SecurityPatch/{Build.VERSION.SECURITY_PATCH}"


- matcher:
    require:
    - 'agent.(1)product.name="SalesforceMobileSDK"'
    variable:
    - 'AppType                             :agent.product.name[1]{"Native"'
    - 'AppProduct                          :@AppType^<'
    extract:
    - 'AgentClass                          :    10000 : "Mobile App"'
    - 'AgentName                           :    10000 : @AppProduct.name'
    - 'AgentVersion                        :    10000 : @AppProduct.version'
    - 'WebviewAppName                      :        1 : "<<<null>>>"'
    - 'WebviewAppVersion                   :        1 : "<<<null>>>"'


- matcher:
    require:
    - 'agent.(1)product.name="SalesforceMobileSDK"'
    variable:
    - 'AppType                             :agent.product.name[1]{"Hybrid"'
    - 'AppProduct                          :@AppType^<'
    extract:
    - 'WebviewAppName                      :      100 : @AppProduct.name'
    - 'WebviewAppVersion                   :      100 : @AppProduct.version'


- lookup:
    name: 'SFSDKMobileBrands'
    merge:
    - 'MobileBrands'
    - 'MobileBrandPrefixes'


- matcher:
    require:
    - 'agent.(1)product.name="SalesforceMobileSDK"'
    variable:
    - 'DeviceModelTag                      :agent.product.name="android mobile"^.(1)comments.(1)entry'
    extract:
    - 'DeviceName                          :      100 :@DeviceModelTag'
    - 'DeviceBrand                         :      100 :LookUpPrefix[SFSDKMobileBrands;@DeviceModelTag]'


- matcher:
    require:
    - 'agent.(1)product.name="SalesforceMobileSDK"'
    extract:
    - 'DeviceClass                         :        0 :"Mobile"'
    - 'OperatingSystemClass                :        1 :"Mobile"'
    - 'OperatingSystemName                 :        1 :"Android"'
    - 'OperatingSystemVersion              :        1 :agent.product.name="android mobile"^.version'


# https://github.com/forcedotcom/SalesforceMobileSDK-iOS/blob/master/libs/SalesforceSDKCore/SalesforceSDKCore/Classes/Common/SalesforceSDKManager.h#L193
# Default implementation, when executed, will return a user agent of the form:
#  SalesforceMobileSDK/3.0.0 iPhone OS/8.1 (iPad) AppName/AppVersion *Native or Hybrid with optional qualifier* *Web-based user agent string*

# https://github.com/forcedotcom/SalesforceMobileSDK-iOS/blob/master/libs/SalesforceSDKCore/SalesforceSDKCore/Classes/RestAPI/SFRestAPI.m#L213
#  Set a user agent string based on the mobile SDK version.
#  We are building a user agent of the form:
#  SalesforceMobileSDK/1.0 iPhone OS/3.2.0 (iPad) AppName/AppVersion Native uid_<device id> [Current User Agent]

- matcher:
    require:
    - 'agent.(1)product.name="SalesforceMobileSDK"'
    extract:
    - 'AgentUuid                           :        1 :ReplaceString[agent.product.version{"uid_"@;"uid_";""]'

- test:
    input:
      user_agent_string: 'SalesforceMobileSDK/9.1.1 iOS/15.1 (iPhone) Chatter/234.020(6203393) Hybrid uid_848778C0-172E-487B-8355-3822BC5417DC ftr_ Mozilla/5.0 (iPhone; CPU iPhone OS 15_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148 iPhone/15.1 iOS_iPhone Salesforce1/234.020(6203393)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15E148'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '15.1'
      OperatingSystemVersionMajor          : '15'
      OperatingSystemNameVersion           : 'iOS 15.1'
      OperatingSystemNameVersionMajor      : 'iOS 15'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Browser'
      AgentName                            : 'AppleWebKit'
      AgentVersion                         : '605.1.15'
      AgentVersionMajor                    : '605'
      AgentNameVersion                     : 'AppleWebKit 605.1.15'
      AgentNameVersionMajor                : 'AppleWebKit 605'
      AgentUuid                            : '848778C0-172E-487B-8355-3822BC5417DC'
      WebviewAppName                       : 'Chatter'
      WebviewAppVersion                    : '234.020'
      WebviewAppVersionMajor               : '234'
      WebviewAppNameVersion                : 'Chatter 234.020'
      WebviewAppNameVersionMajor           : 'Chatter 234'

# Based upon what the code currently shows:
# SalesforceMobileSDK/{SDK_VERSION} android mobile/{Build.VERSION.RELEASE} ({Build.MODEL}) {appName}/{getAppVersion} {appTypeWithQualifier} uid_{uid} ftr_{. separated features} SecurityPatch/{Build.VERSION.SECURITY_PATCH}
- test:
    input: # Manually created based upon the code: Hybrid on Phone
      user_agent_string: 'SalesforceMobileSDK/1.1 android mobile/2.2 (SM-G920F) BasjesApp/3.3 HybridLocal uid_TheDevice-UUID-123 ftr_some.kind.of.feature SecurityPatch/4.4 Mozilla/5.0 (Linux; Android 7.0; SM-G920F Build/NRD90M; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/80.0.3987.149 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung SM-G920F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.0'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Android 7.0'
      OperatingSystemNameVersionMajor      : 'Android 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '80.0'
      LayoutEngineVersionMajor             : '80'
      LayoutEngineNameVersion              : 'Blink 80.0'
      LayoutEngineNameVersionMajor         : 'Blink 80'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '80.0.3987.149'
      AgentVersionMajor                    : '80'
      AgentNameVersion                     : 'Chrome Webview 80.0.3987.149'
      AgentNameVersionMajor                : 'Chrome Webview 80'
      AgentUuid                            : 'TheDevice-UUID-123'
      WebviewAppName                       : 'BasjesApp'
      WebviewAppVersion                    : '3.3'
      WebviewAppVersionMajor               : '3'
      WebviewAppNameVersion                : 'BasjesApp 3.3'
      WebviewAppNameVersionMajor           : 'BasjesApp 3'


- test:
    input: # Manually created based upon the code: Hybrid on Tablet
      user_agent_string: 'SalesforceMobileSDK/1.1 android mobile/2.2 (SM-G SomeTablet) BasjesApp/3.3 HybridLocal uid_TheDevice-UUID-123 ftr_some.kind.of.feature SecurityPatch/4.4 Mozilla/5.0 (Linux; Android 7.0; SM-G920F Build/NRD90M; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/80.0.3987.149 Safari/537.36'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Samsung SM-G SomeTablet'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.0'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Android 7.0'
      OperatingSystemNameVersionMajor      : 'Android 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '80.0'
      LayoutEngineVersionMajor             : '80'
      LayoutEngineNameVersion              : 'Blink 80.0'
      LayoutEngineNameVersionMajor         : 'Blink 80'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '80.0.3987.149'
      AgentVersionMajor                    : '80'
      AgentNameVersion                     : 'Chrome Webview 80.0.3987.149'
      AgentNameVersionMajor                : 'Chrome Webview 80'
      AgentUuid                            : 'TheDevice-UUID-123'
      WebviewAppName                       : 'BasjesApp'
      WebviewAppVersion                    : '3.3'
      WebviewAppVersionMajor               : '3'
      WebviewAppNameVersion                : 'BasjesApp 3.3'
      WebviewAppNameVersionMajor           : 'BasjesApp 3'


- test:
    input: # Manually created based upon the code: Native on Phone
      user_agent_string: 'SalesforceMobileSDK/1.1 android mobile/2.2 (SM-G920F) BasjesApp/3.3 Native uid_TheDevice-UUID-123 ftr_some.kind.of.feature SecurityPatch/4.4 Mozilla/5.0 (Linux; Android 7.0; SM-G920F Build/NRD90M; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/80.0.3987.149 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung SM-G920F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.0'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Android 7.0'
      OperatingSystemNameVersionMajor      : 'Android 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '80.0'
      LayoutEngineVersionMajor             : '80'
      LayoutEngineNameVersion              : 'Blink 80.0'
      LayoutEngineNameVersionMajor         : 'Blink 80'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'BasjesApp'
      AgentVersion                         : '3.3'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'BasjesApp 3.3'
      AgentNameVersionMajor                : 'BasjesApp 3'
      AgentUuid                            : 'TheDevice-UUID-123'


- test:
    input: # Manually created based upon the code: Native on Tablet
      user_agent_string: 'SalesforceMobileSDK/1.1 android mobile/2.2 (SM-G SomeTablet) BasjesApp/3.3 Native uid_TheDevice-UUID-123 ftr_some.kind.of.feature SecurityPatch/4.4 Mozilla/5.0 (Linux; Android 7.0; SM-G920F Build/NRD90M; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/80.0.3987.149 Safari/537.36'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Samsung SM-G SomeTablet'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.0'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Android 7.0'
      OperatingSystemNameVersionMajor      : 'Android 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '80.0'
      LayoutEngineVersionMajor             : '80'
      LayoutEngineNameVersion              : 'Blink 80.0'
      LayoutEngineNameVersionMajor         : 'Blink 80'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'BasjesApp'
      AgentVersion                         : '3.3'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'BasjesApp 3.3'
      AgentNameVersionMajor                : 'BasjesApp 3'
      AgentUuid                            : 'TheDevice-UUID-123'


- test:
    input:
      user_agent_string: 'SalesforceMobileSDK/6.0.0 android mobile/7.0 (SM-G920F) Schoolpoort/1.0 HybridLocal uid_a18335bc65e6a9c9 ftr_AI.GS.UA.US Hybrid Mozilla/5.0 (Linux; Android 7.0; SM-G920F Build/NRD90M; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/80.0.3987.149 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung SM-G920F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.0'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Android 7.0'
      OperatingSystemNameVersionMajor      : 'Android 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '80.0'
      LayoutEngineVersionMajor             : '80'
      LayoutEngineNameVersion              : 'Blink 80.0'
      LayoutEngineNameVersionMajor         : 'Blink 80'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '80.0.3987.149'
      AgentVersionMajor                    : '80'
      AgentNameVersion                     : 'Chrome Webview 80.0.3987.149'
      AgentNameVersionMajor                : 'Chrome Webview 80'
      AgentUuid                            : 'a18335bc65e6a9c9'
      WebviewAppName                       : 'Schoolpoort'
      WebviewAppVersion                    : '1.0'
      WebviewAppVersionMajor               : '1'
      WebviewAppNameVersion                : 'Schoolpoort 1.0'
      WebviewAppNameVersionMajor           : 'Schoolpoort 1'


- test:
    input:
      user_agent_string: 'SalesforceMobileSDK/6.0.0 android mobile/8.0.0 (SM-G930F) Schoolpoort/1.0 HybridLocal uid_69907699e1ae0a29 ftr_AI.GS.UA.US Hybrid Mozilla/5.0 (Linux; Android 8.0.0; SM-G930F Build/R16NW; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/80.0.3987.149 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung SM-G930F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '8.0.0'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Android 8.0.0'
      OperatingSystemNameVersionMajor      : 'Android 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '80.0'
      LayoutEngineVersionMajor             : '80'
      LayoutEngineNameVersion              : 'Blink 80.0'
      LayoutEngineNameVersionMajor         : 'Blink 80'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '80.0.3987.149'
      AgentVersionMajor                    : '80'
      AgentNameVersion                     : 'Chrome Webview 80.0.3987.149'
      AgentNameVersionMajor                : 'Chrome Webview 80'
      AgentUuid                            : '69907699e1ae0a29'
      WebviewAppName                       : 'Schoolpoort'
      WebviewAppVersion                    : '1.0'
      WebviewAppVersionMajor               : '1'
      WebviewAppNameVersion                : 'Schoolpoort 1.0'
      WebviewAppNameVersionMajor           : 'Schoolpoort 1'


- test:
    input:
      user_agent_string: 'SalesforceMobileSDK/6.0.0 android mobile/10 (SM-G973F) Schoolpoort/1.0 HybridLocal uid_58db6bf1e5c88b1a ftr_AI.GS.UA.US Hybrid Mozilla/5.0 (Linux; Android 10; SM-G973F Build/QP1A.190711.020; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/80.0.3987.149 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung SM-G973F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '10'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Android 10'
      OperatingSystemNameVersionMajor      : 'Android 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '80.0'
      LayoutEngineVersionMajor             : '80'
      LayoutEngineNameVersion              : 'Blink 80.0'
      LayoutEngineNameVersionMajor         : 'Blink 80'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '80.0.3987.149'
      AgentVersionMajor                    : '80'
      AgentNameVersion                     : 'Chrome Webview 80.0.3987.149'
      AgentNameVersionMajor                : 'Chrome Webview 80'
      AgentUuid                            : '58db6bf1e5c88b1a'
      WebviewAppName                       : 'Schoolpoort'
      WebviewAppVersion                    : '1.0'
      WebviewAppVersionMajor               : '1'
      WebviewAppNameVersion                : 'Schoolpoort 1.0'
      WebviewAppNameVersionMajor           : 'Schoolpoort 1'


- test:
    input:
      user_agent_string: 'SalesforceMobileSDK/6.0.0 android mobile/10 (SM-G975F) Schoolpoort/1.0 HybridLocal uid_5839c72a16b77760 ftr_AI.GS.UA.US Hybrid Mozilla/5.0 (Linux; Android 10; SM-G975F Build/QP1A.190711.020; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/80.0.3987.149 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung SM-G975F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '10'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Android 10'
      OperatingSystemNameVersionMajor      : 'Android 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '80.0'
      LayoutEngineVersionMajor             : '80'
      LayoutEngineNameVersion              : 'Blink 80.0'
      LayoutEngineNameVersionMajor         : 'Blink 80'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '80.0.3987.149'
      AgentVersionMajor                    : '80'
      AgentNameVersion                     : 'Chrome Webview 80.0.3987.149'
      AgentNameVersionMajor                : 'Chrome Webview 80'
      AgentUuid                            : '5839c72a16b77760'
      WebviewAppName                       : 'Schoolpoort'
      WebviewAppVersion                    : '1.0'
      WebviewAppVersionMajor               : '1'
      WebviewAppNameVersion                : 'Schoolpoort 1.0'
      WebviewAppNameVersionMajor           : 'Schoolpoort 1'

- test:
    input:
      user_agent_string: 'SalesforceMobileSDK/6.0.0 android mobile/8.0.0 (ATU-L21) Schoolpoort/1.0 HybridLocal uid_0a4a95e25b6623eb ftr_AI.GS.UA.US Hybrid Mozilla/5.0 (Linux; Android 8.0.0; ATU-L21 Build/HUAWEIATU-L21; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/80.0.3987.149 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Huawei ATU-L21'
      DeviceBrand                          : 'Huawei'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '8.0.0'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Android 8.0.0'
      OperatingSystemNameVersionMajor      : 'Android 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '80.0'
      LayoutEngineVersionMajor             : '80'
      LayoutEngineNameVersion              : 'Blink 80.0'
      LayoutEngineNameVersionMajor         : 'Blink 80'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '80.0.3987.149'
      AgentVersionMajor                    : '80'
      AgentNameVersion                     : 'Chrome Webview 80.0.3987.149'
      AgentNameVersionMajor                : 'Chrome Webview 80'
      AgentUuid                            : '0a4a95e25b6623eb'
      WebviewAppName                       : 'Schoolpoort'
      WebviewAppVersion                    : '1.0'
      WebviewAppVersionMajor               : '1'
      WebviewAppNameVersion                : 'Schoolpoort 1.0'
      WebviewAppNameVersionMajor           : 'Schoolpoort 1'


- test:
    input:
      user_agent_string: 'SalesforceMobileSDK/9.1.0 android mobile/9 (SM-A530F) Salesforce1/232.051.0(232060200) Native uid ftr_ SecurityPatch/2021-05-01 Cordova/8.0.0 auraff/sm Mozilla/5.0 (Linux; Android 9; SM-A530F Build/PPR1.180610.011; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/92.0.4515.166 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung SM-A530F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '9'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'Android 9'
      OperatingSystemNameVersionMajor      : 'Android 9'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '92.0'
      LayoutEngineVersionMajor             : '92'
      LayoutEngineNameVersion              : 'Blink 92.0'
      LayoutEngineNameVersionMajor         : 'Blink 92'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Salesforce1'
      AgentVersion                         : '232.051.0'
      AgentVersionMajor                    : '232'
      AgentNameVersion                     : 'Salesforce1 232.051.0'
      AgentNameVersionMajor                : 'Salesforce1 232'


- test:
    input:
      user_agent_string: 'SalesforceMobileSDK/7.2.0 android mobile/9 (PDBM00) Salesforce1/226.020.0(226020100) Native uid ftr_AI.UA.US Cordova/8.0.0 auraff/sm'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '9'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'Android 9'
      OperatingSystemNameVersionMajor      : 'Android 9'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'AppleWebKit ??'
      LayoutEngineNameVersionMajor         : 'AppleWebKit ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Salesforce1'
      AgentVersion                         : '226.020.0'
      AgentVersionMajor                    : '226'
      AgentNameVersion                     : 'Salesforce1 226.020.0'
      AgentNameVersionMajor                : 'Salesforce1 226'

#
# Yet Another UserAgent Analyzer
# Copyright (C) 2013-2024 Niels Basjes
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# https://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an AS IS BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#
config:
# Testcases for apps

- lookup:
    name: 'AppNamesMapping'
    map:
      # https://line.me/en/
      # https://play.google.com/store/apps/details?id=jp.naver.line.android
      # https://apps.apple.com/app/line/id443904275?platform=iphone
      'Safari Line' : 'Mobile App|Line'
      'Line'        : 'Mobile App|Line'

      # TODO: Figure out what kind of app "FABUILD" this is.
      'fabuild-android' : 'Mobile App|Fabuild'
      'fabuild-ios'     : 'Mobile App|Fabuild'


      # https://www.camscanner.com/ A mobile app for scanning documents
      'Camscanner'                            : 'Mobile App|Camscanner'

- lookup:
    name: 'NONWebViewAppNamesMapping'
    map:
      # Apps from Google:
      'com.google.android.youtube'            : 'Mobile App|Youtube'
      #  https://play.google.com/store/apps/details?id=com.google.android.youtube.tv&hl=en_US&gl=US
      'com.google.android.youtube.tv'         : 'Mobile App|Youtube for Android TV'
      'com.google.ios.youtube'                : 'Mobile App|Youtube'
      'com.google.android.apps.youtube.music' : 'Mobile App|Youtube Music'
      'com.google.ios.youtubemusic'           : 'Mobile App|Youtube Music'

      'com.google.Drive.ShareExtension'       : 'Mobile App|Google Drive'
      'com.google.Maps'                       : 'Mobile App|Google Maps'
      'com.google.OPA'                        : 'Mobile App|Google Assistant'
      'OPA'                                   : 'Mobile App|Google Assistant'

      # https://play.google.com/store/apps/details?id=com.google.android.apps.searchlite&hl=en&gl=US
      'com.google.android.apps.searchlite'    : 'Mobile App|Google Go'

      # https://www.webmasterworld.com/search_engine_spiders/4836796.htm
      'com.google.GoogleMobile'               : 'Mobile App|Google Plus'

      #  https://www.yammer.com/
      #  https://www.microsoft.com/en-us/microsoft-365/yammer/yammer-overview
      'Yammer'                                : 'Mobile App|Yammer'

      # F-secure app https://apps.apple.com/app/f-secure-safe/id572847748
      'FSCDCSafe'                             : 'Mobile App|F-Secure'

      'Bitwarden_Mobile'                      : 'Mobile App|Bitwarden Mobile'

      'WeChat'                                : 'Mobile App|WeChat'

      'Nextcloud-ios'                         : 'MobileApp | NextCloud iOS'
      'Nextcloud-android'                     : 'MobileApp | NextCloud Android'

      'mailapp'                               : 'Email Client|MailApp'
      'foxmail'                               : 'Email Client|Foxmail'        # https://www.foxmail.com/
      'Superhuman'                            : 'Email Client|Superhuman'     # https://superhuman.com
      'PostboxApp'                            : 'Email Client|PostboxApp'     # https://www.postbox-inc.com/
      'Mailspring'                            : 'Email Client|Mailspring'     # https://www.getmailspring.com/
      'Mailbird'                              : 'Email Client|Mailbird'       # https://www.getmailbird.com/nl/
      'SparkDesktop'                          : 'Email Client|Spark mail'     # https://sparkmailapp.com/
      'SparkMail'                             : 'Email Client|Spark mail'     # https://sparkmailapp.com/
      'ZohoMail-Desktop'                      : 'Email Client|Zoho mail'      # https://www.zoho.com/nl/mail/desktop/
      'ZohoTridentWindows'                    : 'Email Client|Zoho Trident'   # https://www.zoho.com/trident/
      'ZohoTridentMac'                        : 'Email Client|Zoho Trident'   # https://www.zoho.com/trident/
      'MailMaster'                            : 'Email Client|Mail Master'    # https://www.coremail.ai/
      'MailMasterPC'                          : 'Email Client|Mail Master'    # https://www.coremail.ai/
      'NewtonMail'                            : 'Email Client|Newton'         # https://www.newtonhq.com/
      'Tempo'                                 : 'Email Client|Tempo'          # https://www.yourtempo.co/ --> Dead project
      'Lark'                                  : 'Email Client|Lark'           # https://www.larksuite.com/
      'Sunsama'                               : 'Email Client|Sunsama'        # https://www.sunsama.com/
      'monday'                                : 'Email Client|Monday'         # https://monday.com/
      'tutanota-desktop'                      : 'Email Client|Tuta'           # https://tuta.com/
      'FastmailUA'                            : 'Email Client|Fastmail'       # https://www.fastmail.com/
      'OneOutlook'                            : 'Email Client|OneOutlook'

      # Yahoo Japan news app for IOS
      # https://apps.apple.com/jp/app/yahoo-japan/id299147843
      # https://www.ifreeware.net/download-jp-co-yahoo-ipn-appli.html : Yahoo! JAPAN for iPhone is a news app specially designed to be fully-featured entertainment app.
      'YJApp-IOS jp.co.yahoo.ipn.appli'             : 'Mobile App|Yahoo! JAPAN'

      # Yahoo Japan news app for Android
      # https://play.google.com/store/apps/details?id=jp.co.yahoo.android.yjtop&hl=en&gl=US
      'YJApp-ANDROID jp.co.yahoo.android.yjtop'     : 'Mobile App|Yahoo! JAPAN'

      # Yahoo  y!mail client
      'YJApp-IOS jp.co.yahoo.ymail'                 : 'Email Client|Yahoo! Mail'
      'YJApp-ANDROID jp.co.yahoo.android.ymail'     : 'Email Client|Yahoo! Mail'

      # https://2bee.jp/entry/20151011/1444564265/
      # - YJApp-IOS jp.co.yahoo.YBrowser / xxxx.x → Yahoo! Japan Browser (iOS version)
      # - YJApp-Android jp.co.yahoo.YBrowser / xxxx → Yahoo! Japan Browser (Android version)
      # Yahoo! Browser Specifications
      # - iOS:     http://promo.ybrowser.yahoo.co.jp/ios/
      # - Android: http://promo.ybrowser.yahoo.co.jp/

      # Yahoo Japan Browser app for IOS
      'YJApp-IOS jp.co.yahoo.YBrowser'              : 'Browser|Yahoo! JAPAN Browser'

      # Yahoo Japan Browser app for Android
      # https://play.google.com/store/apps/details?id=jp.co.yahoo.android.ybrowser
      'YJApp-ANDROID jp.co.yahoo.android.ybrowser'  : 'Browser|Yahoo! JAPAN Browser'

- matcher:
    variable:
    - 'AgentTag                            :LookUp[NONWebViewAppNamesMapping;agent.product.(1)name]'
    extract:
    - 'DeviceClass                         :        1 :"Mobile"'
    - 'AgentClass                          :    13060 :@AgentTag[[1]]'
    - 'AgentName                           :    13060 :@AgentTag[[2]]'
    - 'AgentVersion                        :    13060 :@AgentTag^.version'
    - 'WebviewAppName                      :    13060 :"<<<null>>>"'
    - 'WebviewAppVersion                   :    13060 :"<<<null>>>"'

# ht tps://user-agents.me/cfnetwork-version-list   (Original source no longer exists)
# If you create an iOS app and retrieve data from a webserver,
# the app will create a default user agent as "AppName/version CFNetwork/version Darwin/version".

# https://stackoverflow.com/a/46746999/114196
# Q: I want to know the default format for macOS (preferably with supporting documentation), and the default format for NSURLConnection as well.
# A: It follows that same code path as the iOS one.
#    nsurl/887 CFNetwork/887 Darwin/17.0.0 (x86_64)
#    $(CFBundleName)/$(CFBundleVersion) CFNetwork/$(CFNetworkVersion) Darwin/$(DarwinVersion) ($(Architecture))
#    If the program doesn't have a CFBundleName, its executable name is used instead.
#    For missing CFBundleVersion, (unknown version) is used.

- matcher:
    variable:
    - 'Darwin                              :agent.product.comments.entry="Darwin"'
    extract:
    - 'DeviceBrand                         :      1 :"Apple"'

- matcher:
    variable:
      - 'Darwin                              :agent.product.name="Darwin"^'
      - 'AppleTag                            :@Darwin.(2)comments.(1)entry?AppleDeviceClass'
    extract:
      - 'DeviceClass                         :      140 :LookUp[AppleDeviceClass;@AppleTag]'
      - 'DeviceBrand                         :      140 :"Apple"'
      - 'DeviceName                          :      140 :LookUp[AppleDeviceName;@AppleTag]'
      - 'DeviceVersion                       :      140 :LookUp[AppleDeviceVersion;@AppleTag]'


- matcher:
    variable:
      - 'Darwin                              :agent.product.name="Darwin"^'
      - 'CPU                                 :LookUp[CPUArchitectures;@Darwin.(1)comments.entry]'
    require:
      - 'agent.product.name="CFNetwork"'
    extract:
      - 'DeviceClass                         :       12 :"Desktop"'
      - 'DeviceBrand                         :       12 :"Apple"'
      - 'DeviceName                          :       12 :"Apple Macintosh"'
      - 'DeviceCpu                           :      115 :@CPU[[1]]'
      - 'DeviceCpuBits                       :      115 :@CPU[[2]]'
      - 'OperatingSystemClass                :       12 :"Desktop"'
      - 'OperatingSystemName                 :       12 :"Mac OS"'
      - 'OperatingSystemVersion              :       12 :LookUpPrefix[AppleDarwinVersionToMacOSVersion; @Darwin^.version;"<<<null>>>"]'
      - 'LayoutEngineClass                   :      141 :"Desktop App"'
      - 'AgentClass                          :      141 :"Desktop App"'


- lookup:
    name: 'AppleDarwinVersionToMacOSVersion'
    map:
      # Based upon https://en.wikipedia.org/wiki/Darwin_(operating_system)

      '1.3.1'     : '10.0.0'
      '1.4.1'     : '10.1.0'
      '5.'        : '10.1.?'
      '5.1'       : '10.1.1'
      '5.5'       : '10.1.5'
      '6.'        : '10.2.?'
      '6.0.1'     : '10.2.0'
      '6.8'       : '10.2.8'
      '7.'        : '10.3.?'
      '7.0'       : '10.3.0'
      '7.9'       : '10.3.9'
      '8.'        : '10.4.?'
      '8.0'       : '10.4.0'
      '8.11'      : '10.4.11'
      '9.'        : '10.5.?'
      '9.0'       : '10.5.0'
      '9.8'       : '10.5.8'
      '10.'       : '10.6.?'
      '10.0'      : '10.6.0'
      '10.8'      : '10.6.8'
      '11.'       : '10.7.?'
      '11.0'      : '10.7.0'
      '11.4'      : '10.7.5'
      '12.'       : '10.8.?'
      '12.0.0'    : '10.8.0'
      '12.6.0'    : '10.8.5'
      '13.'       : '10.9.?'
      '13.0.0'    : '10.9.0'
      '13.4.0'    : '10.9.5'
      '14.'       : '10.10.?'
      '14.0.0'    : '10.10.0'
      '14.5.0'    : '10.10.5'
      '15.'       : '10.11.?'
      '15.0.0'    : '10.11.0'
      '15.6.0'    : '10.11.6'
      '16.'       : '10.12.?'
      '16.0.0'    : '10.12.0'
      '16.5.0'    : '10.12.4'
      '16.6.0'    : '10.12.6'
      '17.?'      : '10.13.?'
      '17.0.0'    : '10.13.0'
      '17.5.0'    : '10.13.4'
      '17.6.0'    : '10.13.5'
      '17.7.0'    : '10.13.6'
      '18.?'      : '10.14.?'
      '18.0.0'    : '10.14.0'
      '18.2.0'    : '10.14.1'
      '19.?'      : '10.15.?'
      '19.0.0'    : '10.15.0'
      '19.2.0'    : '10.15.2'
      '19.3.0'    : '10.15.3'
      '19.4.0'    : '10.15.4'
      '19.5.0'    : '10.15.5'
      '19.6.0'    : '10.15.6 beta 2'
      '20.'       : '11.?'
      '20.0.0'    : '11.0 beta 1'
      '20.1.0'    : '11.0'
      '20.2.0'    : '11.1'
      '20.3.0'    : '11.2'
      '20.4.0'    : '11.3'
      '20.5.0'    : '11.4'
      '20.6.0'    : '11.5 beta 2'
      '21.'       : '12.?'
      '21.0.0'    : '12.0 beta 1'
      '21.0.1'    : '12.0'
      '21.1.0'    : '12.0.1'
      '21.2.0'    : '12.1'
      '21.3.0'    : '12.2'
      '21.4.0'    : '12.3'
      '21.5.0'    : '12.4 beta'
      '22.'       : '13.?'
      '22.0'      : '13.0 beta 1'
      '22.1.0'    : '13.0'
      '22.2.0'    : '13.1'
      '22.3.0'    : '13.2'
      '22.4.0'    : '13.3'
      '22.5.0'    : '13.4'
      '22.6.0'    : '13.5'

      '23.'       : '14.?'
      '23.0.0'    : '14.0'
      '23.1.0'    : '14.1'
      '23.2.0'    : '14.2'
      '23.3.0'    : '14.3'

# FIXME: These are just guesses !
      '24.'       : '15.?'
      '25.'       : '16.?'
      '26.'       : '17.?'
      '27.'       : '18.?'


- lookup:
    name: 'AppleDarwinVersionToIOSVersion'
    map:
      # Based upon https://en.wikipedia.org/wiki/Darwin_(operating_system)
      '10.'       : '4.?'
      '11.'       : '5.?'
      '13.'       : '6.?'
      '14.'       : '8.?' # Uncertain, can also have been iOS 7

      '15.'       : '9.?'
      '15.0.'     : '9.0'
      '15.6.'     : '9.3.3'

      '16.'       : '10.?'
      '16.0.'     : '10.0.1'
      '16.5.'     : '10.3'
      '16.6.'     : '10.3.3'

      '17.'       : '11.?'
      '17.0.'     : '11.0'
      '17.7.'     : '11.4.1'

      '18.'       : '12.?'
      '18.0.'     : '12.0'
      '18.2.'     : '12.1'

      '19.'       : '13.?'
      '19.0.'     : '13.0'
      '19.2.'     : '13.3'
      '19.3.'     : '13.3.1'
      '19.5.'     : '13.5'
      '19.6.'     : '13.6.0 beta 2'

      '20.'       : '14.?'
      '20.0.'     : '14.0 beta 1'
      '20.1.'     : '14.0'
      '20.2.'     : '14.3'
      '20.3.'     : '14.4'
      '20.4.'     : '14.5'
      '20.5.'     : '14.6'
      '20.6.'     : '14.7 beta 2'

      '21.'       : '15.?'
      '21.0.'     : '15.0 beta 1'
      '21.1.'     : '15.0'
      '21.2.'     : '15.2'
      '21.3.'     : '15.3'
      '21.4.'     : '15.4'

      '22.'       : '16.?'
      '22.0'      : '16.0'
      '22.1.0'    : '16.1'
      '22.2.0'    : '16.2'
      '22.3.0'    : '16.3'
      '22.4.0'    : '16.4'
      '22.5.0'    : '16.5'
      '22.6.0'    : '16.6'

      '23.'       : '17.?'
      '23.0.0'    : '17.0'
      '23.1.0'    : '17.1'
      '23.2.0'    : '17.2'
      '23.3.0'    : '17.3'

      # FIXME: These are just guesses !
      '24.'       : '18.?'
      '25.'       : '19.?'
      '26.'       : '20.?'
      '27.'       : '21.?'


- matcher:
    variable:
    - 'Agent                               :agent.(1)product'
    - 'AgentName                           :@Agent.(1)name'
    - 'AgentVersion                        :@Agent.(1)version'
    require:
    - 'agent.product.name="CFNetwork"'
    extract:
    - 'DeviceClass                         :       10 :"Mobile"'
    - 'DeviceBrand                         :       10 :"Apple"'
    - 'DeviceName                          :       10 :"iOS Device"'
    - 'OperatingSystemClass                :       10 :"Mobile"'
    - 'OperatingSystemName                 :       10 :"Darwin (iOS)"'
    - 'OperatingSystemVersion              :       10 :agent.product.name="Darwin"^.version'
    - 'LayoutEngineClass                   :       10 :"Mobile App"'
    - 'LayoutEngineName                    :       10 :@AgentName'
    - 'LayoutEngineVersion                 :       10 :@AgentVersion'
    - 'AgentClass                          :       10 :"Mobile App"'
    - 'AgentName                           :       10 :@AgentName'
    - 'AgentVersion                        :       10 :@AgentVersion'

- matcher:
    require:
      - 'agent.product.name="CFNetwork"'
    extract:
      - 'DeviceClass                         :       11 :"Mobile"'
      - 'DeviceBrand                         :       11 :"Apple"'
      - 'DeviceName                          :       11 :"iOS Device"'
      - 'OperatingSystemClass                :       11 :"Mobile"'
      - 'OperatingSystemName                 :       11 :"iOS"'
      - 'OperatingSystemVersion              :       11 :LookUpPrefix[AppleDarwinVersionToIOSVersion; agent.product.name="Darwin"^.version]'

- matcher:
    require:
    - 'agent.product.name="CFNetwork"'
    extract:
    - 'DeviceClass                         :       11 :"Mobile"'
    - 'DeviceBrand                         :       11 :"Apple"'
    - 'DeviceName                          :       11 :"iOS Device"'
    - 'OperatingSystemClass                :       11 :"Mobile"'
    - 'OperatingSystemName                 :       11 :"iOS"'
    - 'OperatingSystemVersion              :       12 :agent.product.name="iOS"^.version'

- matcher:
    variable:
    - 'AgentName                           :agent.(1)product.(1)name'
    require:
    - 'agent.product.name="CFNetwork"'
    - 'agent.(1)product.(1)comments.(1)entry="unknown version"'
    extract:
    - 'DeviceClass                         :       10 :"Mobile"'
    - 'DeviceBrand                         :       10 :"Apple"'
    - 'DeviceName                          :       10 :"iOS Device"'
    - 'OperatingSystemClass                :       10 :"Mobile"'
    - 'OperatingSystemName                 :       10 :"Darwin (iOS)"'
    - 'OperatingSystemVersion              :       10 :agent.(3)product.name="Darwin"^.version'
    - 'LayoutEngineClass                   :       10 :"Mobile App"'
    - 'LayoutEngineName                    :       10 :@AgentName'
    - 'LayoutEngineVersion                 :        6 :"<<<null>>>"'
    - 'AgentClass                          :       10 :"Mobile App"'
    - 'AgentName                           :       10 :@AgentName'
    - 'AgentVersion                        :        6 :"<<<null>>>"'

- matcher:
    require:
    - 'agent.(1)product.name="Dalvik"'
    extract:
    - 'AgentClass                          :       10 :"Mobile App"'
    - 'AgentName                           :       10 :agent.(2)product.name'
    - 'AgentVersion                        :       10 :agent.(2)product.version'

- test:
    input:
      user_agent_string: 'bol.com/94 CFNetwork/758.2.8 Darwin/15.0.0'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Apple iOS Device'
      DeviceBrand                          : 'Apple'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '9.0'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'iOS 9.0'
      OperatingSystemNameVersionMajor      : 'iOS 9'
      LayoutEngineClass                    : 'Mobile App'
      LayoutEngineName                     : 'bol.com'
      LayoutEngineVersion                  : '94'
      LayoutEngineVersionMajor             : '94'
      LayoutEngineNameVersion              : 'bol.com 94'
      LayoutEngineNameVersionMajor         : 'bol.com 94'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Bol.com'
      AgentVersion                         : '94'
      AgentVersionMajor                    : '94'
      AgentNameVersion                     : 'Bol.com 94'
      AgentNameVersionMajor                : 'Bol.com 94'
      AgentInformationUrl                  : 'bol.com'


- test:
    input:
      User-Agent                           : 'mediaserverd (unknown version) CFNetwork/1237 Darwin/20.4.0'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Apple iOS Device'
      DeviceBrand                          : 'Apple'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '14.5'
      OperatingSystemVersionMajor          : '14'
      OperatingSystemNameVersion           : 'iOS 14.5'
      OperatingSystemNameVersionMajor      : 'iOS 14'
      LayoutEngineClass                    : 'Mobile App'
      LayoutEngineName                     : 'mediaserverd'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'mediaserverd ??'
      LayoutEngineNameVersionMajor         : 'mediaserverd ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Mediaserverd'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'Mediaserverd ??'
      AgentNameVersionMajor                : 'Mediaserverd ??'


- test:
    input:
      user_agent_string: 'iButler-Swift/1 CFNetwork/711.3.15 Darwin/14.0.0'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Apple iOS Device'
      DeviceBrand                          : 'Apple'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '8.?'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'iOS 8.?'
      OperatingSystemNameVersionMajor      : 'iOS 8'
      LayoutEngineClass                    : 'Mobile App'
      LayoutEngineName                     : 'iButler-Swift'
      LayoutEngineVersion                  : '1'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'iButler-Swift 1'
      LayoutEngineNameVersionMajor         : 'iButler-Swift 1'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'iButler-Swift'
      AgentVersion                         : '1'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'iButler-Swift 1'
      AgentNameVersionMajor                : 'iButler-Swift 1'

- test:
    input:
      user_agent_string: 'GoodReader4/100 CFNetwork/711.5.6 Darwin/14.0.0'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Apple iOS Device'
      DeviceBrand                          : 'Apple'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '8.?'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'iOS 8.?'
      OperatingSystemNameVersionMajor      : 'iOS 8'
      LayoutEngineClass                    : 'Mobile App'
      LayoutEngineName                     : 'GoodReader4'
      LayoutEngineVersion                  : '100'
      LayoutEngineVersionMajor             : '100'
      LayoutEngineNameVersion              : 'GoodReader4 100'
      LayoutEngineNameVersionMajor         : 'GoodReader4 100'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'GoodReader4'
      AgentVersion                         : '100'
      AgentVersionMajor                    : '100'
      AgentNameVersion                     : 'GoodReader4 100'
      AgentNameVersionMajor                : 'GoodReader4 100'

- test:
    input:
      user_agent_string: 'iCoreService (unknown version) CFNetwork/720.2.4 Darwin/14.1.0 (x86_64)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Apple Macintosh'
      DeviceBrand                          : 'Apple'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Mac OS'
      OperatingSystemVersion               : '10.10.?'
      OperatingSystemVersionMajor          : '10.10'
      OperatingSystemNameVersion           : 'Mac OS 10.10.?'
      OperatingSystemNameVersionMajor      : 'Mac OS 10.10'
      LayoutEngineClass                    : 'Desktop App'
      LayoutEngineName                     : 'iCoreService'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'iCoreService ??'
      LayoutEngineNameVersionMajor         : 'iCoreService ??'
      AgentClass                           : 'Desktop App'
      AgentName                            : 'iCoreService'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'iCoreService ??'
      AgentNameVersionMajor                : 'iCoreService ??'

- test:
    input:
      user_agent_string: 'MoxDocumentApplication (unknown version) CFNetwork/720.5.7 Darwin/14.5.0 (x86_64)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Apple Macintosh'
      DeviceBrand                          : 'Apple'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Mac OS'
      OperatingSystemVersion               : '10.10.5'
      OperatingSystemVersionMajor          : '10.10'
      OperatingSystemNameVersion           : 'Mac OS 10.10.5'
      OperatingSystemNameVersionMajor      : 'Mac OS 10.10'
      LayoutEngineClass                    : 'Desktop App'
      LayoutEngineName                     : 'MoxDocumentApplication'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'MoxDocumentApplication ??'
      LayoutEngineNameVersionMajor         : 'MoxDocumentApplication ??'
      AgentClass                           : 'Desktop App'
      AgentName                            : 'MoxDocumentApplication'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'MoxDocumentApplication ??'
      AgentNameVersionMajor                : 'MoxDocumentApplication ??'


- test:
    input:
      user_agent_string: 'com.ddeville.llwebkit.linkchecker/1 CFNetwork/760.2.6 Darwin/15.3.0 (x86_64)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Apple Macintosh'
      DeviceBrand                          : 'Apple'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Mac OS'
      OperatingSystemVersion               : '10.11.?'
      OperatingSystemVersionMajor          : '10.11'
      OperatingSystemNameVersion           : 'Mac OS 10.11.?'
      OperatingSystemNameVersionMajor      : 'Mac OS 10.11'
      LayoutEngineClass                    : 'Desktop App'
      LayoutEngineName                     : 'com.ddeville.llwebkit.linkchecker'
      LayoutEngineVersion                  : '1'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'com.ddeville.llwebkit.linkchecker 1'
      LayoutEngineNameVersionMajor         : 'com.ddeville.llwebkit.linkchecker 1'
      AgentClass                           : 'Desktop App'
      AgentName                            : 'Com.ddeville.llwebkit.linkchecker'
      AgentVersion                         : '1'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Com.ddeville.llwebkit.linkchecker 1'
      AgentNameVersionMajor                : 'Com.ddeville.llwebkit.linkchecker 1'

- test:
    input:
      user_agent_string: 'Callpod Keeper for Android 1.0 (10.3.0/245) Dalvik/2.1.0 (Linux; U; Android 6.0; MotoG3 Build/MPI24.65-33)'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Motorola MOTOG3'
      DeviceBrand                          : 'Motorola'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '6.0'
      OperatingSystemVersionMajor          : '6'
      OperatingSystemNameVersion           : 'Android 6.0'
      OperatingSystemNameVersionMajor      : 'Android 6'
      OperatingSystemVersionBuild          : 'MPI24.65-33'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'Callpod Keeper for Android'
      AgentVersion                         : '1.0'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Callpod Keeper for Android 1.0'
      AgentNameVersionMajor                : 'Callpod Keeper for Android 1'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'com.google.ios.youtube/2.6.0.11251 (iPad3,4; U; CPU iPhone OS 8_1_2 like Mac OS X; nl_NL)'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Apple iPad'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPad (4th gen, Wi-Fi)'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '8.1.2'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'iOS 8.1.2'
      OperatingSystemNameVersionMajor      : 'iOS 8'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Youtube'
      AgentVersion                         : '2.6.0.11251'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Youtube 2.6.0.11251'
      AgentNameVersionMajor                : 'Youtube 2'
      AgentLanguage                        : 'Dutch (Netherlands)'
      AgentLanguageCode                    : 'nl-nl'
      AgentSecurity                        : 'Strong security'
      AgentInformationUrl                  : 'com.google.ios.youtube'

# Snapchat on Android
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 7.1.2; Redmi 4X Build/N2G47H; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/66.0.3359.126 Mobile Safari/537.36 Snapchat/10.30.5.0 (Redmi 4X; Android 7.1.2#V9.5.4.0.NAMMIFA#25; gzip)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Xiaomi Redmi 4X'
      DeviceBrand                          : 'Xiaomi'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.1.2'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Android 7.1.2'
      OperatingSystemNameVersionMajor      : 'Android 7'
      OperatingSystemVersionBuild          : 'N2G47H'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '66.0'
      LayoutEngineVersionMajor             : '66'
      LayoutEngineNameVersion              : 'Blink 66.0'
      LayoutEngineNameVersionMajor         : 'Blink 66'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '66.0.3359.126'
      AgentVersionMajor                    : '66'
      AgentNameVersion                     : 'Chrome Webview 66.0.3359.126'
      AgentNameVersionMajor                : 'Chrome Webview 66'
      WebviewAppName                       : 'Snapchat'
      WebviewAppVersion                    : '10.30.5.0'
      WebviewAppVersionMajor               : '10'
      WebviewAppNameVersion                : 'Snapchat 10.30.5.0'
      WebviewAppNameVersionMajor           : 'Snapchat 10'


# Snapchat on IPhone
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 11_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Snapchat/10.34.1.1 (iPhone9,2; iOS 11.4; gzip)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone 7 Plus'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '11.4'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'iOS 11.4'
      OperatingSystemNameVersionMajor      : 'iOS 11'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Browser'
      AgentName                            : 'Snapchat'
      AgentVersion                         : '10.34.1.1'
      AgentVersionMajor                    : '10'
      AgentNameVersion                     : 'Snapchat 10.34.1.1'
      AgentNameVersionMajor                : 'Snapchat 10'


#Instagram on Android 7.1.1
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 7.1.1; Moto G (5S) Build/NPPS26.102-49-4; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/66.0.3359.126 Mobile Safari/537.36 Instagram 42.0.0.19.95 Android (25/7.1.1; 480dpi; 1080x1776; motorola; Moto G (5S); montana_n; qcom; nl_BE; 104766900)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Motorola Moto G (5S)'
      DeviceBrand                          : 'Motorola'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.1.1'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Android 7.1.1'
      OperatingSystemNameVersionMajor      : 'Android 7'
      OperatingSystemVersionBuild          : 'NPPS26.102-49-4'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '66.0'
      LayoutEngineVersionMajor             : '66'
      LayoutEngineNameVersion              : 'Blink 66.0'
      LayoutEngineNameVersionMajor         : 'Blink 66'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '66.0.3359.126'
      AgentVersionMajor                    : '66'
      AgentNameVersion                     : 'Chrome Webview 66.0.3359.126'
      AgentNameVersionMajor                : 'Chrome Webview 66'
      WebviewAppName                       : 'Instagram'
      WebviewAppVersion                    : '42.0.0.19.95'
      WebviewAppVersionMajor               : '42'
      WebviewAppNameVersion                : 'Instagram 42.0.0.19.95'
      WebviewAppNameVersionMajor           : 'Instagram 42'

#Instagram on iPhone
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 9_3_5 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13G36 Instagram 43.0.0.13.91 (iPhone8,1; iPhone OS 9_3_5; nl_NL; nl-NL; scale=2.00; gamut=normal; 750x1334)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '13G36'
      DeviceVersion                        : 'iPhone 6s'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '9.3.5'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'iOS 9.3.5'
      OperatingSystemNameVersionMajor      : 'iOS 9'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '601.1.46'
      LayoutEngineVersionMajor             : '601'
      LayoutEngineNameVersion              : 'AppleWebKit 601.1.46'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 601'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Instagram'
      AgentVersion                         : '43.0.0.13.91'
      AgentVersionMajor                    : '43'
      AgentNameVersion                     : 'Instagram 43.0.0.13.91'
      AgentNameVersionMajor                : 'Instagram 43'
      AgentLanguage                        : 'Dutch (Netherlands)'
      AgentLanguageCode                    : 'nl-nl'

- matcher:
    extract:
    - 'AgentClass                          :       50 :"Special"'
    - 'AgentName                           :       50 :"iTunes"'
    - 'AgentVersion                        :       50 :agent.(1)product.name="iTunes"^.version'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 9; ONEPLUS A6003 Build/PKQ1.180716.001; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/73.0.3683.90 Mobile Safari/537.36 Instagram 89.0.0.21.101 Android (28/9; 420dpi; 1080x2074; OnePlus; ONEPLUS A6003; OnePlus6; qcom; nl_BE; 150338067)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Oneplus A6003'
      DeviceBrand                          : 'Oneplus'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '9'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'Android 9'
      OperatingSystemNameVersionMajor      : 'Android 9'
      OperatingSystemVersionBuild          : 'PKQ1.180716.001'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '73.0'
      LayoutEngineVersionMajor             : '73'
      LayoutEngineNameVersion              : 'Blink 73.0'
      LayoutEngineNameVersionMajor         : 'Blink 73'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '73.0.3683.90'
      AgentVersionMajor                    : '73'
      AgentNameVersion                     : 'Chrome Webview 73.0.3683.90'
      AgentNameVersionMajor                : 'Chrome Webview 73'
      WebviewAppName                       : 'Instagram'
      WebviewAppVersion                    : '89.0.0.21.101'
      WebviewAppVersionMajor               : '89'
      WebviewAppNameVersion                : 'Instagram 89.0.0.21.101'
      WebviewAppNameVersionMajor           : 'Instagram 89'
# TODO: Extracting the language from  agent.(7)product.(1)comments.(8)entry.(1)text="nl_BE" is possible but digging this deep will also impact all useragents that do not have this.

- test:
    input:
      user_agent_string: 'iTunes/12.7.4 (Macintosh; OS X 10.13.4) AppleWebKit/605.1.33.1.4'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Apple Macintosh'
      DeviceBrand                          : 'Apple'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Mac OS'
      OperatingSystemVersion               : '10.13.4'
      OperatingSystemVersionMajor          : '10.13'
      OperatingSystemNameVersion           : 'Mac OS 10.13.4'
      OperatingSystemNameVersionMajor      : 'Mac OS 10.13'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.33.1.4'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.33.1.4'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Special'
      AgentName                            : 'iTunes'
      AgentVersion                         : '12.7.4'
      AgentVersionMajor                    : '12'
      AgentNameVersion                     : 'iTunes 12.7.4'
      AgentNameVersionMajor                : 'iTunes 12'


# NOTE: iTunes makes a complete mess of the Windows desktop OS names
- test:
    input:
      user_agent_string: 'iTunes/12.7.4 (Windows; Microsoft Windows 10 x64 Home Premium Edition (Build 16299); x64) AppleWebKit/7605.1033.1002.2'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '7605.1033.1002.2'
      LayoutEngineVersionMajor             : '7605'
      LayoutEngineNameVersion              : 'AppleWebKit 7605.1033.1002.2'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 7605'
      AgentClass                           : 'Special'
      AgentName                            : 'iTunes'
      AgentVersion                         : '12.7.4'
      AgentVersionMajor                    : '12'
      AgentNameVersion                     : 'iTunes 12.7.4'
      AgentNameVersionMajor                : 'iTunes 12'

- test:
    input:
      user_agent_string: 'iTunes/12.7.4 (Windows; Microsoft Windows 10 x64 Home Premium Edition (Build 17134); x64) AppleWebKit/7605.1033.1002.2'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '7605.1033.1002.2'
      LayoutEngineVersionMajor             : '7605'
      LayoutEngineNameVersion              : 'AppleWebKit 7605.1033.1002.2'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 7605'
      AgentClass                           : 'Special'
      AgentName                            : 'iTunes'
      AgentVersion                         : '12.7.4'
      AgentVersionMajor                    : '12'
      AgentNameVersion                     : 'iTunes 12.7.4'
      AgentNameVersionMajor                : 'iTunes 12'


- test:
    input:
      user_agent_string: 'iTunes/12.7.4 (Windows; Microsoft Windows 10 x64 Professional Edition (Build 16299); x64) AppleWebKit/7605.1033.1002.2'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '7605.1033.1002.2'
      LayoutEngineVersionMajor             : '7605'
      LayoutEngineNameVersion              : 'AppleWebKit 7605.1033.1002.2'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 7605'
      AgentClass                           : 'Special'
      AgentName                            : 'iTunes'
      AgentVersion                         : '12.7.4'
      AgentVersionMajor                    : '12'
      AgentNameVersion                     : 'iTunes 12.7.4'
      AgentNameVersionMajor                : 'iTunes 12'


- test:
    input:
      user_agent_string: 'iTunes/12.7.4 (Windows; Microsoft Windows 7 Home Premium Edition Service Pack 1 (Build 7601)) AppleWebKit/7605.1033.1002.2'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '7605.1033.1002.2'
      LayoutEngineVersionMajor             : '7605'
      LayoutEngineNameVersion              : 'AppleWebKit 7605.1033.1002.2'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 7605'
      AgentClass                           : 'Special'
      AgentName                            : 'iTunes'
      AgentVersion                         : '12.7.4'
      AgentVersionMajor                    : '12'
      AgentNameVersion                     : 'iTunes 12.7.4'
      AgentNameVersionMajor                : 'iTunes 12'


- test:
    input:
      user_agent_string: 'iTunes/12.7 (Windows; Microsoft Windows 8.1 x64 Home Premium Edition (Build 9600); x64) AppleWebKit/7604.1038.1006.6'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '8.1'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Windows 8.1'
      OperatingSystemNameVersionMajor      : 'Windows 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '7604.1038.1006.6'
      LayoutEngineVersionMajor             : '7604'
      LayoutEngineNameVersion              : 'AppleWebKit 7604.1038.1006.6'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 7604'
      AgentClass                           : 'Special'
      AgentName                            : 'iTunes'
      AgentVersion                         : '12.7'
      AgentVersionMajor                    : '12'
      AgentNameVersion                     : 'iTunes 12.7'
      AgentNameVersionMajor                : 'iTunes 12'


- lookup:
    name: 'AliAppNames'
    map:
      "AP"        : "AlipayClient"
      "TUnionSDK" : "AliApp"

- matcher:
    variable:
    - 'AliApp                              :agent.product.name[1]="AliApp"^.comments.(1)entry.(1)product'
    require:
    - 'IsNull[LookUp[AliAppNames;@AliApp.name]]'
    extract:
    - 'AgentClass                          :     2118 :"Browser Webview"'
    - 'WebviewAppName                      :     2118 :Concat["Alibaba ";NormalizeBrand[@AliApp.name]]'
    - 'WebviewAppVersion                   :     2118 :@AliApp.version'

- matcher:
    variable:
    - 'AliApp                              :agent.product.name[2]="AliApp"^.comments.(1)entry.(1)product'
    require:
    - 'IsNull[LookUp[AliAppNames;@AliApp.name]]'
    extract:
    - 'AgentClass                          :     2118 :"Browser Webview"'
    - 'WebviewAppName                      :     2118 :Concat["Alibaba ";NormalizeBrand[@AliApp.name]]'
    - 'WebviewAppVersion                   :     2118 :@AliApp.version'

- matcher:
    variable:
    - 'AliApp                              :agent.product.name[1]="AliApp"^.comments.(1)entry.(1)product'
    - 'AliAppName                          :LookUp[AliAppNames;@AliApp.name]'
    extract:
    - 'AgentClass                          :     2119 :"Browser Webview"'
    - 'WebviewAppName                      :     2119 :Concat["Alibaba ";@AliAppName]'
    - 'WebviewAppVersion                   :     2119 :@AliApp.version'

- matcher:
    variable:
    - 'AliApp                              :agent.product.name[2]="AliApp"^.comments.(1)entry.(1)product'
    - 'AliAppName                          :LookUp[AliAppNames;@AliApp.name]'
    extract:
    - 'AgentClass                          :     2119 :"Browser Webview"'
    - 'WebviewAppName                      :     2119 :Concat["Alibaba ";@AliAppName]'
    - 'WebviewAppVersion                   :     2119 :@AliApp.version'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 9; zh-CN; Pixel Build/PPR2.181005.003) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/57.0.2987.108 UCBrowser/11.9.4.974 UWS/2.13.2.36 Mobile Safari/537.36 AliApp(DingTalk/4.5.18.1) com.alibaba.android.rimet/10652535 Channel/10002068 language/zh-CN'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Google Pixel'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '9'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'Android 9'
      OperatingSystemNameVersionMajor      : 'Android 9'
      OperatingSystemVersionBuild          : 'PPR2.181005.003'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '57.0'
      LayoutEngineVersionMajor             : '57'
      LayoutEngineNameVersion              : 'Blink 57.0'
      LayoutEngineNameVersionMajor         : 'Blink 57'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '57.0.2987.108'
      AgentVersionMajor                    : '57'
      AgentNameVersion                     : 'Chrome Webview 57.0.2987.108'
      AgentNameVersionMajor                : 'Chrome Webview 57'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      AgentSecurity                        : 'Strong security'
      WebviewAppName                       : 'Alibaba DingTalk'
      WebviewAppVersion                    : '4.5.18.1'
      WebviewAppVersionMajor               : '4'
      WebviewAppNameVersion                : 'Alibaba DingTalk 4.5.18.1'
      WebviewAppNameVersionMajor           : 'Alibaba DingTalk 4'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 8.1.0; zh-CN; EML-AL00 Build/HUAWEIEML-AL00) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/57.0.2987.108 baidu.sogo.uc.UCBrowser/11.9.4.974 UWS/2.13.1.48 Mobile Safari/537.36 AliApp(DingTalk/4.5.11) com.alibaba.android.rimet/10487439 Channel/227200 language/zh-CN'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Huawei EML-AL00'
      DeviceBrand                          : 'Huawei'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '8.1.0'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Android 8.1.0'
      OperatingSystemNameVersionMajor      : 'Android 8'
      OperatingSystemVersionBuild          : 'HUAWEIEML-AL00'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '57.0'
      LayoutEngineVersionMajor             : '57'
      LayoutEngineNameVersion              : 'Blink 57.0'
      LayoutEngineNameVersionMajor         : 'Blink 57'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '57.0.2987.108'
      AgentVersionMajor                    : '57'
      AgentNameVersion                     : 'Chrome Webview 57.0.2987.108'
      AgentNameVersionMajor                : 'Chrome Webview 57'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      AgentSecurity                        : 'Strong security'
      WebviewAppName                       : 'Alibaba DingTalk'
      WebviewAppVersion                    : '4.5.11'
      WebviewAppVersionMajor               : '4'
      WebviewAppNameVersion                : 'Alibaba DingTalk 4.5.11'
      WebviewAppNameVersionMajor           : 'Alibaba DingTalk 4'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 11_2_1 like Mac OS X) AppleWebKit/604.4.7 (KHTML, like Gecko) Mobile/15C153 AliApp(DingTalk/3.5.6) com.laiwang.DingTalk/2697521 Channel/201200 language/en-PT'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15C153'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '11.2.1'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'iOS 11.2.1'
      OperatingSystemNameVersionMajor      : 'iOS 11'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '604.4.7'
      LayoutEngineVersionMajor             : '604'
      LayoutEngineNameVersion              : 'AppleWebKit 604.4.7'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 604'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'AppleWebKit'
      AgentVersion                         : '604.4.7'
      AgentVersionMajor                    : '604'
      AgentNameVersion                     : 'AppleWebKit 604.4.7'
      AgentNameVersionMajor                : 'AppleWebKit 604'
      WebviewAppName                       : 'Alibaba DingTalk'
      WebviewAppVersion                    : '3.5.6'
      WebviewAppVersionMajor               : '3'
      WebviewAppNameVersion                : 'Alibaba DingTalk 3.5.6'
      WebviewAppNameVersionMajor           : 'Alibaba DingTalk 3'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 11_3_1 like Mac OS X; zh-CN) AppleWebKit/537.51.1 (KHTML, like Gecko) Mobile/15E302 UCBrowser/11.8.8.1060 Mobile AliApp(TUnionSDK/0.1.20.2)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15E302'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '11.3.1'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'iOS 11.3.1'
      OperatingSystemNameVersionMajor      : 'iOS 11'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'UCBrowser'
      LayoutEngineVersion                  : '11.8.8.1060'
      LayoutEngineVersionMajor             : '11'
      LayoutEngineNameVersion              : 'UCBrowser 11.8.8.1060'
      LayoutEngineNameVersionMajor         : 'UCBrowser 11'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'UCBrowser'
      AgentVersion                         : '11.8.8.1060'
      AgentVersionMajor                    : '11'
      AgentNameVersion                     : 'UCBrowser 11.8.8.1060'
      AgentNameVersionMajor                : 'UCBrowser 11'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      WebviewAppName                       : 'Alibaba AliApp'
      WebviewAppVersion                    : '0.1.20.2'
      WebviewAppVersionMajor               : '0'
      WebviewAppNameVersion                : 'Alibaba AliApp 0.1.20.2'
      WebviewAppNameVersionMajor           : 'Alibaba AliApp 0'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iOS 11_2_6 like Mac OS X) AppleWebKit/604.5.6 (KHTML, like Gecko) Mobile/15D100 ChannelId(3) Nebula AliApp(CLOUDMAIL/2.6.8)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '11.2.6'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'iOS 11.2.6'
      OperatingSystemNameVersionMajor      : 'iOS 11'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '604.5.6'
      LayoutEngineVersionMajor             : '604'
      LayoutEngineNameVersion              : 'AppleWebKit 604.5.6'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 604'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'AppleWebKit'
      AgentVersion                         : '604.5.6'
      AgentVersionMajor                    : '604'
      AgentNameVersion                     : 'AppleWebKit 604.5.6'
      AgentNameVersionMajor                : 'AppleWebKit 604'
      WebviewAppName                       : 'Alibaba Cloudmail'
      WebviewAppVersion                    : '2.6.8'
      WebviewAppVersionMajor               : '2'
      WebviewAppNameVersion                : 'Alibaba Cloudmail 2.6.8'
      WebviewAppNameVersionMajor           : 'Alibaba Cloudmail 2'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 11_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15F79 AliApp(DingTalk/4.5.1) com.laiwang.DingTalk/10127809 Channel/201200 language/zh-Hans-CN'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15F79'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '11.4'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'iOS 11.4'
      OperatingSystemNameVersionMajor      : 'iOS 11'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'AppleWebKit'
      AgentVersion                         : '605.1.15'
      AgentVersionMajor                    : '605'
      AgentNameVersion                     : 'AppleWebKit 605.1.15'
      AgentNameVersionMajor                : 'AppleWebKit 605'
      AgentLanguage                        : 'Chinese (Simplified Han, China)'
      AgentLanguageCode                    : 'zh-hans-cn'
      WebviewAppName                       : 'Alibaba DingTalk'
      WebviewAppVersion                    : '4.5.1'
      WebviewAppVersionMajor               : '4'
      WebviewAppNameVersion                : 'Alibaba DingTalk 4.5.1'
      WebviewAppNameVersionMajor           : 'Alibaba DingTalk 4'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 11_1_2 like Mac OS X; zh-CN) AppleWebKit/537.51.1 (KHTML, like Gecko) Mobile/15B202 UCBrowser/11.8.1.1043 Mobile AliApp(TUnionSDK/0.1.20)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15B202'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '11.1.2'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'iOS 11.1.2'
      OperatingSystemNameVersionMajor      : 'iOS 11'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'UCBrowser'
      LayoutEngineVersion                  : '11.8.1.1043'
      LayoutEngineVersionMajor             : '11'
      LayoutEngineNameVersion              : 'UCBrowser 11.8.1.1043'
      LayoutEngineNameVersionMajor         : 'UCBrowser 11'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'UCBrowser'
      AgentVersion                         : '11.8.1.1043'
      AgentVersionMajor                    : '11'
      AgentNameVersion                     : 'UCBrowser 11.8.1.1043'
      AgentNameVersionMajor                : 'UCBrowser 11'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      WebviewAppName                       : 'Alibaba AliApp'
      WebviewAppVersion                    : '0.1.20'
      WebviewAppVersionMajor               : '0'
      WebviewAppNameVersion                : 'Alibaba AliApp 0.1.20'
      WebviewAppNameVersionMajor           : 'Alibaba AliApp 0'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 10_3_3 like Mac OS X; zh-CN) AppleWebKit/537.51.1 (KHTML, like Gecko) Mobile/14G60 UCBrowser/11.4.7.931 Mobile AliApp(TUnionSDK/0.1.12) AliApp(TUnionSDK/0.1.12)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '14G60'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '10.3.3'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'iOS 10.3.3'
      OperatingSystemNameVersionMajor      : 'iOS 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'UCBrowser'
      LayoutEngineVersion                  : '11.4.7.931'
      LayoutEngineVersionMajor             : '11'
      LayoutEngineNameVersion              : 'UCBrowser 11.4.7.931'
      LayoutEngineNameVersionMajor         : 'UCBrowser 11'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'UCBrowser'
      AgentVersion                         : '11.4.7.931'
      AgentVersionMajor                    : '11'
      AgentNameVersion                     : 'UCBrowser 11.4.7.931'
      AgentNameVersionMajor                : 'UCBrowser 11'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      WebviewAppName                       : 'Alibaba AliApp'
      WebviewAppVersion                    : '0.1.12'
      WebviewAppVersionMajor               : '0'
      WebviewAppNameVersion                : 'Alibaba AliApp 0.1.12'
      WebviewAppNameVersionMajor           : 'Alibaba AliApp 0'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 9_3 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13E230 ChannelId(3) Nebula PSDType(1) AlipayDefined(nt:WIFI,ws:320|504|2.0) AliApp(AP/9.9.0.000001) AlipayClient/9.9.0.000001 Language/zh-Hans ProductType/dev'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '13E230'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '9.3'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'iOS 9.3'
      OperatingSystemNameVersionMajor      : 'iOS 9'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '601.1.46'
      LayoutEngineVersionMajor             : '601'
      LayoutEngineNameVersion              : 'AppleWebKit 601.1.46'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 601'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'AppleWebKit'
      AgentVersion                         : '601.1.46'
      AgentVersionMajor                    : '601'
      AgentNameVersion                     : 'AppleWebKit 601.1.46'
      AgentNameVersionMajor                : 'AppleWebKit 601'
      AgentLanguage                        : 'Chinese (Simplified)'
      AgentLanguageCode                    : 'zh-hans'
      WebviewAppName                       : 'Alibaba AlipayClient'
      WebviewAppVersion                    : '9.9.0.000001'
      WebviewAppVersionMajor               : '9'
      WebviewAppNameVersion                : 'Alibaba AlipayClient 9.9.0.000001'
      WebviewAppNameVersionMajor           : 'Alibaba AlipayClient 9'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iOS 11_2_6 like Mac OS X) AppleWebKit/604.5.6 (KHTML, like Gecko) Mobile/15D100 ChannelId(2) Nebula AliApp(CLOUDMAIL/5.1.0)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '11.2.6'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'iOS 11.2.6'
      OperatingSystemNameVersionMajor      : 'iOS 11'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '604.5.6'
      LayoutEngineVersionMajor             : '604'
      LayoutEngineNameVersion              : 'AppleWebKit 604.5.6'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 604'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'AppleWebKit'
      AgentVersion                         : '604.5.6'
      AgentVersionMajor                    : '604'
      AgentNameVersion                     : 'AppleWebKit 604.5.6'
      AgentNameVersionMajor                : 'AppleWebKit 604'
      WebviewAppName                       : 'Alibaba Cloudmail'
      WebviewAppVersion                    : '5.1.0'
      WebviewAppVersionMajor               : '5'
      WebviewAppNameVersion                : 'Alibaba Cloudmail 5.1.0'
      WebviewAppNameVersionMajor           : 'Alibaba Cloudmail 5'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 11_4_1 like Mac OS X; zh-CN) AppleWebKit/537.51.1 (KHTML, like Gecko) Mobile/15G77 UCBrowser/12.1.2.1096 Mobile AliApp(TUnionSDK/0.1.20.3)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15G77'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '11.4.1'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'iOS 11.4.1'
      OperatingSystemNameVersionMajor      : 'iOS 11'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'UCBrowser'
      LayoutEngineVersion                  : '12.1.2.1096'
      LayoutEngineVersionMajor             : '12'
      LayoutEngineNameVersion              : 'UCBrowser 12.1.2.1096'
      LayoutEngineNameVersionMajor         : 'UCBrowser 12'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'UCBrowser'
      AgentVersion                         : '12.1.2.1096'
      AgentVersionMajor                    : '12'
      AgentNameVersion                     : 'UCBrowser 12.1.2.1096'
      AgentNameVersionMajor                : 'UCBrowser 12'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      WebviewAppName                       : 'Alibaba AliApp'
      WebviewAppVersion                    : '0.1.20.3'
      WebviewAppVersionMajor               : '0'
      WebviewAppNameVersion                : 'Alibaba AliApp 0.1.20.3'
      WebviewAppNameVersionMajor           : 'Alibaba AliApp 0'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 11_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15F79 AliApp(DingTalk/4.5.1) com.laiwang.DingTalk/10127809 Channel/201200 language/en-DE'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15F79'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '11.4'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'iOS 11.4'
      OperatingSystemNameVersionMajor      : 'iOS 11'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'AppleWebKit'
      AgentVersion                         : '605.1.15'
      AgentVersionMajor                    : '605'
      AgentNameVersion                     : 'AppleWebKit 605.1.15'
      AgentNameVersionMajor                : 'AppleWebKit 605'
      AgentLanguage                        : 'English (Germany)'
      AgentLanguageCode                    : 'en-de'
      WebviewAppName                       : 'Alibaba DingTalk'
      WebviewAppVersion                    : '4.5.1'
      WebviewAppVersionMajor               : '4'
      WebviewAppNameVersion                : 'Alibaba DingTalk 4.5.1'
      WebviewAppNameVersionMajor           : 'Alibaba DingTalk 4'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 4.4.2; SM-N9008 Build/KOT49H) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/30.0.0.0 Mobile Safari/537.36 AliApp(AP/8.5.3.012601) AlipayClient/8.5.3.012601'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung SM-N9008'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.4.2'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.4.2'
      OperatingSystemNameVersionMajor      : 'Android 4'
      OperatingSystemVersionBuild          : 'KOT49H'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '30.0'
      LayoutEngineVersionMajor             : '30'
      LayoutEngineNameVersion              : 'Blink 30.0'
      LayoutEngineNameVersionMajor         : 'Blink 30'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '30.0.0.0'
      AgentVersionMajor                    : '30'
      AgentNameVersion                     : 'Chrome Webview 30.0.0.0'
      AgentNameVersionMajor                : 'Chrome Webview 30'
      WebviewAppName                       : 'Alibaba AlipayClient'
      WebviewAppVersion                    : '8.5.3.012601'
      WebviewAppVersionMajor               : '8'
      WebviewAppNameVersion                : 'Alibaba AlipayClient 8.5.3.012601'
      WebviewAppNameVersionMajor           : 'Alibaba AlipayClient 8'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 4.4.4; M353 Build/KTU84P) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/33.0.0.0 Mobile Safari/537.36 AliApp(AP/8.5.3.012601) AlipayClient/8.5.3.012601'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Meizu M353'
      DeviceBrand                          : 'Meizu'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.4.4'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.4.4'
      OperatingSystemNameVersionMajor      : 'Android 4'
      OperatingSystemVersionBuild          : 'KTU84P'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '33.0'
      LayoutEngineVersionMajor             : '33'
      LayoutEngineNameVersion              : 'Blink 33.0'
      LayoutEngineNameVersionMajor         : 'Blink 33'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '33.0.0.0'
      AgentVersionMajor                    : '33'
      AgentNameVersion                     : 'Chrome Webview 33.0.0.0'
      AgentNameVersionMajor                : 'Chrome Webview 33'
      WebviewAppName                       : 'Alibaba AlipayClient'
      WebviewAppVersion                    : '8.5.3.012601'
      WebviewAppVersionMajor               : '8'
      WebviewAppNameVersion                : 'Alibaba AlipayClient 8.5.3.012601'
      WebviewAppNameVersionMajor           : 'Alibaba AlipayClient 8'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 11_2_6 like Mac OS X; zh-CN) AppleWebKit/537.51.1 (KHTML, like Gecko) Mobile/15D100 UCBrowser/11.9.3.1064 Mobile AliApp(TUnionSDK/0.1.20.2)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15D100'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '11.2.6'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'iOS 11.2.6'
      OperatingSystemNameVersionMajor      : 'iOS 11'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'UCBrowser'
      LayoutEngineVersion                  : '11.9.3.1064'
      LayoutEngineVersionMajor             : '11'
      LayoutEngineNameVersion              : 'UCBrowser 11.9.3.1064'
      LayoutEngineNameVersionMajor         : 'UCBrowser 11'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'UCBrowser'
      AgentVersion                         : '11.9.3.1064'
      AgentVersionMajor                    : '11'
      AgentNameVersion                     : 'UCBrowser 11.9.3.1064'
      AgentNameVersionMajor                : 'UCBrowser 11'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      WebviewAppName                       : 'Alibaba AliApp'
      WebviewAppVersion                    : '0.1.20.2'
      WebviewAppVersionMajor               : '0'
      WebviewAppNameVersion                : 'Alibaba AliApp 0.1.20.2'
      WebviewAppNameVersionMajor           : 'Alibaba AliApp 0'


# According to https://twitter.com/dannysullivan/status/1092531647319142400
# A new Google useragent spotted named google-speakr - @JohnMu or @dannysullivan any ideas what this is? https://www.seroundtable.com/new-google-useragent-google-speakr-27056.html …  via @VorticonCmdr and @gfiorelli1
# That's an useragent used when Google Go fetches a page to make sure it has the most up-to-date information before it translates it to read aloud. We'll see about adding documentation. More info here: https://www.blog.google/technology/next-billion-users/make-google-read-it/

# "Today, we’re launching a new feature which will let everyone using Google Go’s browser listen to webpages out loud."

- test:
    input:
      user_agent_string: 'google-speakr'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Google Read Aloud'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Google Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Google Cloud ??'
      OperatingSystemNameVersionMajor      : 'Google Cloud ??'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Google Read Aloud'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Google Read Aloud ??'
      LayoutEngineNameVersionMajor         : 'Google Read Aloud ??'
      AgentClass                           : 'Robot'
      AgentName                            : 'Google Read Aloud'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'Google Read Aloud ??'
      AgentNameVersionMajor                : 'Google Read Aloud ??'


- test:
    input:
      user_agent_string: 'GeenStijlAndroidApp/2.0'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Android ??'
      OperatingSystemNameVersionMajor      : 'Android ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'GeenStijlAndroidApp'
      AgentVersion                         : '2.0'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'GeenStijlAndroidApp 2.0'
      AgentNameVersionMajor                : 'GeenStijlAndroidApp 2'

- test:
    input:
      user_agent_string: 'SafeBrowser/1.11.0.38 CFNetwork/974.2.1 Darwin/18.0.0'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Apple iOS Device'
      DeviceBrand                          : 'Apple'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '12.0'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'iOS 12.0'
      OperatingSystemNameVersionMajor      : 'iOS 12'
      LayoutEngineClass                    : 'Mobile App'
      LayoutEngineName                     : 'SafeBrowser'
      LayoutEngineVersion                  : '1.11.0.38'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'SafeBrowser 1.11.0.38'
      LayoutEngineNameVersionMajor         : 'SafeBrowser 1'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'SafeBrowser'
      AgentVersion                         : '1.11.0.38'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'SafeBrowser 1.11.0.38'
      AgentNameVersionMajor                : 'SafeBrowser 1'

#
# This is used by iOS to know which app to call for which URL.
# https://shinesolutions.com/2017/06/15/universal-linking-a-few-things-to-be-prepared-for/
#
- matcher:
    require:
    - 'agent.(1)product.name="swcd"'
    extract:
    - 'LayoutEngineClass                   :      100 : "<<<null>>>"' # This thing downloads a single specific Json file.
    - 'LayoutEngineName                    :      100 : "<<<null>>>"'
    - 'LayoutEngineVersion                 :      100 : "<<<null>>>"'
    - 'AgentClass                          :      100 : "Special"'
    - 'AgentName                           :      100 : "Apple iOS Universal Links updater"'
    - 'AgentVersion                        :      100 : agent.product.name="Darwin"^.version'

- test:
    input:
      user_agent_string: 'swcd (unknown version) CFNetwork/758.5.3 Darwin/15.6.0'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Apple iOS Device'
      DeviceBrand                          : 'Apple'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '9.3.3'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'iOS 9.3.3'
      OperatingSystemNameVersionMajor      : 'iOS 9'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Special'
      AgentName                            : 'Apple iOS Universal Links updater'
      AgentVersion                         : '15.6.0'
      AgentVersionMajor                    : '15'
      AgentNameVersion                     : 'Apple iOS Universal Links updater 15.6.0'
      AgentNameVersionMajor                : 'Apple iOS Universal Links updater 15'


- matcher:
    extract:
    - 'AgentClass                          :      100 :"Mobile App"'
    - 'AgentName                           :      100 : "EmbeddedBrowser"'
    - 'AgentVersion                        :      100 : agent.product.name="EmbeddedBrowser"^.(2)version'

- matcher:
    variable:
    - 'Product                             :agent.(1-3)product.version="EmbeddedBrowser"^'
    extract:
    - 'AgentClass                          :      100 :"Mobile App"'
    - 'AgentName                           :      100 : Concat["EmbeddedBrowser ";@Product.name]'
    - 'AgentVersion                        :      100 : "<<<null>>>"'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 9_3_3 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13G34 EmbeddedBrowser/Delfi/440 DELFI'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '13G34'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '9.3.3'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'iOS 9.3.3'
      OperatingSystemNameVersionMajor      : 'iOS 9'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '601.1.46'
      LayoutEngineVersionMajor             : '601'
      LayoutEngineNameVersion              : 'AppleWebKit 601.1.46'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 601'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'EmbeddedBrowser'
      AgentVersion                         : '440'
      AgentVersionMajor                    : '440'
      AgentNameVersion                     : 'EmbeddedBrowser 440'
      AgentNameVersionMajor                : 'EmbeddedBrowser 440'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 LaProvince/ EmbeddedBrowser (iPhone; CPU iPhone OS 10_3_3 like Mac OS X) AppleWebKit/603.3.8 (KHTML, like Gecko) Mobile/14G60 DeviceUID: 6835ACD1-B86D-4687-AA67-3DD24B1952EB'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '14G60'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '10.3.3'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'iOS 10.3.3'
      OperatingSystemNameVersionMajor      : 'iOS 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '603.3.8'
      LayoutEngineVersionMajor             : '603'
      LayoutEngineNameVersion              : 'AppleWebKit 603.3.8'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 603'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'EmbeddedBrowser LaProvince'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'EmbeddedBrowser LaProvince ??'
      AgentNameVersionMajor                : 'EmbeddedBrowser LaProvince ??'
      AgentUuid                            : '6835ACD1-B86D-4687-AA67-3DD24B1952EB'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 NordEclair/ EmbeddedBrowser (iPhone; CPU iPhone OS 12_3_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148 DeviceUID: 4AEB9FB8-F815-4150-9B25-7CAED49F185C'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15E148'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '12.3.1'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'iOS 12.3.1'
      OperatingSystemNameVersionMajor      : 'iOS 12'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'EmbeddedBrowser NordEclair'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'EmbeddedBrowser NordEclair ??'
      AgentNameVersionMajor                : 'EmbeddedBrowser NordEclair ??'
      AgentUuid                            : '4AEB9FB8-F815-4150-9B25-7CAED49F185C'


- matcher:
    require:
    - 'IsNull[agent.(1)product.name="Mozilla"]'
    - 'agent.(2)product.name="Mozilla"'
    - 'agent.(2)product.version="5.0"'
    - 'agent.product.name="EmbeddedBrowser"'
    extract:
    - 'AgentClass                          :      100 : "Mobile App"'
    - 'AgentName                           :      100 : agent.(1)product.name'
    - 'AgentVersion                        :      100 : agent.(1)product.version'


- matcher:
    variable:
    - 'EmbeddedBrowser                     :agent.product.name="EmbeddedBrowser"'
    extract:
    - 'AgentUuid                           :      100 : @EmbeddedBrowser^.version.(1)keyvalue.(2)uuid'


- test:
    input:
      user_agent_string: '15min/3.2.18 Mozilla/5.0 (iPhone; CPU iPhone OS 13_1_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148 EmbeddedBrowser DeviceUID: 4111C299-2E0A-430D-994A-E63AC824065F'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15E148'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '13.1.1'
      OperatingSystemVersionMajor          : '13'
      OperatingSystemNameVersion           : 'iOS 13.1.1'
      OperatingSystemNameVersionMajor      : 'iOS 13'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Mobile App'
      AgentName                            : '15MIN'
      AgentVersion                         : '3.2.18'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : '15MIN 3.2.18'
      AgentNameVersionMajor                : '15MIN 3'
      AgentUuid                            : '4111C299-2E0A-430D-994A-E63AC824065F'


- test:
    input:
      user_agent_string: 'Autoplius.lt/4.4.0 Mozilla/5.0 (iPhone; CPU iPhone OS 12_4_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148 EmbeddedBrowser DeviceUID: CEDA6E92-1204-4630-BA16-61871A213A10'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15E148'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '12.4.1'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'iOS 12.4.1'
      OperatingSystemNameVersionMajor      : 'iOS 12'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Autoplius.lt'
      AgentVersion                         : '4.4.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Autoplius.lt 4.4.0'
      AgentNameVersionMajor                : 'Autoplius.lt 4'
      AgentInformationUrl                  : 'Autoplius.lt'
      AgentUuid                            : 'CEDA6E92-1204-4630-BA16-61871A213A10'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 HLNApp/4.8.6.1 EmbeddedBrowser (iPhone; CPU iPhone OS 12_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/16B92 DeviceUID: 1E0EE834-D7CB-4B6F-A5B7-50555D41A7AB'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '16B92'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '12.1'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'iOS 12.1'
      OperatingSystemNameVersionMajor      : 'iOS 12'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Browser'
      AgentName                            : 'HLNApp'
      AgentVersion                         : '4.8.6.1'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'HLNApp 4.8.6.1'
      AgentNameVersionMajor                : 'HLNApp 4'
      AgentUuid                            : '1E0EE834-D7CB-4B6F-A5B7-50555D41A7AB'


- matcher:
    require:
    - 'agent.(1)product.name[1]="ntvmobil"'
    - 'agent.(2)product.name="Mozilla"'
    - 'agent.(2)product.version="5.0"'
    extract:
    - 'AgentClass                          :      100 : "Mobile App"'
    - 'AgentName                           :      100 : "ntvmobil"'
    - 'AgentVersion                        :      100 : "<<<null>>>"'


  ## Really special with json part.
- test:
    input:
      user_agent_string: 'ntvmobil iPhone 7.0 Mozilla/5.0 (iPhone; U; CPU iPhone OS like Mac OS X; de-DE) AppleWebKit/600.1.4 (KHTML, like Gecko) Version/8.0 Mobile/12F70 Safari/600.1.4 ntvAgof (agof={\""angebot\"":\""appntv\"",\""plattform\"":\""iphone\""}) ntvPrivacy (allowed={\""adTracking\"":true,\""agof\"":true,\""googleanalytics\"":true,\""medienGruppenCookie\"":true,\""linkpulse\"":true,\""adjust\"":true})'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'iOS ??'
      OperatingSystemNameVersionMajor      : 'iOS ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '600.1.4'
      LayoutEngineVersionMajor             : '600'
      LayoutEngineNameVersion              : 'AppleWebKit 600.1.4'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 600'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Ntvmobil'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'Ntvmobil ??'
      AgentNameVersionMajor                : 'Ntvmobil ??'
      AgentLanguage                        : 'German (Germany)'
      AgentLanguageCode                    : 'de-de'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      user_agent_string: '"ntvmobil iPhone 7.1 Mozilla/5.0 (iPhone; U; CPU iPhone OS like Mac OS X; de-DE) AppleWebKit/600.1.4 (KHTML, like Gecko) Version/8.0 Mobile/12F70 Safari/600.1.4 ntvAgof (agof={\""angebot\"":\""appntv\"",\""plattform\"":\""iphone\""}) ntvPrivacy (allowed={\""adTracking\"":true,\""agof\"":true,\""googleanalytics\"":true,\""medienGruppenCookie\"":true,\""linkpulse\"":true,\""adjust\"":true})"'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'iOS ??'
      OperatingSystemNameVersionMajor      : 'iOS ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '600.1.4'
      LayoutEngineVersionMajor             : '600'
      LayoutEngineNameVersion              : 'AppleWebKit 600.1.4'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 600'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Ntvmobil'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'Ntvmobil ??'
      AgentNameVersionMajor                : 'Ntvmobil ??'
      AgentLanguage                        : 'German (Germany)'
      AgentLanguageCode                    : 'de-de'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      user_agent_string: '"ntvmobil iPhone 6.35 Mozilla/5.0 (iPhone; U; CPU iPhone OS like Mac OS X; en-NL) AppleWebKit/600.1.4 (KHTML, like Gecko) Version/8.0 Mobile/12F70 Safari/600.1.4 ntvAgof (agof={\""angebot\"":\""appntv\"",\""plattform\"":\""iphone\""}) ntvPrivacy (allowed={\""adTracking\"":true,\""agof\"":true,\""googleanalytics\"":true,\""medienGruppenCookie\"":true,\""linkpulse\"":true,\""adjust\"":true})"'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'iOS ??'
      OperatingSystemNameVersionMajor      : 'iOS ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '600.1.4'
      LayoutEngineVersionMajor             : '600'
      LayoutEngineNameVersion              : 'AppleWebKit 600.1.4'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 600'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Ntvmobil'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'Ntvmobil ??'
      AgentNameVersionMajor                : 'Ntvmobil ??'
      AgentLanguage                        : 'English (Netherlands)'
      AgentLanguageCode                    : 'en-nl'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      user_agent_string: '"ntvmobil iPhone 6.35 Mozilla/5.0 (iPhone; U; CPU iPhone OS like Mac OS X; de-DE) AppleWebKit/600.1.4 (KHTML, like Gecko) Version/8.0 Mobile/12F70 Safari/600.1.4 ntvAgof (agof={\""angebot\"":\""appntv\"",\""plattform\"":\""iphone\""}) ntvPrivacy (allowed={\""adTracking\"":true,\""agof\"":true,\""googleanalytics\"":true,\""medienGruppenCookie\"":true,\""linkpulse\"":true,\""adjust\"":true})"'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'iOS ??'
      OperatingSystemNameVersionMajor      : 'iOS ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '600.1.4'
      LayoutEngineVersionMajor             : '600'
      LayoutEngineNameVersion              : 'AppleWebKit 600.1.4'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 600'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Ntvmobil'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'Ntvmobil ??'
      AgentNameVersionMajor                : 'Ntvmobil ??'
      AgentLanguage                        : 'German (Germany)'
      AgentLanguageCode                    : 'de-de'
      AgentSecurity                        : 'Strong security'


- matcher:
    variable:
    - 'GMMClient:agent.(4)product.(1)name="GmmClient:google_ios"^'
    extract:
    - 'AgentClass                          :      100 : "Browser Webview"'
    - 'WebviewAppName                      :      100 : @GMMClient.(1)version'
    - 'WebviewAppVersion                   :      100 : @GMMClient.(2)version'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; U; CPU iPhone OS 12.4.1; en_US; ) AppleWebKit/0.0 (KHTML, like Gecko) Version/0.0; GmmClient:google_ios/com.google.Maps/5.27.8/Mobile/ios:iPhone10,5/iOS-AppStore'
    #    - 'agent.(4)product="GmmClient:google_ios/com.google.Maps/5.27.8/"'
    #    - 'agent.(4)product.(1)name.(1)keyvalue="GmmClient:google_ios"'
    #    - 'agent.(4)product.(1)name="GmmClient:google_ios"'
    #    - 'agent.(4)product.(1)name.(1)keyvalue.(1)key="GmmClient"'
    #    - 'agent.(4)product.(1)name.(1)keyvalue.(2)text="google_ios"'
    #    - 'agent.(4)product.(1)version="com.google.Maps"'
    #    - 'agent.(4)product.(2)version="5.27.8"'
    #    - 'agent.(5)product="Mobile/ios:iPhone10,5/iOS-AppStore"'
    #    - 'agent.(5)product.(1)name="Mobile"'
    #    - 'agent.(5)product.(1)version="ios:iPhone10,5"'
    #    - 'agent.(5)product.(1)version.(1)keyvalue="ios:iPhone10,5"'
    #    - 'agent.(5)product.(1)version.(1)keyvalue.(1)key="ios"'
    #    - 'agent.(5)product.(1)version.(1)keyvalue.(1)version="iPhone10,5"'
    #    - 'agent.(5)product.(2)version="iOS-AppStore"'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone 8 Plus (A1897)'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '12.4.1'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'iOS 12.4.1'
      OperatingSystemNameVersionMajor      : 'iOS 12'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '0.0'
      LayoutEngineVersionMajor             : '0'
      LayoutEngineNameVersion              : 'AppleWebKit 0.0'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 0'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'UIWebView'
      AgentVersion                         : '0.0'
      AgentVersionMajor                    : '0'
      AgentNameVersion                     : 'UIWebView 0.0'
      AgentNameVersionMajor                : 'UIWebView 0'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'
      WebviewAppName                       : 'com.google.Maps'
      WebviewAppVersion                    : '5.27.8'
      WebviewAppVersionMajor               : '5'
      WebviewAppNameVersion                : 'com.google.Maps 5.27.8'
      WebviewAppNameVersionMajor           : 'com.google.Maps 5'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; U; CPU iPhone OS 12.2; en_US; ) AppleWebKit/0.0 (KHTML, like Gecko) Version/0.0; GmmClient:google_ios/com.google.Maps/5.15.11/Mobile/ios:iPhone11,8/iOS-AppStore'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone XR'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '12.2'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'iOS 12.2'
      OperatingSystemNameVersionMajor      : 'iOS 12'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '0.0'
      LayoutEngineVersionMajor             : '0'
      LayoutEngineNameVersion              : 'AppleWebKit 0.0'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 0'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'UIWebView'
      AgentVersion                         : '0.0'
      AgentVersionMajor                    : '0'
      AgentNameVersion                     : 'UIWebView 0.0'
      AgentNameVersionMajor                : 'UIWebView 0'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'
      WebviewAppName                       : 'com.google.Maps'
      WebviewAppVersion                    : '5.15.11'
      WebviewAppVersionMajor               : '5'
      WebviewAppNameVersion                : 'com.google.Maps 5.15.11'
      WebviewAppNameVersionMajor           : 'com.google.Maps 5'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; U; CPU iPhone OS 11.4; en_US; ) AppleWebKit/0.0 (KHTML, like Gecko) Version/0.0; GmmClient:google_ios/com.google.Maps/4.53.3/Mobile/ios:iPhone10,6/iOS-AppStore'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone X (A1901)'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '11.4'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'iOS 11.4'
      OperatingSystemNameVersionMajor      : 'iOS 11'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '0.0'
      LayoutEngineVersionMajor             : '0'
      LayoutEngineNameVersion              : 'AppleWebKit 0.0'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 0'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'UIWebView'
      AgentVersion                         : '0.0'
      AgentVersionMajor                    : '0'
      AgentNameVersion                     : 'UIWebView 0.0'
      AgentNameVersionMajor                : 'UIWebView 0'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'
      WebviewAppName                       : 'com.google.Maps'
      WebviewAppVersion                    : '4.53.3'
      WebviewAppVersionMajor               : '4'
      WebviewAppNameVersion                : 'com.google.Maps 4.53.3'
      WebviewAppNameVersionMajor           : 'com.google.Maps 4'


- test:
    input: # QR Scanner app
      user_agent_string: 'ZXing (Android)'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Android Mobile'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Android ??'
      OperatingSystemNameVersionMajor      : 'Android ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Special'
      AgentName                            : 'ZXing'
      AgentVersion                         : 'Android'
      AgentVersionMajor                    : 'Android'
      AgentNameVersion                     : 'ZXing Android'
      AgentNameVersionMajor                : 'ZXing Android'


# =========================================
# Some testcases that are NOT BlackBerry
# =========================================

- test: # Constructed test case
    input:
      user_agent_string: 'LeapApp-AppStore/4.75.0.1 CFNetwork/1107.1 Darwin/19.0.0'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Apple iOS Device'
      DeviceBrand                          : 'Apple'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '13.0'
      OperatingSystemVersionMajor          : '13'
      OperatingSystemNameVersion           : 'iOS 13.0'
      OperatingSystemNameVersionMajor      : 'iOS 13'
      LayoutEngineClass                    : 'Mobile App'
      LayoutEngineName                     : 'LeapApp-AppStore'
      LayoutEngineVersion                  : '4.75.0.1'
      LayoutEngineVersionMajor             : '4'
      LayoutEngineNameVersion              : 'LeapApp-AppStore 4.75.0.1'
      LayoutEngineNameVersionMajor         : 'LeapApp-AppStore 4'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'LeapApp-AppStore'
      AgentVersion                         : '4.75.0.1'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'LeapApp-AppStore 4.75.0.1'
      AgentNameVersionMajor                : 'LeapApp-AppStore 4'


- test: # Constructed test case
    input:
      user_agent_string: 'App/1.57.0.1 (iPad4,4; iOS 12.4.2) LeapLMN/36.2.0 LeapHTTPClient/8.0.2'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Apple iPad'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPad mini 2 (Wi-Fi)'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '12.4.2'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'iOS 12.4.2'
      OperatingSystemNameVersionMajor      : 'iOS 12'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Special'
      AgentName                            : 'App'
      AgentVersion                         : '1.57.0.1'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'App 1.57.0.1'
      AgentNameVersionMajor                : 'App 1'



- test: # Constructed test case
    input:
      user_agent_string: 'Leap/5.9.0 DashVideoOnDemandMediaDecoder/0.0.7 leapExoPlayer/0.0.5'
    expected:
      DeviceClass                          : 'Unknown'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Unknown'
      OperatingSystemName                  : 'Unknown'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Unknown ??'
      OperatingSystemNameVersionMajor      : 'Unknown ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Special'
      AgentName                            : 'Leap'
      AgentVersion                         : '5.9.0'
      AgentVersionMajor                    : '5'
      AgentNameVersion                     : 'Leap 5.9.0'
      AgentNameVersionMajor                : 'Leap 5'


- test: # Constructed test case
    input:
      user_agent_string: 'LeapAndroid/5.9.0 (110807 uk)'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Android ??'
      OperatingSystemNameVersionMajor      : 'Android ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Special'
      AgentName                            : 'LeapAndroid'
      AgentVersion                         : '5.9.0'
      AgentVersionMajor                    : '5'
      AgentNameVersion                     : 'LeapAndroid 5.9.0'
      AgentNameVersionMajor                : 'LeapAndroid 5'
      AgentLanguage                        : 'Ukrainian'
      AgentLanguageCode                    : 'uk'


- test:
    input:
      user_agent_string: 'BBCNewsAndroid/5.9.0 (110807)'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Android ??'
      OperatingSystemNameVersionMajor      : 'Android ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Special'
      AgentName                            : 'BBCNewsAndroid'
      AgentVersion                         : '5.9.0'
      AgentVersionMajor                    : '5'
      AgentNameVersion                     : 'BBCNewsAndroid 5.9.0'
      AgentNameVersionMajor                : 'BBCNewsAndroid 5'


- test:
    input:
      user_agent_string: 'iPlayerKids/1.57.0.1 (iPad4,4; iOS 12.4.2) BBCSMP/36.2.0 BBCHTTPClient/8.0.2'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Apple iPad'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPad mini 2 (Wi-Fi)'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '12.4.2'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'iOS 12.4.2'
      OperatingSystemNameVersionMajor      : 'iOS 12'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Special'
      AgentName                            : 'iPlayerKids'
      AgentVersion                         : '1.57.0.1'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'iPlayerKids 1.57.0.1'
      AgentNameVersionMajor                : 'iPlayerKids 1'


- test:
    input:
      user_agent_string: 'BBCiPlayer/4.75.0.1 (iPad2,5; iPhone OS 9.3.5) BBCSMP/36.2.0 BBCHTTPClient/8.0.2'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Apple iPad'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPad mini (Wi-Fi)'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '9.3.5'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'iOS 9.3.5'
      OperatingSystemNameVersionMajor      : 'iOS 9'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Special'
      AgentName                            : 'BBCiPlayer'
      AgentVersion                         : '4.75.0.1'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'BBCiPlayer 4.75.0.1'
      AgentNameVersionMajor                : 'BBCiPlayer 4'


- test:
    input:
      user_agent_string: 'BBCiPlayer-AppStore/4.75.0.1 CFNetwork/1107.1 Darwin/19.0.0'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Apple iOS Device'
      DeviceBrand                          : 'Apple'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '13.0'
      OperatingSystemVersionMajor          : '13'
      OperatingSystemNameVersion           : 'iOS 13.0'
      OperatingSystemNameVersionMajor      : 'iOS 13'
      LayoutEngineClass                    : 'Mobile App'
      LayoutEngineName                     : 'BBCiPlayer-AppStore'
      LayoutEngineVersion                  : '4.75.0.1'
      LayoutEngineVersionMajor             : '4'
      LayoutEngineNameVersion              : 'BBCiPlayer-AppStore 4.75.0.1'
      LayoutEngineNameVersionMajor         : 'BBCiPlayer-AppStore 4'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'BBCiPlayer-AppStore'
      AgentVersion                         : '4.75.0.1'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'BBCiPlayer-AppStore 4.75.0.1'
      AgentNameVersionMajor                : 'BBCiPlayer-AppStore 4'

- test:
    input:
      user_agent_string: 'BBCNewsAndroid/5.9.0 DashVideoOnDemandMediaDecoder/0.0.7 bbcExoPlayer/0.0.5 (Android 9)'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Android Mobile'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '9'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'Android 9'
      OperatingSystemNameVersionMajor      : 'Android 9'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Special'
      AgentName                            : 'BBCNewsAndroid'
      AgentVersion                         : '5.9.0'
      AgentVersionMajor                    : '5'
      AgentNameVersion                     : 'BBCNewsAndroid 5.9.0'
      AgentNameVersionMajor                : 'BBCNewsAndroid 5'

- test:
    input:
      user_agent_string: 'BBC News Android 4.7.1.29/107998 uk smpAndroid/29.4535-dev (android_os/4.4.4)'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Android Mobile'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.4.4'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.4.4'
      OperatingSystemNameVersionMajor      : 'Android 4'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Special'
      AgentName                            : 'BBC News Android'
      AgentVersion                         : '4.7.1.29'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'BBC News Android 4.7.1.29'
      AgentNameVersionMajor                : 'BBC News Android 4'

- test:
    input:
      user_agent_string: 'BBCiPlayerRadio-International/2.15.7.11054 (SM-G930F; Android 8.0.0)'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Samsung SM-G930F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '8.0.0'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Android 8.0.0'
      OperatingSystemNameVersionMajor      : 'Android 8'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Special'
      AgentName                            : 'BBCiPlayerRadio-International'
      AgentVersion                         : '2.15.7.11054'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'BBCiPlayerRadio-International 2.15.7.11054'
      AgentNameVersionMajor                : 'BBCiPlayerRadio-International 2'


- test:
    input:
      user_agent_string: 'BBCNews/172 (iPhone10,4; iOS 13.1.3) BBCSMP/36.1.0 BBCHTTPClient/7.1.1'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone 8 (A1905)'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '13.1.3'
      OperatingSystemVersionMajor          : '13'
      OperatingSystemNameVersion           : 'iOS 13.1.3'
      OperatingSystemNameVersionMajor      : 'iOS 13'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Special'
      AgentName                            : 'BBCNews'
      AgentVersion                         : '172'
      AgentVersionMajor                    : '172'
      AgentNameVersion                     : 'BBCNews 172'
      AgentNameVersionMajor                : 'BBCNews 172'

- test:
    input:
      user_agent_string: 'BBCiPlayer-Kids-AppStore/1.57.0.1 CFNetwork/978.0.7 Darwin/18.7.0'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Apple iOS Device'
      DeviceBrand                          : 'Apple'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '12.?'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'iOS 12.?'
      OperatingSystemNameVersionMajor      : 'iOS 12'
      LayoutEngineClass                    : 'Mobile App'
      LayoutEngineName                     : 'BBCiPlayer-Kids-AppStore'
      LayoutEngineVersion                  : '1.57.0.1'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'BBCiPlayer-Kids-AppStore 1.57.0.1'
      LayoutEngineNameVersionMajor         : 'BBCiPlayer-Kids-AppStore 1'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'BBCiPlayer-Kids-AppStore'
      AgentVersion                         : '1.57.0.1'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'BBCiPlayer-Kids-AppStore 1.57.0.1'
      AgentNameVersionMajor                : 'BBCiPlayer-Kids-AppStore 1'

- test:
    input:
      user_agent_string: 'bbcmediaplayer/3.1.12 (sm-g960f; Android 9) AdobeAIR/23.0.0.246'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Samsung SM-G960F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '9'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'Android 9'
      OperatingSystemNameVersionMajor      : 'Android 9'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Special'
      AgentName                            : 'Bbcmediaplayer'
      AgentVersion                         : '3.1.12'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Bbcmediaplayer 3.1.12'
      AgentNameVersionMajor                : 'Bbcmediaplayer 3'

- test:
    input:
      user_agent_string: 'BBCSounds/1.13.2 (SM-G950F; Android 9) smpAndroid/38.1.0 (android_os/9)'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Samsung SM-G950F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '9'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'Android 9'
      OperatingSystemNameVersionMajor      : 'Android 9'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Special'
      AgentName                            : 'BBCSounds'
      AgentVersion                         : '1.13.2'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'BBCSounds 1.13.2'
      AgentNameVersionMajor                : 'BBCSounds 1'

# ===========================
# The useragent created by the https://www.mytheresa.com/ App.

- matcher:
    require:
    - 'agent.product.name="mythapp"'
    - 'IsNull[agent.product.name="Chrome"]'
    extract:
    - 'AgentClass                          :       42 :"Browser Webview"'
    - 'AgentName                           :       42 :"UIWebView"'
    - 'WebviewAppName                      :        1 :"Mytheresa App"'
    - 'WebviewAppVersion                   :        1 :agent.product.name="mythapp"^.comments.(1)entry'

- matcher:
    require:
    - 'agent.product.name="mythapp"'
    - 'agent.product.name="Chrome"'
    extract:
    - 'AgentClass                          :       42 :"Browser Webview"'
    - 'AgentName                           :       42 :"Chrome Webview"'
    - 'WebviewAppName                      :        1 :"Mytheresa App"'
    - 'WebviewAppVersion                   :        1 :agent.product.name="mythapp"^.comments.(1)entry'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 9; SM-N960N Build/PPR1.180610.011; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/79.0.3945.93 Mobile Safari/537.36 mythapp (3.9.0 build 201905272; samsung SM-N960N; ko_KR; Android 9)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung SM-N960N'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '9'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'Android 9'
      OperatingSystemNameVersionMajor      : 'Android 9'
      OperatingSystemVersionBuild          : 'PPR1.180610.011'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '79.0'
      LayoutEngineVersionMajor             : '79'
      LayoutEngineNameVersion              : 'Blink 79.0'
      LayoutEngineNameVersionMajor         : 'Blink 79'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '79.0.3945.93'
      AgentVersionMajor                    : '79'
      AgentNameVersion                     : 'Chrome Webview 79.0.3945.93'
      AgentNameVersionMajor                : 'Chrome Webview 79'
      AgentLanguage                        : 'Korean (South Korea)'
      AgentLanguageCode                    : 'ko-kr'
      WebviewAppName                       : 'Mytheresa App'
      WebviewAppVersion                    : '3.9.0 build 201905272'
      WebviewAppVersionMajor               : '3'
      WebviewAppNameVersion                : 'Mytheresa App 3.9.0 build 201905272'
      WebviewAppNameVersionMajor           : 'Mytheresa App 3'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 13_1_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148 mythapp (2.12.2 build 2110016; iPhone 7; en-US; iOS 13.1.2)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15E148'
      DeviceVersion                        : '7'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '13.1.2'
      OperatingSystemVersionMajor          : '13'
      OperatingSystemNameVersion           : 'iOS 13.1.2'
      OperatingSystemNameVersionMajor      : 'iOS 13'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'UIWebView'
      AgentVersion                         : '605.1.15'
      AgentVersionMajor                    : '605'
      AgentNameVersion                     : 'UIWebView 605.1.15'
      AgentNameVersionMajor                : 'UIWebView 605'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      WebviewAppName                       : 'Mytheresa App'
      WebviewAppVersion                    : '2.12.2 build 2110016'
      WebviewAppVersionMajor               : '2'
      WebviewAppNameVersion                : 'Mytheresa App 2.12.2 build 2110016'
      WebviewAppNameVersionMajor           : 'Mytheresa App 2'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 9; SM-G955F Build/PPR1.180610.011; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/78.0.3904.62 Mobile Safari/537.36 mythapp (4.0.21.202000013 build 202000013 react-native; samsung SM-G955F; null; Android 9)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung SM-G955F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '9'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'Android 9'
      OperatingSystemNameVersionMajor      : 'Android 9'
      OperatingSystemVersionBuild          : 'PPR1.180610.011'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '78.0'
      LayoutEngineVersionMajor             : '78'
      LayoutEngineNameVersion              : 'Blink 78.0'
      LayoutEngineNameVersionMajor         : 'Blink 78'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '78.0.3904.62'
      AgentVersionMajor                    : '78'
      AgentNameVersion                     : 'Chrome Webview 78.0.3904.62'
      AgentNameVersionMajor                : 'Chrome Webview 78'
      WebviewAppName                       : 'Mytheresa App'
      WebviewAppVersion                    : '4.0.21.202000013 build 202000013 react-native'
      WebviewAppVersionMajor               : '4'
      WebviewAppNameVersion                : 'Mytheresa App 4.0.21.202000013 build 202000013 react-native'
      WebviewAppNameVersionMajor           : 'Mytheresa App 4'


- matcher:
    require:
    - 'agent.(1)product.(1)name="bol.com"'
    extract:
    - 'AgentClass                          :      100 : "Mobile App"'

- test:
    input:
      user_agent_string: 'Bol.com/1.2.3 (Android 9; SM-G955F; Phone)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung SM-G955F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '9'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'Android 9'
      OperatingSystemNameVersionMajor      : 'Android 9'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Bol.com'
      AgentVersion                         : '1.2.3'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Bol.com 1.2.3'
      AgentNameVersionMajor                : 'Bol.com 1'
      AgentInformationUrl                  : 'Bol.com'



- test:
    input:
      user_agent_string: 'Bol.com/1.2.3 (Android 9; SM-G955F; Tablet)'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Samsung SM-G955F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '9'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'Android 9'
      OperatingSystemNameVersionMajor      : 'Android 9'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Bol.com'
      AgentVersion                         : '1.2.3'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Bol.com 1.2.3'
      AgentNameVersionMajor                : 'Bol.com 1'
      AgentInformationUrl                  : 'Bol.com'

- test:
    input:
      user_agent_string: 'Bol.com/1.2.3 (iOS 4.5.6; iPad; Tablet)'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Apple iPad'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPad'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '4.5.6'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'iOS 4.5.6'
      OperatingSystemNameVersionMajor      : 'iOS 4'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Bol.com'
      AgentVersion                         : '1.2.3'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Bol.com 1.2.3'
      AgentNameVersionMajor                : 'Bol.com 1'
      AgentInformationUrl                  : 'Bol.com'

- test:
    input:
      user_agent_string: 'Bol.com/1.2.3 (iOS 4.5.6; iPhone; Phone)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '4.5.6'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'iOS 4.5.6'
      OperatingSystemNameVersionMajor      : 'iOS 4'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Bol.com'
      AgentVersion                         : '1.2.3'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Bol.com 1.2.3'
      AgentNameVersionMajor                : 'Bol.com 1'
      AgentInformationUrl                  : 'Bol.com'

- test:
    input:
      user_agent_string: 'Bol.com/3.10.0-461 (Android 9; SM-G955F; Phone; nl_NL )'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung SM-G955F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '9'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'Android 9'
      OperatingSystemNameVersionMajor      : 'Android 9'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Bol.com'
      AgentVersion                         : '3.10.0-461'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Bol.com 3.10.0-461'
      AgentNameVersionMajor                : 'Bol.com 3'
      AgentLanguage                        : 'Dutch (Netherlands)'
      AgentLanguageCode                    : 'nl-nl'
      AgentInformationUrl                  : 'Bol.com'

- test:
    input:
      user_agent_string: 'Bol.com/3.10.0-461 (iOS 10.1.2.3; iPad ; Tablet ; fr_be )'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Apple iPad'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPad'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '10.1.2.3'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'iOS 10.1.2.3'
      OperatingSystemNameVersionMajor      : 'iOS 10'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Bol.com'
      AgentVersion                         : '3.10.0-461'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Bol.com 3.10.0-461'
      AgentNameVersionMajor                : 'Bol.com 3'
      AgentLanguage                        : 'French (Belgium)'
      AgentLanguageCode                    : 'fr-be'
      AgentInformationUrl                  : 'Bol.com'

- matcher:
    require:
    - 'agent.product.(1)comments.(1)entry.(1)text="LinkedInApp"'
    extract:
    - 'WebviewAppName                      :       10 :                   "LinkedIn"'


# 2020-10-20: When clicking on a link in the LinkedIn chat on an iPhone
#             On Android you do not get an annotation indicating the LinkedApp is used.
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 12_4_8 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148 [LinkedInApp]'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15E148'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '12.4.8'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'iOS 12.4.8'
      OperatingSystemNameVersionMajor      : 'iOS 12'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'UIWebView'
      AgentVersion                         : '605.1.15'
      AgentVersionMajor                    : '605'
      AgentNameVersion                     : 'UIWebView 605.1.15'
      AgentNameVersionMajor                : 'UIWebView 605'
      WebviewAppName                       : 'LinkedIn'
      WebviewAppVersion                    : '??'
      WebviewAppVersionMajor               : '??'
      WebviewAppNameVersion                : 'LinkedIn ??'
      WebviewAppNameVersionMajor           : 'LinkedIn ??'


- matcher:
    variable:
    - 'NRC                                 :agent.product.(1)name="nl.nrc.nrcapp"'
    require:
    - '@NRC^.(2)version="iOS"'
    extract:
    - 'OperatingSystemName                 :      200 : "iOS"'
    - 'OperatingSystemVersion              :      200 : @NRC^>.text'
    - 'AgentClass                          :      200 : "Mobile App"'
    - 'AgentName                           :      200 : "NRC Digitale Editie"'
    - 'AgentVersion                        :      200 : @NRC^.version'

- test:
    input:
      user_agent_string: 'iPad (compatible; Smartphone2.0) NRC Digitale Editie, nl.nrc.nrcapp 9.14 (156) / iOS 13.1.2'
      #    - 'agent.(2)product="NRC Digitale Editie, nl.nrc.nrcapp 9.14 (156) / iOS"'
      #    - 'agent.(2)product.(1)name="NRC Digitale Editie, nl.nrc.nrcapp"'
      #    - 'agent.(2)product.(1)version="9.14"'
      #    - 'agent.(2)product.(1)comments="(156)"'
      #    - 'agent.(2)product.(1)comments.(1)entry="156"'
      #    - 'agent.(2)product.(1)comments.(1)entry.(1)text="156"'
      #    - 'agent.(2)product.(2)version="iOS"'
      #    - 'agent.(3)text="13.1.2"'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Apple iPad'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPad'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '13.1.2'
      OperatingSystemVersionMajor          : '13'
      OperatingSystemNameVersion           : 'iOS 13.1.2'
      OperatingSystemNameVersionMajor      : 'iOS 13'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'NRC Digitale Editie'
      AgentVersion                         : '9.14'
      AgentVersionMajor                    : '9'
      AgentNameVersion                     : 'NRC Digitale Editie 9.14'
      AgentNameVersionMajor                : 'NRC Digitale Editie 9'


# https://github.com/Alamofire/Alamofire
# Alamofire is an HTTP networking library written in Swift.
# Essentially this is a library used in iOS apps for connecting to websites/servers.
# A Mac Catalyst app (i.e. an iPad app adapted to run on a Mac) https://developer.apple.com/mac-catalyst/
# They use Alamofire that connects to the outside and fills the User-Agent header.
# https://github.com/Alamofire/Alamofire/blob/master/Source/HTTPHeaders.swift#L409
#        let osNameVersion: String = {
#          let version = ProcessInfo.processInfo.operatingSystemVersion
#          let versionString = "\(version.majorVersion).\(version.minorVersion).\(version.patchVersion)"
#          let osName: String = {
#            #if os(iOS)
#            #if targetEnvironment(macCatalyst)
#            return "macOS(Catalyst)"
#            #else
#            return "iOS"
#            #endif
#            #elseif os(watchOS)
#            return "watchOS"
#            #elseif os(tvOS)
#            return "tvOS"
#            #elseif os(macOS)
#            return "macOS"
#            #elseif os(Linux)
#            return "Linux"
#            #elseif os(Windows)
#            return "Windows"
#            #else
#            return "Unknown"
#          #endif
#        }()
#
#          return "\(osName) \(versionString)"
#      }()
#
#        let alamofireVersion = "Alamofire/\(version)"
#
#        let userAgent = "\(executable)/\(appVersion) (\(bundle); build:\(appBuild); \(osNameVersion)) \(alamofireVersion)"

- lookup:
    name: 'AlamofireOSDeviceMapping'
    map:
      #            Device                                  | Operating System      | Agent
      #            DClass      | DName       | DBrand      | OClass     | OName    | AClass
      "iOS"     : "Mobile|iOS Device|Apple|Mobile|iOS|Mobile App"
      "watchOS" : "Mobile|Apple Watch|Apple|Mobile|Watch OS|Mobile App"
      "tvOS"    : "Set-top box|Apple TV|Apple|Embedded|tv OS|Mobile App"
      "macOS"   : "Desktop|<<<null>>>|Apple|Desktop|Mac OS|Desktop App"
      "Linux"   : "Desktop|<<<null>>>|<<<null>>>|Desktop|Linux|Desktop App"
      "Windows" : "Desktop|<<<null>>>|<<<null>>>|Desktop|Windows|Desktop App"
      "Unknown" : "<<<null>>>|<<<null>>>|<<<null>>>|<<<null>>>|Unknown|<<<null>>>"

- matcher:
    variable:
    - 'Agent: agent.(1)product'
    - 'Bundle: agent.(1)product.(1)comments.(1)entry'
    - 'AgentBuild: agent.(1)product.(1)comments.(2)entry.(1)keyvalue.(1)key="build"^'
    - 'OperatingSystem: agent.(1)product.(1)comments.(3)entry.product'
    - 'Alamofire: agent.(2)product.(1)name="Alamofire"^'
    - 'MappedOS: LookUp[AlamofireOSDeviceMapping;@OperatingSystem.name]'
    extract:
    - 'DeviceClass                   : 10  : @MappedOS[[1]]'
    - 'DeviceName                    : 10  : @MappedOS[[2]]'
    - 'DeviceBrand                   : 10  : @MappedOS[[3]]'
    - 'OperatingSystemClass          : 10  : @MappedOS[[4]]'
    - 'OperatingSystemName           : 10  : @MappedOS[[5]]'
    - 'OperatingSystemVersion        : 10  : @OperatingSystem.version'
    - 'LayoutEngineClass             : 10  : @MappedOS[[6]]'
    - 'AgentClass                    : 10  : @MappedOS[[6]]'
    - 'AgentName                     : 10  : @Agent.name'
    - 'AgentVersion                  : 10  : @Agent.version'
    - 'AgentBuild                    : 10  : @AgentBuild.value'

- matcher:
    variable:
    - 'Agent: agent.(1)product'
    - 'Bundle: agent.(1)product.(1)comments.(1)entry'
    - 'AgentBuild: agent.(1)product.(1)comments.(2)entry.(1)keyvalue.(1)key="build"^'
    - 'OperatingSystem: agent.(1)product.(1)comments.(3)entry.product'
    - 'Alamofire: agent.(2)product.(1)name="Alamofire"^'
    - 'MappedOS: LookUp[AlamofireOSDeviceMapping;@OperatingSystem.name]'
    require:
    - 'IsNull[@OperatingSystem.version]'
    extract:
    - 'DeviceClass                   : 10 : @MappedOS[[1]]'
    - 'DeviceName                    : 10 : @MappedOS[[2]]'
    - 'DeviceBrand                   : 10 : @MappedOS[[3]]'
    - 'OperatingSystemClass          : 10 : @MappedOS[[4]]'
    - 'OperatingSystemName           : 10 : @MappedOS[[5]]'
    # Needed because 'x(y) 1' the 1 is not parsed as the version in a comment entry.
    - 'OperatingSystemVersion        : 10 : @OperatingSystem>'
    - 'LayoutEngineClass             : 10 : @MappedOS[[6]]'
    - 'AgentClass                    : 10 : @MappedOS[[6]]'
    - 'AgentName                     : 10 : @Agent.name'
    - 'AgentVersion                  : 10 : @Agent.version'
    - 'AgentBuild                    : 10 : @AgentBuild.value'


- test:
    input:
      User-Agent: 'Boulanger/22.3.0 (fr.boulanger.Boulanger; build:823; iOS 15.4.1) Alamofire/4.9.1'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Apple iOS Device'
      DeviceBrand                          : 'Apple'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '15.4.1'
      OperatingSystemVersionMajor          : '15'
      OperatingSystemNameVersion           : 'iOS 15.4.1'
      OperatingSystemNameVersionMajor      : 'iOS 15'
      LayoutEngineClass                    : 'Mobile App'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Boulanger'
      AgentVersion                         : '22.3.0'
      AgentVersionMajor                    : '22'
      AgentNameVersion                     : 'Boulanger 22.3.0'
      AgentNameVersionMajor                : 'Boulanger 22'
      AgentBuild                           : '823'


# Note: funky name
- test:
    input:
      User-Agent: 'Le Tour VIP 3D Tracker/1.1.4 (ntt.global.ar.arcycling; build:2020.07.22.01; iOS 15.0.1) Alamofire/4.9.1'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Apple iOS Device'
      DeviceBrand                          : 'Apple'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '15.0.1'
      OperatingSystemVersionMajor          : '15'
      OperatingSystemNameVersion           : 'iOS 15.0.1'
      OperatingSystemNameVersionMajor      : 'iOS 15'
      LayoutEngineClass                    : 'Mobile App'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Le Tour VIP 3D Tracker'
      AgentVersion                         : '1.1.4'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Le Tour VIP 3D Tracker 1.1.4'
      AgentNameVersionMajor                : 'Le Tour VIP 3D Tracker 1'
      AgentBuild                           : '2020.07.22.01'


# Note: space in agent name
- test:
    input:
      User-Agent  : 'Walibi NL/4.0.15 (nl.walibi.corporate; build:254; iOS 15.4.1) Alamofire/5.5.0'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Apple iOS Device'
      DeviceBrand                          : 'Apple'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '15.4.1'
      OperatingSystemVersionMajor          : '15'
      OperatingSystemNameVersion           : 'iOS 15.4.1'
      OperatingSystemNameVersionMajor      : 'iOS 15'
      LayoutEngineClass                    : 'Mobile App'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Walibi NL'
      AgentVersion                         : '4.0.15'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Walibi NL 4.0.15'
      AgentNameVersionMajor                : 'Walibi NL 4'
      AgentBuild                           : '254'


# Note: short name
- test:
    input:
      User-Agent: 'OM/9.0.18 (com.c4mprod.OM; build:499; iOS 15.4.0) Alamofire/5.2.2'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Apple iOS Device'
      DeviceBrand                          : 'Apple'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '15.4.0'
      OperatingSystemVersionMajor          : '15'
      OperatingSystemNameVersion           : 'iOS 15.4.0'
      OperatingSystemNameVersionMajor      : 'iOS 15'
      LayoutEngineClass                    : 'Mobile App'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'OM'
      AgentVersion                         : '9.0.18'
      AgentVersionMajor                    : '9'
      AgentNameVersion                     : 'OM 9.0.18'
      AgentNameVersionMajor                : 'OM 9'
      AgentBuild                           : '499'


# Note: dash in name
- test:
    input:
      User-Agent: 'Beta-LaRedoute/13 (com.Redoute.RedouteIphone.beta; build:1137; iOS 13.2.2) Alamofire/5.2.2'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Apple iOS Device'
      DeviceBrand                          : 'Apple'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '13.2.2'
      OperatingSystemVersionMajor          : '13'
      OperatingSystemNameVersion           : 'iOS 13.2.2'
      OperatingSystemNameVersionMajor      : 'iOS 13'
      LayoutEngineClass                    : 'Mobile App'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Beta-LaRedoute'
      AgentVersion                         : '13'
      AgentVersionMajor                    : '13'
      AgentNameVersion                     : 'Beta-LaRedoute 13'
      AgentNameVersionMajor                : 'Beta-LaRedoute 13'
      AgentBuild                           : '1137'


# Note: multiple spaces in name
- test:
    input:
      User-Agent: 'Walibi NL halloween/4.0.12 (nl.walibi.corporate; build:189; iOS 15.4.1) Alamofire/5.4.4'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Apple iOS Device'
      DeviceBrand                          : 'Apple'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '15.4.1'
      OperatingSystemVersionMajor          : '15'
      OperatingSystemNameVersion           : 'iOS 15.4.1'
      OperatingSystemNameVersionMajor      : 'iOS 15'
      LayoutEngineClass                    : 'Mobile App'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Walibi NL halloween'
      AgentVersion                         : '4.0.12'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Walibi NL halloween 4.0.12'
      AgentNameVersionMajor                : 'Walibi NL halloween 4'
      AgentBuild                           : '189'


# Note: number in name, string in version
- test:
    input:
      User-Agent: 'boulanger-qua1/22.4.0-INFINITY (com.ineatconseil.boulanger.qua; build:827; iOS 15.3.1) Alamofire/5.2.2'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Apple iOS Device'
      DeviceBrand                          : 'Apple'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '15.3.1'
      OperatingSystemVersionMajor          : '15'
      OperatingSystemNameVersion           : 'iOS 15.3.1'
      OperatingSystemNameVersionMajor      : 'iOS 15'
      LayoutEngineClass                    : 'Mobile App'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Boulanger-QUA1'
      AgentVersion                         : '22.4.0-INFINITY'
      AgentVersionMajor                    : '22'
      AgentNameVersion                     : 'Boulanger-QUA1 22.4.0-INFINITY'
      AgentNameVersionMajor                : 'Boulanger-QUA1 22'
      AgentBuild                           : '827'


# Note: string in alamofire version
- test:
    input:
      User-Agent: 'LM Recette/7.14.3 (com.leroymerlin.frlm-mob-LeroyMerlinRefonte-ios; build:1050; iOS 15.4.1) Alamofire/5.4.4 LMUser'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Apple iOS Device'
      DeviceBrand                          : 'Apple'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '15.4.1'
      OperatingSystemVersionMajor          : '15'
      OperatingSystemNameVersion           : 'iOS 15.4.1'
      OperatingSystemNameVersionMajor      : 'iOS 15'
      LayoutEngineClass                    : 'Mobile App'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'LM Recette'
      AgentVersion                         : '7.14.3'
      AgentVersionMajor                    : '7'
      AgentNameVersion                     : 'LM Recette 7.14.3'
      AgentNameVersionMajor                : 'LM Recette 7'
      AgentBuild                           : '1050'


# Note: dots in build
- test:
    input:
      User-Agent: 'Boulanger/20.3.1 (fr.boulanger.Boulanger; build:20.3.1.592; iOS 15.4.1) Alamofire/4.9.1'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Apple iOS Device'
      DeviceBrand                          : 'Apple'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '15.4.1'
      OperatingSystemVersionMajor          : '15'
      OperatingSystemNameVersion           : 'iOS 15.4.1'
      OperatingSystemNameVersionMajor      : 'iOS 15'
      LayoutEngineClass                    : 'Mobile App'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Boulanger'
      AgentVersion                         : '20.3.1'
      AgentVersionMajor                    : '20'
      AgentNameVersion                     : 'Boulanger 20.3.1'
      AgentNameVersionMajor                : 'Boulanger 20'
      AgentBuild                           : '20.3.1.592'

# https://apps.apple.com/jp/app/yahoo-japan/id299147843
# https://www.ifreeware.net/download-jp-co-yahoo-ipn-appli.html : Yahoo! JAPAN for iPhone is a news app specially designed to be fully-featured entertainment app.
- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (iPhone; CPU iPhone OS 15_4_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148 YJApp-IOS jp.co.yahoo.ipn.appli/4.61.0'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15E148'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '15.4.1'
      OperatingSystemVersionMajor          : '15'
      OperatingSystemNameVersion           : 'iOS 15.4.1'
      OperatingSystemNameVersionMajor      : 'iOS 15'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Yahoo! JAPAN'
      AgentVersion                         : '4.61.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Yahoo! JAPAN 4.61.0'
      AgentNameVersionMajor                : 'Yahoo! JAPAN 4'

# On iPad
- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (iPad; CPU OS 14_7_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148 YJApp-IOS jp.co.yahoo.ipn.appli/4.47.0'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Apple iPad'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15E148'
      DeviceVersion                        : 'iPad'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '14.7.1'
      OperatingSystemVersionMajor          : '14'
      OperatingSystemNameVersion           : 'iOS 14.7.1'
      OperatingSystemNameVersionMajor      : 'iOS 14'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Yahoo! JAPAN'
      AgentVersion                         : '4.47.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Yahoo! JAPAN 4.47.0'
      AgentNameVersionMajor                : 'Yahoo! JAPAN 4'



# https://www.plus-a.net/tools/user_agent_list/?q=YJApp-
# https://play.google.com/store/apps/details?id=jp.co.yahoo.android.yjtop&hl=en&gl=US
- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (Linux; Android 10; SC-03L Build/QP1A.190711.020; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/80.0.3987.162 Mobile Safari/537.36 YJApp-ANDROID jp.co.yahoo.android.yjtop/3.66.1'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung SC-03L'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '10'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Android 10'
      OperatingSystemNameVersionMajor      : 'Android 10'
      OperatingSystemVersionBuild          : 'QP1A.190711.020'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '80.0'
      LayoutEngineVersionMajor             : '80'
      LayoutEngineNameVersion              : 'Blink 80.0'
      LayoutEngineNameVersionMajor         : 'Blink 80'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Yahoo! JAPAN'
      AgentVersion                         : '3.66.1'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Yahoo! JAPAN 3.66.1'
      AgentNameVersionMajor                : 'Yahoo! JAPAN 3'

- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (Linux; Android 10; SC-03L Build/QP1A.190711.020; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/87.0.4280.101 Mobile Safari/537.36 YJApp-ANDROID jp.co.yahoo.android.ybrowser/3.8.8.4'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung SC-03L'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '10'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Android 10'
      OperatingSystemNameVersionMajor      : 'Android 10'
      OperatingSystemVersionBuild          : 'QP1A.190711.020'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '87.0'
      LayoutEngineVersionMajor             : '87'
      LayoutEngineNameVersion              : 'Blink 87.0'
      LayoutEngineNameVersionMajor         : 'Blink 87'
      AgentClass                           : 'Browser'
      AgentName                            : 'Yahoo! JAPAN Browser'
      AgentVersion                         : '3.8.8.4'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Yahoo! JAPAN Browser 3.8.8.4'
      AgentNameVersionMajor                : 'Yahoo! JAPAN Browser 3'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (iPhone; CPU iPhone OS 10_2 like Mac OS X) AppleWebKit/602.3.12 (KHTML, like Gecko) Version/10.0 Mobile/14C92 Safari/9537.53 YJApp-IOS jp.co.yahoo.YBrowser/1.0.19.0'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '14C92'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '10.2'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'iOS 10.2'
      OperatingSystemNameVersionMajor      : 'iOS 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '602.3.12'
      LayoutEngineVersionMajor             : '602'
      LayoutEngineNameVersion              : 'AppleWebKit 602.3.12'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 602'
      AgentClass                           : 'Browser'
      AgentName                            : 'Yahoo! JAPAN Browser'
      AgentVersion                         : '1.0.19.0'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Yahoo! JAPAN Browser 1.0.19.0'
      AgentNameVersionMajor                : 'Yahoo! JAPAN Browser 1'


# https://line.me/en/
# https://play.google.com/store/apps/details?id=jp.naver.line.android
# https://apps.apple.com/app/line/id443904275?platform=iphone
- test:
    input:
      User-Agent: 'Mozilla/5.0 (iPhone; CPU iPhone OS 15_4_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148 Safari Line/12.4.0'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15E148'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '15.4.1'
      OperatingSystemVersionMajor          : '15'
      OperatingSystemNameVersion           : 'iOS 15.4.1'
      OperatingSystemNameVersionMajor      : 'iOS 15'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Line'
      AgentVersion                         : '12.4.0'
      AgentVersionMajor                    : '12'
      AgentNameVersion                     : 'Line 12.4.0'
      AgentNameVersionMajor                : 'Line 12'


- test:
    input:
      User-Agent: 'Mozilla/5.0 (Linux; Android 11; SM-A025F Build/RP1A.200720.012; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/100.0.4896.127 Mobile Safari/537.36 Line/12.6.1/IAB'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung SM-A025F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '11'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'Android 11'
      OperatingSystemNameVersionMajor      : 'Android 11'
      OperatingSystemVersionBuild          : 'RP1A.200720.012'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '100.0'
      LayoutEngineVersionMajor             : '100'
      LayoutEngineNameVersion              : 'Blink 100.0'
      LayoutEngineNameVersionMajor         : 'Blink 100'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '100.0.4896.127'
      AgentVersionMajor                    : '100'
      AgentNameVersion                     : 'Chrome Webview 100.0.4896.127'
      AgentNameVersionMajor                : 'Chrome Webview 100'
      WebviewAppName                       : 'Line'
      WebviewAppVersion                    : '12.6.1'
      WebviewAppVersionMajor               : '12'
      WebviewAppNameVersion                : 'Line 12.6.1'
      WebviewAppNameVersionMajor           : 'Line 12'



- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (iPad; CPU OS 15_0_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148 Safari Line/12.3.0'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Apple iPad'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15E148'
      DeviceVersion                        : 'iPad'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '15.0.2'
      OperatingSystemVersionMajor          : '15'
      OperatingSystemNameVersion           : 'iOS 15.0.2'
      OperatingSystemNameVersionMajor      : 'iOS 15'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Line'
      AgentVersion                         : '12.3.0'
      AgentVersionMajor                    : '12'
      AgentNameVersion                     : 'Line 12.3.0'
      AgentNameVersionMajor                : 'Line 12'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (iPad; CPU OS 15_0 like Mac OS X; x86) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148 Safari Line/11.16.0'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Apple iPad'
      DeviceBrand                          : 'Apple'
      DeviceCpu                            : 'x86' # Weird but this is what is in the User-Agent
      DeviceCpuBits                        : '32'  # Weird but this is what is in the User-Agent
      DeviceFirmwareVersion                : '15E148'
      DeviceVersion                        : 'iPad'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '15.0'
      OperatingSystemVersionMajor          : '15'
      OperatingSystemNameVersion           : 'iOS 15.0'
      OperatingSystemNameVersionMajor      : 'iOS 15'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Line'
      AgentVersion                         : '11.16.0'
      AgentVersionMajor                    : '11'
      AgentNameVersion                     : 'Line 11.16.0'
      AgentNameVersionMajor                : 'Line 11'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (iPad; CPU OS 15_0 like Mac OS X; x86_x64) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148 Safari Line/11.16.0'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Apple iPad'
      DeviceBrand                          : 'Apple'
      DeviceCpu                            : 'Intel x86_64' # Weird for an iPad, but this is what is in the User-Agent
      DeviceCpuBits                        : '64'           # Weird for an iPad, but this is what is in the User-Agent
      DeviceFirmwareVersion                : '15E148'
      DeviceVersion                        : 'iPad'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '15.0'
      OperatingSystemVersionMajor          : '15'
      OperatingSystemNameVersion           : 'iOS 15.0'
      OperatingSystemNameVersionMajor      : 'iOS 15'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Line'
      AgentVersion                         : '11.16.0'
      AgentVersionMajor                    : '11'
      AgentNameVersion                     : 'Line 11.16.0'
      AgentNameVersionMajor                : 'Line 11'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (iPhone; CPU iPhone OS 15_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148 Safari Line/12.4.0'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15E148'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '15.4'
      OperatingSystemVersionMajor          : '15'
      OperatingSystemNameVersion           : 'iOS 15.4'
      OperatingSystemNameVersionMajor      : 'iOS 15'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Line'
      AgentVersion                         : '12.4.0'
      AgentVersionMajor                    : '12'
      AgentNameVersion                     : 'Line 12.4.0'
      AgentNameVersionMajor                : 'Line 12'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (Linux; Android 10; AGS3-L09 Build/HUAWEIAGS3-L09; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/88.0.4324.93 Safari/537.36 Line/10.7.1/IAB'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Huawei AGS3-L09'
      DeviceBrand                          : 'Huawei'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '10'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Android 10'
      OperatingSystemNameVersionMajor      : 'Android 10'
      OperatingSystemVersionBuild          : 'HUAWEIAGS3-L09'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '88.0'
      LayoutEngineVersionMajor             : '88'
      LayoutEngineNameVersion              : 'Blink 88.0'
      LayoutEngineNameVersionMajor         : 'Blink 88'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '88.0.4324.93'
      AgentVersionMajor                    : '88'
      AgentNameVersion                     : 'Chrome Webview 88.0.4324.93'
      AgentNameVersionMajor                : 'Chrome Webview 88'
      WebviewAppName                       : 'Line'
      WebviewAppVersion                    : '10.7.1'
      WebviewAppVersionMajor               : '10'
      WebviewAppNameVersion                : 'Line 10.7.1'
      WebviewAppNameVersionMajor           : 'Line 10'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (Linux; Android 11; XQ-BT52 Build/62.0.A.3.131; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/100.0.4896.79 Mobile Safari/537.36 Line/12.4.2/IAB'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Sony XQ-BT52'
      DeviceBrand                          : 'Sony'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '11'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'Android 11'
      OperatingSystemNameVersionMajor      : 'Android 11'
      OperatingSystemVersionBuild          : '62.0.A.3.131'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '100.0'
      LayoutEngineVersionMajor             : '100'
      LayoutEngineNameVersion              : 'Blink 100.0'
      LayoutEngineNameVersionMajor         : 'Blink 100'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '100.0.4896.79'
      AgentVersionMajor                    : '100'
      AgentNameVersion                     : 'Chrome Webview 100.0.4896.79'
      AgentNameVersionMajor                : 'Chrome Webview 100'
      WebviewAppName                       : 'Line'
      WebviewAppVersion                    : '12.4.2'
      WebviewAppVersionMajor               : '12'
      WebviewAppNameVersion                : 'Line 12.4.2'
      WebviewAppNameVersionMajor           : 'Line 12'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (Linux; Android 12; ASUS_I006D Build/SKQ1.210821.001; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/99.0.4844.73 Mobile Safari/537.36 Line/12.3.3/IAB'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Asus I006D'
      DeviceBrand                          : 'Asus'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '12'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'Android 12'
      OperatingSystemNameVersionMajor      : 'Android 12'
      OperatingSystemVersionBuild          : 'SKQ1.210821.001'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '99.0'
      LayoutEngineVersionMajor             : '99'
      LayoutEngineNameVersion              : 'Blink 99.0'
      LayoutEngineNameVersionMajor         : 'Blink 99'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '99.0.4844.73'
      AgentVersionMajor                    : '99'
      AgentNameVersion                     : 'Chrome Webview 99.0.4844.73'
      AgentNameVersionMajor                : 'Chrome Webview 99'
      WebviewAppName                       : 'Line'
      WebviewAppVersion                    : '12.3.3'
      WebviewAppVersionMajor               : '12'
      WebviewAppNameVersion                : 'Line 12.3.3'
      WebviewAppNameVersionMajor           : 'Line 12'


# TODO: Figure out what kind of app "FABUILD" this is.
- test:
    input:
      User-Agent  : 'Mozilla/5.0 (iPhone; CPU iPhone OS 14_8_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML; like Gecko) Version/13.0.5 Safari/604.18 FABUILD-iOS/4.4.1'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '14.8.1'
      OperatingSystemVersionMajor          : '14'
      OperatingSystemNameVersion           : 'iOS 14.8.1'
      OperatingSystemNameVersionMajor      : 'iOS 14'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Fabuild'
      AgentVersion                         : '4.4.1'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Fabuild 4.4.1'
      AgentNameVersionMajor                : 'Fabuild 4'


- test:
    input:
      User-Agent  : 'Mozilla/5.0 (Linux; Android 12; SM-G991B Build/SP1A.210812.016) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/100.0.4896.127 Mobile Safari/537.36 FABUILD-ANDROID/3.3.81'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung SM-G991B'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '12'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'Android 12'
      OperatingSystemNameVersionMajor      : 'Android 12'
      OperatingSystemVersionBuild          : 'SP1A.210812.016'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '100.0'
      LayoutEngineVersionMajor             : '100'
      LayoutEngineNameVersion              : 'Blink 100.0'
      LayoutEngineNameVersionMajor         : 'Blink 100'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '100.0.4896.127'
      AgentVersionMajor                    : '100'
      AgentNameVersion                     : 'Chrome Webview 100.0.4896.127'
      AgentNameVersionMajor                : 'Chrome Webview 100'
      WebviewAppName                       : 'Fabuild'
      WebviewAppVersion                    : '3.3.81'
      WebviewAppVersionMajor               : '3'
      WebviewAppNameVersion                : 'Fabuild 3.3.81'
      WebviewAppNameVersionMajor           : 'Fabuild 3'

- test:
    input:
      User-Agent  : 'Mozilla/5.0 (iPhone; CPU iPhone OS 15_4_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML; like Gecko) Version/13.0.5 Safari/604.18 FABUILD-IOS/6.0.1 FABUILD-IOS-iOS/6.0.1 APP/6.0.1'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '15.4.1'
      OperatingSystemVersionMajor          : '15'
      OperatingSystemNameVersion           : 'iOS 15.4.1'
      OperatingSystemNameVersionMajor      : 'iOS 15'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Fabuild'
      AgentVersion                         : '6.0.1'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'Fabuild 6.0.1'
      AgentNameVersionMajor                : 'Fabuild 6'


# https://github.com/nielsbasjes/yauaa/issues/570
- test:
    input:
      User-Agent  : 'GiFi/415 CFNetwork/1331.0.7 Darwin/21.4.0'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Apple iOS Device'
      DeviceBrand                          : 'Apple'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '15.4'
      OperatingSystemVersionMajor          : '15'
      OperatingSystemNameVersion           : 'iOS 15.4'
      OperatingSystemNameVersionMajor      : 'iOS 15'
      LayoutEngineClass                    : 'Mobile App'
      LayoutEngineName                     : 'GiFi'
      LayoutEngineVersion                  : '415'
      LayoutEngineVersionMajor             : '415'
      LayoutEngineNameVersion              : 'GiFi 415'
      LayoutEngineNameVersionMajor         : 'GiFi 415'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'GiFi'
      AgentVersion                         : '415'
      AgentVersionMajor                    : '415'
      AgentNameVersion                     : 'GiFi 415'
      AgentNameVersionMajor                : 'GiFi 415'


# ==========================================================================
# CFNetwork NON iOS cases

# Example from https://github.com/appium/appium/issues/2329
- test:
    input:
      User-Agent  : 'Appium (unknown version) CFNetwork/673.2.1 Darwin/13.1.0 (x86_64) (Macmini5,2)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Apple MAC Mini'
      DeviceBrand                          : 'Apple'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      DeviceVersion                        : 'Mac mini (Mid 2011)'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Mac OS'
      OperatingSystemVersion               : '10.9.?'
      OperatingSystemVersionMajor          : '10.9'
      OperatingSystemNameVersion           : 'Mac OS 10.9.?'
      OperatingSystemNameVersionMajor      : 'Mac OS 10.9'
      LayoutEngineClass                    : 'Desktop App'
      LayoutEngineName                     : 'Appium'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Appium ??'
      LayoutEngineNameVersionMajor         : 'Appium ??'
      AgentClass                           : 'Desktop App'
      AgentName                            : 'Appium'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'Appium ??'
      AgentNameVersionMajor                : 'Appium ??'

- test:
    input:
      User-Agent  : 'DVDpedia/204 CFNetwork/1128.1 Darwin/19.6.0 (x86_64)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Apple Macintosh'
      DeviceBrand                          : 'Apple'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Mac OS'
      OperatingSystemVersion               : '10.15.6 beta 2'
      OperatingSystemVersionMajor          : '10.15'
      OperatingSystemNameVersion           : 'Mac OS 10.15.6 beta 2'
      OperatingSystemNameVersionMajor      : 'Mac OS 10.15'
      LayoutEngineClass                    : 'Desktop App'
      LayoutEngineName                     : 'DVDpedia'
      LayoutEngineVersion                  : '204'
      LayoutEngineVersionMajor             : '204'
      LayoutEngineNameVersion              : 'DVDpedia 204'
      LayoutEngineNameVersionMajor         : 'DVDpedia 204'
      AgentClass                           : 'Desktop App'
      AgentName                            : 'DVDpedia'
      AgentVersion                         : '204'
      AgentVersionMajor                    : '204'
      AgentNameVersion                     : 'DVDpedia 204'
      AgentNameVersionMajor                : 'DVDpedia 204'

- test:
    input:
      User-Agent                           : 'Safari/6534.59.10 CFNetwork/454.12.4 Darwin/10.8.0 (i386) (MacBook2,1)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Apple Macbook'
      DeviceBrand                          : 'Apple'
      DeviceCpu                            : 'Intel i386'
      DeviceCpuBits                        : '32'
      DeviceVersion                        : 'MacBook (13-inch, Late 2006)'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Mac OS'
      OperatingSystemVersion               : '10.6.8'
      OperatingSystemVersionMajor          : '10.6'
      OperatingSystemNameVersion           : 'Mac OS 10.6.8'
      OperatingSystemNameVersionMajor      : 'Mac OS 10.6'
      LayoutEngineClass                    : 'Desktop App'
      LayoutEngineName                     : 'Safari'
      LayoutEngineVersion                  : '6534.59.10'
      LayoutEngineVersionMajor             : '6534'
      LayoutEngineNameVersion              : 'Safari 6534.59.10'
      LayoutEngineNameVersionMajor         : 'Safari 6534'
      AgentClass                           : 'Desktop App'
      AgentName                            : 'Safari'
      AgentVersion                         : '6534.59.10'
      AgentVersionMajor                    : '6534'
      AgentNameVersion                     : 'Safari 6534.59.10'
      AgentNameVersionMajor                : 'Safari 6534'


- test:
    input:
      User-Agent                           : 'Bookpedia/81 CFNetwork/673.6 Darwin/13.4.0 (x86_64) (iMac14%2C2)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Apple Imac'
      DeviceBrand                          : 'Apple'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      DeviceVersion                        : 'iMac (27-inch, Late 2013)'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Mac OS'
      OperatingSystemVersion               : '10.9.5'
      OperatingSystemVersionMajor          : '10.9'
      OperatingSystemNameVersion           : 'Mac OS 10.9.5'
      OperatingSystemNameVersionMajor      : 'Mac OS 10.9'
      LayoutEngineClass                    : 'Desktop App'
      LayoutEngineName                     : 'Bookpedia'
      LayoutEngineVersion                  : '81'
      LayoutEngineVersionMajor             : '81'
      LayoutEngineNameVersion              : 'Bookpedia 81'
      LayoutEngineNameVersionMajor         : 'Bookpedia 81'
      AgentClass                           : 'Desktop App'
      AgentName                            : 'Bookpedia'
      AgentVersion                         : '81'
      AgentVersionMajor                    : '81'
      AgentNameVersion                     : 'Bookpedia 81'
      AgentNameVersionMajor                : 'Bookpedia 81'


- test:
    input:
      User-Agent                           : 'WeChatShareExtensionNew/8.0.18.34 CFNetwork/1333.0.4 Darwin/21.5.0'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Apple iOS Device'
      DeviceBrand                          : 'Apple'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '15.?'
      OperatingSystemVersionMajor          : '15'
      OperatingSystemNameVersion           : 'iOS 15.?'
      OperatingSystemNameVersionMajor      : 'iOS 15'
      LayoutEngineClass                    : 'Mobile App'
      LayoutEngineName                     : 'WeChatShareExtensionNew'
      LayoutEngineVersion                  : '8.0.18.34'
      LayoutEngineVersionMajor             : '8'
      LayoutEngineNameVersion              : 'WeChatShareExtensionNew 8.0.18.34'
      LayoutEngineNameVersionMajor         : 'WeChatShareExtensionNew 8'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChatShareExtensionNew'
      AgentVersion                         : '8.0.18.34'
      AgentVersionMajor                    : '8'
      AgentNameVersion                     : 'WeChatShareExtensionNew 8.0.18.34'
      AgentNameVersionMajor                : 'WeChatShareExtensionNew 8'




  # Cronet:
  # https://developer.android.com/guide/topics/connectivity/cronet
  # Cronet is the Chromium network stack made available to Android apps as a library.
- test:
    input:
      user_agent_string: 'com.google.android.apps.searchlite/444785 (Linux; U; Android 10; nl_BE; moto g(7) power; Build/QPOS30.52-29-7-6; Cronet/89.0.4389.90)'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Motorola Moto G(7) Power'
      DeviceBrand                          : 'Motorola'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '10'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Android 10'
      OperatingSystemNameVersionMajor      : 'Android 10'
      OperatingSystemVersionBuild          : 'QPOS30.52-29-7-6'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Google Go'
      AgentVersion                         : '444785'
      AgentVersionMajor                    : '444785'
      AgentNameVersion                     : 'Google Go 444785'
      AgentNameVersionMajor                : 'Google Go 444785'
      AgentLanguage                        : 'Dutch (Belgium)'
      AgentLanguageCode                    : 'nl-be'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'com.google.android.apps.searchlite/444787 (Linux; U; Android 10; nl; Nokia 1 Plus; Build/QP1A.190711.020; Cronet/89.0.4389.90)'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Nokia 1 Plus'
      DeviceBrand                          : 'Nokia'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '10'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Android 10'
      OperatingSystemNameVersionMajor      : 'Android 10'
      OperatingSystemVersionBuild          : 'QP1A.190711.020'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Google Go'
      AgentVersion                         : '444787'
      AgentVersionMajor                    : '444787'
      AgentNameVersion                     : 'Google Go 444787'
      AgentNameVersionMajor                : 'Google Go 444787'
      AgentLanguage                        : 'Dutch'
      AgentLanguageCode                    : 'nl'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'com.google.android.apps.searchlite/63665 (Linux; U; Android 8.1.0; en_ZA; SM-A260F; Build/OPR6; Cronet/89.0.4389.90)'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Samsung SM-A260F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '8.1.0'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Android 8.1.0'
      OperatingSystemNameVersionMajor      : 'Android 8'
      OperatingSystemVersionBuild          : 'OPR6'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Google Go'
      AgentVersion                         : '63665'
      AgentVersionMajor                    : '63665'
      AgentNameVersion                     : 'Google Go 63665'
      AgentNameVersionMajor                : 'Google Go 63665'
      AgentLanguage                        : 'English (South Africa)'
      AgentLanguageCode                    : 'en-za'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      User-Agent                           : 'com.google.android.youtube/16.30.34(Linux; U; Android 11; nl_NL; CPH2273 Build/RP1A.200720.011) gzip'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Oppo CPH2273'
      DeviceBrand                          : 'Oppo'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '11'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'Android 11'
      OperatingSystemNameVersionMajor      : 'Android 11'
      OperatingSystemVersionBuild          : 'RP1A.200720.011'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Youtube'
      AgentVersion                         : '16.30.34'
      AgentVersionMajor                    : '16'
      AgentNameVersion                     : 'Youtube 16.30.34'
      AgentNameVersionMajor                : 'Youtube 16'
      AgentLanguage                        : 'Dutch (Netherlands)'
      AgentLanguageCode                    : 'nl-nl'
      AgentInformationUrl                  : 'com.google.android.youtube'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      User-Agent                           : 'com.google.android.youtube/17.11.35(Linux; U; Android 11; nl_NL; SM-A515F Build/RP1A.200720.012) gzip'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Samsung SM-A515F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '11'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'Android 11'
      OperatingSystemNameVersionMajor      : 'Android 11'
      OperatingSystemVersionBuild          : 'RP1A.200720.012'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Youtube'
      AgentVersion                         : '17.11.35'
      AgentVersionMajor                    : '17'
      AgentNameVersion                     : 'Youtube 17.11.35'
      AgentNameVersionMajor                : 'Youtube 17'
      AgentLanguage                        : 'Dutch (Netherlands)'
      AgentLanguageCode                    : 'nl-nl'
      AgentInformationUrl                  : 'com.google.android.youtube'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      User-Agent                           : 'com.google.android.youtube/16.35.36(Linux; U; Android 11; en_US; Infinix X688B Build/RP1A.200720.011) gzip'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Infinix X688B'
      DeviceBrand                          : 'Infinix'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '11'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'Android 11'
      OperatingSystemNameVersionMajor      : 'Android 11'
      OperatingSystemVersionBuild          : 'RP1A.200720.011'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Youtube'
      AgentVersion                         : '16.35.36'
      AgentVersionMajor                    : '16'
      AgentNameVersion                     : 'Youtube 16.35.36'
      AgentNameVersionMajor                : 'Youtube 16'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentInformationUrl                  : 'com.google.android.youtube'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      User-Agent                           : 'com.google.android.youtube/16.19.37(Linux; U; Android 11; en_GB; SM-M127G Build/RP1A.200720.012) gzip'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Samsung SM-M127G'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '11'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'Android 11'
      OperatingSystemNameVersionMajor      : 'Android 11'
      OperatingSystemVersionBuild          : 'RP1A.200720.012'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Youtube'
      AgentVersion                         : '16.19.37'
      AgentVersionMajor                    : '16'
      AgentNameVersion                     : 'Youtube 16.19.37'
      AgentNameVersionMajor                : 'Youtube 16'
      AgentLanguage                        : 'English (United Kingdom)'
      AgentLanguageCode                    : 'en-gb'
      AgentInformationUrl                  : 'com.google.android.youtube'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      User-Agent                           : 'com.google.android.youtube/17.24.34(Linux; U; Android 12; ro_RO; SM-G985F Build/SP1A.210812.016) gzip'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Samsung SM-G985F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '12'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'Android 12'
      OperatingSystemNameVersionMajor      : 'Android 12'
      OperatingSystemVersionBuild          : 'SP1A.210812.016'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Youtube'
      AgentVersion                         : '17.24.34'
      AgentVersionMajor                    : '17'
      AgentNameVersion                     : 'Youtube 17.24.34'
      AgentNameVersionMajor                : 'Youtube 17'
      AgentLanguage                        : 'Romanian (Romania)'
      AgentLanguageCode                    : 'ro-ro'
      AgentInformationUrl                  : 'com.google.android.youtube'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      User-Agent                           : 'com.google.android.youtube/17.24.34(Linux; U; Android 12; nl_NL; moto g(100) Build/S1RTS32.41-20-16-01-2) gzip'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Motorola Moto G(100)'
      DeviceBrand                          : 'Motorola'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '12'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'Android 12'
      OperatingSystemNameVersionMajor      : 'Android 12'
      OperatingSystemVersionBuild          : 'S1RTS32.41-20-16-01-2'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Youtube'
      AgentVersion                         : '17.24.34'
      AgentVersionMajor                    : '17'
      AgentNameVersion                     : 'Youtube 17.24.34'
      AgentNameVersionMajor                : 'Youtube 17'
      AgentLanguage                        : 'Dutch (Netherlands)'
      AgentLanguageCode                    : 'nl-nl'
      AgentInformationUrl                  : 'com.google.android.youtube'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      User-Agent                           : 'com.google.android.youtube/17.24.34(Linux; U; Android 12; nl_NL; moto g pro Build/S0PRS32.44-11-10-02-7) gzip'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Motorola Moto G PRO'
      DeviceBrand                          : 'Motorola'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '12'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'Android 12'
      OperatingSystemNameVersionMajor      : 'Android 12'
      OperatingSystemVersionBuild          : 'S0PRS32.44-11-10-02-7'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Youtube'
      AgentVersion                         : '17.24.34'
      AgentVersionMajor                    : '17'
      AgentNameVersion                     : 'Youtube 17.24.34'
      AgentNameVersionMajor                : 'Youtube 17'
      AgentLanguage                        : 'Dutch (Netherlands)'
      AgentLanguageCode                    : 'nl-nl'
      AgentInformationUrl                  : 'com.google.android.youtube'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      User-Agent                           : 'com.google.android.youtube/17.23.35(Linux; U; Android 7.0; zh_CN_#Hans; SM-A510F Build/NRD90M) gzip'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Samsung SM-A510F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.0'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Android 7.0'
      OperatingSystemNameVersionMajor      : 'Android 7'
      OperatingSystemVersionBuild          : 'NRD90M'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Youtube'
      AgentVersion                         : '17.23.35'
      AgentVersionMajor                    : '17'
      AgentNameVersion                     : 'Youtube 17.23.35'
      AgentNameVersionMajor                : 'Youtube 17'
      AgentInformationUrl                  : 'com.google.android.youtube'
      AgentSecurity                        : 'Strong security'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'


- test:
    input:
      User-Agent                           : 'com.google.android.youtube/17.23.35(Linux; U; Android 10; ar_IQ_#u-nu-latn; Infinix X612 Build/QP1A.190711.020) gzip'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Infinix X612'
      DeviceBrand                          : 'Infinix'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '10'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Android 10'
      OperatingSystemNameVersionMajor      : 'Android 10'
      OperatingSystemVersionBuild          : 'QP1A.190711.020'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Youtube'
      AgentVersion                         : '17.23.35'
      AgentVersionMajor                    : '17'
      AgentNameVersion                     : 'Youtube 17.23.35'
      AgentNameVersionMajor                : 'Youtube 17'
      AgentInformationUrl                  : 'com.google.android.youtube'
      AgentSecurity                        : 'Strong security'
      AgentLanguage                        : 'Arabic (Iraq)'
      AgentLanguageCode                    : 'ar-iq'


- test:
    input:
      User-Agent                           : 'com.google.android.apps.youtube.music/5.14.53(Linux; U; Android 12; fr_BE; SM-G781B Build/SP1A.210812.016) gzip'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Samsung SM-G781B'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '12'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'Android 12'
      OperatingSystemNameVersionMajor      : 'Android 12'
      OperatingSystemVersionBuild          : 'SP1A.210812.016'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Youtube Music'
      AgentVersion                         : '5.14.53'
      AgentVersionMajor                    : '5'
      AgentNameVersion                     : 'Youtube Music 5.14.53'
      AgentNameVersionMajor                : 'Youtube Music 5'
      AgentLanguage                        : 'French (Belgium)'
      AgentLanguageCode                    : 'fr-be'
      AgentInformationUrl                  : 'com.google.android.apps.youtube.music'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      User-Agent                           : 'com.google.android.apps.youtube.music/5.13.50(Linux; U; Android 11; zh_HK_#Hant; SM-A226B Build/RP1A.200720.012) gzip'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Samsung SM-A226B'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '11'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'Android 11'
      OperatingSystemNameVersionMajor      : 'Android 11'
      OperatingSystemVersionBuild          : 'RP1A.200720.012'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Youtube Music'
      AgentVersion                         : '5.13.50'
      AgentVersionMajor                    : '5'
      AgentNameVersion                     : 'Youtube Music 5.13.50'
      AgentNameVersionMajor                : 'Youtube Music 5'
      AgentInformationUrl                  : 'com.google.android.apps.youtube.music'
      AgentSecurity                        : 'Strong security'
      AgentLanguage                        : 'Chinese (Hong Kong)'
      AgentLanguageCode                    : 'zh-hk'


- test:
    input:
      User-Agent                           : 'com.google.ios.youtube/17.24.4 (iPhone14,3; U; CPU iOS 15_5 like Mac OS X; en_NL)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone 13 Pro Max'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '15.5'
      OperatingSystemVersionMajor          : '15'
      OperatingSystemNameVersion           : 'iOS 15.5'
      OperatingSystemNameVersionMajor      : 'iOS 15'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Youtube'
      AgentVersion                         : '17.24.4'
      AgentVersionMajor                    : '17'
      AgentNameVersion                     : 'Youtube 17.24.4'
      AgentNameVersionMajor                : 'Youtube 17'
      AgentLanguage                        : 'English (Netherlands)'
      AgentLanguageCode                    : 'en-nl'
      AgentInformationUrl                  : 'com.google.ios.youtube'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      User-Agent                           : 'com.google.ios.youtube/17.24.4 (iPhone6,2; U; CPU iOS 12_5_5 like Mac OS X; nl_NL)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone 5s (A1457/A1518/A1530)'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '12.5.5'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'iOS 12.5.5'
      OperatingSystemNameVersionMajor      : 'iOS 12'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Youtube'
      AgentVersion                         : '17.24.4'
      AgentVersionMajor                    : '17'
      AgentNameVersion                     : 'Youtube 17.24.4'
      AgentNameVersionMajor                : 'Youtube 17'
      AgentLanguage                        : 'Dutch (Netherlands)'
      AgentLanguageCode                    : 'nl-nl'
      AgentInformationUrl                  : 'com.google.ios.youtube'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      User-Agent                           : 'com.google.ios.youtube/17.24.4 (iPhone9,3; U; CPU iOS 14_2 like Mac OS X; fr_BE)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone 7'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '14.2'
      OperatingSystemVersionMajor          : '14'
      OperatingSystemNameVersion           : 'iOS 14.2'
      OperatingSystemNameVersionMajor      : 'iOS 14'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Youtube'
      AgentVersion                         : '17.24.4'
      AgentVersionMajor                    : '17'
      AgentNameVersion                     : 'Youtube 17.24.4'
      AgentNameVersionMajor                : 'Youtube 17'
      AgentLanguage                        : 'French (Belgium)'
      AgentLanguageCode                    : 'fr-be'
      AgentInformationUrl                  : 'com.google.ios.youtube'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      User-Agent                           : 'com.google.ios.youtube/17.24.4 (iPhone9,4; U; CPU iOS 15_5 like Mac OS X; nl_NL)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone 7 Plus'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '15.5'
      OperatingSystemVersionMajor          : '15'
      OperatingSystemNameVersion           : 'iOS 15.5'
      OperatingSystemNameVersionMajor      : 'iOS 15'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Youtube'
      AgentVersion                         : '17.24.4'
      AgentVersionMajor                    : '17'
      AgentNameVersion                     : 'Youtube 17.24.4'
      AgentNameVersionMajor                : 'Youtube 17'
      AgentLanguage                        : 'Dutch (Netherlands)'
      AgentLanguageCode                    : 'nl-nl'
      AgentInformationUrl                  : 'com.google.ios.youtube'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      User-Agent                           : 'com.google.ios.youtubemusic/5.07.1 (iPhone10,6; U; CPU iOS 15_5 like Mac OS X; nl_NL)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone X (A1901)'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '15.5'
      OperatingSystemVersionMajor          : '15'
      OperatingSystemNameVersion           : 'iOS 15.5'
      OperatingSystemNameVersionMajor      : 'iOS 15'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Youtube Music'
      AgentVersion                         : '5.07.1'
      AgentVersionMajor                    : '5'
      AgentNameVersion                     : 'Youtube Music 5.07.1'
      AgentNameVersionMajor                : 'Youtube Music 5'
      AgentLanguage                        : 'Dutch (Netherlands)'
      AgentLanguageCode                    : 'nl-nl'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (iPhone; CPU iPhone OS 15.4.1 like Mac OS X;) AppleWebKit/601.1.46 (KHTML, like Gecko) OPA/209.0 CoreAssistant/com.google.GoogleMobile'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '15.4.1'
      OperatingSystemVersionMajor          : '15'
      OperatingSystemNameVersion           : 'iOS 15.4.1'
      OperatingSystemNameVersionMajor      : 'iOS 15'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '601.1.46'
      LayoutEngineVersionMajor             : '601'
      LayoutEngineNameVersion              : 'AppleWebKit 601.1.46'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 601'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Google Assistant'
      AgentVersion                         : '209.0'
      AgentVersionMajor                    : '209'
      AgentNameVersion                     : 'Google Assistant 209.0'
      AgentNameVersionMajor                : 'Google Assistant 209'

- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (iPhone; CPU OS 12.5.5 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) GoogleWv/1.0 (WKWebView) OPA/1.9.33408 CoreAssistant/com.google.OPA'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '12.5.5'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'iOS 12.5.5'
      OperatingSystemNameVersionMajor      : 'iOS 12'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Google Assistant'
      AgentVersion                         : '1.9.33408'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Google Assistant 1.9.33408'
      AgentNameVersionMajor                : 'Google Assistant 1'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (iPad; CPU OS 15.3.1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) GoogleWv/1.0 (WKWebView) OPA/1.9.40904 CoreAssistant/com.google.OPA'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Apple iPad'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPad'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '15.3.1'
      OperatingSystemVersionMajor          : '15'
      OperatingSystemNameVersion           : 'iOS 15.3.1'
      OperatingSystemNameVersionMajor      : 'iOS 15'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Google Assistant'
      AgentVersion                         : '1.9.40904'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Google Assistant 1.9.40904'
      AgentNameVersionMajor                : 'Google Assistant 1'

# TODO: What is this?
#  com.apple.WebKit.Networking/10603.3.8 CFNetwork/720.5.7 Darwin/14.5.0 (x86_64)
#  com.apple.WebKit.Networking/13605.1.33.1.4 CFNetwork/897.15 Darwin/17.5.0 (x86_64)
#  com.apple.WebKit.Networking/13605.3.8 CFNetwork/902.1 Darwin/17.7.0 (x86_64)


- test:
    input:
      User-Agent                           : 'com.google.Drive.ShareExtension/4.2022.06204 iPad/14.8 hw/iPad7_5'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Apple iPad'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPad (6th gen, A1893)'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'iOS ??'
      OperatingSystemNameVersionMajor      : 'iOS ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Google Drive'
      AgentVersion                         : '4.2022.06204'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Google Drive 4.2022.06204'
      AgentNameVersionMajor                : 'Google Drive 4'


- test:
    input:
      User-Agent                           : 'com.google.Drive.ShareExtension/4.2022.22200 iPad/15.3.1 hw/iPad6_11'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Apple iPad'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPad (2017)'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'iOS ??'
      OperatingSystemNameVersionMajor      : 'iOS ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Google Drive'
      AgentVersion                         : '4.2022.22200'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Google Drive 4.2022.22200'
      AgentNameVersionMajor                : 'Google Drive 4'


- test:
    input:
      User-Agent                           : 'com.google.Drive.ShareExtension/4.2022.22200 iPhone/15.4.1 hw/iPhone14_3'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone 13 Pro Max'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'iOS ??'
      OperatingSystemNameVersionMajor      : 'iOS ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Google Drive'
      AgentVersion                         : '4.2022.22200'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Google Drive 4.2022.22200'
      AgentNameVersionMajor                : 'Google Drive 4'


- test:
    input:
      User-Agent                           : 'com.google.Maps/6.27.0 iPhone/15.4.1 hw/iPhone13_2 (gzip)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone 12'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'iOS ??'
      OperatingSystemNameVersionMajor      : 'iOS ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Google Maps'
      AgentVersion                         : '6.27.0'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'Google Maps 6.27.0'
      AgentNameVersionMajor                : 'Google Maps 6'


- test:
    input:
      User-Agent                           : 'com.google.Maps/6.27.0 iPhone/15.5 hw/iPhone14_5 (gzip)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone 13'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'iOS ??'
      OperatingSystemNameVersionMajor      : 'iOS ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Google Maps'
      AgentVersion                         : '6.27.0'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'Google Maps 6.27.0'
      AgentNameVersionMajor                : 'Google Maps 6'


#  com.microsoft.rdc.androidx/1182 (Android;11.0)

#  com.google.android.apps.searchlite/632506 (Linux; U; Android 10; nl_BE; moto e(7i) power; Build/QOJS30.506-7-2; Cronet/103.0.5060.42)
#  com.google.android.apps.searchlite/63665 (Linux; U; Android 8.1.0; fr_FR; RIO_BN; Build/OPM2.171019.012; Cronet/101.0.4951.41)
#
#  com.google.android.youtube.player/1.14.0 com.google.android.youtube/17.28.34 com.google.android.youtube/17.28.34 (Linux; U; Android 9; nl_NL; FIG-LX1 Build/HUAWEIFIG-L31) gzip


- matcher:
    extract:
      - 'AgentClass                         : 1000  : "Mobile App"'
      - 'AgentName                          : 1000  : "DuckDuckGo"'
      - 'AgentVersion                       : 1000  : agent.product.name="ddg_android"^.version'


- test:
    input:
      User-Agent                           : 'ddg_android/5.107.0 (com.duckduckgo.mobile.android; Android API 30)'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Mobile Android Mobile'
      DeviceBrand                          : 'Mobile'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '11'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'Android 11'
      OperatingSystemNameVersionMajor      : 'Android 11'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'DuckDuckGo'
      AgentVersion                         : '5.107.0'
      AgentVersionMajor                    : '5'
      AgentNameVersion                     : 'DuckDuckGo 5.107.0'
      AgentNameVersionMajor                : 'DuckDuckGo 5'
      AgentInformationUrl                  : 'com.duckduckgo.mobile.android'



- test:
    input:
      User-Agent                           : 'ddg_android/5.109.0 (com.duckduckgo.mobile.android; Android API 31)'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Mobile Android Mobile'
      DeviceBrand                          : 'Mobile'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '12'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'Android 12'
      OperatingSystemNameVersionMajor      : 'Android 12'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'DuckDuckGo'
      AgentVersion                         : '5.109.0'
      AgentVersionMajor                    : '5'
      AgentNameVersion                     : 'DuckDuckGo 5.109.0'
      AgentNameVersionMajor                : 'DuckDuckGo 5'
      AgentInformationUrl                  : 'com.duckduckgo.mobile.android'


- test:
    input:
      User-Agent                           : 'ddg_android/5.111.0 (com.duckduckgo.mobile.android; Android API 25)'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Mobile Android Mobile'
      DeviceBrand                          : 'Mobile'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.1'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Android 7.1'
      OperatingSystemNameVersionMajor      : 'Android 7'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'DuckDuckGo'
      AgentVersion                         : '5.111.0'
      AgentVersionMajor                    : '5'
      AgentNameVersion                     : 'DuckDuckGo 5.111.0'
      AgentNameVersionMajor                : 'DuckDuckGo 5'
      AgentInformationUrl                  : 'com.duckduckgo.mobile.android'


# This is URL encoded Japanese ウイルスバスター which translates to "Virus Buster" and seems to be from TrendMicro
- test:
    input:
      User-Agent                           : '%E3%82%A6%E3%82%A4%E3%83%AB%E3%82%B9%E3%83%90%E3%82%B9%E3%82%BF%E3%83%BC%20for%20Mac/1 CFNetwork/1240.0.4 Darwin/20.6.0'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Apple iOS Device'
      DeviceBrand                          : 'Apple'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '14.7 beta 2'
      OperatingSystemVersionMajor          : '14'
      OperatingSystemNameVersion           : 'iOS 14.7 beta 2'
      OperatingSystemNameVersionMajor      : 'iOS 14'
      LayoutEngineClass                    : 'Mobile App'
      LayoutEngineName                     : 'ウイルスバスター for Mac'
      LayoutEngineVersion                  : '1'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'ウイルスバスター for Mac 1'
      LayoutEngineNameVersionMajor         : 'ウイルスバスター for Mac 1'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'ウイルスバスター for Mac'
      AgentVersion                         : '1'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'ウイルスバスター for Mac 1'
      AgentNameVersionMajor                : 'ウイルスバスター for Mac 1'


#  https://www.yammer.com/
#  https://www.microsoft.com/en-us/microsoft-365/yammer/yammer-overview
- test:
    input:
      User-Agent                           : 'Yammer/9.25.0.1810 (iPhone12,3; iOS 15.5; nl_NL; nl-NL; Scale/3.00) AppleWebKit (KHTML, like Gecko)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone 11 Pro'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '15.5'
      OperatingSystemVersionMajor          : '15'
      OperatingSystemNameVersion           : 'iOS 15.5'
      OperatingSystemNameVersionMajor      : 'iOS 15'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'AppleWebKit ??'
      LayoutEngineNameVersionMajor         : 'AppleWebKit ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Yammer'
      AgentVersion                         : '9.25.0.1810'
      AgentVersionMajor                    : '9'
      AgentNameVersion                     : 'Yammer 9.25.0.1810'
      AgentNameVersionMajor                : 'Yammer 9'
      AgentLanguage                        : 'Dutch (Netherlands)'
      AgentLanguageCode                    : 'nl-nl'


# https://play.google.com/store/apps/details?id=com.twipemobile.nrc&hl=en&gl=US
# NRC - Nieuws & achtergronden
# Very non standard formatted UserAgent

- matcher:
    require:
      - 'agent.(1)product.comments.entry="Mobile2.0"'
    extract:
      - 'DeviceClass : 10 : "Phone"'

- matcher:
    require:
      - 'agent.(1)product.comments.entry="Smartphone2.0"'
    extract:
      - 'DeviceClass : 10 : "Phone"'

- matcher:
    require:
      - 'agent.(1)product.comments.entry="Tablet2.0"'
    extract:
      - 'DeviceClass : 10 : "Tablet"'

- matcher:
    variable:
    - 'Agent:agent.product.(1)name="com.twipemobile.nrc"^'
    require:
      - '@Agent.(2)version="Android"'
    extract:
      - 'OperatingSystemClass              :    101  :"Mobile"'
      - 'OperatingSystemName               :    101  :"Android"'
      - 'OperatingSystemVersion            :    101  :LookUp[AndroidAPIToVersionMap;@Agent>;"<<<null>>>"]'
      - 'AgentClass                        :    100  :"Mobile App"'
      - 'AgentName                         :    100  :"NRC"'
      - 'AgentVersion                      :    100  :@Agent.(1)version'
      - 'AgentBuild                        :    100  :@Agent.(1)comments.(1)entry'

- test:
    input:
      User-Agent                           : 'SM-G930F (compatible; Mobile2.0) HandelsbladProduction, com.twipemobile.nrc 5.1.1 (508) / Android 26'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung SM-G930F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '8.0'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Android 8.0'
      OperatingSystemNameVersionMajor      : 'Android 8'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'NRC'
      AgentVersion                         : '5.1.1'
      AgentVersionMajor                    : '5'
      AgentNameVersion                     : 'NRC 5.1.1'
      AgentNameVersionMajor                : 'NRC 5'
      AgentBuild                           : '508'


- test:
    input:
      User-Agent                           : 'moto g(50) (compatible; Mobile2.0) HandelsbladProduction, com.twipemobile.nrc 5.1.1 (508) / Android 31'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Motorola Moto G'
      DeviceBrand                          : 'Motorola'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '12'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'Android 12'
      OperatingSystemNameVersionMajor      : 'Android 12'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'NRC'
      AgentVersion                         : '5.1.1'
      AgentVersionMajor                    : '5'
      AgentNameVersion                     : 'NRC 5.1.1'
      AgentNameVersionMajor                : 'NRC 5'
      AgentBuild                           : '508'


- test:
    input:
      User-Agent                           : 'moto g(6) plus (compatible; Mobile2.0) HandelsbladProduction, com.twipemobile.nrc 4.4.2 (412) / Android 28'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Motorola Moto G'
      DeviceBrand                          : 'Motorola'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '9'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'Android 9'
      OperatingSystemNameVersionMajor      : 'Android 9'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'NRC'
      AgentVersion                         : '4.4.2'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'NRC 4.4.2'
      AgentNameVersionMajor                : 'NRC 4'
      AgentBuild                           : '412'


- test:
    input:
      User-Agent                           : 'DN2103 (compatible; Mobile2.0) HandelsbladProduction, com.twipemobile.nrc 5.1.1 (508) / Android 30'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Oneplus DN2103'
      DeviceBrand                          : 'Oneplus'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '11'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'Android 11'
      OperatingSystemNameVersionMajor      : 'Android 11'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'NRC'
      AgentVersion                         : '5.1.1'
      AgentVersionMajor                    : '5'
      AgentNameVersion                     : 'NRC 5.1.1'
      AgentNameVersionMajor                : 'NRC 5'
      AgentBuild                           : '508'


- test:
    input:
      User-Agent                           : 'Lenovo TB-8704F (compatible; Tablet2.0) HandelsbladProduction, com.twipemobile.nrc 5.1.1 (508) / Android 27'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Lenovo TB-8704F'
      DeviceBrand                          : 'Lenovo'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '8.1'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Android 8.1'
      OperatingSystemNameVersionMajor      : 'Android 8'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'NRC'
      AgentVersion                         : '5.1.1'
      AgentVersionMajor                    : '5'
      AgentNameVersion                     : 'NRC 5.1.1'
      AgentNameVersionMajor                : 'NRC 5'
      AgentBuild                           : '508'

- test:
    input:
      User-Agent                           : 'Mi 9T Pro (compatible; Mobile2.0) HandelsbladProduction, com.twipemobile.nrc 5.1.1 (508) / Android 30'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Xiaomi MI 9T'
      DeviceBrand                          : 'Xiaomi'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '11'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'Android 11'
      OperatingSystemNameVersionMajor      : 'Android 11'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'NRC'
      AgentVersion                         : '5.1.1'
      AgentVersionMajor                    : '5'
      AgentNameVersion                     : 'NRC 5.1.1'
      AgentNameVersionMajor                : 'NRC 5'
      AgentBuild                           : '508'


- test:
    input:
      User-Agent                           : 'SM-G970F (compatible; Mobile2.0) HandelsbladProduction, com.twipemobile.nrc 5.1.3 (510) / Android 31'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung SM-G970F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '12'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'Android 12'
      OperatingSystemNameVersionMajor      : 'Android 12'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'NRC'
      AgentVersion                         : '5.1.3'
      AgentVersionMajor                    : '5'
      AgentNameVersion                     : 'NRC 5.1.3'
      AgentNameVersionMajor                : 'NRC 5'
      AgentBuild                           : '510'


- test:
    input:
      User-Agent                           : 'SM-G970F (compatible; Smartphone2.0) HandelsbladProduction, com.twipemobile.nrc 4.2.0 (405) / Android 31'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung SM-G970F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '12'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'Android 12'
      OperatingSystemNameVersionMajor      : 'Android 12'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'NRC'
      AgentVersion                         : '4.2.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'NRC 4.2.0'
      AgentNameVersionMajor                : 'NRC 4'
      AgentBuild                           : '405'


- test:
    input:
      User-Agent                           : 'Lou''s Pizza/3.16.0 iOS/16.2 CFNetwork/1402.0.8 Darwin/22.2.0 HQ:10214 bs=99 ts=0 ja3=b76d503360ae441d410a85a7f8d648ab as=22394'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Apple iOS Device'
      DeviceBrand                          : 'Apple'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '16.2'
      OperatingSystemVersionMajor          : '16'
      OperatingSystemNameVersion           : 'iOS 16.2'
      OperatingSystemNameVersionMajor      : 'iOS 16'
      LayoutEngineClass                    : 'Mobile App'
      LayoutEngineName                     : 'Lou''s Pizza'
      LayoutEngineVersion                  : '3.16.0'
      LayoutEngineVersionMajor             : '3'
      LayoutEngineNameVersion              : 'Lou''s Pizza 3.16.0'
      LayoutEngineNameVersionMajor         : 'Lou''s Pizza 3'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Lou''s Pizza'
      AgentVersion                         : '3.16.0'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Lou''s Pizza 3.16.0'
      AgentNameVersionMajor                : 'Lou''s Pizza 3'


- test:
    input:
      User-Agent                           : 'Sandbox/1.0 (me.og4.local-full; build:1; macOS(Catalyst) 13.1.0) Alamofire/5.6.4'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Apple'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Mac OS'
      OperatingSystemVersion               : '13.1.0'
      OperatingSystemVersionMajor          : '13'
      OperatingSystemNameVersion           : 'Mac OS 13.1.0'
      OperatingSystemNameVersionMajor      : 'Mac OS 13'
      LayoutEngineClass                    : 'Desktop App'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Desktop App'
      AgentName                            : 'Sandbox'
      AgentVersion                         : '1.0'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Sandbox 1.0'
      AgentNameVersionMajor                : 'Sandbox 1'
      AgentBuild                           : '1'


- test:
    input:
      User-Agent  : 'Qmusic/266 (be.qmusic.qmusicradio; build:1; iOS 15.5.0) Alamofire/266'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Apple iOS Device'
      DeviceBrand                          : 'Apple'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '15.5.0'
      OperatingSystemVersionMajor          : '15'
      OperatingSystemNameVersion           : 'iOS 15.5.0'
      OperatingSystemNameVersionMajor      : 'iOS 15'
      LayoutEngineClass                    : 'Mobile App'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Qmusic'
      AgentVersion                         : '266'
      AgentVersionMajor                    : '266'
      AgentNameVersion                     : 'Qmusic 266'
      AgentNameVersionMajor                : 'Qmusic 266'
      AgentBuild                           : '1'


- test:
    input:
      User-Agent  : 'Don''t Waste My Time! Extension/1.0 (skavans.dont-waste-my-time.extension; build:2; macOS 10.16.0) Alamofire/5.0.4'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Apple'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Mac OS'
      OperatingSystemVersion               : '10.16.0'
      OperatingSystemVersionMajor          : '10.16'
      OperatingSystemNameVersion           : 'Mac OS 10.16.0'
      OperatingSystemNameVersionMajor      : 'Mac OS 10.16'
      LayoutEngineClass                    : 'Desktop App'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Desktop App'
      AgentName                            : 'Don''t Waste My Time! Extension'
      AgentVersion                         : '1.0'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Don''t Waste My Time! Extension 1.0'
      AgentNameVersionMajor                : 'Don''t Waste My Time! Extension 1'
      AgentBuild                           : '2'


# The F-secure iOS app: FSCDCSafe
- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (iPhone; CPU iPhone OS 16_3_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) FSCDCSafe/20.0.290702 Mobile/15E148 Version/16.3.1 Safari/605.1.15'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15E148'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '16.3.1'
      OperatingSystemVersionMajor          : '16'
      OperatingSystemNameVersion           : 'iOS 16.3.1'
      OperatingSystemNameVersionMajor      : 'iOS 16'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'F-Secure'
      AgentVersion                         : '20.0.290702'
      AgentVersionMajor                    : '20'
      AgentNameVersion                     : 'F-Secure 20.0.290702'
      AgentNameVersionMajor                : 'F-Secure 20'


# TODO: No specifications and only this string as input.
# The values shown are my current guess. Looking for a specification and a few more examples
#- test:
#    input:
#      User-Agent                           : 'nu.nl/10.13 (iOS,16.2;230124161124;828x1792@2.0x)(Sanoma/app)'
#    expected:
#      DeviceClass                          : 'Mobile'
#      DeviceName                           : 'Apple iOS Device'
#      DeviceBrand                          : 'Apple'
#      OperatingSystemClass                 : 'Mobile'
#      OperatingSystemName                  : 'iOS'
#      OperatingSystemVersion               : '16.2'

#      LayoutEngineClass                    : 'Mobile App'

#      AgentClass                           : 'Mobile App'
#      AgentName                            : 'Nu.nl'
#      AgentVersion                         : '10.13'


- lookup:
    name: 'WhatsAppPlatforms'
    map:
      #            D brand  | Device name           | OS Name           | OS Version | OS Name Version
      "i"       : "Apple    | iOS Device            | iOS               | ??         | iOS ??"
      "A"       : "Unknown  | Android Device        | Android           | ??         | Android ??"
      "N"       : "Nokia    | KaiOS                 | KaiOS             | ??         | KaiOS ??"
      "W"       : "Unknown  | Generic Windows Phone | Windows Mobile    | 10         | Windows 10 Mobile"

- matcher:
    variable:
      - 'WhatsAppAgent:agent.(1)product.(1)name="WhatsApp"'
      - 'WhatsAppPlatform:LookUp[WhatsAppPlatforms;agent.(2)text]'
    extract:
    - 'DeviceClass                         :       11 :"Mobile"'
    - 'DeviceBrand                         :       11 :@WhatsAppPlatform[[1]]'
    - 'DeviceName                          :       11 :@WhatsAppPlatform[[2]]'
    - 'OperatingSystemClass                :       11 :"Mobile"'
    - 'OperatingSystemName                 :       11 :@WhatsAppPlatform[[3]]'
    - 'OperatingSystemVersion              :       11 :@WhatsAppPlatform[[4]]'
    - 'OperatingSystemNameVersion          :       11 :@WhatsAppPlatform[[5]]'
    - 'LayoutEngineClass                   :       11 :"Mobile App"'
    - 'AgentClass                          :       11 :"Mobile App"'
    - 'AgentName                           :       11 :"WhatsApp"'
    - 'AgentVersion                        :       11 :@WhatsAppAgent^.version'


- test:
    input:
      User-Agent                           : 'WhatsApp/2.23.3.77 i'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Apple iOS Device'
      DeviceBrand                          : 'Apple'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'iOS ??'
      OperatingSystemNameVersionMajor      : 'iOS ??'
      LayoutEngineClass                    : 'Mobile App'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WhatsApp'
      AgentVersion                         : '2.23.3.77'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'WhatsApp 2.23.3.77'
      AgentNameVersionMajor                : 'WhatsApp 2'


- test:
    input:
      User-Agent                           : 'WhatsApp/2.23.3.77 A'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Android Device'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Android ??'
      OperatingSystemNameVersionMajor      : 'Android ??'
      LayoutEngineClass                    : 'Mobile App'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WhatsApp'
      AgentVersion                         : '2.23.3.77'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'WhatsApp 2.23.3.77'
      AgentNameVersionMajor                : 'WhatsApp 2'


- test:
    input:
      User-Agent                           : 'WhatsApp/2.2305.7 N'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Nokia Kaios'
      DeviceBrand                          : 'Nokia'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'KaiOS'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'KaiOS ??'
      OperatingSystemNameVersionMajor      : 'KaiOS ??'
      LayoutEngineClass                    : 'Mobile App'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WhatsApp'
      AgentVersion                         : '2.2305.7'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'WhatsApp 2.2305.7'
      AgentNameVersionMajor                : 'WhatsApp 2'


- test:
    input:
      User-Agent                           : 'WhatsApp/2.2306.4 W'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Generic Windows Phone'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Windows Mobile'
      OperatingSystemVersion               : '10'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10 Mobile'
      OperatingSystemNameVersionMajor      : 'Windows 10 Mobile'
      LayoutEngineClass                    : 'Mobile App'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WhatsApp'
      AgentVersion                         : '2.2306.4'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'WhatsApp 2.2306.4'
      AgentNameVersionMajor                : 'WhatsApp 2'

# Bitwarden Mobile app
- matcher:
    require:
    - 'agent.(1)product.(1)name="Bitwarden_Mobile"'
    - 'agent.(1)product.(1)comments.entry.product.name="Android"'
    variable:
    - 'ModelTag : agent.(1)product.(1)comments.entry[1]="Model"@[2-]'
    extract:
    - 'DeviceClass  :   1                       : "Mobile"'
    - 'DeviceName   : 500                       : @ModelTag'
    - 'DeviceBrand  : 500                       : "<<<null>>>"'
    - 'AgentClass   : 500                       : "Mobile App"'
    - 'AgentName    : 500                       : "Bitwarden Mobile"'


# Bitwarden Mobile app (iOS) Fallback
- matcher:
    require:
    - 'agent.(1)product.(1)name="Bitwarden_Mobile"'
    variable:
    - 'AppleTag               : agent.(1)product.(1)comments.entry[1]="Model"@[2-]'
    - 'iOSVersion             : agent.(1)product.(1)comments.entry.product.name="iOS"^.version'
    extract:
    - 'DeviceClass            :   500 : LookUp[AppleDeviceClass;@AppleTag]'
    - 'DeviceBrand            :   500 : "Apple"'
    - 'DeviceName             :   500 : LookUp[AppleDeviceName;@AppleTag]'
    - 'DeviceVersion          :   500 : LookUp[AppleDeviceVersion;@AppleTag]'
    - 'AgentClass             :   500 : "Mobile App"'
    - 'AgentName              :   500 : "Bitwarden Mobile"'
    - 'OperatingSystemClass   :   500 : "Mobile"'
    - 'OperatingSystemName    :   500 : "iOS"'
    - 'OperatingSystemVersion :   500 : CleanVersion[@iOSVersion]'


# Bitwarden Mobile app (iOS)
- matcher:
    require:
    - 'agent.(1)product.(1)name="Bitwarden_Mobile"'
    variable:
    - 'AppleTag               : agent.(1)product.(1)comments.entry[1]="Model"@[2-]'
    - 'iOSVersion             : agent.(1)product.(1)comments.entry.product.name="iOS"^.version'
    extract:
    - 'DeviceClass            :   501 : LookUp[AppleDeviceClass;@AppleTag]'
    - 'DeviceBrand            :   501 : "Apple"'
    - 'DeviceName             :   501 : LookUp[AppleDeviceName;@AppleTag]'
    - 'DeviceVersion          :   501 : LookUp[AppleDeviceVersion;@AppleTag]'
    - 'AgentClass             :   501 : "Mobile App"'
    - 'AgentName              :   501 : "Bitwarden Mobile"'
    - 'OperatingSystemClass   :   501 : "Mobile"'
    - 'OperatingSystemName    :   501 : "iOS"'
    - 'OperatingSystemVersion :   501 : CleanVersion[@iOSVersion]'


- test:
    input:
      User-Agent                           : 'Bitwarden_Mobile/2023.5.0 (Android 11; SDK 30; Model Nokia 7.2)'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Nokia 7.2'
      DeviceBrand                          : 'Nokia'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '11'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'Android 11'
      OperatingSystemNameVersionMajor      : 'Android 11'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Bitwarden Mobile'
      AgentVersion                         : '2023.5.0'
      AgentVersionMajor                    : '2023'
      AgentNameVersion                     : 'Bitwarden Mobile 2023.5.0'
      AgentNameVersionMajor                : 'Bitwarden Mobile 2023'


- test:
    input:
      User-Agent                           : 'Bitwarden_Mobile/2023.5.0 (Android 12; SDK 31; Model Nokia 5.3)'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Nokia 5.3'
      DeviceBrand                          : 'Nokia'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '12'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'Android 12'
      OperatingSystemNameVersionMajor      : 'Android 12'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Bitwarden Mobile'
      AgentVersion                         : '2023.5.0'
      AgentVersionMajor                    : '2023'
      AgentNameVersion                     : 'Bitwarden Mobile 2023.5.0'
      AgentNameVersionMajor                : 'Bitwarden Mobile 2023'


- test:
    input:
      User-Agent                           : 'Bitwarden_Mobile/2023.5.0 (Android 12; SDK 31; Model Nokia 5.4)'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Nokia 5.4'
      DeviceBrand                          : 'Nokia'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '12'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'Android 12'
      OperatingSystemNameVersionMajor      : 'Android 12'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Bitwarden Mobile'
      AgentVersion                         : '2023.5.0'
      AgentVersionMajor                    : '2023'
      AgentNameVersion                     : 'Bitwarden Mobile 2023.5.0'
      AgentNameVersionMajor                : 'Bitwarden Mobile 2023'


- test:
    input:
      User-Agent                           : 'Bitwarden_Mobile/2023.5.0 (Android 13; SDK 33; Model SM-S901B)'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Samsung SM-S901B'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '13'
      OperatingSystemVersionMajor          : '13'
      OperatingSystemNameVersion           : 'Android 13'
      OperatingSystemNameVersionMajor      : 'Android 13'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Bitwarden Mobile'
      AgentVersion                         : '2023.5.0'
      AgentVersionMajor                    : '2023'
      AgentNameVersion                     : 'Bitwarden Mobile 2023.5.0'
      AgentNameVersionMajor                : 'Bitwarden Mobile 2023'


- test:
    input:
      User-Agent                           : 'Bitwarden_Mobile/2023.5.0 (Android 7.0; SDK 24; Model SM-T710)'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Samsung SM-T710'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.0'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Android 7.0'
      OperatingSystemNameVersionMajor      : 'Android 7'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Bitwarden Mobile'
      AgentVersion                         : '2023.5.0'
      AgentVersionMajor                    : '2023'
      AgentNameVersion                     : 'Bitwarden Mobile 2023.5.0'
      AgentNameVersionMajor                : 'Bitwarden Mobile 2023'


- test:
    input:
      User-Agent                           : 'Bitwarden_Mobile/2023.5.0 (Android 9; SDK 28; Model SM-G950F)'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Samsung SM-G950F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '9'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'Android 9'
      OperatingSystemNameVersionMajor      : 'Android 9'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Bitwarden Mobile'
      AgentVersion                         : '2023.5.0'
      AgentVersionMajor                    : '2023'
      AgentNameVersion                     : 'Bitwarden Mobile 2023.5.0'
      AgentNameVersionMajor                : 'Bitwarden Mobile 2023'


# No real example of iOS available right now.
# https://github.com/bitwarden/mobile/blob/master/src/iOS.Core/Services/DeviceActionService.cs#L29
#  _userAgent = $"Bitwarden_Mobile/{Xamarin.Essentials.AppInfo.VersionString} " +
#  $"(iOS {UIDevice.CurrentDevice.SystemVersion}; Model {UIDevice.CurrentDevice.Model})";

# FIXME: Manually created predicted useragent based on code
- test:
    input:
      User-Agent                           : 'Bitwarden_Mobile/2023.5.0 (iOS 12_3_1; Model iPhone15,2)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone 14 Pro'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '12.3.1'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'iOS 12.3.1'
      OperatingSystemNameVersionMajor      : 'iOS 12'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Bitwarden Mobile'
      AgentVersion                         : '2023.5.0'
      AgentVersionMajor                    : '2023'
      AgentNameVersion                     : 'Bitwarden Mobile 2023.5.0'
      AgentNameVersionMajor                : 'Bitwarden Mobile 2023'

# https://github.com/uphold/uphold-sdk-javascript
- matcher:
    require:
    - 'agent.(1)product.(1)name="uphold-sdk-javascript"'
    extract:
    - 'AgentName               :        10 :agent.(2)product.(1)name'
    - 'AgentVersion            :        10 :agent.(2)product.(1)version'

- matcher:
    require:
    - 'agent.(1)product.(1)name="uphold-sdk-javascript"'
    - 'agent.(2)product.(1)name[2]="Android"'
    extract:
    - 'DeviceName              :        11 : agent.(1)product.(1)comments.(1)entry.text'
    - 'OperatingSystemClass    :        11 :"Mobile"'
    - 'OperatingSystemName     :        11 :"Android"'
    - 'OperatingSystemVersion  :        11 :agent.(1)product.(1)comments.(2)entry.text'
    - 'AgentName               :        11 :agent.(2)product.(1)name[1]'
    - 'AgentVersion            :        11 :agent.(2)product.(1)version'

- matcher:
    require:
    - 'agent.(1)product.(1)name="uphold-sdk-javascript"'
    - 'agent.(2)product.(1)name[2]="iOS"'
    variable:
    - 'AppleTag: agent.(1)product.(1)comments.(1)entry.text'
    extract:
    - 'DeviceClass             :        11 : LookUp[AppleDeviceClass;@AppleTag]'
    - 'DeviceBrand             :        11 : "Apple"'
    - 'DeviceName              :        11 : LookUp[AppleDeviceName;@AppleTag]'
    - 'DeviceVersion           :        11 : LookUp[AppleDeviceVersion;@AppleTag]'
    - 'OperatingSystemClass    :        11 :"Mobile"'
    - 'OperatingSystemName     :        11 :"iOS"'
    - 'OperatingSystemVersion  :        11 :agent.(1)product.(1)comments.(2)entry.text'
    - 'AgentName               :        11 :agent.(2)product.(1)name[1]'
    - 'AgentVersion            :        11 :agent.(2)product.(1)version'

- test:
    input:
      User-Agent                           : 'uphold-sdk-javascript/v2.4.1 (taro; 12; en_US) Wallet Android/4.79.1'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Taro'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '12'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'Android 12'
      OperatingSystemNameVersionMajor      : 'Android 12'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Special'
      AgentName                            : 'Wallet'
      AgentVersion                         : '4.79.1'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Wallet 4.79.1'
      AgentNameVersionMajor                : 'Wallet 4'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'

# MT6737 is really a MediaTek CPU ... not a Phone
- test:
    input:
      User-Agent                           : 'uphold-sdk-javascript/v2.4.1 (MT6737; 9; es_US) Wallet Android/5.1.1'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'MediaTek MT6737'
      DeviceBrand                          : 'MediaTek'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '9'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'Android 9'
      OperatingSystemNameVersionMajor      : 'Android 9'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Special'
      AgentName                            : 'Wallet'
      AgentVersion                         : '5.1.1'
      AgentVersionMajor                    : '5'
      AgentNameVersion                     : 'Wallet 5.1.1'
      AgentNameVersionMajor                : 'Wallet 5'
      AgentLanguage                        : 'Spanish (United States)'
      AgentLanguageCode                    : 'es-us'

# EXYNOS9820 is really a Samsung CPU ... not a Phone
- test:
    input:
      User-Agent                           : 'uphold-sdk-javascript/v2.4.1 (exynos9820; 12; hu) Wallet Android/5.9.1'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Samsung EXYNOS9820'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '12'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'Android 12'
      OperatingSystemNameVersionMajor      : 'Android 12'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Special'
      AgentName                            : 'Wallet'
      AgentVersion                         : '5.9.1'
      AgentVersionMajor                    : '5'
      AgentNameVersion                     : 'Wallet 5.9.1'
      AgentNameVersionMajor                : 'Wallet 5'
      AgentLanguage                        : 'Hungarian'
      AgentLanguageCode                    : 'hu'

- test:
    input:
      User-Agent                           : 'uphold-sdk-javascript/v2.4.1 (iPhone13,4; 16.1.2; en) Wallet iOS/5.6.0'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone 12 Pro Max'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '16.1.2'
      OperatingSystemVersionMajor          : '16'
      OperatingSystemNameVersion           : 'iOS 16.1.2'
      OperatingSystemNameVersionMajor      : 'iOS 16'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Special'
      AgentName                            : 'Wallet'
      AgentVersion                         : '5.6.0'
      AgentVersionMajor                    : '5'
      AgentNameVersion                     : 'Wallet 5.6.0'
      AgentNameVersionMajor                : 'Wallet 5'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'

# Some kind of 'spec': https://github.com/Shopify/browser_sniffer/blob/master/test/shopify_agents_test.rb
- matcher:
    require:
      - 'agent.(1)product.(1)name="Shopify Mobile"'
      - 'agent.(1)product.(1)version="Android"'
    extract:
    - 'DeviceClass                         :      101 :"Mobile"'
    - 'DeviceBrand                         :      101 : agent.(1)product.(1)comments.(1)entry.product.name[1]="on"@[2-]'
    - 'DeviceName                          :      101 : agent.(1)product.(1)comments.(1)entry.product.name[1]="on"^.version'
    - 'OperatingSystemClass                :      101 :"Mobile"'
    - 'OperatingSystemName                 :      101 :"Android"'
    - 'OperatingSystemVersion              :      101 :LookUp[AndroidAPIToVersionMap;agent.(1)product.(1)comments.(1)entry.product.name="with API"^.version;"<<<null>>>"]'
    - 'OperatingSystemVersionBuild         :      101 :"<<<null>>>"'
    - 'AgentClass                          :     101 : "Mobile App"'
    - 'AgentName                           :     101 :"Shopify Mobile"'
    - 'AgentVersion                        :     101 :agent.(1)product.(2)version'
    - 'AgentBuild                          :     101 : agent.(1)product.(1)comments.(1)entry.(1)product.(1)name="Build"^.version'


- matcher:
    require:
    - 'agent.(1)product.(1)name="Shopify Mobile"'
    - 'agent.(1)product.(1)version="iOS"'
    variable:
    - 'AppleTag: agent.(1)product.(1)comments.(1)entry.(1)product.(1)name'
    extract:
    - 'DeviceClass                         :       11 : LookUp[AppleDeviceClass;@AppleTag]'
    - 'DeviceBrand                         :       11 : "Apple"'
    - 'DeviceName                          :       11 : LookUp[AppleDeviceName;@AppleTag]'
    - 'DeviceVersion                       :       11 : LookUp[AppleDeviceVersion;@AppleTag]'
    - 'OperatingSystemClass                :      101 :"Mobile"'
    - 'OperatingSystemName                 :      101 :"iOS"'
    - 'OperatingSystemVersion              :      101 :@AppleTag^.(2)version'
    - 'OperatingSystemVersionBuild         :      101 :"<<<null>>>"'
    - 'AgentClass                          :     101 : "Mobile App"'
    - 'AgentName                           :     101 :"Shopify Mobile"'
    - 'AgentVersion                        :     101 :agent.(1)product.(2)version'
    - 'AgentBuild                          :     101 : agent.product.name="Build"^.version'


- test:
    input:
      User-Agent                           : 'Shopify Mobile/Android/9.129.0 (Build 33470 with API 31 on OPPO CPH2223)'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Oppo CPH2223'
      DeviceBrand                          : 'Oppo'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '12'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'Android 12'
      OperatingSystemNameVersionMajor      : 'Android 12'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Shopify Mobile'
      AgentVersion                         : '9.129.0'
      AgentVersionMajor                    : '9'
      AgentNameVersion                     : 'Shopify Mobile 9.129.0'
      AgentNameVersionMajor                : 'Shopify Mobile 9'
      AgentBuild                           : '33470'


- test:
    input:
      User-Agent                           : 'Shopify Mobile/iOS/9.124.2 (iPhone15,3/com.jadedpixel.shopify/16.6.0) - Build 1184'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : 'iPhone 14 Pro Max'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '16.6.0'
      OperatingSystemVersionMajor          : '16'
      OperatingSystemNameVersion           : 'iOS 16.6.0'
      OperatingSystemNameVersionMajor      : 'iOS 16'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'Shopify Mobile'
      AgentVersion                         : '9.124.2'
      AgentVersionMajor                    : '9'
      AgentNameVersion                     : 'Shopify Mobile 9.124.2'
      AgentNameVersionMajor                : 'Shopify Mobile 9'
      AgentBuild                           : '1184'


# https://www.camscanner.com/
# A mobile app for scanning documents
- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (Linux; Android 9; SM-A530F Build/PPR1.180610.011; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/111.0.5563.58 Mobile Safari/537.36 CamScanner/6.27.0.2210170000'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung SM-A530F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '9'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'Android 9'
      OperatingSystemNameVersionMajor      : 'Android 9'
      OperatingSystemVersionBuild          : 'PPR1.180610.011'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '6.27.0.2210170000'
      LayoutEngineVersionMajor             : '6'
      LayoutEngineNameVersion              : 'Blink 6.27.0.2210170000'
      LayoutEngineNameVersionMajor         : 'Blink 6'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '6.27.0.2210170000'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'Chrome Webview 6.27.0.2210170000'
      AgentNameVersionMajor                : 'Chrome Webview 6'
      WebviewAppName                       : 'Camscanner'
      WebviewAppVersion                    : '6.27.0.2210170000'
      WebviewAppVersionMajor               : '6'
      WebviewAppNameVersion                : 'Camscanner 6.27.0.2210170000'
      WebviewAppNameVersionMajor           : 'Camscanner 6'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (Linux; Android 13; SM-A715F Build/TP1A.220624.014; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/111.0.5563.116 Mobile Safari/537.36 CamScanner/6.35.0.2302240000'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung SM-A715F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '13'
      OperatingSystemVersionMajor          : '13'
      OperatingSystemNameVersion           : 'Android 13'
      OperatingSystemNameVersionMajor      : 'Android 13'
      OperatingSystemVersionBuild          : 'TP1A.220624.014'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '6.35.0.2302240000'
      LayoutEngineVersionMajor             : '6'
      LayoutEngineNameVersion              : 'Blink 6.35.0.2302240000'
      LayoutEngineNameVersionMajor         : 'Blink 6'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '6.35.0.2302240000'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'Chrome Webview 6.35.0.2302240000'
      AgentNameVersionMajor                : 'Chrome Webview 6'
      WebviewAppName                       : 'Camscanner'
      WebviewAppVersion                    : '6.35.0.2302240000'
      WebviewAppVersionMajor               : '6'
      WebviewAppNameVersion                : 'Camscanner 6.35.0.2302240000'
      WebviewAppNameVersionMajor           : 'Camscanner 6'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (Linux; Android 10; CPH2161 Build/QP1A.190711.020; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/113.0.5672.76 Mobile Safari/537.36 CamScanner/6.40.0.2304260000'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Oppo CPH2161'
      DeviceBrand                          : 'Oppo'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '10'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Android 10'
      OperatingSystemNameVersionMajor      : 'Android 10'
      OperatingSystemVersionBuild          : 'QP1A.190711.020'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '6.40.0.2304260000'
      LayoutEngineVersionMajor             : '6'
      LayoutEngineNameVersion              : 'Blink 6.40.0.2304260000'
      LayoutEngineNameVersionMajor         : 'Blink 6'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '6.40.0.2304260000'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'Chrome Webview 6.40.0.2304260000'
      AgentNameVersionMajor                : 'Chrome Webview 6'
      WebviewAppName                       : 'Camscanner'
      WebviewAppVersion                    : '6.40.0.2304260000'
      WebviewAppVersionMajor               : '6'
      WebviewAppNameVersion                : 'Camscanner 6.40.0.2304260000'
      WebviewAppNameVersionMajor           : 'Camscanner 6'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (Linux; Android 13; SM-A528B Build/TP1A.220624.014; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/118.0.0.0 Mobile Safari/537.36 CamScanner/6.51.0.2310160000'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung SM-A528B'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '13'
      OperatingSystemVersionMajor          : '13'
      OperatingSystemNameVersion           : 'Android 13'
      OperatingSystemNameVersionMajor      : 'Android 13'
      OperatingSystemVersionBuild          : 'TP1A.220624.014'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '6.51.0.2310160000'
      LayoutEngineVersionMajor             : '6'
      LayoutEngineNameVersion              : 'Blink 6.51.0.2310160000'
      LayoutEngineNameVersionMajor         : 'Blink 6'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '6.51.0.2310160000'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'Chrome Webview 6.51.0.2310160000'
      AgentNameVersionMajor                : 'Chrome Webview 6'
      WebviewAppName                       : 'Camscanner'
      WebviewAppVersion                    : '6.51.0.2310160000'
      WebviewAppVersionMajor               : '6'
      WebviewAppNameVersion                : 'Camscanner 6.51.0.2310160000'
      WebviewAppNameVersionMajor           : 'Camscanner 6'


# A mobile app to connect to a Nextcloud instance
- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (iOS) Nextcloud-iOS/4.7.0'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'iOS ??'
      OperatingSystemNameVersionMajor      : 'iOS ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '5.0'
      LayoutEngineVersionMajor             : '5'
      LayoutEngineNameVersion              : 'Mozilla 5.0'
      LayoutEngineNameVersionMajor         : 'Mozilla 5'
      AgentClass                           : 'MobileApp'
      AgentName                            : 'NextCloud iOS'
      AgentVersion                         : '4.7.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'NextCloud iOS 4.7.0'
      AgentNameVersionMajor                : 'NextCloud iOS 4'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (Android) Nextcloud-android/3.24.2'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Android Mobile'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Android ??'
      OperatingSystemNameVersionMajor      : 'Android ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '5.0'
      LayoutEngineVersionMajor             : '5'
      LayoutEngineNameVersion              : 'Mozilla 5.0'
      LayoutEngineNameVersionMajor         : 'Mozilla 5'
      AgentClass                           : 'MobileApp'
      AgentName                            : 'NextCloud Android'
      AgentVersion                         : '3.24.2'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'NextCloud Android 3.24.2'
      AgentNameVersionMajor                : 'NextCloud Android 3'

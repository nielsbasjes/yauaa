#
# Yet Another UserAgent Analyzer
# Copyright (C) 2013-2018 Niels Basjes
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an AS IS BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

# These are examples of robot/spider/bot useragents we have seen.

config:

- lookup:
    name: 'NamedRobots'
    map:
      'DejaClick'                  : 'DejaClick'
      'Site-Shot'                  : 'Site-Shot'
      'Vagabondo'                  : 'Wise-Guys'
      'Netcraft Web Server Survey' : 'Netcraft'

- matcher:
    variable:
    - 'RobotProductName:agent.product.name?NamedRobots'
    extract:
    - 'DeviceClass           : 1000:"Robot"'
    - 'DeviceBrand           : 1000:LookUp[NamedRobots;@RobotProductName]'
    - 'DeviceName            : 1000:@RobotProductName'
    - 'DeviceCpu             : 1000:"<<<null>>>"'
    - 'DeviceCpuBits         : 1000:"<<<null>>>"'
    - 'LayoutEngineClass     : 1000:"Robot"'
    - 'LayoutEngineName      : 1000:@RobotProductName'
    - 'LayoutEngineVersion   : 1000:@RobotProductName^.version'
    - 'AgentClass            : 1000:"Robot"'
    - 'AgentName             : 1000:@RobotProductName'
    - 'AgentVersion          : 1000:@RobotProductName^.version'

- matcher:
    variable:
    - 'RobotProductName:agent.product.comments.entry.product.name?NamedRobots'
    extract:
    - 'DeviceClass           : 1000:"Robot"'
    - 'DeviceBrand           : 1000:LookUp[NamedRobots;@RobotProductName]'
    - 'DeviceName            : 1000:@RobotProductName'
    - 'DeviceCpu             : 1000:"<<<null>>>"'
    - 'DeviceCpuBits         : 1000:"<<<null>>>"'
    - 'LayoutEngineClass     : 1000:"Robot"'
    - 'LayoutEngineName      : 1000:@RobotProductName'
    - 'LayoutEngineVersion   : 1000:@RobotProductName^.version'
    - 'AgentClass            : 1000:"Robot"'
    - 'AgentName             : 1000:@RobotProductName'
    - 'AgentVersion          : 1000:@RobotProductName^.version'


- matcher:
    variable:
    - 'RobotProductName:agent.product.comments.entry.text?NamedRobots'
    extract:
    - 'DeviceClass           : 1000:"Robot"'
    - 'DeviceBrand           : 1000:LookUp[NamedRobots;@RobotProductName]'
    - 'DeviceName            : 1000:@RobotProductName'
    - 'DeviceCpu             : 1000:"<<<null>>>"'
    - 'DeviceCpuBits         : 1000:"<<<null>>>"'
    - 'LayoutEngineClass     : 1000:"Robot"'
    - 'LayoutEngineName      : 1000:@RobotProductName'
    - 'LayoutEngineVersion   : 1000:"??"'
    - 'AgentClass            : 1000:"Robot"'
    - 'AgentName             : 1000:@RobotProductName'
    - 'AgentVersion          : 1000:"??"'

# --------------------------------------------------------------------------------------
- matcher:
    variable:
    - 'RobotProduct:agent.product.version~"spider"^'
    extract:
    - 'DeviceClass           :  102:"Robot"'
    - 'DeviceName            :  102:@RobotProduct.name'
    - 'DeviceCpu             : 1000:"<<<null>>>"'
    - 'DeviceCpuBits         : 1000:"<<<null>>>"'
    - 'OperatingSystemClass  :  102:"Cloud"'
    - 'OperatingSystemName   :  102:"Cloud"'
    - 'OperatingSystemVersion:  102:"Cloud"'
    - 'LayoutEngineClass     :  102:"Robot"'
    - 'LayoutEngineName      :  102:@RobotProduct.name'
    - 'LayoutEngineVersion   :  102:@RobotProduct.(1)version'
    - 'AgentClass            :  102:"Robot"'
    - 'AgentName             :  102:@RobotProduct.name'
    - 'AgentVersion          :  102:@RobotProduct.(1)version'

- matcher:
    variable:
    - 'RobotProduct:agent.product.version~"crawl"^'
    extract:
    - 'DeviceClass           :  102:"Robot"'
    - 'DeviceName            :  102:@RobotProduct.name'
    - 'DeviceCpu             : 1000:"<<<null>>>"'
    - 'DeviceCpuBits         : 1000:"<<<null>>>"'
    - 'OperatingSystemClass  :  102:"Cloud"'
    - 'OperatingSystemName   :  102:"Cloud"'
    - 'OperatingSystemVersion:  102:"Cloud"'
    - 'LayoutEngineClass     :  102:"Robot"'
    - 'LayoutEngineName      :  102:@RobotProduct.name'
    - 'LayoutEngineVersion   :  102:@RobotProduct.(1)version'
    - 'AgentClass            :  102:"Robot"'
    - 'AgentName             :  102:@RobotProduct.name'
    - 'AgentVersion          :  102:@RobotProduct.(1)version'


- matcher:
    variable:
    - 'RobotProduct:agent.product.version~"bot"^'
    extract:
    - 'DeviceClass           :  102:"Robot"'
    - 'DeviceName            :  102:@RobotProduct.name'
    - 'DeviceCpu             : 1000:"<<<null>>>"'
    - 'DeviceCpuBits         : 1000:"<<<null>>>"'
    - 'OperatingSystemClass  :  102:"Cloud"'
    - 'OperatingSystemName   :  102:"Cloud"'
    - 'OperatingSystemVersion:  102:"Cloud"'
    - 'LayoutEngineClass     :  102:"Robot"'
    - 'LayoutEngineName      :  102:@RobotProduct.name'
    - 'LayoutEngineVersion   :  102:@RobotProduct.(1)version'
    - 'AgentClass            :  102:"Robot"'
    - 'AgentName             :  102:@RobotProduct.name'
    - 'AgentVersion          :  102:@RobotProduct.(1)version'


- matcher:
    variable:
    - 'RobotProduct:agent.product.version~"scan"^'
    extract:
    - 'DeviceClass           :  102:"Robot"'
    - 'DeviceName            :  102:@RobotProduct.name'
    - 'DeviceCpu             : 1000:"<<<null>>>"'
    - 'DeviceCpuBits         : 1000:"<<<null>>>"'
    - 'OperatingSystemClass  :  102:"Cloud"'
    - 'OperatingSystemName   :  102:"Cloud"'
    - 'OperatingSystemVersion:  102:"Cloud"'
    - 'LayoutEngineClass     :  102:"Robot"'
    - 'LayoutEngineName      :  102:@RobotProduct.name'
    - 'LayoutEngineVersion   :  102:@RobotProduct.(1)version'
    - 'AgentClass            :  102:"Robot"'
    - 'AgentName             :  102:@RobotProduct.name'
    - 'AgentVersion          :  102:@RobotProduct.(1)version'

#- matcher:
#    variable:
#    - 'RobotProduct:agent.product.version~"checker"^'
#    extract:
#    - 'DeviceClass           :  102:"Robot"'
#    - 'DeviceName            :  102:@RobotProduct.name'
#    - 'DeviceCpu             : 1000:"<<<null>>>"'
#    - 'DeviceCpuBits         : 1000:"<<<null>>>"'
#    - 'OperatingSystemClass  :  102:"Cloud"'
#    - 'OperatingSystemName   :  102:"Cloud"'
#    - 'OperatingSystemVersion:  102:"Cloud"'
#    - 'LayoutEngineClass     :  102:"Robot"'
#    - 'LayoutEngineName      :  102:@RobotProduct.name'
#    - 'LayoutEngineVersion   :  102:@RobotProduct.(1)version'
#    - 'AgentClass            :  102:"Robot"'
#    - 'AgentName             :  102:@RobotProduct.name'
#    - 'AgentVersion          :  102:@RobotProduct.(1)version'

# --------------------------------------------------------------------------------------


- matcher:
    variable:
    - 'RobotName:agent.text~"spider"'
    extract:
    - 'DeviceClass           :  101:"Robot"'
    - 'DeviceName            :  101:@RobotName'
    - 'DeviceCpu             : 1000:"<<<null>>>"'
    - 'DeviceCpuBits         : 1000:"<<<null>>>"'
    - 'OperatingSystemClass  :  101:"Cloud"'
    - 'OperatingSystemName   :  101:"Cloud"'
    - 'OperatingSystemVersion:  101:"Cloud"'
    - 'LayoutEngineClass     :  101:"Robot"'
    - 'LayoutEngineName      :  101:@RobotName'
    - 'LayoutEngineVersion   :  101:"??"'
    - 'AgentClass            :  101:"Robot"'
    - 'AgentName             :  101:@RobotName'
    - 'AgentVersion          :  101:"??"'


- matcher:
    variable:
    - 'RobotName:agent.text~"crawl"'
    extract:
    - 'DeviceClass           :  101:"Robot"'
    - 'DeviceName            :  101:@RobotName'
    - 'DeviceCpu             : 1000:"<<<null>>>"'
    - 'DeviceCpuBits         : 1000:"<<<null>>>"'
    - 'OperatingSystemClass  :  101:"Cloud"'
    - 'OperatingSystemName   :  101:"Cloud"'
    - 'OperatingSystemVersion:  101:"Cloud"'
    - 'LayoutEngineClass     :  101:"Robot"'
    - 'LayoutEngineName      :  101:@RobotName'
    - 'LayoutEngineVersion   :  101:"??"'
    - 'AgentClass            :  101:"Robot"'
    - 'AgentName             :  101:@RobotName'
    - 'AgentVersion          :  101:"??"'


- matcher:
    variable:
    - 'RobotName:agent.text~"bot"'
    extract:
    - 'DeviceClass           :  101:"Robot"'
    - 'DeviceName            :  101:@RobotName'
    - 'DeviceCpu             : 1000:"<<<null>>>"'
    - 'DeviceCpuBits         : 1000:"<<<null>>>"'
    - 'OperatingSystemClass  :  101:"Cloud"'
    - 'OperatingSystemName   :  101:"Cloud"'
    - 'OperatingSystemVersion:  101:"Cloud"'
    - 'LayoutEngineClass     :  101:"Robot"'
    - 'LayoutEngineName      :  101:@RobotName'
    - 'LayoutEngineVersion   :  101:"??"'
    - 'AgentClass            :  101:"Robot"'
    - 'AgentName             :  101:@RobotName'
    - 'AgentVersion          :  101:"??"'


- matcher:
    variable:
    - 'RobotName:agent.text~"scan"'
    extract:
    - 'DeviceClass           :  101:"Robot"'
    - 'DeviceName            :  101:@RobotName'
    - 'DeviceCpu             : 1000:"<<<null>>>"'
    - 'DeviceCpuBits         : 1000:"<<<null>>>"'
    - 'OperatingSystemClass  :  101:"Cloud"'
    - 'OperatingSystemName   :  101:"Cloud"'
    - 'OperatingSystemVersion:  101:"Cloud"'
    - 'LayoutEngineClass     :  101:"Robot"'
    - 'LayoutEngineName      :  101:@RobotName'
    - 'LayoutEngineVersion   :  101:"??"'
    - 'AgentClass            :  101:"Robot"'
    - 'AgentName             :  101:@RobotName'
    - 'AgentVersion          :  101:"??"'

- matcher:
    variable:
    - 'RobotName:agent.text~"checker"'
    extract:
    - 'DeviceClass           :  101:"Robot"'
    - 'DeviceName            :  101:@RobotName'
    - 'DeviceCpu             : 1000:"<<<null>>>"'
    - 'DeviceCpuBits         : 1000:"<<<null>>>"'
    - 'OperatingSystemClass  :  101:"Cloud"'
    - 'OperatingSystemName   :  101:"Cloud"'
    - 'OperatingSystemVersion:  101:"Cloud"'
    - 'LayoutEngineClass     :  101:"Robot"'
    - 'LayoutEngineName      :  101:@RobotName'
    - 'LayoutEngineVersion   :  101:"??"'
    - 'AgentClass            :  101:"Robot"'
    - 'AgentName             :  101:@RobotName'
    - 'AgentVersion          :  101:"??"'

# --------------------------------------------------------------------------------------

- matcher:
    variable:
    - 'RobotName:agent.product.name~"spider"'
    extract:
    - 'DeviceClass           :  111:"Robot"'
    - 'DeviceName            :  111:@RobotName'
    - 'DeviceCpu             : 1000:"<<<null>>>"'
    - 'DeviceCpuBits         : 1000:"<<<null>>>"'
    - 'OperatingSystemClass  :  111:"Cloud"'
    - 'OperatingSystemName   :  111:"Cloud"'
    - 'OperatingSystemVersion:  111:"Cloud"'
    - 'LayoutEngineClass     :  111:"Robot"'
    - 'LayoutEngineName      :  111:@RobotName'
    - 'LayoutEngineVersion   :  111:"??"'
    - 'AgentClass            :  111:"Robot"'
    - 'AgentName             :  111:@RobotName'
    - 'AgentVersion          :  111:"??"'

- matcher:
    require:
    - 'agent.product.name~"spider"@~"mobile"'
    extract:
    - 'DeviceClass           :  112:"Robot Mobile"'

- matcher:
    variable:
    - 'RobotVersion:agent.product.name~"spider"^.(1)version'
    extract:
    - 'LayoutEngineVersion   :  112:@RobotVersion'
    - 'AgentVersion          :  112:@RobotVersion'

- matcher:
    variable:
    - 'RobotName:agent.product.name~"crawl"'
    extract:
    - 'DeviceClass           :  111:"Robot"'
    - 'DeviceName            :  111:@RobotName'
    - 'DeviceCpu             : 1000:"<<<null>>>"'
    - 'DeviceCpuBits         : 1000:"<<<null>>>"'
    - 'OperatingSystemClass  :  111:"Cloud"'
    - 'OperatingSystemName   :  111:"Cloud"'
    - 'OperatingSystemVersion:  111:"Cloud"'
    - 'LayoutEngineClass     :  111:"Robot"'
    - 'LayoutEngineName      :  111:@RobotName'
    - 'LayoutEngineVersion   :  111:"??"'
    - 'AgentClass            :  111:"Robot"'
    - 'AgentName             :  111:@RobotName'
    - 'AgentVersion          :  111:"??"'

- matcher:
    require:
    - 'agent.product.name~"crawl"@~"mobile"'
    extract:
    - 'DeviceClass           :  112:"Robot Mobile"'

- matcher:
    variable:
    - 'RobotVersion:agent.product.name~"crawl"^.(1)version'
    extract:
    - 'LayoutEngineVersion   :  112:@RobotVersion'
    - 'AgentVersion          :  112:@RobotVersion'

- matcher:
    variable:
    - 'RobotName:agent.product.name~"bot"'
    extract:
    - 'DeviceClass           :  111:"Robot"'
    - 'DeviceName            :  111:@RobotName'
    - 'DeviceCpu             : 1000:"<<<null>>>"'
    - 'DeviceCpuBits         : 1000:"<<<null>>>"'
    - 'OperatingSystemClass  :  111:"Cloud"'
    - 'OperatingSystemName   :  111:"Cloud"'
    - 'OperatingSystemVersion:  111:"Cloud"'
    - 'LayoutEngineClass     :  111:"Robot"'
    - 'LayoutEngineName      :  111:@RobotName'
    - 'LayoutEngineVersion   :  111:"??"'
    - 'AgentClass            :  111:"Robot"'
    - 'AgentName             :  111:@RobotName'
    - 'AgentVersion          :  111:"??"'

- matcher:
    require:
    - 'agent.product.name~"bot"@~"mobile"'
    extract:
    - 'DeviceClass           :  112:"Robot Mobile"'

- matcher:
    variable:
    - 'RobotVersion:agent.product.name~"bot"^.(1)version'
    extract:
    - 'LayoutEngineVersion   :  112:@RobotVersion'
    - 'AgentVersion          :  112:@RobotVersion'

- matcher:
    variable:
    - 'RobotName:agent.product.name~"scan"'
    extract:
    - 'DeviceClass           :  111:"Robot"'
    - 'DeviceName            :  111:@RobotName'
    - 'DeviceCpu             : 1000:"<<<null>>>"'
    - 'DeviceCpuBits         : 1000:"<<<null>>>"'
    - 'OperatingSystemClass  :  111:"Cloud"'
    - 'OperatingSystemName   :  111:"Cloud"'
    - 'OperatingSystemVersion:  111:"Cloud"'
    - 'LayoutEngineClass     :  111:"Robot"'
    - 'LayoutEngineName      :  111:@RobotName'
    - 'LayoutEngineVersion   :  111:"??"'
    - 'AgentClass            :  111:"Robot"'
    - 'AgentName             :  111:@RobotName'
    - 'AgentVersion          :  111:"??"'

- matcher:
    require:
    - 'agent.product.name~"scan"@~"mobile"'
    extract:
    - 'DeviceClass           :  112:"Robot Mobile"'

- matcher:
    variable:
    - 'RobotVersion:agent.product.name~"scan"^.(1)version'
    extract:
    - 'LayoutEngineVersion   :  112:@RobotVersion'
    - 'AgentVersion          :  112:@RobotVersion'

#- matcher:
#    variable:
#    - 'RobotName:agent.product.name~"checker"'
#    extract:
#    - 'DeviceClass           :  111:"Robot"'
#    - 'DeviceName            :  111:@RobotName'
#    - 'DeviceCpu             : 1000:"<<<null>>>"'
#    - 'DeviceCpuBits         : 1000:"<<<null>>>"'
#    - 'OperatingSystemClass  :  111:"Cloud"'
#    - 'OperatingSystemName   :  111:"Cloud"'
#    - 'OperatingSystemVersion:  111:"Cloud"'
#    - 'LayoutEngineClass     :  111:"Robot"'
#    - 'LayoutEngineName      :  111:@RobotName'
#    - 'LayoutEngineVersion   :  111:"??"'
#    - 'AgentClass            :  111:"Robot"'
#    - 'AgentName             :  111:@RobotName'
#    - 'AgentVersion          :  111:"??"'
#
#- matcher:
#    require:
#    - 'agent.product.name~"checker"@~"mobile"'
#    extract:
#    - 'DeviceClass           :  112:"Robot Mobile"'
#
#- matcher:
#    variable:
#    - 'RobotVersion:agent.product.name~"checker"^.(1)version'
#    extract:
#    - 'LayoutEngineVersion   :  112:@RobotVersion'
#    - 'AgentVersion          :  112:@RobotVersion'

- matcher:
    variable:
    - 'RobotName:agent.(1)product.comments.entry.product.name~"spider"'
    extract:
    - '__Set_ALL_Fields__    :   99:"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'DeviceClass           :  100:"Robot"'
    - 'DeviceName            :  100:@RobotName'
    - 'DeviceCpu             : 1000:"<<<null>>>"'
    - 'DeviceCpuBits         : 1000:"<<<null>>>"'
    - 'OperatingSystemClass  :  100:"Cloud"'
    - 'OperatingSystemName   :  100:"Cloud"'
    - 'OperatingSystemVersion:  100:"Cloud"'
    - 'LayoutEngineClass     :  100:"Robot"'
    - 'LayoutEngineName      :  100:@RobotName'
    - 'LayoutEngineVersion   :  100:@RobotName^.version'
    - 'AgentClass            :  100:"Robot"'
    - 'AgentName             :  100:@RobotName'
    - 'AgentVersion          :  100:@RobotName^.version'

- matcher:
    variable:
    - 'RobotName:agent.(1)product.comments.entry.product.name~"crawl"'
    extract:
    - '__Set_ALL_Fields__    :   99:"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'DeviceClass           :  100:"Robot"'
    - 'DeviceName            :  100:@RobotName'
    - 'DeviceCpu             : 1000:"<<<null>>>"'
    - 'DeviceCpuBits         : 1000:"<<<null>>>"'
    - 'OperatingSystemClass  :  100:"Cloud"'
    - 'OperatingSystemName   :  100:"Cloud"'
    - 'OperatingSystemVersion:  100:"Cloud"'
    - 'LayoutEngineClass     :  100:"Robot"'
    - 'LayoutEngineName      :  100:@RobotName'
    - 'LayoutEngineVersion   :  100:@RobotName^.version'
    - 'AgentClass            :  100:"Robot"'
    - 'AgentName             :  100:@RobotName'
    - 'AgentVersion          :  100:@RobotName^.version'

- matcher:
    require:
    - 'IsNull[agent.(1)product.comments.entry.product.name[1]="cubot"]'
    variable:
    - 'RobotName:agent.(1)product.comments.entry.product.name~"bot"'
    extract:
    - '__Set_ALL_Fields__    :   99:"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'DeviceClass           :  100:"Robot"'
    - 'DeviceName            :  100:@RobotName'
    - 'DeviceCpu             : 1000:"<<<null>>>"'
    - 'DeviceCpuBits         : 1000:"<<<null>>>"'
    - 'OperatingSystemClass  :  100:"Cloud"'
    - 'OperatingSystemName   :  100:"Cloud"'
    - 'OperatingSystemVersion:  100:"Cloud"'
    - 'LayoutEngineClass     :  100:"Robot"'
    - 'LayoutEngineName      :  100:@RobotName'
    - 'LayoutEngineVersion   :  100:@RobotName^.version'
    - 'AgentClass            :  100:"Robot"'
    - 'AgentName             :  100:@RobotName'
    - 'AgentVersion          :  100:@RobotName^.version'

- matcher:
    variable:
    - 'RobotName:agent.(1)product.comments.entry.product.name~"scan"'
    extract:
    - '__Set_ALL_Fields__    :   99:"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'DeviceClass           :  100:"Robot"'
    - 'DeviceName            :  100:@RobotName'
    - 'DeviceCpu             : 1000:"<<<null>>>"'
    - 'DeviceCpuBits         : 1000:"<<<null>>>"'
    - 'OperatingSystemClass  :  100:"Cloud"'
    - 'OperatingSystemName   :  100:"Cloud"'
    - 'OperatingSystemVersion:  100:"Cloud"'
    - 'LayoutEngineClass     :  100:"Robot"'
    - 'LayoutEngineName      :  100:@RobotName'
    - 'LayoutEngineVersion   :  100:@RobotName^.version'
    - 'AgentClass            :  100:"Robot"'
    - 'AgentName             :  100:@RobotName'
    - 'AgentVersion          :  100:@RobotName^.version'

#- matcher:
#    variable:
#    - 'RobotName:agent.(1)product.comments.entry.product.name~"checker"'
#    extract:
#    - '__Set_ALL_Fields__    :   99:"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
#    - 'DeviceClass           :  100:"Robot"'
#    - 'DeviceName            :  100:@RobotName'
#    - 'DeviceCpu             : 1000:"<<<null>>>"'
#    - 'DeviceCpuBits         : 1000:"<<<null>>>"'
#    - 'OperatingSystemClass  :  100:"Cloud"'
#    - 'OperatingSystemName   :  100:"Cloud"'
#    - 'OperatingSystemVersion:  100:"Cloud"'
#    - 'LayoutEngineClass     :  100:"Robot"'
#    - 'LayoutEngineName      :  100:@RobotName'
#    - 'LayoutEngineVersion   :  100:@RobotName^.version'
#    - 'AgentClass            :  100:"Robot"'
#    - 'AgentName             :  100:@RobotName'
#    - 'AgentVersion          :  100:@RobotName^.version'

- matcher:
    variable:
    - 'RobotName:agent.(1)product.comments.entry.text~"spider"'
    extract:
    - '__Set_ALL_Fields__    :   99:"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'DeviceClass           :  100:"Robot"'
    - 'DeviceName            :  100:@RobotName'
    - 'DeviceCpu             : 1000:"<<<null>>>"'
    - 'DeviceCpuBits         : 1000:"<<<null>>>"'
    - 'OperatingSystemClass  :  100:"Cloud"'
    - 'OperatingSystemName   :  100:"Cloud"'
    - 'OperatingSystemVersion:  100:"Cloud"'
    - 'LayoutEngineClass     :  100:"Robot"'
    - 'LayoutEngineName      :  100:@RobotName'
    - 'LayoutEngineVersion   :  100:@RobotName'
    - 'AgentClass            :  100:"Robot"'
    - 'AgentName             :  100:@RobotName'
    - 'AgentVersion          :  100:@RobotName'

- matcher:
    variable:
    - 'RobotName:agent.(1)product.comments.entry.text~"crawl"'
    extract:
    - '__Set_ALL_Fields__    :   99:"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'DeviceClass           :  100:"Robot"'
    - 'DeviceName            :  100:@RobotName'
    - 'DeviceCpu             : 1000:"<<<null>>>"'
    - 'DeviceCpuBits         : 1000:"<<<null>>>"'
    - 'OperatingSystemClass  :  100:"Cloud"'
    - 'OperatingSystemName   :  100:"Cloud"'
    - 'OperatingSystemVersion:  100:"Cloud"'
    - 'LayoutEngineClass     :  100:"Robot"'
    - 'LayoutEngineName      :  100:@RobotName'
    - 'LayoutEngineVersion   :  100:@RobotName'
    - 'AgentClass            :  100:"Robot"'
    - 'AgentName             :  100:@RobotName'
    - 'AgentVersion          :  100:@RobotName'

- matcher:
    require:
    - 'IsNull[agent.(1)product.comments.entry.text[1]="cubot"]'
    variable:
    - 'RobotName:agent.(1)product.comments.entry.text~"bot"'
    extract:
    - '__Set_ALL_Fields__    :   99:"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'DeviceClass           :  100:"Robot"'
    - 'DeviceName            :  100:@RobotName'
    - 'DeviceCpu             : 1000:"<<<null>>>"'
    - 'DeviceCpuBits         : 1000:"<<<null>>>"'
    - 'OperatingSystemClass  :  100:"Cloud"'
    - 'OperatingSystemName   :  100:"Cloud"'
    - 'OperatingSystemVersion:  100:"Cloud"'
    - 'LayoutEngineClass     :  100:"Robot"'
    - 'LayoutEngineName      :  100:@RobotName'
    - 'LayoutEngineVersion   :  100:@RobotName'
    - 'AgentClass            :  100:"Robot"'
    - 'AgentName             :  100:@RobotName'
    - 'AgentVersion          :  100:@RobotName'

- matcher:
    variable:
    - 'RobotName:agent.(1)product.comments.entry.text~"scan"'
    extract:
    - '__Set_ALL_Fields__    :   99:"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'DeviceClass           :  100:"Robot"'
    - 'DeviceName            :  100:@RobotName'
    - 'DeviceCpu             : 1000:"<<<null>>>"'
    - 'DeviceCpuBits         : 1000:"<<<null>>>"'
    - 'OperatingSystemClass  :  100:"Cloud"'
    - 'OperatingSystemName   :  100:"Cloud"'
    - 'OperatingSystemVersion:  100:"Cloud"'
    - 'LayoutEngineClass     :  100:"Robot"'
    - 'LayoutEngineName      :  100:@RobotName'
    - 'LayoutEngineVersion   :  100:@RobotName'
    - 'AgentClass            :  100:"Robot"'
    - 'AgentName             :  100:@RobotName'
    - 'AgentVersion          :  100:@RobotName'

#- matcher:
#    variable:
#    - 'RobotName:agent.(1)product.comments.entry.text~"checker"'
#    extract:
#    - '__Set_ALL_Fields__    :   99:"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
#    - 'DeviceClass           :  100:"Robot"'
#    - 'DeviceName            :  100:@RobotName'
#    - 'DeviceCpu             : 1000:"<<<null>>>"'
#    - 'DeviceCpuBits         : 1000:"<<<null>>>"'
#    - 'OperatingSystemClass  :  100:"Cloud"'
#    - 'OperatingSystemName   :  100:"Cloud"'
#    - 'OperatingSystemVersion:  100:"Cloud"'
#    - 'LayoutEngineClass     :  100:"Robot"'
#    - 'LayoutEngineName      :  100:@RobotName'
#    - 'LayoutEngineVersion   :  100:@RobotName'
#    - 'AgentClass            :  100:"Robot"'
#    - 'AgentName             :  100:@RobotName'
#    - 'AgentVersion          :  100:@RobotName'

- matcher:
    variable:
    - 'PhantomJSVersion:agent.product.name="PhantomJS"^.version'
    extract:
    - 'DeviceClass           : 1000:"Robot"'
    - 'DeviceBrand           : 1000:"PhantomJS"'
    - 'DeviceName            : 1000:"PhantomJS"'
    - 'DeviceCpu             : 1000:"<<<null>>>"'
    - 'DeviceCpuBits         : 1000:"<<<null>>>"'
    - 'LayoutEngineClass     : 1000:"Robot"'
    - 'LayoutEngineName      : 1000:"PhantomJS"'
    - 'LayoutEngineVersion   : 1000:@PhantomJSVersion'
    - 'AgentClass            : 1000:"Robot"'
    - 'AgentName             : 1000:"PhantomJS"'
    - 'AgentVersion          : 1000:@PhantomJSVersion'

# ------------------------------------------------------------

- test:
    input:
      user_agent_string: 'Sogou web spider/4.0(+http://www.sogou.com/docs/help/webmasters.htm#07)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Sogou WEB Spider'
      DeviceBrand                          : 'Sogou'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Sogou web spider'
      LayoutEngineVersion                  : '4.0'
      LayoutEngineVersionMajor             : '4'
      LayoutEngineNameVersion              : 'Sogou web spider 4.0'
      LayoutEngineNameVersionMajor         : 'Sogou web spider 4'
      AgentClass                           : 'Robot'
      AgentName                            : 'Sogou web spider'
      AgentVersion                         : '4.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Sogou web spider 4.0'
      AgentNameVersionMajor                : 'Sogou web spider 4'
      AgentInformationUrl                  : 'http://www.sogou.com/docs/help/webmasters.htm#07'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Unknown; Linux x86_64) AppleWebKit/534.34 (KHTML, like Gecko) PhantomJS/1.9.8 Safari/534.34'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'PhantomJs'
      DeviceBrand                          : 'PhantomJs'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : 'Intel x86_64'
      OperatingSystemNameVersion           : 'Linux Intel x86_64'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'PhantomJS'
      LayoutEngineVersion                  : '1.9.8'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'PhantomJS 1.9.8'
      LayoutEngineNameVersionMajor         : 'PhantomJS 1'
      AgentClass                           : 'Robot'
      AgentName                            : 'PhantomJS'
      AgentVersion                         : '1.9.8'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'PhantomJS 1.9.8'
      AgentNameVersionMajor                : 'PhantomJS 1'

# DejaClick  (last occurance was in 2015)
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux i686; rv:10.0.2) Gecko/20100101 Firefox/10.0.2 DejaClick/2.4.1.6'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'DejaClick'
      DeviceBrand                          : 'DejaClick'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : 'Intel i686'
      OperatingSystemNameVersion           : 'Linux Intel i686'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '10.0.2'
      LayoutEngineVersionMajor             : '10'
      LayoutEngineNameVersion              : 'Gecko 10.0.2'
      LayoutEngineNameVersionMajor         : 'Gecko 10'
      LayoutEngineBuild                    : '20100101'
      AgentClass                           : 'Browser'
      AgentName                            : 'DejaClick'
      AgentVersion                         : '2.4.1.6'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'DejaClick 2.4.1.6'
      AgentNameVersionMajor                : 'DejaClick 2'

# Online website screenshot tool
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; Seznam screenshot-generator 2.1; +http://fulltext.sblog.cz/screenshot/)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Robot'
      DeviceBrand                          : 'Sblog'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '5.0'
      LayoutEngineVersionMajor             : '5'
      LayoutEngineNameVersion              : 'Mozilla 5.0'
      LayoutEngineNameVersionMajor         : 'Mozilla 5'
      AgentClass                           : 'Browser'
      AgentName                            : 'Seznam screenshot-generator'
      AgentVersion                         : '2.1'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Seznam screenshot-generator 2.1'
      AgentNameVersionMajor                : 'Seznam screenshot-generator 2'
      AgentInformationUrl                  : 'http://fulltext.sblog.cz/screenshot/'


# Online website screenshot tool
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/534.34 (KHTML, like Gecko) Chromium/31.0.1650.63 Site-Shot/2.1 (http://www.site-shot.com/) Safari/534.34'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Site-Shot'
      DeviceBrand                          : 'Site-Shot'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : 'Intel x86_64'
      OperatingSystemNameVersion           : 'Linux Intel x86_64'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Site-Shot'
      LayoutEngineVersion                  : '2.1'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Site-Shot 2.1'
      LayoutEngineNameVersionMajor         : 'Site-Shot 2'
      AgentClass                           : 'Robot'
      AgentName                            : 'Site-Shot'
      AgentVersion                         : '2.1'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Site-Shot 2.1'
      AgentNameVersionMajor                : 'Site-Shot 2'
      AgentInformationUrl                  : 'http://www.site-shot.com/'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; Baiduspider/2.0; +http://www.baidu.com/search/spider.html)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Baiduspider'
      DeviceBrand                          : 'Baidu'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Baiduspider'
      LayoutEngineVersion                  : '2.0'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Baiduspider 2.0'
      LayoutEngineNameVersionMajor         : 'Baiduspider 2'
      AgentClass                           : 'Robot'
      AgentName                            : 'Baiduspider'
      AgentVersion                         : '2.0'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Baiduspider 2.0'
      AgentNameVersionMajor                : 'Baiduspider 2'
      AgentInformationUrl                  : 'http://www.baidu.com/search/spider.html'

#Yahoo
- matcher:
    require:
    - 'agent.(1)product.(1)comments.entry.text="Yahoo! Slurp"'
    extract:
    - 'DeviceClass           :  3020:"Robot"'
    - 'DeviceBrand           :  3020:"Yahoo"'
    - 'DeviceName            :  3020:"Yahoo"'
    - 'DeviceCpu             :  1000:"<<<null>>>"'
    - 'DeviceCpuBits         :  1000:"<<<null>>>"'
    - 'OperatingSystemClass  :  3020:"Cloud"'
    - 'OperatingSystemName   :  3020:"Yahoo"'
    - 'OperatingSystemVersion:  3020:"Yahoo"'
    - 'LayoutEngineClass     :  3020:"Robot"'
    - 'LayoutEngineName      :  3020:"Yahoo! Slurp"'
    - 'LayoutEngineVersion   :  3020:"Yahoo! Slurp"'
    - 'AgentClass            :  3020:"Robot"'
    - 'AgentName             :  3020:"Yahoo! Slurp"'
    - 'AgentVersion          :  3020:"Yahoo! Slurp"'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; Yahoo! Slurp; http://help.yahoo.com/help/us/ysearch/slurp)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Yahoo'
      DeviceBrand                          : 'Yahoo'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Yahoo'
      OperatingSystemVersion               : 'Yahoo'
      OperatingSystemNameVersion           : 'Yahoo'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Yahoo! Slurp'
      LayoutEngineVersion                  : 'Yahoo! Slurp'
      LayoutEngineVersionMajor             : 'Yahoo! Slurp'
      LayoutEngineNameVersion              : 'Yahoo! Slurp'
      LayoutEngineNameVersionMajor         : 'Yahoo! Slurp'
      AgentClass                           : 'Robot'
      AgentName                            : 'Yahoo! Slurp'
      AgentVersion                         : 'Yahoo! Slurp'
      AgentVersionMajor                    : 'Yahoo! Slurp'
      AgentNameVersion                     : 'Yahoo! Slurp'
      AgentNameVersionMajor                : 'Yahoo! Slurp'
      AgentInformationUrl                  : 'http://help.yahoo.com/help/us/ysearch/slurp'

# Archive.org_bot
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; archive.org_bot; Wayback Machine Live Record; +http://archive.org/details/archive.org_bot)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Archive.org_BOT'
      DeviceBrand                          : 'Archive'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'archive.org_bot'
      LayoutEngineVersion                  : 'archive.org_bot'
      LayoutEngineVersionMajor             : 'archive'
      LayoutEngineNameVersion              : 'archive.org_bot'
      LayoutEngineNameVersionMajor         : 'archive.org_bot archive'
      AgentClass                           : 'Robot'
      AgentName                            : 'archive.org_bot'
      AgentVersion                         : 'archive.org_bot'
      AgentVersionMajor                    : 'archive'
      AgentNameVersion                     : 'archive.org_bot'
      AgentNameVersionMajor                : 'archive.org_bot archive'
      AgentInformationUrl                  : 'http://archive.org/details/archive.org_bot'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; archive.org_bot +http://www.archive.org/details/archive.org_bot)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Archive.org_BOT'
      DeviceBrand                          : 'Archive'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'archive.org_bot'
      LayoutEngineVersion                  : 'http://www.archive.org/details/archive.org_bot'
      LayoutEngineVersionMajor             : 'http://www.archive.org/details/archive.org_bot'
      LayoutEngineNameVersion              : 'archive.org_bot http://www.archive.org/details/archive.org_bot'
      LayoutEngineNameVersionMajor         : 'archive.org_bot http://www.archive.org/details/archive.org_bot'
      AgentClass                           : 'Robot'
      AgentName                            : 'archive.org_bot'
      AgentVersion                         : 'http://www.archive.org/details/archive.org_bot'
      AgentVersionMajor                    : 'http://www.archive.org/details/archive.org_bot'
      AgentNameVersion                     : 'archive.org_bot http://www.archive.org/details/archive.org_bot'
      AgentNameVersionMajor                : 'archive.org_bot http://www.archive.org/details/archive.org_bot'
      AgentInformationUrl                  : 'http://www.archive.org/details/archive.org_bot'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; Charlotte/1.1; http://www.searchme.com/support/)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Robot'
      DeviceBrand                          : 'Searchme'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '5.0'
      LayoutEngineVersionMajor             : '5'
      LayoutEngineNameVersion              : 'Mozilla 5.0'
      LayoutEngineNameVersionMajor         : 'Mozilla 5'
      AgentClass                           : 'Browser'
      AgentName                            : 'Charlotte'
      AgentVersion                         : '1.1'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Charlotte 1.1'
      AgentNameVersionMajor                : 'Charlotte 1'
      AgentInformationUrl                  : 'http://www.searchme.com/support/'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; SputnikBot/2.3; +http://corp.sputnik.ru/webmaster)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'SputnikBot'
      DeviceBrand                          : 'Sputnik'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'SputnikBot'
      LayoutEngineVersion                  : '2.3'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'SputnikBot 2.3'
      LayoutEngineNameVersionMajor         : 'SputnikBot 2'
      AgentClass                           : 'Robot'
      AgentName                            : 'SputnikBot'
      AgentVersion                         : '2.3'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'SputnikBot 2.3'
      AgentNameVersionMajor                : 'SputnikBot 2'
      AgentInformationUrl                  : 'http://corp.sputnik.ru/webmaster'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; Applebot/0.3; +http://www.apple.com/go/applebot)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Apple BOT'
      DeviceBrand                          : 'Apple'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Applebot'
      LayoutEngineVersion                  : '0.3'
      LayoutEngineVersionMajor             : '0'
      LayoutEngineNameVersion              : 'Applebot 0.3'
      LayoutEngineNameVersionMajor         : 'Applebot 0'
      AgentClass                           : 'Robot'
      AgentName                            : 'Applebot'
      AgentVersion                         : '0.3'
      AgentVersionMajor                    : '0'
      AgentNameVersion                     : 'Applebot 0.3'
      AgentNameVersionMajor                : 'Applebot 0'
      AgentInformationUrl                  : 'http://www.apple.com/go/applebot'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; ltbot/0.3.6 +http://www.kdsl.tu-darmstadt.de/de/kdsl/research-program/crawling-and-semantic-structuring/)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Ltbot'
      DeviceBrand                          : 'TU-Darmstadt'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'ltbot'
      LayoutEngineVersion                  : '0.3.6'
      LayoutEngineVersionMajor             : '0'
      LayoutEngineNameVersion              : 'ltbot 0.3.6'
      LayoutEngineNameVersionMajor         : 'ltbot 0'
      AgentClass                           : 'Robot'
      AgentName                            : 'ltbot'
      AgentVersion                         : '0.3.6'
      AgentVersionMajor                    : '0'
      AgentNameVersion                     : 'ltbot 0.3.6'
      AgentNameVersionMajor                : 'ltbot 0'
      AgentInformationUrl                  : 'http://www.kdsl.tu-darmstadt.de/de/kdsl/research-program/crawling-and-semantic-structuring/'

- test:
    input:
      user_agent_string: 'NeumobBot/0.2.16 (+http://www.neumob.com/bot)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'NeumobBot'
      DeviceBrand                          : 'Neumob'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'NeumobBot'
      LayoutEngineVersion                  : '0.2.16'
      LayoutEngineVersionMajor             : '0'
      LayoutEngineNameVersion              : 'NeumobBot 0.2.16'
      LayoutEngineNameVersionMajor         : 'NeumobBot 0'
      AgentClass                           : 'Robot'
      AgentName                            : 'NeumobBot'
      AgentVersion                         : '0.2.16'
      AgentVersionMajor                    : '0'
      AgentNameVersion                     : 'NeumobBot 0.2.16'
      AgentNameVersionMajor                : 'NeumobBot 0'
      AgentInformationUrl                  : 'http://www.neumob.com/bot'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; MojeekBot/0.6; +https://www.mojeek.com/bot.html)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'MojeekBot'
      DeviceBrand                          : 'Mojeek'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'MojeekBot'
      LayoutEngineVersion                  : '0.6'
      LayoutEngineVersionMajor             : '0'
      LayoutEngineNameVersion              : 'MojeekBot 0.6'
      LayoutEngineNameVersionMajor         : 'MojeekBot 0'
      AgentClass                           : 'Robot'
      AgentName                            : 'MojeekBot'
      AgentVersion                         : '0.6'
      AgentVersionMajor                    : '0'
      AgentNameVersion                     : 'MojeekBot 0.6'
      AgentNameVersionMajor                : 'MojeekBot 0'
      AgentInformationUrl                  : 'https://www.mojeek.com/bot.html'

- matcher:
    extract:
    - 'DeviceClass            :   5000:"Robot"'
    - 'DeviceName             :   5000:"FlipboardProxy"'
    - 'DeviceBrand            :   5000:"Flipboard"'
    - 'DeviceCpu              :   1000:"<<<null>>>"'
    - 'DeviceCpuBits          :   1000:"<<<null>>>"'
    - 'OperatingSystemClass   :   5000:"Cloud"'
    - 'OperatingSystemName    :   5000:"Cloud"'
    - 'OperatingSystemVersion :   5000:"Cloud"'
    - 'AgentClass             :   5000:"Robot"'
    - 'AgentName              :   5000:"FlipboardProxy"'
    - 'AgentVersion           :   5000:agent.product.(1)comments.entry.(1)product.(1)name="FlipboardProxy"^.version'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10.9; rv:28.0) Gecko/20100101 Firefox/28.0 (FlipboardProxy/1.1; +http://flipboard.com/browserproxy)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Flipboard Proxy'
      DeviceBrand                          : 'Flipboard'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '28.0'
      LayoutEngineVersionMajor             : '28'
      LayoutEngineNameVersion              : 'Gecko 28.0'
      LayoutEngineNameVersionMajor         : 'Gecko 28'
      LayoutEngineBuild                    : '20100101'
      AgentClass                           : 'Robot'
      AgentName                            : 'FlipboardProxy'
      AgentVersion                         : '1.1'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'FlipboardProxy 1.1'
      AgentNameVersionMajor                : 'FlipboardProxy 1'
      AgentInformationUrl                  : 'http://flipboard.com/browserproxy'

- matcher:
    extract:
    - 'DeviceClass            :   5000:"Robot"'
    - 'DeviceName             :   5000:"Applebot"'
    - 'DeviceBrand            :   5000:"Apple"'
    - 'DeviceCpu              :   1000:"<<<null>>>"'
    - 'DeviceCpuBits          :   1000:"<<<null>>>"'
    - 'OperatingSystemClass   :   5000:"Cloud"'
    - 'OperatingSystemName    :   5000:"Cloud"'
    - 'OperatingSystemVersion :   5000:"Cloud"'
    - 'AgentClass             :   5000:"Robot"'
    - 'AgentName              :   5000:"Applebot"'
    - 'AgentVersion           :   5000:agent.product.(1)comments.entry.(1)product.(1)name="Applebot"^.version'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_1) AppleWebKit/600.2.5 (KHTML, like Gecko) Version/8.0.2 Safari/600.2.5 (Applebot/0.1; +http://www.apple.com/go/applebot)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Apple BOT'
      DeviceBrand                          : 'Apple'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '600.2.5'
      LayoutEngineVersionMajor             : '600'
      LayoutEngineNameVersion              : 'AppleWebKit 600.2.5'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 600'
      AgentClass                           : 'Robot'
      AgentName                            : 'Applebot'
      AgentVersion                         : '0.1'
      AgentVersionMajor                    : '0'
      AgentNameVersion                     : 'Applebot 0.1'
      AgentNameVersionMajor                : 'Applebot 0'
      AgentInformationUrl                  : 'http://www.apple.com/go/applebot'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0); 360Spider(compatible; HaosouSpider; http://www.haosou.com/help/help_3_2.html)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : '360SPIDER'
      DeviceBrand                          : 'Haosou'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Trident'
      LayoutEngineVersion                  : '5.0'
      LayoutEngineVersionMajor             : '5'
      LayoutEngineNameVersion              : 'Trident 5.0'
      LayoutEngineNameVersionMajor         : 'Trident 5'
      AgentClass                           : 'Browser'
      AgentName                            : 'Internet Explorer'
      AgentVersion                         : '9.0'
      AgentVersionMajor                    : '9'
      AgentNameVersion                     : 'Internet Explorer 9.0'
      AgentNameVersionMajor                : 'Internet Explorer 9'
      AgentInformationUrl                  : 'http://www.haosou.com/help/help_3_2.html'

- matcher:
    extract:
    - 'DeviceClass            :  2100:"Robot"'
    - 'DeviceName             :  2100:agent.product.comments.entry.text="Exabot-Thumbnails"'
    - 'DeviceBrand            :  2100:"Exalead"'
    - 'AgentClass             :  2100:"Robot"'
    - 'AgentName              :  2100:agent.product.comments.entry.text="Exabot-Thumbnails"'
    - 'AgentVersion           :  2100:"??"'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; Konqueror/3.5; Linux) KHTML/3.5.5 (like Gecko) (Exabot-Thumbnails)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Exalead Exabot-Thumbnails'
      DeviceBrand                          : 'Exalead'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '??'
      OperatingSystemNameVersion           : 'Linux ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'KHTML'
      LayoutEngineVersion                  : '3.5'
      LayoutEngineVersionMajor             : '3'
      LayoutEngineNameVersion              : 'KHTML 3.5'
      LayoutEngineNameVersionMajor         : 'KHTML 3'
      AgentClass                           : 'Robot'
      AgentName                            : 'Exabot-Thumbnails'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'Exabot-Thumbnails ??'
      AgentNameVersionMajor                : 'Exabot-Thumbnails ??'

- test:
    input:
      user_agent_string: 'yacybot%20(freeworld/global;%20amd64%20Linux%203.1.0-1.2-desktop;%20java%201.6.0_22;%20Europe/de)%20http://yacy.net/bot.html'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Yacybot'
      DeviceBrand                          : 'Yacy'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'yacybot'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'yacybot ??'
      LayoutEngineNameVersionMajor         : 'yacybot ??'
      AgentClass                           : 'Robot'
      AgentName                            : 'yacybot'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'yacybot ??'
      AgentNameVersionMajor                : 'yacybot ??'
      AgentInformationUrl                  : 'http://yacy.net/bot.html'

- test:
    input:
      user_agent_string: 'yacybot (/global; amd64 Windows 10 10.0; java 1.8.0_77; Europe/en) http://yacy.net/bot.html'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Yacybot'
      DeviceBrand                          : 'Unknown'  #FIXME: Should be 'Yacy' but fails due to syntax error caused by '/global'.
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'yacybot'
      LayoutEngineVersion                  : 'global'
      LayoutEngineVersionMajor             : 'global'
      LayoutEngineNameVersion              : 'yacybot global'
      LayoutEngineNameVersionMajor         : 'yacybot global'
      AgentClass                           : 'Robot'
      AgentName                            : 'yacybot'
      AgentVersion                         : 'global'
      AgentVersionMajor                    : 'global'
      AgentNameVersion                     : 'yacybot global'
      AgentNameVersionMajor                : 'yacybot global'
      __SyntaxError__                      : 'true'


- test:
    input:
      user_agent_string: 'yacybot (-global; amd64 Windows 2003 5.2; java 1.8.0_131; Europe/en) http://yacy.net/bot.html'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Yacybot'
      DeviceBrand                          : 'Yacy'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'yacybot'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'yacybot ??'
      LayoutEngineNameVersionMajor         : 'yacybot ??'
      AgentClass                           : 'Robot'
      AgentName                            : 'yacybot'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'yacybot ??'
      AgentNameVersionMajor                : 'yacybot ??'
      AgentInformationUrl                  : 'http://yacy.net/bot.html'





- test:
    input:
      user_agent_string: 'NetLyzer FastProbe (See http://netlyzer.com/report/www.bol.com for info)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Robot'
      DeviceBrand                          : 'Netlyzer'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'NetLyzer FastProbe'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'NetLyzer FastProbe ??'
      AgentNameVersionMajor                : 'NetLyzer FastProbe ??'
      AgentInformationUrl                  : 'http://netlyzer.com/report/www.bol.com'

- test:
    input:
      user_agent_string: '0xSCANNER-INURL_blog.inurl.com.br-K-Meleon/19.4 (Redhat Linux 2.6; en_NZ;)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : '0XSCANNER-Inurl_Blog.inurl.com.br-K-Meleon'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : '0xSCANNER-INURL_blog.inurl.com.br-K-Meleon'
      LayoutEngineVersion                  : '19.4'
      LayoutEngineVersionMajor             : '19'
      LayoutEngineNameVersion              : '0xSCANNER-INURL_blog.inurl.com.br-K-Meleon 19.4'
      LayoutEngineNameVersionMajor         : '0xSCANNER-INURL_blog.inurl.com.br-K-Meleon 19'
      AgentClass                           : 'Robot'
      AgentName                            : '0xSCANNER-INURL_blog.inurl.com.br-K-Meleon'
      AgentVersion                         : '19.4'
      AgentVersionMajor                    : '19'
      AgentNameVersion                     : '0xSCANNER-INURL_blog.inurl.com.br-K-Meleon 19.4'
      AgentNameVersionMajor                : '0xSCANNER-INURL_blog.inurl.com.br-K-Meleon 19'
      AgentLanguage                        : 'English (New Zealand)'
      AgentLanguageCode                    : 'en-nz'


- test:
    input:
      user_agent_string: 'rogerbot/1.1 (http://moz.com/help/guides/search-overview/crawl-diagnostics#more-help, rogerbot-crawler+pr2-crawler-05@moz.com)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Rogerbot'
      DeviceBrand                          : 'MOZ'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'rogerbot'
      LayoutEngineVersion                  : '1.1'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'rogerbot 1.1'
      LayoutEngineNameVersionMajor         : 'rogerbot 1'
      AgentClass                           : 'Robot'
      AgentName                            : 'rogerbot'
      AgentVersion                         : '1.1'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'rogerbot 1.1'
      AgentNameVersionMajor                : 'rogerbot 1'
      AgentInformationEmail                : 'rogerbot-crawler+pr2-crawler-05@moz.com'
      AgentInformationUrl                  : 'http://moz.com/help/guides/search-overview/crawl-diagnostics#more-help'

- test:
    input:
      user_agent_string: 'BuiBui-Bot/1.0 (3m4il: buibui[dot]bot[\xc3\xa07]moquadv[dot]com)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Buibui-BOT'
      DeviceBrand                          : 'Moquadv'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'BuiBui-Bot'
      LayoutEngineVersion                  : '1.0'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'BuiBui-Bot 1.0'
      LayoutEngineNameVersionMajor         : 'BuiBui-Bot 1'
      AgentClass                           : 'Robot'
      AgentName                            : 'BuiBui-Bot'
      AgentVersion                         : '1.0'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'BuiBui-Bot 1.0'
      AgentNameVersionMajor                : 'BuiBui-Bot 1'
      AgentInformationEmail                : 'buibui.bot@moquadv.com'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; zitebot support [at] zite [dot] com +http://zite.com)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Zitebot'
      DeviceBrand                          : 'Zite'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'zitebot'
      LayoutEngineVersion                  : 'support [at] zite [dot] com'
      LayoutEngineVersionMajor             : 'support [at] zite [dot] com'
      LayoutEngineNameVersion              : 'zitebot support [at] zite [dot] com'
      LayoutEngineNameVersionMajor         : 'zitebot support [at] zite [dot] com'
      AgentClass                           : 'Robot'
      AgentName                            : 'zitebot'
      AgentVersion                         : 'support [at] zite [dot] com'
      AgentVersionMajor                    : 'support [at] zite [dot] com'
      AgentNameVersion                     : 'zitebot support [at] zite [dot] com'
      AgentNameVersionMajor                : 'zitebot support [at] zite [dot] com'
      AgentInformationEmail                : 'support@zite.com'
      AgentInformationUrl                  : 'http://zite.com'

- test:
    input:
      user_agent_string: 'Yahoo-MMAudVid/1.0 (mms dash mmaudvidcrawler dash support at yahoo dash inc dot com)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Robot'
      DeviceBrand                          : 'Yahoo-INC'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'Yahoo-MMAudVid'
      AgentVersion                         : '1.0'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Yahoo-MMAudVid 1.0'
      AgentNameVersionMajor                : 'Yahoo-MMAudVid 1'
      AgentInformationEmail                : 'mms-mmaudvidcrawler-support@yahoo-inc.com'

- test:
    input:
      user_agent_string: 'DuckDuckBot/1.0; (+http://duckduckgo.com/duckduckbot.html)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'DuckDuckBot'
      DeviceBrand                          : 'Duckduckgo'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'DuckDuckBot'
      LayoutEngineVersion                  : '1.0'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'DuckDuckBot 1.0'
      LayoutEngineNameVersionMajor         : 'DuckDuckBot 1'
      AgentClass                           : 'Robot'
      AgentName                            : 'DuckDuckBot'
      AgentVersion                         : '1.0'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'DuckDuckBot 1.0'
      AgentNameVersionMajor                : 'DuckDuckBot 1'
      AgentInformationUrl                  : 'http://duckduckgo.com/duckduckbot.html'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; PRTG Network Monitor (www.paessler.com); Windows)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Robot'
      DeviceBrand                          : 'Paessler'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '5.0'
      LayoutEngineVersionMajor             : '5'
      LayoutEngineNameVersion              : 'Mozilla 5.0'
      LayoutEngineNameVersionMajor         : 'Mozilla 5'
      AgentClass                           : 'Browser'
      AgentName                            : 'Netscape'
      AgentVersion                         : '5.0'
      AgentVersionMajor                    : '5'
      AgentNameVersion                     : 'Netscape 5.0'
      AgentNameVersionMajor                : 'Netscape 5'
      AgentInformationUrl                  : 'www.paessler.com'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; SISTRIX Crawler; http://crawler.sistrix.net/)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Sistrix Crawler'
      DeviceBrand                          : 'Sistrix'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'SISTRIX Crawler'
      LayoutEngineVersion                  : 'SISTRIX Crawler'
      LayoutEngineVersionMajor             : 'SISTRIX Crawler'
      LayoutEngineNameVersion              : 'SISTRIX Crawler'
      LayoutEngineNameVersionMajor         : 'SISTRIX Crawler'
      AgentClass                           : 'Robot'
      AgentName                            : 'SISTRIX Crawler'
      AgentVersion                         : 'SISTRIX Crawler'
      AgentVersionMajor                    : 'SISTRIX Crawler'
      AgentNameVersion                     : 'SISTRIX Crawler'
      AgentNameVersionMajor                : 'SISTRIX Crawler'
      AgentInformationUrl                  : 'http://crawler.sistrix.net/'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; SeznamBot/3.2-test1-1; +http://napoveda.seznam.cz/en/seznambot-intro/)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'SeznamBot'
      DeviceBrand                          : 'Seznam'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'SeznamBot'
      LayoutEngineVersion                  : '3.2-test1-1'
      LayoutEngineVersionMajor             : '3'
      LayoutEngineNameVersion              : 'SeznamBot 3.2-test1-1'
      LayoutEngineNameVersionMajor         : 'SeznamBot 3'
      AgentClass                           : 'Robot'
      AgentName                            : 'SeznamBot'
      AgentVersion                         : '3.2-test1-1'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'SeznamBot 3.2-test1-1'
      AgentNameVersionMajor                : 'SeznamBot 3'
      AgentInformationUrl                  : 'http://napoveda.seznam.cz/en/seznambot-intro/'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; ToutiaoSpider/1.0; http://web.toutiao.com/media_cooperation/;)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'ToutiaoSpider'
      DeviceBrand                          : 'Toutiao'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'ToutiaoSpider'
      LayoutEngineVersion                  : '1.0'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'ToutiaoSpider 1.0'
      LayoutEngineNameVersionMajor         : 'ToutiaoSpider 1'
      AgentClass                           : 'Robot'
      AgentName                            : 'ToutiaoSpider'
      AgentVersion                         : '1.0'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'ToutiaoSpider 1.0'
      AgentNameVersionMajor                : 'ToutiaoSpider 1'
      AgentInformationUrl                  : 'http://web.toutiao.com/media_cooperation/'

- test:
    input:
      user_agent_string: 'SentiBot www.sentibot.eu (compatible with Googlebot)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'SentiBot'
      DeviceBrand                          : 'Sentibot'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'SentiBot'
      LayoutEngineVersion                  : 'www.sentibot.eu'
      LayoutEngineVersionMajor             : 'www.sentibot.eu'
      LayoutEngineNameVersion              : 'SentiBot www.sentibot.eu'
      LayoutEngineNameVersionMajor         : 'SentiBot www.sentibot.eu'
      AgentClass                           : 'Robot'
      AgentName                            : 'SentiBot'
      AgentVersion                         : 'www.sentibot.eu'
      AgentVersionMajor                    : 'www.sentibot.eu'
      AgentNameVersion                     : 'SentiBot www.sentibot.eu'
      AgentNameVersionMajor                : 'SentiBot www.sentibot.eu'
      AgentInformationUrl                  : 'www.sentibot.eu'

- test:
    input:
      user_agent_string: 'www.deadlinkchecker.com Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.86 Safari/537.36'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Robot'
      DeviceBrand                          : 'Deadlinkchecker'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '46.0'
      LayoutEngineVersionMajor             : '46'
      LayoutEngineNameVersion              : 'Blink 46.0'
      LayoutEngineNameVersionMajor         : 'Blink 46'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '46.0.2490.86'
      AgentVersionMajor                    : '46'
      AgentNameVersion                     : 'Chrome 46.0.2490.86'
      AgentNameVersionMajor                : 'Chrome 46'
      AgentInformationUrl                  : 'www.deadlinkchecker.com'

- test:
    input:
      user_agent_string: 'ADmantX Platform Semantic Analyzer - ADmantX Inc. - www.admantx.com - support@admantx.com'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Robot'
      DeviceBrand                          : 'Admantx'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'ADmantX Platform Semantic Analyzer'
      AgentVersion                         : 'ADmantX'
      AgentVersionMajor                    : 'ADmantX'
      AgentNameVersion                     : 'ADmantX Platform Semantic Analyzer ADmantX'
      AgentNameVersionMajor                : 'ADmantX Platform Semantic Analyzer ADmantX'
      AgentInformationUrl                  : 'www.admantx.com'

- test:
    input:
      user_agent_string: 'Curious George - www.analyticsseo.com/crawler'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Curious George'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Curious George'
      LayoutEngineVersion                  : 'www.analyticsseo.com/crawler'
      LayoutEngineVersionMajor             : 'www.analyticsseo.com/crawler'
      LayoutEngineNameVersion              : 'Curious George www.analyticsseo.com/crawler'
      LayoutEngineNameVersionMajor         : 'Curious George www.analyticsseo.com/crawler'
      AgentClass                           : 'Robot'
      AgentName                            : 'Curious George'
      AgentVersion                         : 'www.analyticsseo.com/crawler'
      AgentVersionMajor                    : 'www.analyticsseo.com/crawler'
      AgentNameVersion                     : 'Curious George www.analyticsseo.com/crawler'
      AgentNameVersionMajor                : 'Curious George www.analyticsseo.com/crawler'
      AgentInformationUrl                  : 'www.analyticsseo.com/crawler'

# When you share a link on facebook then the Facebook systems will try to create a preview of the page
# using one of these useragents
- matcher:
    require:
    - 'agent.(1)product.(1)name="facebookexternalhit"'
    extract:
    - 'DeviceClass                          : 10 : "Robot"'
    - 'DeviceName                           : 10 : "Facebook Robot"'
    - 'DeviceBrand                          : 10 : "Facebook"'
    - 'OperatingSystemClass                 : 10 : "Cloud"'
    - 'OperatingSystemName                  : 10 : "Cloud"'
    - 'OperatingSystemVersion               : 10 : "Cloud"'
    - 'OperatingSystemNameVersion           : 10 : "Cloud"'

- test:
    input:
      user_agent_string: 'facebookexternalhit/1.1 (+http://www.facebook.com/externalhit_uatext.php)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Facebook Robot'
      DeviceBrand                          : 'Facebook'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'facebookexternalhit'
      AgentVersion                         : '1.1'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'facebookexternalhit 1.1'
      AgentNameVersionMajor                : 'facebookexternalhit 1'
      AgentInformationUrl                  : 'http://www.facebook.com/externalhit_uatext.php'

- test:
    input:
      user_agent_string: 'facebookexternalhit/1.1'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Facebook Robot'
      DeviceBrand                          : 'Facebook'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'facebookexternalhit'
      AgentVersion                         : '1.1'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'facebookexternalhit 1.1'
      AgentNameVersionMajor                : 'facebookexternalhit 1'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/27.0.1453.116 Safari/537.36 HubSpot Webcrawler'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Hubspot Webcrawler'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.36'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.36'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '27.0.1453.116'
      AgentVersionMajor                    : '27'
      AgentNameVersion                     : 'Chrome 27.0.1453.116'
      AgentNameVersionMajor                : 'Chrome 27'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'AltaVista V2.0B crawler@evreka.com'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'AltaVista'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'AltaVista'
      LayoutEngineVersion                  : 'V2.0B'
      LayoutEngineVersionMajor             : 'V2'
      LayoutEngineNameVersion              : 'AltaVista V2.0B'
      LayoutEngineNameVersionMajor         : 'AltaVista V2'
      AgentClass                           : 'Robot'
      AgentName                            : 'AltaVista'
      AgentVersion                         : 'V2.0B'
      AgentVersionMajor                    : 'V2'
      AgentNameVersion                     : 'AltaVista V2.0B'
      AgentNameVersionMajor                : 'AltaVista V2'

# A tool similar to curl
- test:
    input:
      user_agent_string: 'Typhoeus - https://github.com/typhoeus/typhoeus'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Robot'
      DeviceBrand                          : 'Github' # Funny yet unavoidable
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'Typhoeus'
      AgentVersion                         : 'https://github.com/typhoeus/typhoeus'
      AgentVersionMajor                    : 'https://github.com/typhoeus/typhoeus'
      AgentNameVersion                     : 'Typhoeus https://github.com/typhoeus/typhoeus'
      AgentNameVersionMajor                : 'Typhoeus https://github.com/typhoeus/typhoeus'
      AgentInformationUrl                  : 'https://github.com/typhoeus/typhoeus'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 CommonCrawler Node 252Y6KCHGDLOM4NOCXY5DDVIQC4I4CQ46SU5EM76GSZ2ZY6EPLYBKYFL5PRMOL4.R.GPMRT2CTBQMMKZPSBBCPP6O4XLKIWXRKYIQNNL3CIDAST4WS.cdn0.common.crawl.zone'
    expected:
      DeviceClass                           : 'Robot'
      DeviceName                            : 'CommonCrawler Node'
      DeviceBrand                           : 'Unknown'
      OperatingSystemClass                  : 'Cloud'
      OperatingSystemName                   : 'Cloud'
      OperatingSystemVersion                : 'Cloud'
      OperatingSystemNameVersion            : 'Cloud'
      LayoutEngineClass                     : 'Robot'
      LayoutEngineName                      : 'CommonCrawler Node'
      LayoutEngineVersion                   : '252Y6KCHGDLOM4NOCXY5DDVIQC4I4CQ46SU5EM76GSZ2ZY6EPLYBKYFL5PRMOL4.R.GPMRT2CTBQMMKZPSBBCPP6O4XLKIWXRKYIQNNL3CIDAST4WS.cdn0.common.crawl.zone'
      LayoutEngineVersionMajor              : '252Y6KCHGDLOM4NOCXY5DDVIQC4I4CQ46SU5EM76GSZ2ZY6EPLYBKYFL5PRMOL4'
      LayoutEngineNameVersion               : 'CommonCrawler Node 252Y6KCHGDLOM4NOCXY5DDVIQC4I4CQ46SU5EM76GSZ2ZY6EPLYBKYFL5PRMOL4.R.GPMRT2CTBQMMKZPSBBCPP6O4XLKIWXRKYIQNNL3CIDAST4WS.cdn0.common.crawl.zone'
      LayoutEngineNameVersionMajor          : 'CommonCrawler Node 252Y6KCHGDLOM4NOCXY5DDVIQC4I4CQ46SU5EM76GSZ2ZY6EPLYBKYFL5PRMOL4'
      AgentClass                            : 'Robot'
      AgentName                             : 'CommonCrawler Node'
      AgentVersion                          : '252Y6KCHGDLOM4NOCXY5DDVIQC4I4CQ46SU5EM76GSZ2ZY6EPLYBKYFL5PRMOL4.R.GPMRT2CTBQMMKZPSBBCPP6O4XLKIWXRKYIQNNL3CIDAST4WS.cdn0.common.crawl.zone'
      AgentVersionMajor                     : '252Y6KCHGDLOM4NOCXY5DDVIQC4I4CQ46SU5EM76GSZ2ZY6EPLYBKYFL5PRMOL4'
      AgentNameVersion                      : 'CommonCrawler Node 252Y6KCHGDLOM4NOCXY5DDVIQC4I4CQ46SU5EM76GSZ2ZY6EPLYBKYFL5PRMOL4.R.GPMRT2CTBQMMKZPSBBCPP6O4XLKIWXRKYIQNNL3CIDAST4WS.cdn0.common.crawl.zone'
      AgentNameVersionMajor                 : 'CommonCrawler Node 252Y6KCHGDLOM4NOCXY5DDVIQC4I4CQ46SU5EM76GSZ2ZY6EPLYBKYFL5PRMOL4'


- test:
    input:
      user_agent_string: 'bitlybot/3.0 (+http://bit.ly/)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Bitlybot'
      DeviceBrand                          : 'BIT'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'bitlybot'
      LayoutEngineVersion                  : '3.0'
      LayoutEngineVersionMajor             : '3'
      LayoutEngineNameVersion              : 'bitlybot 3.0'
      LayoutEngineNameVersionMajor         : 'bitlybot 3'
      AgentClass                           : 'Robot'
      AgentName                            : 'bitlybot'
      AgentVersion                         : '3.0'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'bitlybot 3.0'
      AgentNameVersionMajor                : 'bitlybot 3'
      AgentInformationUrl                  : 'http://bit.ly/'

- test:
    input:
      user_agent_string: 'Xanti Link Check Robot/1.1 (http://www.xanti.nl/)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Xanti Link Check Robot'
      DeviceBrand                          : 'Xanti'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Xanti Link Check Robot'
      LayoutEngineVersion                  : '1.1'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Xanti Link Check Robot 1.1'
      LayoutEngineNameVersionMajor         : 'Xanti Link Check Robot 1'
      AgentClass                           : 'Robot'
      AgentName                            : 'Xanti Link Check Robot'
      AgentVersion                         : '1.1'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Xanti Link Check Robot 1.1'
      AgentNameVersionMajor                : 'Xanti Link Check Robot 1'
      AgentInformationUrl                  : 'http://www.xanti.nl/'



# http://www.webpagetest.org --> PTST
# http://support.speedcurve.com/testing-process/how-do-the-browser-testing-agents-work
# SpeedCurve testing agents use the standard WebPagetest user agent and you can filter testing agents out of your analytics by search for the string "PTST/SpeedCurve" in the user agent string.

- matcher:
    variable:
    - 'PTSTVersion:agent.product.comments.entry.product.name="PTST"^.version'
    extract:
    - '__Set_ALL_Fields__        : 4999 : "<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'DeviceClass               : 5000 : "Robot"'
    - 'DeviceName                : 5000 : "WebpageTest"'
    - 'DeviceBrand               : 5000 : "WebpageTest"'
    - 'OperatingSystemClass      : 5000 : "Cloud"'
    - 'OperatingSystemName       : 5000 : "Cloud"'
    - 'OperatingSystemVersion    : 5000 : "Cloud"'
    - 'LayoutEngineClass         : 5000 : "Robot"'
    - 'LayoutEngineName          : 5000 : "WebpageTest"'
    - 'LayoutEngineVersion       : 5000 : @PTSTVersion'
    - 'AgentClass                : 5000 : "Robot"'
    - 'AgentName                 : 5000 : "WebpageTest"'
    - 'AgentVersion              : 5000 : @PTSTVersion'

- matcher:
    variable:
    - 'PTSTVersion:agent.product.name="PTST"^.version'
    extract:
    - '__Set_ALL_Fields__        : 4999 : "<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'DeviceClass               : 5000 : "Robot"'
    - 'DeviceName                : 5000 : "WebpageTest"'
    - 'DeviceBrand               : 5000 : "WebpageTest"'
    - 'OperatingSystemClass      : 5000 : "Cloud"'
    - 'OperatingSystemName       : 5000 : "Cloud"'
    - 'OperatingSystemVersion    : 5000 : "Cloud"'
    - 'LayoutEngineClass         : 5000 : "Robot"'
    - 'LayoutEngineName          : 5000 : "WebpageTest"'
    - 'LayoutEngineVersion       : 5000 : @PTSTVersion'
    - 'AgentClass                : 5000 : "Robot"'
    - 'AgentName                 : 5000 : "WebpageTest"'
    - 'AgentVersion              : 5000 : @PTSTVersion'


- matcher:
    require:
    - 'agent.product.(1)version="SpeedCurve"'
    - 'agent.product.name="PTST"^.(1)version="SpeedCurve"'
    variable:
    - 'PTSTVersion:agent.product.name="PTST"^.(2)version'
    extract:
    - '__Set_ALL_Fields__        : 4999 : "<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'DeviceClass               : 5001 : "Robot"'
    - 'DeviceName                : 5001 : "SpeedCurve WebpageTest"'
    - 'DeviceBrand               : 5001 : "SpeedCurve"'
    - 'OperatingSystemClass      : 5001 : "Cloud"'
    - 'OperatingSystemName       : 5001 : "Cloud"'
    - 'OperatingSystemVersion    : 5001 : "Cloud"'
    - 'LayoutEngineClass         : 5001 : "Robot"'
    - 'LayoutEngineName          : 5001 : "SpeedCurve WebpageTest"'
    - 'LayoutEngineVersion       : 5001 : @PTSTVersion'
    - 'AgentClass                : 5001 : "Robot"'
    - 'AgentName                 : 5001 : "SpeedCurve WebpageTest"'
    - 'AgentVersion              : 5001 : @PTSTVersion'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 6.0.1; Moto G (4) Build/MPJ24.139-64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.146 Mobile Safari/537.36 PTST/180521.140508'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'WebpageTest'
      DeviceBrand                          : 'WebpageTest'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'WebpageTest'
      LayoutEngineVersion                  : '180521.140508'
      LayoutEngineVersionMajor             : '180521'
      LayoutEngineNameVersion              : 'WebpageTest 180521.140508'
      LayoutEngineNameVersionMajor         : 'WebpageTest 180521'
      AgentClass                           : 'Robot'
      AgentName                            : 'WebpageTest'
      AgentVersion                         : '180521.140508'
      AgentVersionMajor                    : '180521'
      AgentNameVersion                     : 'WebpageTest 180521.140508'
      AgentNameVersionMajor                : 'WebpageTest 180521'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36 PTST/180620.180643'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'WebpageTest'
      DeviceBrand                          : 'WebpageTest'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'WebpageTest'
      LayoutEngineVersion                  : '180620.180643'
      LayoutEngineVersionMajor             : '180620'
      LayoutEngineNameVersion              : 'WebpageTest 180620.180643'
      LayoutEngineNameVersionMajor         : 'WebpageTest 180620'
      AgentClass                           : 'Robot'
      AgentName                            : 'WebpageTest'
      AgentVersion                         : '180620.180643'
      AgentVersionMajor                    : '180620'
      AgentNameVersion                     : 'WebpageTest 180620.180643'
      AgentNameVersionMajor                : 'WebpageTest 180620'

- test:
    input:
      user_agent_string: 'Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0; SLCC1; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; PTST 2.264)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'WebpageTest'
      DeviceBrand                          : 'WebpageTest'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'WebpageTest'
      LayoutEngineVersion                  : '2.264'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'WebpageTest 2.264'
      LayoutEngineNameVersionMajor         : 'WebpageTest 2'
      AgentClass                           : 'Robot'
      AgentName                            : 'WebpageTest'
      AgentVersion                         : '2.264'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'WebpageTest 2.264'
      AgentNameVersionMajor                : 'WebpageTest 2'

- test:
    input:
      user_agent_string: 'Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; PTST 2.295)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'WebpageTest'
      DeviceBrand                          : 'WebpageTest'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'WebpageTest'
      LayoutEngineVersion                  : '2.295'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'WebpageTest 2.295'
      LayoutEngineNameVersionMajor         : 'WebpageTest 2'
      AgentClass                           : 'Robot'
      AgentName                            : 'WebpageTest'
      AgentVersion                         : '2.295'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'WebpageTest 2.295'
      AgentNameVersionMajor                : 'WebpageTest 2'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPad; CPU OS 9_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Version/9.0 Mobile/13B137 Safari/601.1 PTST/SpeedCurve/180620.180643'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'SpeedCurve WebpageTest'
      DeviceBrand                          : 'SpeedCurve'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'SpeedCurve WebpageTest'
      LayoutEngineVersion                  : '180620.180643'
      LayoutEngineVersionMajor             : '180620'
      LayoutEngineNameVersion              : 'SpeedCurve WebpageTest 180620.180643'
      LayoutEngineNameVersionMajor         : 'SpeedCurve WebpageTest 180620'
      AgentClass                           : 'Robot'
      AgentName                            : 'SpeedCurve WebpageTest'
      AgentVersion                         : '180620.180643'
      AgentVersionMajor                    : '180620'
      AgentNameVersion                     : 'SpeedCurve WebpageTest 180620.180643'
      AgentNameVersionMajor                : 'SpeedCurve WebpageTest 180620'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 9_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Version/9.0 Mobile/13B143 Safari/601.1 PTST/SpeedCurve/180620.180643'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'SpeedCurve WebpageTest'
      DeviceBrand                          : 'SpeedCurve'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'SpeedCurve WebpageTest'
      LayoutEngineVersion                  : '180620.180643'
      LayoutEngineVersionMajor             : '180620'
      LayoutEngineNameVersion              : 'SpeedCurve WebpageTest 180620.180643'
      LayoutEngineNameVersionMajor         : 'SpeedCurve WebpageTest 180620'
      AgentClass                           : 'Robot'
      AgentName                            : 'SpeedCurve WebpageTest'
      AgentVersion                         : '180620.180643'
      AgentVersionMajor                    : '180620'
      AgentNameVersion                     : 'SpeedCurve WebpageTest 180620.180643'
      AgentNameVersionMajor                : 'SpeedCurve WebpageTest 180620'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36 PTST/SpeedCurve/180620.180643'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'SpeedCurve WebpageTest'
      DeviceBrand                          : 'SpeedCurve'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'SpeedCurve WebpageTest'
      LayoutEngineVersion                  : '180620.180643'
      LayoutEngineVersionMajor             : '180620'
      LayoutEngineNameVersion              : 'SpeedCurve WebpageTest 180620.180643'
      LayoutEngineNameVersionMajor         : 'SpeedCurve WebpageTest 180620'
      AgentClass                           : 'Robot'
      AgentName                            : 'SpeedCurve WebpageTest'
      AgentVersion                         : '180620.180643'
      AgentVersionMajor                    : '180620'
      AgentNameVersion                     : 'SpeedCurve WebpageTest 180620.180643'
      AgentNameVersionMajor                : 'SpeedCurve WebpageTest 180620'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; YandexBot/3.0; +http://yandex.com/bots)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'YandexBot'
      DeviceBrand                          : 'Yandex'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'YandexBot'
      LayoutEngineVersion                  : '3.0'
      LayoutEngineVersionMajor             : '3'
      LayoutEngineNameVersion              : 'YandexBot 3.0'
      LayoutEngineNameVersionMajor         : 'YandexBot 3'
      AgentClass                           : 'Robot'
      AgentName                            : 'YandexBot'
      AgentVersion                         : '3.0'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'YandexBot 3.0'
      AgentNameVersionMajor                : 'YandexBot 3'
      AgentInformationUrl                  : 'http://yandex.com/bots'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; SemrushBot/2~bl; +http://www.semrush.com/bot.html)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'SemrushBot'
      DeviceBrand                          : 'Semrush'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'SemrushBot'
      LayoutEngineVersion                  : '2~bl'
      LayoutEngineVersionMajor             : '2~bl'
      LayoutEngineNameVersion              : 'SemrushBot 2~bl'
      LayoutEngineNameVersionMajor         : 'SemrushBot 2~bl'
      AgentClass                           : 'Robot'
      AgentName                            : 'SemrushBot'
      AgentVersion                         : '2~bl'
      AgentVersionMajor                    : '2~bl'
      AgentNameVersion                     : 'SemrushBot 2~bl'
      AgentNameVersionMajor                : 'SemrushBot 2~bl'
      AgentInformationUrl                  : 'http://www.semrush.com/bot.html'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; SEOkicks; +https://www.seokicks.de/robot.html)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Robot'
      DeviceBrand                          : 'Seokicks'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '5.0'
      LayoutEngineVersionMajor             : '5'
      LayoutEngineNameVersion              : 'Mozilla 5.0'
      LayoutEngineNameVersionMajor         : 'Mozilla 5'
      AgentClass                           : 'Browser'
      AgentName                            : 'Netscape' # TODO (low prio): Improve naming this robot.
      AgentVersion                         : '5.0'
      AgentVersionMajor                    : '5'
      AgentNameVersion                     : 'Netscape 5.0'
      AgentNameVersionMajor                : 'Netscape 5'
      AgentInformationUrl                  : 'https://www.seokicks.de/robot.html'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; Gluten Free Crawler/1.0; +http://glutenfreepleasure.com/)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Gluten Free Crawler'
      DeviceBrand                          : 'Glutenfreepleasure'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Gluten Free Crawler'
      LayoutEngineVersion                  : '1.0'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Gluten Free Crawler 1.0'
      LayoutEngineNameVersionMajor         : 'Gluten Free Crawler 1'
      AgentClass                           : 'Robot'
      AgentName                            : 'Gluten Free Crawler'
      AgentVersion                         : '1.0'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Gluten Free Crawler 1.0'
      AgentNameVersionMajor                : 'Gluten Free Crawler 1'
      AgentInformationUrl                  : 'http://glutenfreepleasure.com/'


- test:
    input:
      user_agent_string: 'DomainCheck.io Crawler/1.3 (https://domaincheck.io)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'DomainCheck.io Crawler'
      DeviceBrand                          : 'Domaincheck'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'DomainCheck.io Crawler'
      LayoutEngineVersion                  : '1.3'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'DomainCheck.io Crawler 1.3'
      LayoutEngineNameVersionMajor         : 'DomainCheck.io Crawler 1'
      AgentClass                           : 'Robot'
      AgentName                            : 'DomainCheck.io Crawler'
      AgentVersion                         : '1.3'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'DomainCheck.io Crawler 1.3'
      AgentNameVersionMajor                : 'DomainCheck.io Crawler 1'
      AgentInformationUrl                  : 'https://domaincheck.io'


- test:
    input:
      user_agent_string: 'DomainCrawler/3.0 (info@domaincrawler.com; http://www.domaincrawler.com/basj.es)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'DomainCrawler'
      DeviceBrand                          : 'Domaincrawler'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'DomainCrawler'
      LayoutEngineVersion                  : '3.0'
      LayoutEngineVersionMajor             : '3'
      LayoutEngineNameVersion              : 'DomainCrawler 3.0'
      LayoutEngineNameVersionMajor         : 'DomainCrawler 3'
      AgentClass                           : 'Robot'
      AgentName                            : 'DomainCrawler'
      AgentVersion                         : '3.0'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'DomainCrawler 3.0'
      AgentNameVersionMajor                : 'DomainCrawler 3'
      AgentInformationEmail                : 'info@domaincrawler.com'
      AgentInformationUrl                  : 'http://www.domaincrawler.com/basj.es'


- test:
    input:
      user_agent_string: 'DomainCrawler/3.0 (info@domaincrawler.com; http://www.domaincrawler.com/basjes.nl)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'DomainCrawler'
      DeviceBrand                          : 'Domaincrawler'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'DomainCrawler'
      LayoutEngineVersion                  : '3.0'
      LayoutEngineVersionMajor             : '3'
      LayoutEngineNameVersion              : 'DomainCrawler 3.0'
      LayoutEngineNameVersionMajor         : 'DomainCrawler 3'
      AgentClass                           : 'Robot'
      AgentName                            : 'DomainCrawler'
      AgentVersion                         : '3.0'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'DomainCrawler 3.0'
      AgentNameVersionMajor                : 'DomainCrawler 3'
      AgentInformationEmail                : 'info@domaincrawler.com'
      AgentInformationUrl                  : 'http://www.domaincrawler.com/basjes.nl'


- test:
    input:
      user_agent_string: 'Mozilla/4.0 (compatible; BOTW Spider; +http://botw.org)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Botw Spider'
      DeviceBrand                          : 'Botw'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'BOTW Spider'
      LayoutEngineVersion                  : 'BOTW Spider'
      LayoutEngineVersionMajor             : 'BOTW Spider'
      LayoutEngineNameVersion              : 'BOTW Spider'
      LayoutEngineNameVersionMajor         : 'BOTW Spider'
      AgentClass                           : 'Robot'
      AgentName                            : 'BOTW Spider'
      AgentVersion                         : 'BOTW Spider'
      AgentVersionMajor                    : 'BOTW Spider'
      AgentNameVersion                     : 'BOTW Spider'
      AgentNameVersionMajor                : 'BOTW Spider'
      AgentInformationUrl                  : 'http://botw.org'


- test:
    input:
      user_agent_string: 'Mozilla/4.0 (compatible; Netcraft Web Server Survey)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Netcraft WEB Server Survey'
      DeviceBrand                          : 'Netcraft'
      OperatingSystemClass                 : 'Unknown'
      OperatingSystemName                  : 'Unknown'
      OperatingSystemVersion               : '??'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Netcraft Web Server Survey'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Netcraft Web Server Survey ??'
      LayoutEngineNameVersionMajor         : 'Netcraft Web Server Survey ??'
      AgentClass                           : 'Robot'
      AgentName                            : 'Netcraft Web Server Survey'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'Netcraft Web Server Survey ??'
      AgentNameVersionMajor                : 'Netcraft Web Server Survey ??'


- test:
    input:
      user_agent_string: 'Mozilla/4.0 (compatible;  Vagabondo/4.0; http://webagent.wise-guys.nl/)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Wise-Guys Vagabondo'
      DeviceBrand                          : 'Wise-Guys'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Vagabondo'
      LayoutEngineVersion                  : '4.0'
      LayoutEngineVersionMajor             : '4'
      LayoutEngineNameVersion              : 'Vagabondo 4.0'
      LayoutEngineNameVersionMajor         : 'Vagabondo 4'
      AgentClass                           : 'Robot'
      AgentName                            : 'Vagabondo'
      AgentVersion                         : '4.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Vagabondo 4.0'
      AgentNameVersionMajor                : 'Vagabondo 4'
      AgentInformationUrl                  : 'http://webagent.wise-guys.nl/'


#TODO: Implement
- test:
    input:
      user_agent_string: 'Mozilla/4.0 (compatible;  Vagabondo/4.0; http://webagent.wise-guys.nl/; http://www.wise-guys.nl/)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Wise-Guys Vagabondo'
      DeviceBrand                          : 'Wise-Guys'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Vagabondo'
      LayoutEngineVersion                  : '4.0'
      LayoutEngineVersionMajor             : '4'
      LayoutEngineNameVersion              : 'Vagabondo 4.0'
      LayoutEngineNameVersionMajor         : 'Vagabondo 4'
      AgentClass                           : 'Robot'
      AgentName                            : 'Vagabondo'
      AgentVersion                         : '4.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Vagabondo 4.0'
      AgentNameVersionMajor                : 'Vagabondo 4'
      AgentInformationUrl                  : 'http://webagent.wise-guys.nl/'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; 007ac9 Crawler; http://crawler.007ac9.net/)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Crawler'
      DeviceBrand                          : '007AC9'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Crawler'
      LayoutEngineVersion                  : 'Crawler'
      LayoutEngineVersionMajor             : 'Crawler'
      LayoutEngineNameVersion              : 'Crawler'
      LayoutEngineNameVersionMajor         : 'Crawler'
      AgentClass                           : 'Robot'
      AgentName                            : 'Crawler'
      AgentVersion                         : 'Crawler'
      AgentVersionMajor                    : 'Crawler'
      AgentNameVersion                     : 'Crawler'
      AgentNameVersionMajor                : 'Crawler'
      AgentInformationUrl                  : 'http://crawler.007ac9.net/'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; AhrefsBot/5.2; +http://ahrefs.com/robot/)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'AhrefsBot'
      DeviceBrand                          : 'Ahrefs'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'AhrefsBot'
      LayoutEngineVersion                  : '5.2'
      LayoutEngineVersionMajor             : '5'
      LayoutEngineNameVersion              : 'AhrefsBot 5.2'
      LayoutEngineNameVersionMajor         : 'AhrefsBot 5'
      AgentClass                           : 'Robot'
      AgentName                            : 'AhrefsBot'
      AgentVersion                         : '5.2'
      AgentVersionMajor                    : '5'
      AgentNameVersion                     : 'AhrefsBot 5.2'
      AgentNameVersionMajor                : 'AhrefsBot 5'
      AgentInformationUrl                  : 'http://ahrefs.com/robot/'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; aiHitBot/2.9; +https://www.aihitdata.com/about)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Aihitbot'
      DeviceBrand                          : 'Aihitdata'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'aiHitBot'
      LayoutEngineVersion                  : '2.9'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'aiHitBot 2.9'
      LayoutEngineNameVersionMajor         : 'aiHitBot 2'
      AgentClass                           : 'Robot'
      AgentName                            : 'aiHitBot'
      AgentVersion                         : '2.9'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'aiHitBot 2.9'
      AgentNameVersionMajor                : 'aiHitBot 2'
      AgentInformationUrl                  : 'https://www.aihitdata.com/about'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; alexa site audit/1.0; +http://www.alexa.com/help/webmasters; )'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Robot'
      DeviceBrand                          : 'Alexa'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '5.0'
      LayoutEngineVersionMajor             : '5'
      LayoutEngineNameVersion              : 'Mozilla 5.0'
      LayoutEngineNameVersionMajor         : 'Mozilla 5'
      AgentClass                           : 'Browser'
      AgentName                            : 'alexa site audit'
      AgentVersion                         : '1.0'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'alexa site audit 1.0'
      AgentNameVersionMajor                : 'alexa site audit 1'
      AgentInformationUrl                  : 'http://www.alexa.com/help/webmasters'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; AlphaBot/3.2; +http://alphaseobot.com/bot.html)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'AlphaBot'
      DeviceBrand                          : 'Alphaseobot'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'AlphaBot'
      LayoutEngineVersion                  : '3.2'
      LayoutEngineVersionMajor             : '3'
      LayoutEngineNameVersion              : 'AlphaBot 3.2'
      LayoutEngineNameVersionMajor         : 'AlphaBot 3'
      AgentClass                           : 'Robot'
      AgentName                            : 'AlphaBot'
      AgentVersion                         : '3.2'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'AlphaBot 3.2'
      AgentNameVersionMajor                : 'AlphaBot 3'
      AgentInformationUrl                  : 'http://alphaseobot.com/bot.html'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; Baiduspider-render/2.0; +http://www.baidu.com/search/spider.html)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Baiduspider-Render'
      DeviceBrand                          : 'Baidu'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Baiduspider-render'
      LayoutEngineVersion                  : '2.0'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Baiduspider-render 2.0'
      LayoutEngineNameVersionMajor         : 'Baiduspider-render 2'
      AgentClass                           : 'Robot'
      AgentName                            : 'Baiduspider-render'
      AgentVersion                         : '2.0'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Baiduspider-render 2.0'
      AgentNameVersionMajor                : 'Baiduspider-render 2'
      AgentInformationUrl                  : 'http://www.baidu.com/search/spider.html'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; BLEXBot/1.0; +http://webmeup-crawler.com/)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Blexbot'
      DeviceBrand                          : 'Webmeup-Crawler'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'BLEXBot'
      LayoutEngineVersion                  : '1.0'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'BLEXBot 1.0'
      LayoutEngineNameVersionMajor         : 'BLEXBot 1'
      AgentClass                           : 'Robot'
      AgentName                            : 'BLEXBot'
      AgentVersion                         : '1.0'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'BLEXBot 1.0'
      AgentNameVersionMajor                : 'BLEXBot 1'
      AgentInformationUrl                  : 'http://webmeup-crawler.com/'


##TODO: Implement
#- test:
#    input:
#      user_agent_string: 'Mozilla/5.0 (compatible; Dataprovider.com;)'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; Daum/4.1; +http://cs.daum.net/faq/15/4118.html?faqId=28966)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Robot'
      DeviceBrand                          : 'Daum'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '5.0'
      LayoutEngineVersionMajor             : '5'
      LayoutEngineNameVersion              : 'Mozilla 5.0'
      LayoutEngineNameVersionMajor         : 'Mozilla 5'
      AgentClass                           : 'Browser'
      AgentName                            : 'Daum'
      AgentVersion                         : '4.1'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Daum 4.1'
      AgentNameVersionMajor                : 'Daum 4'
      AgentInformationUrl                  : 'http://cs.daum.net/faq/15/4118.html?faqId=28966'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; discobot/2.0; +http://discoveryengine.com/discobot.html)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Discobot'
      DeviceBrand                          : 'Discoveryengine'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'discobot'
      LayoutEngineVersion                  : '2.0'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'discobot 2.0'
      LayoutEngineNameVersionMajor         : 'discobot 2'
      AgentClass                           : 'Robot'
      AgentName                            : 'discobot'
      AgentVersion                         : '2.0'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'discobot 2.0'
      AgentNameVersionMajor                : 'discobot 2'
      AgentInformationUrl                  : 'http://discoveryengine.com/discobot.html'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; DNS SSL/TLS HTTP HTML Website Security Scanner/0.2 beta; +https://www.htmlyse.com/)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Robot'
      DeviceBrand                          : 'Htmlyse'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '5.0'
      LayoutEngineVersionMajor             : '5'
      LayoutEngineNameVersion              : 'Mozilla 5.0'
      LayoutEngineNameVersionMajor         : 'Mozilla 5'
      AgentClass                           : 'Browser'
      AgentName                            : 'DNS SSL'
      # FIXME: Messy name with extra '/' in it --> broken version. Should be 0.2 in this case.
      AgentVersion                         : 'TLS HTTP HTML Website Security Scanner'
      AgentVersionMajor                    : 'TLS HTTP HTML Website Security Scanner'
      AgentNameVersion                     : 'DNS SSL TLS HTTP HTML Website Security Scanner'
      AgentNameVersionMajor                : 'DNS SSL TLS HTTP HTML Website Security Scanner'
      AgentInformationUrl                  : 'https://www.htmlyse.com/'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; DotBot/1.1; http://www.opensiteexplorer.org/dotbot, help@moz.com)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Dotbot'
      DeviceBrand                          : 'Opensiteexplorer'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'DotBot'
      LayoutEngineVersion                  : '1.1'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'DotBot 1.1'
      LayoutEngineNameVersionMajor         : 'DotBot 1'
      AgentClass                           : 'Robot'
      AgentName                            : 'DotBot'
      AgentVersion                         : '1.1'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'DotBot 1.1'
      AgentNameVersionMajor                : 'DotBot 1'
      AgentInformationEmail                : 'help@moz.com'
      AgentInformationUrl                  : 'http://www.opensiteexplorer.org/dotbot'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; DuckDuckGo-Favicons-Bot/1.0; +http://duckduckgo.com)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'DuckDuckGo-Favicons-BOT'
      DeviceBrand                          : 'Duckduckgo'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'DuckDuckGo-Favicons-Bot'
      LayoutEngineVersion                  : '1.0'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'DuckDuckGo-Favicons-Bot 1.0'
      LayoutEngineNameVersionMajor         : 'DuckDuckGo-Favicons-Bot 1'
      AgentClass                           : 'Robot'
      AgentName                            : 'DuckDuckGo-Favicons-Bot'
      AgentVersion                         : '1.0'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'DuckDuckGo-Favicons-Bot 1.0'
      AgentNameVersionMajor                : 'DuckDuckGo-Favicons-Bot 1'
      AgentInformationUrl                  : 'http://duckduckgo.com'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; ExtLinksBot/1.5; +https://extlinks.com/Bot.html)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'ExtlinksBot'
      DeviceBrand                          : 'Extlinks'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'ExtLinksBot'
      LayoutEngineVersion                  : '1.5'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'ExtLinksBot 1.5'
      LayoutEngineNameVersionMajor         : 'ExtLinksBot 1'
      AgentClass                           : 'Robot'
      AgentName                            : 'ExtLinksBot'
      AgentVersion                         : '1.5'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'ExtLinksBot 1.5'
      AgentNameVersionMajor                : 'ExtLinksBot 1'
      AgentInformationUrl                  : 'https://extlinks.com/Bot.html'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; Go-http-client/1.1; +centurybot9@gmail.com)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Robot'
      DeviceBrand                          : 'Gmail' # Wrong, funny and unavoidable
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '5.0'
      LayoutEngineVersionMajor             : '5'
      LayoutEngineNameVersion              : 'Mozilla 5.0'
      LayoutEngineNameVersionMajor         : 'Mozilla 5'
      AgentClass                           : 'Browser'
      AgentName                            : 'Go-http-client'
      AgentVersion                         : '1.1'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Go-http-client 1.1'
      AgentNameVersionMajor                : 'Go-http-client 1'
      AgentInformationEmail                : 'centurybot9@gmail.com'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; Grobbot/2.2; +https://grob.it)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'Grobbot'
      DeviceBrand                          : 'Grob'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'Grobbot'
      LayoutEngineVersion                  : '2.2'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Grobbot 2.2'
      LayoutEngineNameVersionMajor         : 'Grobbot 2'
      AgentClass                           : 'Robot'
      AgentName                            : 'Grobbot'
      AgentVersion                         : '2.2'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Grobbot 2.2'
      AgentNameVersionMajor                : 'Grobbot 2'
      AgentInformationUrl                  : 'https://grob.it'


- test:
    input:
      # Yet another parse error.
      user_agent_string: 'Consilio/4.17.00 (WebHare Application Portal); LinkChecker)'
    expected:
      DeviceClass                          : 'Robot'
      DeviceName                           : 'LinkChecker'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : 'Cloud'
      OperatingSystemNameVersion           : 'Cloud'
      LayoutEngineClass                    : 'Robot'
      LayoutEngineName                     : 'LinkChecker'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'LinkChecker ??'
      LayoutEngineNameVersionMajor         : 'LinkChecker ??'
      AgentClass                           : 'Robot'
      AgentName                            : 'LinkChecker'
      AgentVersion                         : '??'
      AgentVersionMajor                    : '??'
      AgentNameVersion                     : 'LinkChecker ??'
      AgentNameVersionMajor                : 'LinkChecker ??'

#
# Yet Another UserAgent Analyzer
# Copyright (C) 2013-2022 Niels Basjes
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# https://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an AS IS BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

config:
- test:
    name: 'Chrome on Windows 11 (No Client Hints) (old test format)'
    input:
      user_agent_string                    : 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.4844.51 Safari/537.361'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '>=10'
      OperatingSystemVersionMajor          : '>=10'
      OperatingSystemNameVersion           : 'Windows >=10'
      OperatingSystemNameVersionMajor      : 'Windows >=10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '99.0'
      LayoutEngineVersionMajor             : '99'
      LayoutEngineNameVersion              : 'Blink 99.0'
      LayoutEngineNameVersionMajor         : 'Blink 99'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '99.0.4844.51'
      AgentVersionMajor                    : '99'
      AgentNameVersion                     : 'Chrome 99.0.4844.51'
      AgentNameVersionMajor                : 'Chrome 99'


- test:
    name: 'Chrome on Windows 11 (No Client Hints) (header based test format)'
    input:
      User-Agent                           : 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.4844.51 Safari/537.362'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '>=10'
      OperatingSystemVersionMajor          : '>=10'
      OperatingSystemNameVersion           : 'Windows >=10'
      OperatingSystemNameVersionMajor      : 'Windows >=10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '99.0'
      LayoutEngineVersionMajor             : '99'
      LayoutEngineNameVersion              : 'Blink 99.0'
      LayoutEngineNameVersionMajor         : 'Blink 99'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '99.0.4844.51'
      AgentVersionMajor                    : '99'
      AgentNameVersion                     : 'Chrome 99.0.4844.51'
      AgentNameVersionMajor                : 'Chrome 99'


- test:
    name: 'Chrome on Windows 11 (Standard Client Hints)'
    input:
      User-Agent                           : 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.4844.51 Safari/537.36'
      Sec-Ch-Ua                            : '" Not A;Brand";v="99", "Chromium";v="99", "Google Chrome";v="99"'
      Sec-Ch-Ua-Mobile                     : '?0'
      Sec-Ch-Ua-Platform                   : '"Windows"'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '>=10'
      OperatingSystemVersionMajor          : '>=10'
      OperatingSystemNameVersion           : 'Windows >=10'
      OperatingSystemNameVersionMajor      : 'Windows >=10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '99.0'
      LayoutEngineVersionMajor             : '99'
      LayoutEngineNameVersion              : 'Blink 99.0'
      LayoutEngineNameVersionMajor         : 'Blink 99'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '99.0.4844.51'
      AgentVersionMajor                    : '99'
      AgentNameVersion                     : 'Chrome 99.0.4844.51'
      AgentNameVersionMajor                : 'Chrome 99'


- test:
    name: 'Chrome on Windows 11 (Full Client Hints)'
    input:
      User-Agent                           : 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.4844.51 Safari/537.36'
      Sec-Ch-Ua                            : '" Not A;Brand";v="99", "Chromium";v="99", "Google Chrome";v="99"'
      Sec-Ch-Ua-Arch                       : '"x86"'
      Sec-Ch-Ua-Full-Version-List          : '" Not A;Brand";v="99.0.0.0", "Chromium";v="99.0.4844.51", "Google Chrome";v="99.0.4844.51"'
      Sec-Ch-Ua-Mobile                     : '?0'
      Sec-Ch-Ua-Model                      : ''
      Sec-Ch-Ua-Platform                   : '"Windows"'
      Sec-Ch-Ua-Platform-Version           : '"14.0.0"'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '11'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'Windows 11'
      OperatingSystemNameVersionMajor      : 'Windows 11'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '99.0'
      LayoutEngineVersionMajor             : '99'
      LayoutEngineNameVersion              : 'Blink 99.0'
      LayoutEngineNameVersionMajor         : 'Blink 99'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '99.0.4844.51'
      AgentVersionMajor                    : '99'
      AgentNameVersion                     : 'Chrome 99.0.4844.51'
      AgentNameVersionMajor                : 'Chrome 99'

# Chrome 100 on Windows 7

- test:
    name: 'Chrome 100 on Windows 7 (Normal, NO Client Hints)'
    input:
      User-Agent                           : 'Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.75 Safari/537.36'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '100.0'
      LayoutEngineVersionMajor             : '100'
      LayoutEngineNameVersion              : 'Blink 100.0'
      LayoutEngineNameVersionMajor         : 'Blink 100'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '100.0.4896.75'
      AgentVersionMajor                    : '100'
      AgentNameVersion                     : 'Chrome 100.0.4896.75'
      AgentNameVersionMajor                : 'Chrome 100'


- test:
    name: 'Chrome 100 on Windows 7 (Normal, Standard Client Hints)'
    input:
      User-Agent                           : 'Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.75 Safari/537.36'
      Sec-Ch-Ua                            : '" Not A;Brand";v="99", "Chromium";v="100", "Google Chrome";v="100"'
      Sec-Ch-Ua-Mobile                     : '?0'
      Sec-Ch-Ua-Platform                   : '"Windows"'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '100.0'
      LayoutEngineVersionMajor             : '100'
      LayoutEngineNameVersion              : 'Blink 100.0'
      LayoutEngineNameVersionMajor         : 'Blink 100'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '100.0.4896.75'
      AgentVersionMajor                    : '100'
      AgentNameVersion                     : 'Chrome 100.0.4896.75'
      AgentNameVersionMajor                : 'Chrome 100'


- test:
    name: 'Chrome 100 on Windows 7 (Normal, Full Client Hints)'
    input:
      User-Agent                           : 'Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.75 Safari/537.36'
      Sec-Ch-Ua                            : '" Not A;Brand";v="99", "Chromium";v="100", "Google Chrome";v="100"'
      Sec-Ch-Ua-Mobile                     : '?0'
      Sec-Ch-Ua-Arch                       : '"x86"'
      Sec-Ch-Ua-Platform                   : '"Windows"'
      Sec-Ch-Ua-Platform-Version           : '"0.1.0"'
      Sec-Ch-Ua-Model                      : '""'
      Sec-Ch-Ua-Wow64                      : '?0'
      Sec-Ch-Ua-Full-Version-List          : '" Not A;Brand";v="99.0.0.0", "Chromium";v="100.0.4896.75", "Google Chrome";v="100.0.4896.75"'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '100.0'
      LayoutEngineVersionMajor             : '100'
      LayoutEngineNameVersion              : 'Blink 100.0'
      LayoutEngineNameVersionMajor         : 'Blink 100'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '100.0.4896.75'
      AgentVersionMajor                    : '100'
      AgentNameVersion                     : 'Chrome 100.0.4896.75'
      AgentNameVersionMajor                : 'Chrome 100'

# Major in minor version

- test:
    name: 'Chrome 100 on Windows 7 (Major in minor version, NO Client Hints)'
    input:
      User-Agent                           : 'Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.100.4896.75 Safari/537.36'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '100.0'
      LayoutEngineVersionMajor             : '100'
      LayoutEngineNameVersion              : 'Blink 100.0'
      LayoutEngineNameVersionMajor         : 'Blink 100'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '100.0'
      AgentVersionMajor                    : '100'
      AgentNameVersion                     : 'Chrome 100.0'
      AgentNameVersionMajor                : 'Chrome 100'



- test:
    name: 'Chrome 100 on Windows 7 (Major in minor version, Standard Client Hints)'
    input:
      User-Agent                           : 'Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.100.4896.75 Safari/537.36'
      Sec-Ch-Ua                            : '" Not A;Brand";v="99", "Chromium";v="99", "Google Chrome";v="99"'
      Sec-Ch-Ua-Mobile                     : '?0'
      Sec-Ch-Ua-Platform                   : '"Windows"'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '100.0'
      LayoutEngineVersionMajor             : '100'
      LayoutEngineNameVersion              : 'Blink 100.0'
      LayoutEngineNameVersionMajor         : 'Blink 100'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '100.0'
      AgentVersionMajor                    : '100'
      AgentNameVersion                     : 'Chrome 100.0'
      AgentNameVersionMajor                : 'Chrome 100'


- test:
    name: 'Chrome 100 on Windows 7 (Major in minor version, Full Client Hints)'
    input:
      User-Agent                           : 'Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.100.4896.75 Safari/537.36'
      Sec-Ch-Ua                            : '" Not A;Brand";v="99", "Chromium";v="99", "Google Chrome";v="99"'
      Sec-Ch-Ua-Mobile                     : '?0'
      Sec-Ch-Ua-Arch                       : '"x86"'
      Sec-Ch-Ua-Platform                   : '"Windows"'
      Sec-Ch-Ua-Platform-Version           : '"0.1.0"'
      Sec-Ch-Ua-Model                      : '""'
      Sec-Ch-Ua-Wow64                      : '?0'
      Sec-Ch-Ua-Full-Version-List          : '" Not A;Brand";v="99.0.0.0", "Chromium";v="99.100.4896.75", "Google Chrome";v="99.100.4896.75"'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '100.0'
      LayoutEngineVersionMajor             : '100'
      LayoutEngineNameVersion              : 'Blink 100.0'
      LayoutEngineNameVersionMajor         : 'Blink 100'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '100.0'
      AgentVersionMajor                    : '100'
      AgentNameVersion                     : 'Chrome 100.0'
      AgentNameVersionMajor                : 'Chrome 100'

# Reduced

- test:
    name: 'Chrome 100 on Windows 7 with reduced User-Agent (NO Client Hints)'
    input:
      User-Agent                           : 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.0.0 Safari/537.36'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Windows NT ??'
      OperatingSystemNameVersionMajor      : 'Windows NT ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '100'
      LayoutEngineVersionMajor             : '100'
      LayoutEngineNameVersion              : 'Blink 100'
      LayoutEngineNameVersionMajor         : 'Blink 100'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '100'
      AgentVersionMajor                    : '100'
      AgentNameVersion                     : 'Chrome 100'
      AgentNameVersionMajor                : 'Chrome 100'


- test:
    name: 'Chrome 100 on Windows 7 with reduced User-Agent (Standard Client Hints)'
    input:
      User-Agent                           : 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.0.0 Safari/537.36'
      Sec-Ch-Ua                            : '" Not A;Brand";v="99", "Chromium";v="100", "Google Chrome";v="100"'
      Sec-Ch-Ua-Mobile                     : '?0'
      Sec-Ch-Ua-Platform                   : '"Windows"'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Windows NT ??'
      OperatingSystemNameVersionMajor      : 'Windows NT ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '100'
      LayoutEngineVersionMajor             : '100'
      LayoutEngineNameVersion              : 'Blink 100'
      LayoutEngineNameVersionMajor         : 'Blink 100'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '100'
      AgentVersionMajor                    : '100'
      AgentNameVersion                     : 'Chrome 100'
      AgentNameVersionMajor                : 'Chrome 100'


- test:
    name: 'Chrome 100 on Windows 7 with reduced User-Agent (Full Client Hints)'
    input:
      User-Agent                           : 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.0.0 Safari/537.36'
      Sec-Ch-Ua                            : '" Not A;Brand";v="99", "Chromium";v="100", "Google Chrome";v="100"'
      Sec-Ch-Ua-Arch                       : '"x86"'
      Sec-Ch-Ua-Full-Version-List          : '" Not A;Brand";v="99.0.0.0", "Chromium";v="100.0.4896.75", "Google Chrome";v="100.0.4896.75"'
      Sec-Ch-Ua-Mobile                     : '?0'
      Sec-Ch-Ua-Model                      : '""'
      Sec-Ch-Ua-Platform                   : '"Windows"'
      Sec-Ch-Ua-Platform-Version           : '"0.1.0"'
      Sec-Ch-Ua-Wow64                      : '?0'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '100.0'
      LayoutEngineVersionMajor             : '100'
      LayoutEngineNameVersion              : 'Blink 100.0'
      LayoutEngineNameVersionMajor         : 'Blink 100'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '100.0.4896.75'
      AgentVersionMajor                    : '100'
      AgentNameVersion                     : 'Chrome 100.0.4896.75'
      AgentNameVersionMajor                : 'Chrome 100'

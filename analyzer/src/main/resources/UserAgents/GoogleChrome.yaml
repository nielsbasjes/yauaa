#
# Yet Another UserAgent Analyzer
# Copyright (C) 2013-2021 Niels Basjes
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# https://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an AS IS BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

#https://en.wikipedia.org/wiki/List_of_web_browsers
#
#Layout engines
#Gecko is developed by the Mozilla Foundation.
#KHTML is developed by the KDE project.
#Presto is developed by Opera Software for use in Opera. Development stopped as Opera transitioned to Blink.
#Tasman was developed by Microsoft for use in Internet Explorer 5 for Macintosh.
#Trident is developed by Microsoft for use in the Windows versions of Internet Explorer 4 to Internet Explorer 11.
#WebKit is a fork of KHTML by Apple Inc. used in Apple Safari, Chromium and Google Chrome.
#Blink is a 2013 fork of WebKit by Google used in Chromium, Google Chrome and Opera.[20]
#Servo is an experimental web browser layout engine being developed cooperatively by Mozilla and Samsung.
#EdgeHTML is the engine developed by Microsoft for Edge. It is a largely rewritten fork of Trident with all legacy code removed.

config:

- lookup:
    name: 'SpecialChromeBrowserNames'
    map:
      "Vivaldi"         : "Vivaldi"
      "OPR"             : "Opera"
      "MMS"             : "Opera Neon"
      "OPT"             : "Opera Touch"
      "Amigo"           : "Amigo"       # https://amigo.mail.ru/
      "MRCHROME"        : "Amigo"       # https://amigo.mail.ru/
      "MRPULSE"         : "Pulse"       # https://amigo.mail.ru/
      # Also matches "Ubuntu Chromium", "snap Chromium" (Chromium running from within a snap), "Raspbian Chromium", ...
      "Chromium"        : "Chromium"
      "CrMo"            : "Chrome"      # https://bugs.chromium.org/p/chromium/issues/detail?id=116455
      "Epiphany"        : "Epiphany"
      "UCBrowser"       : "UCBrowser"
      "Viera"           : "Viera"
      "Puffin"          : "Puffin"
      "AvantBrowser"    : "AvantBrowser"
      "CoolNovo"        : "CoolNovo"
      "Iron"            : "Iron"
      "Iridium"         : "Iridium"
      "Quark"           : "Quark"
      "Mxbrowser"       : "Maxthon"
      "Brave Chrome"    : "Brave"
      "Iron Safari"     : "Iron"
      "Mobile Iron Safari" : "Iron"
      "Falkon"          : "Falkon"
      "QupZilla"        : "QupZilla" # The old name of what is now called Falkon
      "Colibri"         : "Colibri"
      "Midori"          : "Midori"
      "SE"              : "Sogou Explorer"
      "LBBROWSER"       : "Liebao Browser" # Created by Kingsoft
      "TungstenBrowser" : "TungstenBrowser"
      "Kinza"           : "Kinza"
      "Avast"           : "Avast"
      "Dragon"          : "Comodo Dragon"
      "IceDragon"       : "Comodo IceDragon"
      "XVast"           : "XVast"
      "Tbrowser"        : "Tbrowser" # Used in TVs
      "PHX"             : "Phoenix"
      "AlohaBrowser"    : "Aloha Browser"
      "Sleipnir"        : "Sleipnir"
      "RockMelt"        : "RockMelt"
      "VivoBrowser"     : "VivoBrowser"

- lookup:
    name: 'KnownWebviewAppNames'
    map:
      'GSApp'                : 'Google Search App'
      'Focus'                : 'Firefox Focus'
      'Acheetahi'            : 'Cheetah Mobile Browser'
      'MediBangPaintTablet'  : 'MediBang Paint'
      'ZhihuHybrid'          : 'Zhihu Hybrid'
      'Cake'                 : 'Cake Browser'

# ================================
# Specific browser rules

# Epiphany also occurs like this:
#  ... Chromium/?? Chrome/?? Safari/?? Debian/?? Epiphany/??
# In this case the "Chromium" wins which is incorrect

- matcher:
    extract:
    - 'AgentClass                          :     2100 :"Browser"'
    - 'AgentName                           :     2100 :"Epiphany"'
    - 'AgentVersion                        :     2100 :agent.product.name="Epiphany"^.version'

# ================================

- matcher:
    extract:
    - 'AgentClass                          :     2014 :"Browser"'
    - 'AgentName                           :     2014 :"Chrome"'
    - 'AgentVersion                        :     2014 :agent.product.name="Chrome"^.version'

# Chrome on iOS is the only Chrome that does not use Blink
- matcher:
    extract:
    - 'AgentClass                          :     2014 :"Browser"'
    - 'AgentName                           :     2014 :"Chrome"'
    - 'AgentVersion                        :     2014 :agent.product.name="CriOS"^.version'
    - 'LayoutEngineClass                   :     1000 :"Browser"'
    - 'LayoutEngineName                    :     1000 :"AppleWebKit"'
    - 'LayoutEngineVersion                 :     1000 :agent.product.name="AppleWebKit"^.version'


  # Chrome uses Blink starting with version 28
  # See https://en.wikipedia.org/wiki/Blink_(web_engine)
  # We define the 'old' version with a higher score and set the new one as the default
- matcher:
    require:
    - 'LookUp[ChromeLayoutEngineName;agent.product.name="Chrome"^.version[-1]]'
    extract:
    - 'LayoutEngineClass                   :     1000 :"Browser"'
    - 'LayoutEngineName                    :     1000 :"AppleWebKit"'
    - 'LayoutEngineVersion                 :     1000 :agent.product.name="AppleWebKit"^.version'

- matcher:
    extract:
    - 'LayoutEngineClass                   :      999 :"Browser"'
    - 'LayoutEngineName                    :      999 :"Blink"'
    - 'LayoutEngineVersion                 :      999 :agent.product.name="Chrome"^.version[-2]'

- matcher:
    require:
    - 'LookUp[ChromeLayoutEngineName;agent.product.name="CriOS"^.version[-1]]'
    extract:
    - 'LayoutEngineClass                   :     1000 :"Browser"'
    - 'LayoutEngineName                    :     1000 :"AppleWebKit"'
    - 'LayoutEngineVersion                 :     1000 :agent.product.name="AppleWebKit"^.version'

- matcher:
    extract:
    - 'LayoutEngineClass                   :      999 :"Browser"'
    - 'LayoutEngineName                    :      999 :"Blink"'
    - 'LayoutEngineVersion                 :      999 :agent.product.name="CriOS"^.version[-2]'


- matcher:
    extract:
    - 'DeviceClass                         :      998 :"Phone"'
    - 'LayoutEngineClass                   :      999 :"Browser"'
    - 'LayoutEngineName                    :      999 :"Blink"'
    - 'LayoutEngineVersion                 :      999 :agent.product.name="Mobile Chrome"^.version[-2]'


- lookup:
    name: 'ChromeLayoutEngineName'
    map:
      "0"  : "AppleWebKit"
      "1"  : "AppleWebKit"
      "2"  : "AppleWebKit"
      "3"  : "AppleWebKit"
      "4"  : "AppleWebKit"
      "5"  : "AppleWebKit"
      "6"  : "AppleWebKit"
      "7"  : "AppleWebKit"
      "8"  : "AppleWebKit"
      "9"  : "AppleWebKit"
      "10" : "AppleWebKit"
      "11" : "AppleWebKit"
      "12" : "AppleWebKit"
      "13" : "AppleWebKit"
      "14" : "AppleWebKit"
      "15" : "AppleWebKit"
      "16" : "AppleWebKit"
      "17" : "AppleWebKit"
      "18" : "AppleWebKit"
      "19" : "AppleWebKit"
      "20" : "AppleWebKit"
      "21" : "AppleWebKit"
      "22" : "AppleWebKit"
      "23" : "AppleWebKit"
      "24" : "AppleWebKit"
      "25" : "AppleWebKit"
      "26" : "AppleWebKit"
      "27" : "AppleWebKit"

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US) AppleWebKit/525.13 (KHTML, like Gecko) Chrome/0.2.149.27 Safari/525.13'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : 'XP'
      OperatingSystemVersionMajor          : 'XP'
      OperatingSystemNameVersion           : 'Windows XP'
      OperatingSystemNameVersionMajor      : 'Windows XP'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '525.13'
      LayoutEngineVersionMajor             : '525'
      LayoutEngineNameVersion              : 'AppleWebKit 525.13'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 525'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '0.2.149.27'
      AgentVersionMajor                    : '0'
      AgentNameVersion                     : 'Chrome 0.2.149.27'
      AgentNameVersionMajor                : 'Chrome 0'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; CrOS x86_64 6310.68.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.96 Safari/537.36'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Google Chromebook'
      DeviceBrand                          : 'Google'            # This is a "Best guess".
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Chrome OS'
      OperatingSystemVersion               : '6310.68.0'
      OperatingSystemVersionMajor          : '6310'
      OperatingSystemNameVersion           : 'Chrome OS 6310.68.0'
      OperatingSystemNameVersionMajor      : 'Chrome OS 6310'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '39.0'
      LayoutEngineVersionMajor             : '39'
      LayoutEngineNameVersion              : 'Blink 39.0'
      LayoutEngineNameVersionMajor         : 'Blink 39'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '39.0.2171.96'
      AgentVersionMajor                    : '39'
      AgentNameVersion                     : 'Chrome 39.0.2171.96'
      AgentNameVersionMajor                : 'Chrome 39'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; CrOS armv7l 6680.81.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.118 Safari/537.36'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Google Chromebook'
      DeviceBrand                          : 'Google'            # This is a "Best guess".
      DeviceCpu                            : 'ARMv7l'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Chrome OS'
      OperatingSystemVersion               : '6680.81.0'
      OperatingSystemVersionMajor          : '6680'
      OperatingSystemNameVersion           : 'Chrome OS 6680.81.0'
      OperatingSystemNameVersionMajor      : 'Chrome OS 6680'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '41.0'
      LayoutEngineVersionMajor             : '41'
      LayoutEngineNameVersion              : 'Blink 41.0'
      LayoutEngineNameVersionMajor         : 'Blink 41'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '41.0.2272.118'
      AgentVersionMajor                    : '41'
      AgentNameVersion                     : 'Chrome 41.0.2272.118'
      AgentNameVersionMajor                : 'Chrome 41'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; CrOS x86_64 6680.78.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.102 Safari/537.36'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Google Chromebook'
      DeviceBrand                          : 'Google'            # This is a "Best guess".
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Chrome OS'
      OperatingSystemVersion               : '6680.78.0'
      OperatingSystemVersionMajor          : '6680'
      OperatingSystemNameVersion           : 'Chrome OS 6680.78.0'
      OperatingSystemNameVersionMajor      : 'Chrome OS 6680'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '41.0'
      LayoutEngineVersionMajor             : '41'
      LayoutEngineNameVersion              : 'Blink 41.0'
      LayoutEngineNameVersionMajor         : 'Blink 41'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '41.0.2272.102'
      AgentVersionMajor                    : '41'
      AgentNameVersion                     : 'Chrome 41.0.2272.102'
      AgentNameVersionMajor                : 'Chrome 41'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; U; CrOS i686 9.10.0; en-US) AppleWebKit/532.5 (KHTML, like Gecko) Chrome/4.0.253.0 Safari/532.5'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Google Chromebook'
      DeviceBrand                          : 'Google'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Chrome OS'
      OperatingSystemVersion               : '9.10.0'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'Chrome OS 9.10.0'
      OperatingSystemNameVersionMajor      : 'Chrome OS 9'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '532.5'
      LayoutEngineVersionMajor             : '532'
      LayoutEngineNameVersion              : 'AppleWebKit 532.5'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 532'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '4.0.253.0'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Chrome 4.0.253.0'
      AgentNameVersionMajor                : 'Chrome 4'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 4.0.4; Galaxy Nexus Build/IMM76B) AppleWebKit/535.19 (KHTML, like Gecko) Chrome/18.0.1025.133 Mobile Safari/535.19'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung Galaxy Nexus'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.0.4'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.0.4'
      OperatingSystemNameVersionMajor      : 'Android 4'
      OperatingSystemVersionBuild          : 'IMM76B'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '535.19'
      LayoutEngineVersionMajor             : '535'
      LayoutEngineNameVersion              : 'AppleWebKit 535.19'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 535'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '18.0.1025.133'
      AgentVersionMajor                    : '18'
      AgentNameVersion                     : 'Chrome 18.0.1025.133'
      AgentNameVersionMajor                : 'Chrome 18'

# Webview
# https://developer.chrome.com/multidevice/user-agent

# WebView UA in KitKat to Lollipop
# Mozilla/5.0 (Linux; Android 4.4; Nexus 5 Build/_BuildID_) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/30.0.0.0 Mobile Safari/537.36
# If you’re attempting to differentiate between the WebView and Chrome for Android, you should look for the
# presence of the Version/_X.X_ string in the WebView user-agent string.
# Don’t rely on the specific Chrome version number (for example, 30.0.0.0) as the version numbers
# changes with each release.

- matcher:
    require:
    - 'agent.product.name="Version"'
    extract:
    - 'AgentClass                          :     2500 :"Browser Webview"'
    - 'AgentName                           :     2500 :"Chrome Webview"'
    - 'AgentVersion                        :     2500 :agent.product.name="Chrome"^.version'
    - 'WebviewAppName                      :        0 :"Unknown Webview App"'
    - 'WebviewAppVersion                   :        0 :"<<<null>>>"'

- matcher:
    variable:
    - 'Chrome                              :agent.product.name="Chrome"^'
    - 'WebViewApp                          :@Chrome>'
    - 'WebViewAppName                      :@WebViewApp.name'
    require:
    - '@WebViewAppName!="Safari"'
    - '@WebViewAppName!="Mobile Safari"'
    - 'agent.product.name="Version"'
    extract:
    - 'AgentClass                          :     2500 :"Browser Webview"'
    - 'AgentName                           :     2500 :"Chrome Webview"'
    - 'AgentVersion                        :     2500 :@Chrome.version'
    - 'WebviewAppName                      :        9 :NormalizeBrand[@WebViewAppName]'
    - 'WebviewAppVersion                   :        9 :@WebViewApp.version'

# Sometimes we get variants where parts are swapped around like this:
#     Mobile DuckDuckGo/5 Safari/537.36
# instead of
#     Mobile Safari/537.36 DuckDuckGo/5
- matcher:
    variable:
    - 'Chrome                              :agent.product.name="Chrome"^'
    - 'WebViewApp                          :@Chrome>'
    - 'WebViewAppName                      :@WebViewApp.name'
    require:
    - '@WebViewAppName!="Safari"'
    - '@WebViewAppName!="Mobile Safari"'
    - '@WebViewAppName[1]="Mobile"'
    - 'agent.product.name="Version"'
    extract:
    - 'DeviceClass                         :     3500 :"Phone"'
    - 'AgentClass                          :     3500 :"Browser Webview"'
    - 'AgentName                           :     3500 :"Chrome Webview"'
    - 'AgentVersion                        :     3500 :@Chrome.version'
    - 'WebviewAppName                      :       10 :NormalizeBrand[@WebViewAppName[2-]]'
    - 'WebviewAppVersion                   :       10 :@WebViewApp.version'


- matcher:
    variable:
    - 'Chrome                              :agent.product.name="Chrome"^'
    - 'WebViewApp                          :@Chrome>>'
    - 'WebViewAppName                      :@WebViewApp.name'
    require:
    - '@WebViewAppName!="Safari"'
    - '@WebViewAppName!="Mobile Safari"'
    - 'agent.product.name="Version"'
    extract:
    - 'AgentClass                          :     2500 :"Browser Webview"'
    - 'AgentName                           :     2500 :"Chrome Webview"'
    - 'AgentVersion                        :     2500 :@Chrome.version'
    - 'WebviewAppName                      :       10 :NormalizeBrand[@WebViewAppName]'
    - 'WebviewAppVersion                   :       10 :@WebViewApp.version'

- matcher:
    variable:
    - 'Browser                             :LookUp[SpecialChromeBrowserNames;agent.product.name]'
    extract:
    - 'AgentClass                          :       38 :"Browser"'
    - 'AgentName                           :     2038 :@Browser'
    - 'AgentVersion                        :     2038 :@Browser^.version'

- matcher:
    variable:
    - 'Browser                             :LookUp[SpecialChromeBrowserNames;agent.product.name[2-]]'
    extract:
    - 'AgentClass                          :       38 :"Browser"'
    - 'AgentName                           :     2037 :@Browser'
    - 'AgentVersion                        :     2037 :@Browser^.version'

- matcher:
    variable:
    - 'WebViewProduct                      :agent.product.name="Chrome"^>>'
    require:
    - 'agent.product.name="Version"'
    extract:
    - 'AgentClass                          :     2500 :"Browser Webview"'
    - 'AgentName                           :     2500 :"Chrome Webview"'
    - 'AgentVersion                        :     2500 :agent.product.name="Chrome"^.version'
    - 'WebviewAppName                      :       11 :LookUp[SpecialChromeBrowserNames;@WebViewProduct.name]'
    - 'WebviewAppVersion                   :       11 :@WebViewProduct.version'

- matcher:
    variable:
    - 'WebViewProduct                      :agent.product.name="Version"^>>.name="Chrome"^<'
    extract:
    - 'AgentClass                          :     2500 :"Browser Webview"'
    - 'AgentName                           :     2500 :"Chrome Webview"'
    - 'AgentVersion                        :     2500 :agent.product.name="Chrome"^.version'
    - 'WebviewAppName                      :       12 :LookUp[SpecialChromeBrowserNames;@WebViewProduct.name]'
    - 'WebviewAppVersion                   :       12 :@WebViewProduct.version'


- matcher:
    require:
    - 'agent.product.name="Safari"'
    variable:
    - 'WebViewProduct                      :agent.product.name="Version"^>.name="Chrome"^>>.name="Safari"^<'
    extract:
    - 'AgentClass                          :     2500 :"Browser Webview"'
    - 'AgentName                           :     2500 :"Chrome Webview"'
    - 'AgentVersion                        :     2500 :agent.product.name="Chrome"^.version'
    - 'WebviewAppName                      :       12 :LookUp[SpecialChromeBrowserNames;@WebViewProduct.name]'
    - 'WebviewAppVersion                   :       12 :@WebViewProduct.version'

- matcher:
    require:
    - 'agent.product.name="Mobile Safari"'
    variable:
    - 'WebViewProduct                      :agent.product.name="Version"^>.name="Chrome"^>>.name="Mobile Safari"^<'
    extract:
    - 'AgentClass                          :     2500 :"Browser Webview"'
    - 'AgentName                           :     2500 :"Chrome Webview"'
    - 'AgentVersion                        :     2500 :agent.product.name="Chrome"^.version'
    - 'WebviewAppName                      :       12 :LookUp[SpecialChromeBrowserNames;@WebViewProduct.name]'
    - 'WebviewAppVersion                   :       12 :@WebViewProduct.version'

- matcher:
    variable:
    - 'Chrome                              :agent.product.name="Chrome"^'
    - 'WebViewProduct                      :@Chrome>>'
    require:
    - 'agent.product.name="Version"'
    extract:
    - 'AgentClass                          :     2500 :"Browser Webview"'
    - 'AgentName                           :     2500 :"Chrome Webview"'
    - 'AgentVersion                        :     2500 :@Chrome.version'
    - 'WebviewAppName                      :       11 :LookUp[KnownWebviewAppNames;@WebViewProduct.name]'
    - 'WebviewAppVersion                   :       11 :@WebViewProduct.version'

- matcher:
    extract:
    - 'WebviewAppName                      :       12 :LookUp[KnownWebviewAppNames;agent.(1)product.name]'
    - 'WebviewAppVersion                   :       12 :agent.(1)product.version'

- matcher:
    variable:
    - 'WebViewProduct                      :agent.product.name="Version"^>>.name="Chrome"^<'
    extract:
    - 'AgentClass                          :     2500 :"Browser Webview"'
    - 'AgentName                           :     2500 :"Chrome Webview"'
    - 'AgentVersion                        :     2500 :agent.product.name="Chrome"^.version'
    - 'WebviewAppName                      :       11 :@WebViewProduct.name'
    - 'WebviewAppVersion                   :       11 :@WebViewProduct.version'

- matcher:
    variable:
    - 'WebViewProduct                      :agent.product.name="Version"^>>.name="Chrome"^<'
    extract:
    - 'AgentClass                          :     2500 :"Browser Webview"'
    - 'AgentName                           :     2500 :"Chrome Webview"'
    - 'AgentVersion                        :     2500 :agent.product.name="Chrome"^.version'
    - 'WebviewAppName                      :       12 :LookUp[KnownWebviewAppNames;@WebViewProduct.name]'
    - 'WebviewAppVersion                   :       12 :@WebViewProduct.version'


- matcher:
    variable:
    - 'WebViewApp                          :agent.(1)product.(1)comments.entry.(1)text?KnownWebviewAppNames'
    require:
    - 'agent.product.name="Version"'
    extract:
    - 'AgentClass                          :     2500 :"Browser Webview"'
    - 'AgentName                           :     2500 :"Chrome Webview"'
    - 'AgentVersion                        :     2500 :agent.product.name="Chrome"^.version'
    - 'WebviewAppName                      :       13 :LookUp[KnownWebviewAppNames;@WebViewApp]'
    - 'WebviewAppVersion                   :       13 :"<<<null>>>"'

- matcher:
    variable:
    - 'WebViewApp                          :agent.(1)product.(1)comments.entry.(1)product.(1)name?KnownWebviewAppNames'
    require:
    - 'agent.product.name="Version"'
    extract:
    - 'AgentClass                          :     2500 :"Browser Webview"'
    - 'AgentName                           :     2500 :"Chrome Webview"'
    - 'AgentVersion                        :     2500 :agent.product.name="Chrome"^.version'
    - 'WebviewAppName                      :       13 :LookUp[KnownWebviewAppNames;@WebViewApp]'
    - 'WebviewAppVersion                   :       13 :@WebViewApp^.version'

# WebView UA in Lollipop and Above
# In the newer versions of WebView, you can differentiate the WebView by looking for the wv field
# as highlighted below.

# Mozilla/5.0 (Linux; Android 5.1.1; Nexus 5 Build/LMY48B; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/43.0.2357.65 Mobile Safari/537.36

- matcher:
    require:
    - 'agent.(1)product.(1)comments.entry.(1)text="wv"'
    extract:
    - 'AgentClass                          :    10000 :"Browser Webview"'
    - 'AgentName                           :    10000 :"Chrome Webview"'
    - 'AgentVersion                        :    10000 :agent.product.name="Chrome"^.version'
    - 'WebviewAppName                      :        0 :"Unknown Webview App"'
    - 'WebviewAppVersion                   :        0 :"<<<null>>>"'

- matcher:
    variable:
    - 'Chrome                              :agent.product.name="Chrome"^'
    - 'WebViewApp                          :@Chrome>'
    - 'WebViewAppName                      :@WebViewApp.name'
    require:
    - '@WebViewAppName!="Safari"'
    - '@WebViewAppName!="Mobile Safari"'
    - 'agent.product.comments.entry="wv"'
    extract:
    - 'AgentClass                          :     2500 :"Browser Webview"'
    - 'AgentName                           :     2500 :"Chrome Webview"'
    - 'AgentVersion                        :     2500 :@Chrome.version'
    - 'WebviewAppName                      :        9 :NormalizeBrand[@WebViewAppName]'
    - 'WebviewAppVersion                   :        9 :@WebViewApp.version'

- matcher:
    variable:
    - 'Chrome                              :agent.product.name="Chrome"^'
    - 'WebViewApp                          :@Chrome>>'
    - 'WebViewAppName                      :@WebViewApp.name'
    require:
    - '@WebViewAppName!="Safari"'
    - '@WebViewAppName!="Mobile Safari"'
    - 'agent.product.comments.entry="wv"'
    extract:
    - 'AgentClass                          :     2500 :"Browser Webview"'
    - 'AgentName                           :     2500 :"Chrome Webview"'
    - 'AgentVersion                        :     2500 :@Chrome.version'
    - 'WebviewAppName                      :        9 :NormalizeBrand[@WebViewAppName]'
    - 'WebviewAppVersion                   :        9 :@WebViewApp.version'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 5.1.1; Nexus 5 Build/LMY48B; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/43.0.2357.65 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Google Nexus 5'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '5.1.1'
      OperatingSystemVersionMajor          : '5'
      OperatingSystemNameVersion           : 'Android 5.1.1'
      OperatingSystemNameVersionMajor      : 'Android 5'
      OperatingSystemVersionBuild          : 'LMY48B'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '43.0'
      LayoutEngineVersionMajor             : '43'
      LayoutEngineNameVersion              : 'Blink 43.0'
      LayoutEngineNameVersionMajor         : 'Blink 43'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '43.0.2357.65'
      AgentVersionMajor                    : '43'
      AgentNameVersion                     : 'Chrome Webview 43.0.2357.65'
      AgentNameVersionMajor                : 'Chrome Webview 43'
      WebviewAppName                       : 'Unknown Webview App'
      WebviewAppVersion                    : '??'
      WebviewAppVersionMajor               : '??'
      WebviewAppNameVersion                : 'Unknown Webview App ??'
      WebviewAppNameVersionMajor           : 'Unknown Webview App ??'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 6.0.1; Nexus 6 Build/MMB29S; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/47.0.2526.100 Mobile Safari/537.36 GSApp/1.1'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Google Nexus 6'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '6.0.1'
      OperatingSystemVersionMajor          : '6'
      OperatingSystemNameVersion           : 'Android 6.0.1'
      OperatingSystemNameVersionMajor      : 'Android 6'
      OperatingSystemVersionBuild          : 'MMB29S'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '47.0'
      LayoutEngineVersionMajor             : '47'
      LayoutEngineNameVersion              : 'Blink 47.0'
      LayoutEngineNameVersionMajor         : 'Blink 47'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '47.0.2526.100'
      AgentVersionMajor                    : '47'
      AgentNameVersion                     : 'Chrome Webview 47.0.2526.100'
      AgentNameVersionMajor                : 'Chrome Webview 47'
      WebviewAppName                       : 'Google Search App'
      WebviewAppVersion                    : '1.1'
      WebviewAppVersionMajor               : '1'
      WebviewAppNameVersion                : 'Google Search App 1.1'
      WebviewAppNameVersionMajor           : 'Google Search App 1'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 5.1; ZP951 Build/LMY47D) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/39.0.0.0 Mobile Safari/537.36 GSApp/1.1'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'ZP951'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '5.1'
      OperatingSystemVersionMajor          : '5'
      OperatingSystemNameVersion           : 'Android 5.1'
      OperatingSystemNameVersionMajor      : 'Android 5'
      OperatingSystemVersionBuild          : 'LMY47D'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '39.0'
      LayoutEngineVersionMajor             : '39'
      LayoutEngineNameVersion              : 'Blink 39.0'
      LayoutEngineNameVersionMajor         : 'Blink 39'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '39.0.0.0'
      AgentVersionMajor                    : '39'
      AgentNameVersion                     : 'Chrome Webview 39.0.0.0'
      AgentNameVersionMajor                : 'Chrome Webview 39'
      WebviewAppName                       : 'Google Search App'
      WebviewAppVersion                    : '1.1'
      WebviewAppVersionMajor               : '1'
      WebviewAppNameVersion                : 'Google Search App 1.1'
      WebviewAppNameVersionMajor           : 'Google Search App 1'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 6.0; HUAWEI MT7-L09 Build/HuaweiMT7-L09; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/58.0.3029.83 Mobile Safari/537.36 PlayStation App/4.20.5/nl-NL/nl-NL'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Huawei MT7-L09'
      DeviceBrand                          : 'Huawei'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '6.0'
      OperatingSystemVersionMajor          : '6'
      OperatingSystemNameVersion           : 'Android 6.0'
      OperatingSystemNameVersionMajor      : 'Android 6'
      OperatingSystemVersionBuild          : 'HuaweiMT7-L09'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '58.0'
      LayoutEngineVersionMajor             : '58'
      LayoutEngineNameVersion              : 'Blink 58.0'
      LayoutEngineNameVersionMajor         : 'Blink 58'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '58.0.3029.83'
      AgentVersionMajor                    : '58'
      AgentNameVersion                     : 'Chrome Webview 58.0.3029.83'
      AgentNameVersionMajor                : 'Chrome Webview 58'
      WebviewAppName                       : 'PlayStation APP'
      WebviewAppVersion                    : '4.20.5'
      WebviewAppVersionMajor               : '4'
      WebviewAppNameVersion                : 'PlayStation APP 4.20.5'
      WebviewAppNameVersionMajor           : 'PlayStation APP 4'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 10_1_1 like Mac OS X) AppleWebKit/602.2.14 (KHTML, like Gecko) Mobile/14B100 PlayStation Messages App/4.0.15'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '14B100'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '10.1.1'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'iOS 10.1.1'
      OperatingSystemNameVersionMajor      : 'iOS 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '602.2.14'
      LayoutEngineVersionMajor             : '602'
      LayoutEngineNameVersion              : 'AppleWebKit 602.2.14'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 602'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'PlayStation Messages App'
      AgentVersion                         : '4.0.15'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'PlayStation Messages App 4.0.15'
      AgentNameVersionMajor                : 'PlayStation Messages App 4'

- matcher:
    variable:
    - 'ProductAfterChrome                  :agent.product.name="Chrome"^>'
    extract:
    - 'AgentName                           :     2072 :LookUp[SpecialChromeBrowserNames;@ProductAfterChrome.name]'
    - 'AgentVersion                        :     2072 :@ProductAfterChrome.(1)version'

- matcher:
    variable:
    - 'ProductAfterChrome                  :agent.product.name="Chrome"^>>'
    extract:
    - 'AgentName                           :     2071 :LookUp[SpecialChromeBrowserNames;@ProductAfterChrome.name]'
    - 'AgentVersion                        :     2071 :@ProductAfterChrome.(1)version'

- matcher:
    variable:
    - 'ProductAfterChrome                  :agent.product.name="Chrome"^>>>'
    extract:
    - 'AgentName                           :     2070 :LookUp[SpecialChromeBrowserNames;@ProductAfterChrome.name]'
    - 'AgentVersion                        :     2070 :@ProductAfterChrome.(1)version'

- matcher:
    extract:
    - 'AgentName                           :     2069 :LookUp[SpecialChromeBrowserNames;agent.text]'
    - 'AgentVersion                        :     2069 :agent.product.name="Chrome"^.version'

- matcher:
    variable:
    - 'ProductBeforeChrome                 :agent.product.name="Chrome"^<'
    extract:
    - 'AgentName                           :     2087 :LookUp[SpecialChromeBrowserNames;@ProductBeforeChrome.name]'
    - 'AgentVersion                        :     2087 :@ProductBeforeChrome.(1)version'


- matcher:
    variable:
    - 'ProductBeforeChrome                 :agent.product.name="Chrome"^<<'
    extract:
    - 'AgentName                           :     2086 :LookUp[SpecialChromeBrowserNames;@ProductBeforeChrome.name]'
    - 'AgentVersion                        :     2086 :@ProductBeforeChrome.(1)version'

# Sometimes the name of the agent is BETWEEN the "Chrome" and "(Mobile) Safari" products.
- matcher:
    require:
    - 'agent.product.name="Safari"' # Performance trick
    variable:
    - 'Product                             :agent.product.name="Chrome"^>>.name="Safari"^<'
    extract:
    - 'AgentClass                          :     2080 :"Browser"'
    - 'AgentName                           :     2080 :@Product.name'
    - 'AgentVersion                        :     2080 :@Product.version'

- matcher:
    require:
    - 'agent.product.name="Mobile Safari"' # Performance trick
    variable:
    - 'Product                             :agent.product.name="Chrome"^>>.name="Mobile Safari"^<'
    extract:
    - 'AgentClass                          :     2080 :"Browser"'
    - 'AgentName                           :     2080 :@Product.name'
    - 'AgentVersion                        :     2080 :@Product.version'

# Sometimes the name of the agent AND the name of something else are BETWEEN the "Chrome" and "(Mobile) Safari" products.
- matcher:
    require:
    - 'agent.product.name="Safari"' # Performance trick
    variable:
    - 'Product                             :agent.product.name="Chrome"^>>>.name="Safari"^<<'
    extract:
    - 'AgentClass                          :     2080 :"Browser"'
    - 'AgentName                           :     2080 :@Product.name'
    - 'AgentVersion                        :     2080 :@Product.version'

- matcher:
    require:
    - 'agent.product.name="Mobile Safari"' # Performance trick
    variable:
    - 'Product                             :agent.product.name="Chrome"^>>>.name="Mobile Safari"^<<'
    extract:
    - 'AgentClass                          :     2080 :"Browser"'
    - 'AgentName                           :     2080 :@Product.name'
    - 'AgentVersion                        :     2080 :@Product.version'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.99 Safari/537.36 Vivaldi/1.0.321.3'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '45.0'
      LayoutEngineVersionMajor             : '45'
      LayoutEngineNameVersion              : 'Blink 45.0'
      LayoutEngineNameVersionMajor         : 'Blink 45'
      AgentClass                           : 'Browser'
      AgentName                            : 'Vivaldi'
      AgentVersion                         : '1.0.321.3'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Vivaldi 1.0.321.3'
      AgentNameVersionMajor                : 'Vivaldi 1'

# Opera Neon
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.21 Safari/537.36 MMS/1.0.2459.0'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '53.0'
      LayoutEngineVersionMajor             : '53'
      LayoutEngineNameVersion              : 'Blink 53.0'
      LayoutEngineNameVersionMajor         : 'Blink 53'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera Neon'
      AgentVersion                         : '1.0.2459.0'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Opera Neon 1.0.2459.0'
      AgentNameVersionMajor                : 'Opera Neon 1'

# Confusing case. I am unsure what the right value for the CPU and the bits of the CPU are. So any of the two options is valid.
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux i686 (x86_64)) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.95 Safari/537.36'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Linux ??'
      OperatingSystemNameVersionMajor      : 'Linux ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '39.0'
      LayoutEngineVersionMajor             : '39'
      LayoutEngineNameVersion              : 'Blink 39.0'
      LayoutEngineNameVersionMajor         : 'Blink 39'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '39.0.2171.95'
      AgentVersionMajor                    : '39'
      AgentNameVersion                     : 'Chrome 39.0.2171.95'
      AgentNameVersionMajor                : 'Chrome 39'

- test:
    input:
      # Pulse browser from https://amigo.mail.ru/
      user_agent_string: 'Mozilla/5.0 (Linux; Android 7.0; Nexus 6 Build/NBD92G) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.105 Mobile Safari/537.36 MRPULSE v1.3.5'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Google Nexus 6'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.0'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Android 7.0'
      OperatingSystemNameVersionMajor      : 'Android 7'
      OperatingSystemVersionBuild          : 'NBD92G'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '55.0'
      LayoutEngineVersionMajor             : '55'
      LayoutEngineNameVersion              : 'Blink 55.0'
      LayoutEngineNameVersionMajor         : 'Blink 55'
      AgentClass                           : 'Browser'
      AgentName                            : 'Pulse'
      AgentVersion                         : 'v1.3.5'
      AgentVersionMajor                    : 'v1'
      AgentNameVersion                     : 'Pulse v1.3.5'
      AgentNameVersionMajor                : 'Pulse v1'

- test:
    input:
      # Several sources on the internet indicate this is a robot
      #   https://github.com/fnando/browser/issues/205
      #   http://www.spambotsecurity.com/forum/viewtopic.php?f=7&t=1424
      # It is also possible MrChrome is just the internal name name of the Amigo browser
      # (The android variant is called Pulse which shows MRPULSE)
      # See https://amigo.mail.ru/
      user_agent_string: 'Mozilla/5.0 (Windows NT 6.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/32.0.1709.117 Amigo/32.0.1709.117 MRCHROME SOC Safari/537.36'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : 'Vista'
      OperatingSystemVersionMajor          : 'Vista'
      OperatingSystemNameVersion           : 'Windows Vista'
      OperatingSystemNameVersionMajor      : 'Windows Vista'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '32.0'
      LayoutEngineVersionMajor             : '32'
      LayoutEngineNameVersion              : 'Blink 32.0'
      LayoutEngineNameVersionMajor         : 'Blink 32'
      AgentClass                           : 'Browser'
      AgentName                            : 'Amigo'
      AgentVersion                         : '32.0.1709.117'
      AgentVersionMajor                    : '32'
      AgentNameVersion                     : 'Amigo 32.0.1709.117'
      AgentNameVersionMajor                : 'Amigo 32'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.11 (KHTML, like Gecko) Chrome/17.0.963.46 Safari/535.11 MRCHROME'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '535.11'
      LayoutEngineVersionMajor             : '535'
      LayoutEngineNameVersion              : 'AppleWebKit 535.11'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 535'
      AgentClass                           : 'Browser'
      AgentName                            : 'Amigo'
      AgentVersion                         : '17.0.963.46'
      AgentVersionMajor                    : '17'
      AgentNameVersion                     : 'Amigo 17.0.963.46'
      AgentNameVersionMajor                : 'Amigo 17'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 7.1.1) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Focus/1.3 Chrome/60.0.3112.116 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Android Mobile'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.1.1'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Android 7.1.1'
      OperatingSystemNameVersionMajor      : 'Android 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '60.0'
      LayoutEngineVersionMajor             : '60'
      LayoutEngineNameVersion              : 'Blink 60.0'
      LayoutEngineNameVersionMajor         : 'Blink 60'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '60.0.3112.116'
      AgentVersionMajor                    : '60'
      AgentNameVersion                     : 'Chrome Webview 60.0.3112.116'
      AgentNameVersionMajor                : 'Chrome Webview 60'
      WebviewAppName                       : 'Firefox Focus'
      WebviewAppVersion                    : '1.3'
      WebviewAppVersionMajor               : '1'
      WebviewAppNameVersion                : 'Firefox Focus 1.3'
      WebviewAppNameVersionMajor           : 'Firefox Focus 1'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 7.1.1) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 SomeThing Unexpected/3.14 Chrome/60.0.3112.116 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Android Mobile'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.1.1'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Android 7.1.1'
      OperatingSystemNameVersionMajor      : 'Android 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '60.0'
      LayoutEngineVersionMajor             : '60'
      LayoutEngineNameVersion              : 'Blink 60.0'
      LayoutEngineNameVersionMajor         : 'Blink 60'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '60.0.3112.116'
      AgentVersionMajor                    : '60'
      AgentNameVersion                     : 'Chrome Webview 60.0.3112.116'
      AgentNameVersionMajor                : 'Chrome Webview 60'
      WebviewAppName                       : 'SomeThing Unexpected'
      WebviewAppVersion                    : '3.14'
      WebviewAppVersionMajor               : '3'
      WebviewAppNameVersion                : 'SomeThing Unexpected 3.14'
      WebviewAppNameVersionMajor           : 'SomeThing Unexpected 3'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 7.1.1) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/60.0.3112.116 Mobile Safari/537.36 SomeThing Unexpected/3.14'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Android Mobile'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.1.1'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Android 7.1.1'
      OperatingSystemNameVersionMajor      : 'Android 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '60.0'
      LayoutEngineVersionMajor             : '60'
      LayoutEngineNameVersion              : 'Blink 60.0'
      LayoutEngineNameVersionMajor         : 'Blink 60'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '60.0.3112.116'
      AgentVersionMajor                    : '60'
      AgentNameVersion                     : 'Chrome Webview 60.0.3112.116'
      AgentNameVersionMajor                : 'Chrome Webview 60'
      WebviewAppName                       : 'SomeThing Unexpected'
      WebviewAppVersion                    : '3.14'
      WebviewAppVersionMajor               : '3'
      WebviewAppNameVersion                : 'SomeThing Unexpected 3.14'
      WebviewAppNameVersionMajor           : 'SomeThing Unexpected 3'

# Chromium
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Ubuntu Chromium/45.0.2454.101 Chrome/45.0.2454.101 Safari/537.36 FirePHP/4Chrome'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Ubuntu ??'
      OperatingSystemNameVersionMajor      : 'Ubuntu ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '45.0'
      LayoutEngineVersionMajor             : '45'
      LayoutEngineNameVersion              : 'Blink 45.0'
      LayoutEngineNameVersionMajor         : 'Blink 45'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chromium'
      AgentVersion                         : '45.0.2454.101'
      AgentVersionMajor                    : '45'
      AgentNameVersion                     : 'Chromium 45.0.2454.101'
      AgentNameVersionMajor                : 'Chromium 45'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Ubuntu Chromium/45.0.2454.101 Chrome/45.0.2454.101 Safari/537.36,gzip(gfe)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Ubuntu ??'
      OperatingSystemNameVersionMajor      : 'Ubuntu ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '45.0'
      LayoutEngineVersionMajor             : '45'
      LayoutEngineNameVersion              : 'Blink 45.0'
      LayoutEngineNameVersionMajor         : 'Blink 45'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chromium'
      AgentVersion                         : '45.0.2454.101'
      AgentVersionMajor                    : '45'
      AgentNameVersion                     : 'Chromium 45.0.2454.101'
      AgentNameVersionMajor                : 'Chromium 45'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/535.22+ (KHTML, like Gecko) Chromium/17.0.963.56 Chrome/17.0.963.56 Safari/535.22+ Debian/7.0 (3.4.2-2.1) Epiphany/3.4.2'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Debian'
      OperatingSystemVersion               : '7.0'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Debian 7.0'
      OperatingSystemNameVersionMajor      : 'Debian 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '535.22'
      LayoutEngineVersionMajor             : '535'
      LayoutEngineNameVersion              : 'AppleWebKit 535.22'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 535'
      AgentClass                           : 'Browser'
      AgentName                            : 'Epiphany'
      AgentVersion                         : '3.4.2'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Epiphany 3.4.2'
      AgentNameVersionMajor                : 'Epiphany 3'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (SMART-TV; X11; Linux armv7l) AppleWebKit/537.42 (KHTML, like Gecko) Chromium/25.0.1349.2 Chrome/25.0.1349.2 Safari/537.42'
    expected:
      DeviceClass                          : 'TV'
      DeviceName                           : 'Samsung Smart TV'
      DeviceBrand                          : 'Samsung'
      DeviceCpu                            : 'ARMv7l'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Embedded'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : 'SmartTV'
      OperatingSystemVersionMajor          : 'SmartTV'
      OperatingSystemNameVersion           : 'Linux SmartTV'
      OperatingSystemNameVersionMajor      : 'Linux SmartTV'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.42'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.42'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chromium'
      AgentVersion                         : '25.0.1349.2'
      AgentVersionMajor                    : '25'
      AgentNameVersion                     : 'Chromium 25.0.1349.2'
      AgentNameVersionMajor                : 'Chromium 25'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (SMART-TV; X11; Linux armv7l) AppleWebkit/537.42 (KHTML, like Gecko) Chromium/25.0.1349.2 Chrome/25.0.1349.2 Safari/537.42,gzip(gfe)'
    expected:
      DeviceClass                          : 'TV'
      DeviceName                           : 'Samsung Smart TV'
      DeviceBrand                          : 'Samsung'
      DeviceCpu                            : 'ARMv7l'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Embedded'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : 'SmartTV'
      OperatingSystemVersionMajor          : 'SmartTV'
      OperatingSystemNameVersion           : 'Linux SmartTV'
      OperatingSystemNameVersionMajor      : 'Linux SmartTV'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.42'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.42'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chromium'
      AgentVersion                         : '25.0.1349.2'
      AgentVersionMajor                    : '25'
      AgentNameVersion                     : 'Chromium 25.0.1349.2'
      AgentNameVersionMajor                : 'Chromium 25'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux armv7l) AppleWebKit/537.6+ (KHTML, like Gecko) Chromium/23.0.1271.95 Chrome/23.0.1271.95 Safari/537.6+ Epiphany/3.6.1'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'ARMv7l'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Linux ??'
      OperatingSystemNameVersionMajor      : 'Linux ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.6'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.6'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'Epiphany'
      AgentVersion                         : '3.6.1'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Epiphany 3.6.1'
      AgentNameVersionMajor                : 'Epiphany 3'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Ubuntu Chromium/62.0.3202.89 Chrome/62.0.3202.89 Safari/537.36'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Ubuntu ??'
      OperatingSystemNameVersionMajor      : 'Ubuntu ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '62.0'
      LayoutEngineVersionMajor             : '62'
      LayoutEngineNameVersion              : 'Blink 62.0'
      LayoutEngineNameVersionMajor         : 'Blink 62'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chromium'
      AgentVersion                         : '62.0.3202.89'
      AgentVersionMajor                    : '62'
      AgentNameVersion                     : 'Chromium 62.0.3202.89'
      AgentNameVersionMajor                : 'Chromium 62'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Ubuntu Chromium/63.0.3239.84 Chrome/63.0.3239.84 Safari/537.36'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Ubuntu ??'
      OperatingSystemNameVersionMajor      : 'Ubuntu ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '63.0'
      LayoutEngineVersionMajor             : '63'
      LayoutEngineNameVersion              : 'Blink 63.0'
      LayoutEngineNameVersionMajor         : 'Blink 63'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chromium'
      AgentVersion                         : '63.0.3239.84'
      AgentVersionMajor                    : '63'
      AgentNameVersion                     : 'Chromium 63.0.3239.84'
      AgentNameVersionMajor                : 'Chromium 63'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.2; Trident/6.0; ARM; Touch; WPDesktop) UCBrowser/4.2.1.541'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Windows Phone'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'ARM'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Windows Phone'
      OperatingSystemVersion               : '8'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Windows Phone 8'
      OperatingSystemNameVersionMajor      : 'Windows Phone 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Trident'
      LayoutEngineVersion                  : '6.0'
      LayoutEngineVersionMajor             : '6'
      LayoutEngineNameVersion              : 'Trident 6.0'
      LayoutEngineNameVersionMajor         : 'Trident 6'
      AgentClass                           : 'Browser'
      AgentName                            : 'UCBrowser'
      AgentVersion                         : '4.2.1.541'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'UCBrowser 4.2.1.541'
      AgentNameVersionMajor                : 'UCBrowser 4'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows; U; Windows NT 5.2; en-US) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/57.0.2987.108 Safari/537.36 UCBrowser/12.5.5.1111'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : 'XP x64 Edition'
      OperatingSystemVersionMajor          : 'XP x64 Edition'
      OperatingSystemNameVersion           : 'Windows XP x64 Edition'
      OperatingSystemNameVersionMajor      : 'Windows XP x64 Edition'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '57.0'
      LayoutEngineVersionMajor             : '57'
      LayoutEngineNameVersion              : 'Blink 57.0'
      LayoutEngineNameVersionMajor         : 'Blink 57'
      AgentClass                           : 'Browser'
      AgentName                            : 'UCBrowser'
      AgentVersion                         : '12.5.5.1111'
      AgentVersionMajor                    : '12'
      AgentNameVersion                     : 'UCBrowser 12.5.5.1111'
      AgentNameVersionMajor                : 'UCBrowser 12'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/31.0.1650.63 Safari/537.36 UCBrowser/11.4.5.1005'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '31.0'
      LayoutEngineVersionMajor             : '31'
      LayoutEngineNameVersion              : 'Blink 31.0'
      LayoutEngineNameVersionMajor         : 'Blink 31'
      AgentClass                           : 'Browser'
      AgentName                            : 'UCBrowser'
      AgentVersion                         : '11.4.5.1005'
      AgentVersionMajor                    : '11'
      AgentNameVersion                     : 'UCBrowser 11.4.5.1005'
      AgentNameVersionMajor                : 'UCBrowser 11'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows; U; Windows NT 5.2; en-US) AppleWebKit/534.31 (KHTML, like Gecko) Chrome/17.0.558.0 Safari/534.31 UCBrowser/11.0.4.846'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : 'XP x64 Edition'
      OperatingSystemVersionMajor          : 'XP x64 Edition'
      OperatingSystemNameVersion           : 'Windows XP x64 Edition'
      OperatingSystemNameVersionMajor      : 'Windows XP x64 Edition'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '534.31'
      LayoutEngineVersionMajor             : '534'
      LayoutEngineNameVersion              : 'AppleWebKit 534.31'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 534'
      AgentClass                           : 'Browser'
      AgentName                            : 'UCBrowser'
      AgentVersion                         : '11.0.4.846'
      AgentVersionMajor                    : '11'
      AgentNameVersion                     : 'UCBrowser 11.0.4.846'
      AgentNameVersionMajor                : 'UCBrowser 11'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'



- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows; U; Windows NT 5.2; zh-CN) AppleWebKit/537.51.1 (KHTML, like Gecko) Chrome/40.0.2214.89 Safari/537.36 UCBrowser/11.9.2.1062 AliApp(TUnionSDK/0.1.20.2)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : 'XP x64 Edition'
      OperatingSystemVersionMajor          : 'XP x64 Edition'
      OperatingSystemNameVersion           : 'Windows XP x64 Edition'
      OperatingSystemNameVersionMajor      : 'Windows XP x64 Edition'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '40.0'
      LayoutEngineVersionMajor             : '40'
      LayoutEngineNameVersion              : 'Blink 40.0'
      LayoutEngineNameVersionMajor         : 'Blink 40'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'UCBrowser'
      AgentVersion                         : '11.9.2.1062'
      AgentVersionMajor                    : '11'
      AgentNameVersion                     : 'UCBrowser 11.9.2.1062'
      AgentNameVersionMajor                : 'UCBrowser 11'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      AgentSecurity                        : 'Strong security'
      WebviewAppName                       : 'Alibaba AliApp'
      WebviewAppVersion                    : '0.1.20.2'
      WebviewAppVersionMajor               : '0'
      WebviewAppNameVersion                : 'Alibaba AliApp 0.1.20.2'
      WebviewAppNameVersionMajor           : 'Alibaba AliApp 0'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 9_2 like Mac OS X; zh-CN) AppleWebKit/537.51.1 (KHTML, like Gecko) Mobile/13C75 UCBrowser/11.2.0.863 Mobile AliApp(TUnionSDK/0.1.6)'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '13C75'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '9.2'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'iOS 9.2'
      OperatingSystemNameVersionMajor      : 'iOS 9'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'UCBrowser'
      LayoutEngineVersion                  : '11.2.0.863'
      LayoutEngineVersionMajor             : '11'
      LayoutEngineNameVersion              : 'UCBrowser 11.2.0.863'
      LayoutEngineNameVersionMajor         : 'UCBrowser 11'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'UCBrowser'
      AgentVersion                         : '11.2.0.863'
      AgentVersionMajor                    : '11'
      AgentNameVersion                     : 'UCBrowser 11.2.0.863'
      AgentNameVersionMajor                : 'UCBrowser 11'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      WebviewAppName                       : 'Alibaba AliApp'
      WebviewAppVersion                    : '0.1.6'
      WebviewAppVersionMajor               : '0'
      WebviewAppNameVersion                : 'Alibaba AliApp 0.1.6'
      WebviewAppNameVersionMajor           : 'Alibaba AliApp 0'

# This is actually a GAME running on a Desktop PC
# See https://en.wikipedia.org/wiki/Tabletop_Simulator
# ZFBrowser
# https://zenfulcrum.com/docs/browser/Readme.html
# Quote: This asset allows you to embed a full copy of Chromium, the open-source core of Google Chrome, inside your game!
# So this is just Chrome running inside a game.
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 6.1; Unity 3D; ZFBrowser 1.1.0; Tabletop Simulator 1.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/48.0.2556.0 Safari/537.36'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '48.0'
      LayoutEngineVersionMajor             : '48'
      LayoutEngineNameVersion              : 'Blink 48.0'
      LayoutEngineNameVersionMajor         : 'Blink 48'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '48.0.2556.0'
      AgentVersionMajor                    : '48'
      AgentNameVersion                     : 'Chrome 48.0.2556.0'
      AgentNameVersionMajor                : 'Chrome 48'


# Current guess: https://browser.yandex.com/
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.125 YaBrowser/17.7.1.791 Yowser/2.5 Safari/537.36'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '59.0'
      LayoutEngineVersionMajor             : '59'
      LayoutEngineNameVersion              : 'Blink 59.0'
      LayoutEngineNameVersionMajor         : 'Blink 59'
      AgentClass                           : 'Browser'
      AgentName                            : 'YaBrowser'
      AgentVersion                         : '17.7.1.791'
      AgentVersionMajor                    : '17'
      AgentNameVersion                     : 'YaBrowser 17.7.1.791'
      AgentNameVersionMajor                : 'YaBrowser 17'


# 2345Explorer seems to be a bad advertising plugin
# https://greatis.com/blog/win32-pup-gen/fix-2345explorer-virus.htm .
# https://malwaretips.com/blogs/2345-com-removal/ --> "The 2345.com browser hijacker"
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/47.0.2526.108 Safari/537.36 2345Explorer/7.1.0.12633'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : 'XP'
      OperatingSystemVersionMajor          : 'XP'
      OperatingSystemNameVersion           : 'Windows XP'
      OperatingSystemNameVersionMajor      : 'Windows XP'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '47.0'
      LayoutEngineVersionMajor             : '47'
      LayoutEngineNameVersion              : 'Blink 47.0'
      LayoutEngineNameVersionMajor         : 'Blink 47'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '47.0.2526.108'
      AgentVersionMajor                    : '47'
      AgentNameVersion                     : 'Chrome 47.0.2526.108'
      AgentNameVersionMajor                : 'Chrome 47'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 7.1.1; Nexus 6 Build/N6F27M) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.181 YaBrowser/18.6.0.683.00 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Google Nexus 6'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.1.1'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Android 7.1.1'
      OperatingSystemNameVersionMajor      : 'Android 7'
      OperatingSystemVersionBuild          : 'N6F27M'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '66.0'
      LayoutEngineVersionMajor             : '66'
      LayoutEngineNameVersion              : 'Blink 66.0'
      LayoutEngineNameVersionMajor         : 'Blink 66'
      AgentClass                           : 'Browser'
      AgentName                            : 'YaBrowser'
      AgentVersion                         : '18.6.0.683.00'
      AgentVersionMajor                    : '18'
      AgentNameVersion                     : 'YaBrowser 18.6.0.683.00'
      AgentNameVersionMajor                : 'YaBrowser 18'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.86 YaBrowser/19.4.0.2397 Yowser/2.5 Safari/537.36'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '73.0'
      LayoutEngineVersionMajor             : '73'
      LayoutEngineNameVersion              : 'Blink 73.0'
      LayoutEngineNameVersionMajor         : 'Blink 73'
      AgentClass                           : 'Browser'
      AgentName                            : 'YaBrowser'
      AgentVersion                         : '19.4.0.2397'
      AgentVersionMajor                    : '19'
      AgentNameVersion                     : 'YaBrowser 19.4.0.2397'
      AgentNameVersionMajor                : 'YaBrowser 19'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.1 (KHTML, like Gecko)  Iron/13.0.800.0 Chrome/13.0.800.0 Safari/535.1'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '535.1'
      LayoutEngineVersionMajor             : '535'
      LayoutEngineNameVersion              : 'AppleWebKit 535.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 535'
      AgentClass                           : 'Browser'
      AgentName                            : 'Iron'
      AgentVersion                         : '13.0.800.0'
      AgentVersionMajor                    : '13'
      AgentNameVersion                     : 'Iron 13.0.800.0'
      AgentNameVersionMajor                : 'Iron 13'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/536.11 (KHTML, like Gecko) Chrome/20.0.1150.1  Iron/20.0.1150.1 Safari/536.11'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Linux ??'
      OperatingSystemNameVersionMajor      : 'Linux ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '536.11'
      LayoutEngineVersionMajor             : '536'
      LayoutEngineNameVersion              : 'AppleWebKit 536.11'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 536'
      AgentClass                           : 'Browser'
      AgentName                            : 'Iron'
      AgentVersion                         : '20.0.1150.1'
      AgentVersionMajor                    : '20'
      AgentNameVersion                     : 'Iron 20.0.1150.1'
      AgentNameVersionMajor                : 'Iron 20'

# Quark browser
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 6.0.1; zh-CN; Nexus 6P Build/MTC20L) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/57.0.2987.108 Quark/2.4.5.934 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Google Nexus 6P'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '6.0.1'
      OperatingSystemVersionMajor          : '6'
      OperatingSystemNameVersion           : 'Android 6.0.1'
      OperatingSystemNameVersionMajor      : 'Android 6'
      OperatingSystemVersionBuild          : 'MTC20L'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '57.0'
      LayoutEngineVersionMajor             : '57'
      LayoutEngineNameVersion              : 'Blink 57.0'
      LayoutEngineNameVersionMajor         : 'Blink 57'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '57.0.2987.108'
      AgentVersionMajor                    : '57'
      AgentNameVersion                     : 'Chrome Webview 57.0.2987.108'
      AgentNameVersionMajor                : 'Chrome Webview 57'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      AgentSecurity                        : 'Strong security'
      WebviewAppName                       : 'Quark'
      WebviewAppVersion                    : '2.4.5.934'
      WebviewAppVersionMajor               : '2'
      WebviewAppNameVersion                : 'Quark 2.4.5.934'
      WebviewAppNameVersionMajor           : 'Quark 2'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 6.0; zh-CN; HUAWEI NXT-TL00 Build/HUAWEINXT-TL00) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/57.0.2987.108 Quark/2.4.1.985 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Huawei NXT-TL00'
      DeviceBrand                          : 'Huawei'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '6.0'
      OperatingSystemVersionMajor          : '6'
      OperatingSystemNameVersion           : 'Android 6.0'
      OperatingSystemNameVersionMajor      : 'Android 6'
      OperatingSystemVersionBuild          : 'HUAWEINXT-TL00'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '57.0'
      LayoutEngineVersionMajor             : '57'
      LayoutEngineNameVersion              : 'Blink 57.0'
      LayoutEngineNameVersionMajor         : 'Blink 57'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '57.0.2987.108'
      AgentVersionMajor                    : '57'
      AgentNameVersion                     : 'Chrome Webview 57.0.2987.108'
      AgentNameVersionMajor                : 'Chrome Webview 57'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      AgentSecurity                        : 'Strong security'
      WebviewAppName                       : 'Quark'
      WebviewAppVersion                    : '2.4.1.985'
      WebviewAppVersionMajor               : '2'
      WebviewAppNameVersion                : 'Quark 2.4.1.985'
      WebviewAppNameVersionMajor           : 'Quark 2'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 7.0; zh-CN; SM-G9300 Build/NRD90M) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/57.0.2987.108 Quark/2.4.1.985 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung SM-G9300'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.0'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Android 7.0'
      OperatingSystemNameVersionMajor      : 'Android 7'
      OperatingSystemVersionBuild          : 'NRD90M'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '57.0'
      LayoutEngineVersionMajor             : '57'
      LayoutEngineNameVersion              : 'Blink 57.0'
      LayoutEngineNameVersionMajor         : 'Blink 57'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '57.0.2987.108'
      AgentVersionMajor                    : '57'
      AgentNameVersion                     : 'Chrome Webview 57.0.2987.108'
      AgentNameVersionMajor                : 'Chrome Webview 57'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      AgentSecurity                        : 'Strong security'
      WebviewAppName                       : 'Quark'
      WebviewAppVersion                    : '2.4.1.985'
      WebviewAppVersionMajor               : '2'
      WebviewAppNameVersion                : 'Quark 2.4.1.985'
      WebviewAppNameVersionMajor           : 'Quark 2'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 7.0; zh-Hans-CN; BAC-TL00 Build/HUAWEIBAC-TL00) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/57.0.2987.108 Quark/2.4.1.985 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Huawei BAC-TL00'
      DeviceBrand                          : 'Huawei'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.0'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Android 7.0'
      OperatingSystemNameVersionMajor      : 'Android 7'
      OperatingSystemVersionBuild          : 'HUAWEIBAC-TL00'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '57.0'
      LayoutEngineVersionMajor             : '57'
      LayoutEngineNameVersion              : 'Blink 57.0'
      LayoutEngineNameVersionMajor         : 'Blink 57'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '57.0.2987.108'
      AgentVersionMajor                    : '57'
      AgentNameVersion                     : 'Chrome Webview 57.0.2987.108'
      AgentNameVersionMajor                : 'Chrome Webview 57'
      AgentLanguage                        : 'Chinese (Simplified Han, China)'
      AgentLanguageCode                    : 'zh-hans-cn'
      AgentSecurity                        : 'Strong security'
      WebviewAppName                       : 'Quark'
      WebviewAppVersion                    : '2.4.1.985'
      WebviewAppVersionMajor               : '2'
      WebviewAppNameVersion                : 'Quark 2.4.1.985'
      WebviewAppNameVersionMajor           : 'Quark 2'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 7.0; zh-Hans-CN; MHA-AL00 Build/HUAWEIMHA-AL00) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/57.0.2987.108 Quark/2.4.1.985 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Huawei MHA-AL00'
      DeviceBrand                          : 'Huawei'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.0'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Android 7.0'
      OperatingSystemNameVersionMajor      : 'Android 7'
      OperatingSystemVersionBuild          : 'HUAWEIMHA-AL00'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '57.0'
      LayoutEngineVersionMajor             : '57'
      LayoutEngineNameVersion              : 'Blink 57.0'
      LayoutEngineNameVersionMajor         : 'Blink 57'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '57.0.2987.108'
      AgentVersionMajor                    : '57'
      AgentNameVersion                     : 'Chrome Webview 57.0.2987.108'
      AgentNameVersionMajor                : 'Chrome Webview 57'
      AgentLanguage                        : 'Chinese (Simplified Han, China)'
      AgentLanguageCode                    : 'zh-hans-cn'
      AgentSecurity                        : 'Strong security'
      WebviewAppName                       : 'Quark'
      WebviewAppVersion                    : '2.4.1.985'
      WebviewAppVersionMajor               : '2'
      WebviewAppNameVersion                : 'Quark 2.4.1.985'
      WebviewAppNameVersionMajor           : 'Quark 2'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 7.0; zh-TW; MI 5s Build/NRD90M) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/57.0.2987.108 Quark/2.4.1.985 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Xiaomi MI 5S'
      DeviceBrand                          : 'Xiaomi'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.0'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Android 7.0'
      OperatingSystemNameVersionMajor      : 'Android 7'
      OperatingSystemVersionBuild          : 'NRD90M'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '57.0'
      LayoutEngineVersionMajor             : '57'
      LayoutEngineNameVersion              : 'Blink 57.0'
      LayoutEngineNameVersionMajor         : 'Blink 57'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '57.0.2987.108'
      AgentVersionMajor                    : '57'
      AgentNameVersion                     : 'Chrome Webview 57.0.2987.108'
      AgentNameVersionMajor                : 'Chrome Webview 57'
      AgentLanguage                        : 'Chinese (Taiwan)'
      AgentLanguageCode                    : 'zh-tw'
      AgentSecurity                        : 'Strong security'
      WebviewAppName                       : 'Quark'
      WebviewAppVersion                    : '2.4.1.985'
      WebviewAppVersionMajor               : '2'
      WebviewAppNameVersion                : 'Quark 2.4.1.985'
      WebviewAppNameVersionMajor           : 'Quark 2'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 8.0.0; zh-CN; ONEPLUS A3000 Build/OPR1.170623.032) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/57.0.2987.108 Quark/2.4.1.985 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Oneplus A3000'
      DeviceBrand                          : 'Oneplus'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '8.0.0'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Android 8.0.0'
      OperatingSystemNameVersionMajor      : 'Android 8'
      OperatingSystemVersionBuild          : 'OPR1.170623.032'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '57.0'
      LayoutEngineVersionMajor             : '57'
      LayoutEngineNameVersion              : 'Blink 57.0'
      LayoutEngineNameVersionMajor         : 'Blink 57'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '57.0.2987.108'
      AgentVersionMajor                    : '57'
      AgentNameVersion                     : 'Chrome Webview 57.0.2987.108'
      AgentNameVersionMajor                : 'Chrome Webview 57'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      AgentSecurity                        : 'Strong security'
      WebviewAppName                       : 'Quark'
      WebviewAppVersion                    : '2.4.1.985'
      WebviewAppVersionMajor               : '2'
      WebviewAppNameVersion                : 'Quark 2.4.1.985'
      WebviewAppNameVersionMajor           : 'Quark 2'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 8.0.0; zh-Hans-CN; BKL-AL00 Build/HUAWEIBKL-AL00) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/57.0.2987.108 Quark/2.4.1.985 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Huawei BKL-AL00'
      DeviceBrand                          : 'Huawei'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '8.0.0'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Android 8.0.0'
      OperatingSystemNameVersionMajor      : 'Android 8'
      OperatingSystemVersionBuild          : 'HUAWEIBKL-AL00'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '57.0'
      LayoutEngineVersionMajor             : '57'
      LayoutEngineNameVersion              : 'Blink 57.0'
      LayoutEngineNameVersionMajor         : 'Blink 57'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '57.0.2987.108'
      AgentVersionMajor                    : '57'
      AgentNameVersion                     : 'Chrome Webview 57.0.2987.108'
      AgentNameVersionMajor                : 'Chrome Webview 57'
      AgentLanguage                        : 'Chinese (Simplified Han, China)'
      AgentLanguageCode                    : 'zh-hans-cn'
      AgentSecurity                        : 'Strong security'
      WebviewAppName                       : 'Quark'
      WebviewAppVersion                    : '2.4.1.985'
      WebviewAppVersionMajor               : '2'
      WebviewAppNameVersion                : 'Quark 2.4.1.985'
      WebviewAppNameVersionMajor           : 'Quark 2'

# Brave and Iron put their name right in front of either "Chrome" or "Safari"
# In both cases the version with the 'Chrome' is the version of the browser.
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 5.0.2; SM-G360F Build/LRX22G) AppleWebKit/537.36 (KHTML, like Gecko) Brave Chrome/65.0.3325.109 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung SM-G360F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '5.0.2'
      OperatingSystemVersionMajor          : '5'
      OperatingSystemNameVersion           : 'Android 5.0.2'
      OperatingSystemNameVersionMajor      : 'Android 5'
      OperatingSystemVersionBuild          : 'LRX22G'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.36'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.36'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'Brave'
      AgentVersion                         : '65.0.3325.109'
      AgentVersionMajor                    : '65'
      AgentNameVersion                     : 'Brave 65.0.3325.109'
      AgentNameVersionMajor                : 'Brave 65'

# Faked testcase
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 5.0.2; SM-G360F Build/LRX22G) AppleWebKit/537.36 (KHTML, like Gecko) Brave Chrome/65.0.3325.109 Safari/537.36'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Samsung SM-G360F'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '5.0.2'
      OperatingSystemVersionMajor          : '5'
      OperatingSystemNameVersion           : 'Android 5.0.2'
      OperatingSystemNameVersionMajor      : 'Android 5'
      OperatingSystemVersionBuild          : 'LRX22G'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.36'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.36'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'Brave'
      AgentVersion                         : '65.0.3325.109'
      AgentVersionMajor                    : '65'
      AgentNameVersion                     : 'Brave 65.0.3325.109'
      AgentNameVersionMajor                : 'Brave 65'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) brave/0.8.3 Chrome/49.0.2623.108 Brave/0.37.3 Safari/537.36'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '49.0'
      LayoutEngineVersionMajor             : '49'
      LayoutEngineNameVersion              : 'Blink 49.0'
      LayoutEngineNameVersionMajor         : 'Blink 49'
      AgentClass                           : 'Browser'
      AgentName                            : 'Brave'
      AgentVersion                         : '0.37.3'
      AgentVersionMajor                    : '0'
      AgentNameVersion                     : 'Brave 0.37.3' # NOTE: Brave is mentioned TWICE! I do not know which is correct.
      AgentNameVersionMajor                : 'Brave 0'

- matcher:
    variable:
    - 'ChromeName                          :agent.product.name[1]="Chrome"'
    - 'SafariName                          :agent.product.name="Iron Safari"'
    - 'ProductName                         :@SafariName@[1]'
    require:
    - 'IsNull[agent.product.name="Mobile Safari"]'
    extract:
    - 'AgentName                           :     2100 :@ProductName'
    - 'AgentVersion                        :     2100 :@ChromeName^.version'

- matcher:
    variable:
    - 'ChromeName                          :agent.product.name[1]="Chrome"'
    - 'SafariName                          :agent.product.name[3]="Safari"'
    - 'ProductName                         :@SafariName@[2]'
    require:
    - 'agent.product.name[1]="Mobile"' # Speedup trick
    - '@SafariName@[1]="Mobile"'
    - 'IsNull[agent.product.name="Mobile Safari"]'
    - 'IsNull[agent.product.name="Mobile VR Safari"]'
    extract:
    - 'AgentName                           :     2100 :@ProductName'
    - 'AgentVersion                        :     2100 :@ChromeName^.version'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3450.0 Iron Safari/537.36'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Linux ??'
      OperatingSystemNameVersionMajor      : 'Linux ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '66.0'
      LayoutEngineVersionMajor             : '66'
      LayoutEngineNameVersion              : 'Blink 66.0'
      LayoutEngineNameVersionMajor         : 'Blink 66'
      AgentClass                           : 'Browser'
      AgentName                            : 'Iron'
      AgentVersion                         : '66.0.3450.0'
      AgentVersionMajor                    : '66'
      AgentNameVersion                     : 'Iron 66.0.3450.0'
      AgentNameVersionMajor                : 'Iron 66'

# Iron browser: https://play.google.com/store/apps/details?id=org.iron.srware
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 7.1.1; Nexus 6 Build/N6F27M) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/61.0.3163.81 Mobile Iron Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Google Nexus 6'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.1.1'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Android 7.1.1'
      OperatingSystemNameVersionMajor      : 'Android 7'
      OperatingSystemVersionBuild          : 'N6F27M'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '61.0'
      LayoutEngineVersionMajor             : '61'
      LayoutEngineNameVersion              : 'Blink 61.0'
      LayoutEngineNameVersionMajor         : 'Blink 61'
      AgentClass                           : 'Browser'
      AgentName                            : 'Iron'
      AgentVersion                         : '61.0.3163.81'
      AgentVersionMajor                    : '61'
      AgentNameVersion                     : 'Iron 61.0.3163.81'
      AgentNameVersionMajor                : 'Iron 61'

# Chromium installed as a snap on Ubuntu 16.4 LTS
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) snap Chromium/71.0.3578.80 Chrome/71.0.3578.80 Safari/537.36'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Linux ??'
      OperatingSystemNameVersionMajor      : 'Linux ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '71.0'
      LayoutEngineVersionMajor             : '71'
      LayoutEngineNameVersion              : 'Blink 71.0'
      LayoutEngineNameVersionMajor         : 'Blink 71'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chromium'
      AgentVersion                         : '71.0.3578.80'
      AgentVersionMajor                    : '71'
      AgentNameVersion                     : 'Chromium 71.0.3578.80'
      AgentNameVersionMajor                : 'Chromium 71'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/42.0.2311.154 Safari/537.36 LBBROWSER'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '42.0'
      LayoutEngineVersionMajor             : '42'
      LayoutEngineNameVersion              : 'Blink 42.0'
      LayoutEngineNameVersionMajor         : 'Blink 42'
      AgentClass                           : 'Browser'
      AgentName                            : 'Liebao Browser'
      AgentVersion                         : '42.0.2311.154'
      AgentVersionMajor                    : '42'
      AgentNameVersion                     : 'Liebao Browser 42.0.2311.154'
      AgentNameVersionMajor                : 'Liebao Browser 42'


# Whale https://whale.naver.com/en/
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.103 Whale/1.5.73.16 Safari/537.36'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '73.0'
      LayoutEngineVersionMajor             : '73'
      LayoutEngineNameVersion              : 'Blink 73.0'
      LayoutEngineNameVersionMajor         : 'Blink 73'
      AgentClass                           : 'Browser'
      AgentName                            : 'Whale'
      AgentVersion                         : '1.5.73.16'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Whale 1.5.73.16'
      AgentNameVersionMajor                : 'Whale 1'


# Thungsten https://en.tungsten-start.net/
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36 TungstenBrowser/2.1'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '71.0'
      LayoutEngineVersionMajor             : '71'
      LayoutEngineNameVersion              : 'Blink 71.0'
      LayoutEngineNameVersionMajor         : 'Blink 71'
      AgentClass                           : 'Browser'
      AgentName                            : 'TungstenBrowser'
      AgentVersion                         : '2.1'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'TungstenBrowser 2.1'
      AgentNameVersionMajor                : 'TungstenBrowser 2'


# Kinza https://www.kinza.jp/en/
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.142 Safari/537.36 Kinza/5.6.3'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '75.0'
      LayoutEngineVersionMajor             : '75'
      LayoutEngineNameVersion              : 'Blink 75.0'
      LayoutEngineNameVersionMajor         : 'Blink 75'
      AgentClass                           : 'Browser'
      AgentName                            : 'Kinza'
      AgentVersion                         : '5.6.3'
      AgentVersionMajor                    : '5'
      AgentNameVersion                     : 'Kinza 5.6.3'
      AgentNameVersionMajor                : 'Kinza 5'


# Iridium https://iridiumbrowser.de/
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Iridium/2019.04 Safari/537.36 Chrome/73.0.0.0'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '73.0'
      LayoutEngineVersionMajor             : '73'
      LayoutEngineNameVersion              : 'Blink 73.0'
      LayoutEngineNameVersionMajor         : 'Blink 73'
      AgentClass                           : 'Browser'
      AgentName                            : 'Iridium'
      AgentVersion                         : '2019.04'
      AgentVersionMajor                    : '2019'
      AgentNameVersion                     : 'Iridium 2019.04'
      AgentNameVersionMajor                : 'Iridium 2019'


# Superbird  http://superbird-browser.com/
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.103 Superbird/73.0.3683.103 Safari/537.36'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '73.0'
      LayoutEngineVersionMajor             : '73'
      LayoutEngineNameVersion              : 'Blink 73.0'
      LayoutEngineNameVersionMajor         : 'Blink 73'
      AgentClass                           : 'Browser'
      AgentName                            : 'Superbird'
      AgentVersion                         : '73.0.3683.103'
      AgentVersionMajor                    : '73'
      AgentNameVersion                     : 'Superbird 73.0.3683.103'
      AgentNameVersionMajor                : 'Superbird 73'


# Avast https://www.avast.com/secure-browser
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.100 Safari/537.36 Avast/75.1.1528.101'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '75.0'
      LayoutEngineVersionMajor             : '75'
      LayoutEngineNameVersion              : 'Blink 75.0'
      LayoutEngineNameVersionMajor         : 'Blink 75'
      AgentClass                           : 'Browser'
      AgentName                            : 'Avast'
      AgentVersion                         : '75.1.1528.101'
      AgentVersionMajor                    : '75'
      AgentNameVersion                     : 'Avast 75.1.1528.101'
      AgentNameVersionMajor                : 'Avast 75'


# Comodo Dragon https://browser.comodo.com/
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Dragon/45.9.12.393 Chrome/45.0.2454.93 Safari/537.36'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '45.0'
      LayoutEngineVersionMajor             : '45'
      LayoutEngineNameVersion              : 'Blink 45.0'
      LayoutEngineNameVersionMajor         : 'Blink 45'
      AgentClass                           : 'Browser'
      AgentName                            : 'Comodo Dragon'
      AgentVersion                         : '45.9.12.393'
      AgentVersionMajor                    : '45'
      AgentNameVersion                     : 'Comodo Dragon 45.9.12.393'
      AgentNameVersionMajor                : 'Comodo Dragon 45'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Dragon/36.1.1.21 Chrome/36.0.1985.97 Safari/537.36'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '36.0'
      LayoutEngineVersionMajor             : '36'
      LayoutEngineNameVersion              : 'Blink 36.0'
      LayoutEngineNameVersionMajor         : 'Blink 36'
      AgentClass                           : 'Browser'
      AgentName                            : 'Comodo Dragon'
      AgentVersion                         : '36.1.1.21'
      AgentVersionMajor                    : '36'
      AgentNameVersion                     : 'Comodo Dragon 36.1.1.21'
      AgentNameVersionMajor                : 'Comodo Dragon 36'


# Comodo IceDragon https://browser.comodo.com/
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 10.0; WOW64; rv:65.0) Gecko/20100101 Firefox/65.0 IceDragon/65.0.2'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '65.0'
      LayoutEngineVersionMajor             : '65'
      LayoutEngineNameVersion              : 'Gecko 65.0'
      LayoutEngineNameVersionMajor         : 'Gecko 65'
      LayoutEngineBuild                    : '20100101'
      AgentClass                           : 'Browser'
      AgentName                            : 'Comodo IceDragon'
      AgentVersion                         : '65.0.2'
      AgentVersionMajor                    : '65'
      AgentNameVersion                     : 'Comodo IceDragon 65.0.2'
      AgentNameVersionMajor                : 'Comodo IceDragon 65'


# https://www.xvast.com/
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3390.0 Xvast/1.1.0.4 Safari/537.36'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '67.0'
      LayoutEngineVersionMajor             : '67'
      LayoutEngineNameVersion              : 'Blink 67.0'
      LayoutEngineNameVersionMajor         : 'Blink 67'
      AgentClass                           : 'Browser'
      AgentName                            : 'Xvast'
      AgentVersion                         : '1.1.0.4'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Xvast 1.1.0.4'
      AgentNameVersionMajor                : 'Xvast 1'


# coccoc
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) coc_coc_browser/80.0.180 Chrome/74.0.3729.180 Safari/537.36'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '74.0'
      LayoutEngineVersionMajor             : '74'
      LayoutEngineNameVersion              : 'Blink 74.0'
      LayoutEngineNameVersionMajor         : 'Blink 74'
      AgentClass                           : 'Browser'
      AgentName                            : 'Coc Coc Browser'
      AgentVersion                         : '80.0.180'
      AgentVersionMajor                    : '80'
      AgentNameVersion                     : 'Coc Coc Browser 80.0.180'
      AgentNameVersionMajor                : 'Coc Coc Browser 80'


# CrMo is really Chrome (before ~2013)
# https://bugs.chromium.org/p/chromium/issues/detail?id=116455
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android-4.0.3; en-us; Galaxy Nexus Build/IML74K) AppleWebKit/535.7 (KHTML, like Gecko) CrMo/16.0.912.75 Mobile Safari/535.7'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung Galaxy Nexus'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.0.3'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.0.3'
      OperatingSystemNameVersionMajor      : 'Android 4'
      OperatingSystemVersionBuild          : 'IML74K'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '535.7'
      LayoutEngineVersionMajor             : '535'
      LayoutEngineNameVersion              : 'AppleWebKit 535.7'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 535'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '16.0.912.75'
      AgentVersionMajor                    : '16'
      AgentNameVersion                     : 'Chrome 16.0.912.75'
      AgentNameVersionMajor                : 'Chrome 16'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'


# Old Chrome reference examples
# https://blog.chromium.org/2011/03/ua-string-changes-coming-in-chrome-11.html

# Chrome 10 on Windows
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows; U; Windows NT 6.0; en-US) AppleWebKit/534.16 (KHTML, like Gecko) Chrome/10.0.648.204 Safari/534.16'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : 'Vista'
      OperatingSystemVersionMajor          : 'Vista'
      OperatingSystemNameVersion           : 'Windows Vista'
      OperatingSystemNameVersionMajor      : 'Windows Vista'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '534.16'
      LayoutEngineVersionMajor             : '534'
      LayoutEngineNameVersion              : 'AppleWebKit 534.16'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 534'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '10.0.648.204'
      AgentVersionMajor                    : '10'
      AgentNameVersion                     : 'Chrome 10.0.648.204'
      AgentNameVersionMajor                : 'Chrome 10'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'

# Chrome 10 on Linux
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; U; Linux x86_64; en-US) AppleWebKit/534.16 (KHTML, like Gecko) Chrome/10.0.648.204 Safari/534.16'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Linux ??'
      OperatingSystemNameVersionMajor      : 'Linux ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '534.16'
      LayoutEngineVersionMajor             : '534'
      LayoutEngineNameVersion              : 'AppleWebKit 534.16'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 534'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '10.0.648.204'
      AgentVersionMajor                    : '10'
      AgentNameVersion                     : 'Chrome 10.0.648.204'
      AgentNameVersionMajor                : 'Chrome 10'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'

# Chrome 11 on Windows
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 6.0; WOW64) AppleWebKit/534.24 (KHTML, like Gecko) Chrome/11.0.696.16 Safari/534.24'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : 'Vista'
      OperatingSystemVersionMajor          : 'Vista'
      OperatingSystemNameVersion           : 'Windows Vista'
      OperatingSystemNameVersionMajor      : 'Windows Vista'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '534.24'
      LayoutEngineVersionMajor             : '534'
      LayoutEngineNameVersion              : 'AppleWebKit 534.24'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 534'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '11.0.696.16'
      AgentVersionMajor                    : '11'
      AgentNameVersion                     : 'Chrome 11.0.696.16'
      AgentNameVersionMajor                : 'Chrome 11'

# Chrome 11 on Linux
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/534.24 (KHTML, like Gecko) Chrome/11.0.696.16 Safari/534.24'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Linux ??'
      OperatingSystemNameVersionMajor      : 'Linux ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '534.24'
      LayoutEngineVersionMajor             : '534'
      LayoutEngineNameVersion              : 'AppleWebKit 534.24'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 534'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '11.0.696.16'
      AgentVersionMajor                    : '11'
      AgentNameVersion                     : 'Chrome 11.0.696.16'
      AgentNameVersionMajor                : 'Chrome 11'

# From https://chromium.googlesource.com/chromium/src.git/+/master/docs/ios/user_agent.md
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 10_3 like Mac OS X) AppleWebKit/602.1.50 (KHTML, like Gecko) CriOS/56.0.2924.75 Mobile/14E5239e Safari/602.1'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '14E5239e'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '10.3'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'iOS 10.3'
      OperatingSystemNameVersionMajor      : 'iOS 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '602.1.50'
      LayoutEngineVersionMajor             : '602'
      LayoutEngineNameVersion              : 'AppleWebKit 602.1.50'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 602'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '56.0.2924.75'
      AgentVersionMajor                    : '56'
      AgentNameVersion                     : 'Chrome 56.0.2924.75'
      AgentNameVersionMajor                : 'Chrome 56'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 10_3 like Mac OS X) AppleWebKit/603.1.23 (KHTML, like Gecko) Version/10.0 Mobile/14E5239e Safari/602.1'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '14E5239e'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '10.3'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'iOS 10.3'
      OperatingSystemNameVersionMajor      : 'iOS 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '603.1.23'
      LayoutEngineVersionMajor             : '603'
      LayoutEngineNameVersion              : 'AppleWebKit 603.1.23'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 603'
      AgentClass                           : 'Browser'
      AgentName                            : 'Safari'
      AgentVersion                         : '10.0'
      AgentVersionMajor                    : '10'
      AgentNameVersion                     : 'Safari 10.0'
      AgentNameVersionMajor                : 'Safari 10'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_4) AppleWebKit/600.7.12 (KHTML, like Gecko) Version/8.0.7 Safari/600.7.12'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Apple Macintosh'
      DeviceBrand                          : 'Apple'
      DeviceCpu                            : 'Intel'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Mac OS X'
      OperatingSystemVersion               : '10.10.4'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Mac OS X 10.10.4'
      OperatingSystemNameVersionMajor      : 'Mac OS X 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '600.7.12'
      LayoutEngineVersionMajor             : '600'
      LayoutEngineNameVersion              : 'AppleWebKit 600.7.12'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 600'
      AgentClass                           : 'Browser'
      AgentName                            : 'Safari'
      AgentVersion                         : '8.0.7'
      AgentVersionMajor                    : '8'
      AgentNameVersion                     : 'Safari 8.0.7'
      AgentNameVersionMajor                : 'Safari 8'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 13_5 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) CriOS/83.0.4103.88 Mobile/15E148 Safari/604.1'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15E148'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '13.5'
      OperatingSystemVersionMajor          : '13'
      OperatingSystemNameVersion           : 'iOS 13.5'
      OperatingSystemNameVersionMajor      : 'iOS 13'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '83.0.4103.88'
      AgentVersionMajor                    : '83'
      AgentNameVersion                     : 'Chrome 83.0.4103.88'
      AgentNameVersionMajor                : 'Chrome 83'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPad; CPU OS 13_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) CriOS/83.0.4103.88 Mobile/15E148 Safari/604.1'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Apple iPad'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15E148'
      DeviceVersion                        : 'iPad'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '13.4'
      OperatingSystemVersionMajor          : '13'
      OperatingSystemNameVersion           : 'iOS 13.4'
      OperatingSystemNameVersionMajor      : 'iOS 13'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '83.0.4103.88'
      AgentVersionMajor                    : '83'
      AgentNameVersion                     : 'Chrome 83.0.4103.88'
      AgentNameVersionMajor                : 'Chrome 83'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 10; Nokia 7.2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.99 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Nokia 7.2'
      DeviceBrand                          : 'Nokia'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '10'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Android 10'
      OperatingSystemNameVersionMajor      : 'Android 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '86.0'
      LayoutEngineVersionMajor             : '86'
      LayoutEngineNameVersion              : 'Blink 86.0'
      LayoutEngineNameVersionMajor         : 'Blink 86'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '86.0.4240.99'
      AgentVersionMajor                    : '86'
      AgentNameVersion                     : 'Chrome 86.0.4240.99'
      AgentNameVersionMajor                : 'Chrome 86'


# Vivaldi 4.0 on Linux is IDENTICAL to Chrome 91 on Linux
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.114 Safari/537.36'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Linux ??'
      OperatingSystemNameVersionMajor      : 'Linux ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '91.0'
      LayoutEngineVersionMajor             : '91'
      LayoutEngineNameVersion              : 'Blink 91.0'
      LayoutEngineNameVersionMajor         : 'Blink 91'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '91.0.4472.114'
      AgentVersionMajor                    : '91'
      AgentNameVersion                     : 'Chrome 91.0.4472.114'
      AgentNameVersionMajor                : 'Chrome 91'

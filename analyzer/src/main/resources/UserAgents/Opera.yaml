#
# Yet Another UserAgent Analyzer
# Copyright (C) 2013-2023 Niels Basjes
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# https://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an AS IS BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

config:

- matcher:
    extract:
    - 'LayoutEngineClass                   :     2010 :"Browser"'
    - 'LayoutEngineName                    :     2010 :"Presto"'
    - 'LayoutEngineVersion                 :     2010 :"1"'
    - 'AgentClass                          :     2010 :"Browser"'
    - 'AgentName                           :     2010 :"Opera"'
    - 'AgentVersion                        :     2010 :agent.product.name="Opera"^.version'

- matcher:
    require:
    - 'agent.product.name="Opera"'
    extract:
    - 'LayoutEngineClass                   :     2011 :"Browser"'
    - 'LayoutEngineName                    :     2011 :"Presto"'
    - 'LayoutEngineVersion                 :     2011 :agent.product.name="Presto"^.version'
    - 'AgentClass                          :     2011 :"Browser"'
    - 'AgentName                           :     2011 :"Opera"'
    - 'AgentVersion                        :     2011 :agent.product.name="Version"^.version'

# https://en.m.wikipedia.org/wiki/Presto_(layout_engine)
# OPR Implies the BLink engine instead of Presto
#- matcher:
#    extract:
#    - 'LayoutEngineClass          : 2020:"Browser"'
#    - 'LayoutEngineName           : 2020:"Blink"'
#    - 'LayoutEngineVersion        : 2020:agent.product.name="Chrome"^.version'
#    - 'AgentClass                 : 2020:"Browser"'
#    - 'AgentName                  : 2020:"Opera"'
#    - 'AgentVersion               : 2020:agent.product.name="Opr"^.version'

# From 2011: https://dev.opera.com/articles/opera-mini-request-headers/
# User-Agent: Opera/9.80 (Android; Opera Mini/8.0.1807/36.1609; U; en) Presto/2.12.423 Version/12.16
# User-Agent: Opera/9.80 ($PLATFORM_NAME$; $PRODUCT_NAME$/$CLIENT_VERSION$/ $SERVER_VERSION$;U; $LOCALE$) $PRESTO_VERSION$ $EQUIV_DESKTOP_VERSION$

- matcher:
    extract:
    - 'AgentClass                          :     2012 :"Browser"'
    - 'AgentName                           :     2012 :"Opera Mini"'
    - 'AgentVersion                        :     2012 :agent.(1-4)product.comments.entry.(1-2)product.name="Opera Mini"^.version'
    - 'DeviceClass                         :        1 :"Mobile"'

- matcher:
    extract:
    - 'AgentClass                          :     2012 :"Browser"'
    - 'AgentName                           :     2012 :"Opera Mini"'
    - 'AgentVersion                        :     2012 :agent.(1)product.name="Opera Mini"^.version'
    - 'DeviceClass                         :        1 :"Mobile"'

- matcher:
    require:
    - 'agent.(1-4)product.comments.entry.(1-4)product.name="Opera Tablet"'
    extract:
    - 'AgentClass                          :     2012 :"Browser"'
    - 'AgentName                           :     2012 :"Opera Tablet"'
    - 'AgentVersion                        :     2012 :agent.product.name="Version"^.version'


# Opera Mini on Android is presented as a "Webview". Perhaps it is really a webview but for reporting not desired.
- matcher:
    variable:
    - 'OperaVersion:agent.product.(1)name="OPR"^.version'
    require:
    - 'agent.(1)product.(1)comments.entry.(1)text="wv"'
    - 'agent.(1)product.(1)comments.entry.(1)product.(1)name[1]="Android"'
    extract:
    - 'AgentClass                   : 12100 : "Browser"'
    - 'AgentName                    : 12100 : "Opera Mini"'
    - 'AgentVersion                 : 12100 : @OperaVersion'
    - 'WebviewAppName               : 10012 : "<<<null>>>"'
    - 'WebviewAppVersion            : 10012 : "<<<null>>>"'


# Opera Mobile on Android is presented as "Opera".
- matcher:
    variable:
    - 'OperaVersion:agent.product.(1)name="OPR"^.version'
    require:
    - 'IsNull[agent.(1)product.(1)comments.entry.(1)text="wv"]'
    - 'agent.(1)product.(1)comments.entry.(1)product.(1)name[1]="Android"'
    extract:
    - 'AgentClass                   : 12100 : "Browser"'
    - 'AgentName                    : 12100 : "Opera Mobile"'
    - 'AgentVersion                 : 12100 : @OperaVersion'
    - 'WebviewAppName               : 10012 : "<<<null>>>"'
    - 'WebviewAppVersion            : 10012 : "<<<null>>>"'


# Opera on iOS
- matcher:
    extract:
    - 'AgentClass                          :     2014 :"Browser"'
    - 'AgentName                           :     2014 :"Opera"'
    - 'AgentVersion                        :     2014 :agent.product.name="OPiOS"^.version'


# Opera Touch.
- matcher:
    variable:
    - 'OperaVersion:agent.product.(1)name="OPT"^.version'
    extract:
    - 'AgentClass                   : 12100 : "Browser"'
    - 'AgentName                    : 12100 : "Opera Touch"'
    - 'AgentVersion                 : 12100 : @OperaVersion'
    - 'WebviewAppName               : 10012 : "<<<null>>>"'
    - 'WebviewAppVersion            : 10012 : "<<<null>>>"'


# Opera GX
- matcher:
    extract:
    - 'AgentClass                          :     3014 :"Browser"'
    - 'AgentName                           :     3014 :"Opera GX"'
    - 'AgentVersion                        :     3014 :agent.product.name="OPRGX"^.version'


# Opera GX on Android
- matcher:
    extract:
    - 'AgentClass                          :     3014 :"Browser"'
    - 'AgentName                           :     3014 :"Opera GX"'
    - 'AgentVersion                        :     3014 :agent.product.name="OPX"^.version'


- test:
    input:
      user_agent_string: 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; en) Opera 9.51'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : 'XP'
      OperatingSystemVersionMajor          : 'XP'
      OperatingSystemNameVersion           : 'Windows XP'
      OperatingSystemNameVersionMajor      : 'Windows XP'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '1'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Presto 1'
      LayoutEngineNameVersionMajor         : 'Presto 1'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera'
      AgentVersion                         : '9.51'
      AgentVersionMajor                    : '9'
      AgentNameVersion                     : 'Opera 9.51'
      AgentNameVersionMajor                : 'Opera 9'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 6.0; U; en; rv:1.8.1) Gecko/20061208 Firefox/2.0.0 Opera 9.51'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : 'Vista'
      OperatingSystemVersionMajor          : 'Vista'
      OperatingSystemNameVersion           : 'Windows Vista'
      OperatingSystemNameVersionMajor      : 'Windows Vista'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '1'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Presto 1'
      LayoutEngineNameVersionMajor         : 'Presto 1'
      LayoutEngineBuild                    : '20061208'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera'
      AgentVersion                         : '9.51'
      AgentVersionMajor                    : '9'
      AgentNameVersion                     : 'Opera 9.51'
      AgentNameVersionMajor                : 'Opera 9'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Opera/9.51 (Windows NT 5.1; U; en)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : 'XP'
      OperatingSystemVersionMajor          : 'XP'
      OperatingSystemNameVersion           : 'Windows XP'
      OperatingSystemNameVersionMajor      : 'Windows XP'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '1'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Presto 1'
      LayoutEngineNameVersionMajor         : 'Presto 1'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera'
      AgentVersion                         : '9.51'
      AgentVersionMajor                    : '9'
      AgentNameVersion                     : 'Opera 9.51'
      AgentNameVersionMajor                : 'Opera 9'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Opera/9.80 (Windows NT 6.1; Win64; x64) Presto/2.12.388 Version/12.16'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '2.12.388'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Presto 2.12.388'
      LayoutEngineNameVersionMajor         : 'Presto 2'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera'
      AgentVersion                         : '12.16'
      AgentVersionMajor                    : '12'
      AgentNameVersion                     : 'Opera 12.16'
      AgentNameVersionMajor                : 'Opera 12'


- test:
    input:
      user_agent_string: 'Opera/9.80 (Android; Opera Mini/7.6.40234/36.1344; U; nl) Presto/2.12.423 Version/12.16'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Android Mobile'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Android ??'
      OperatingSystemNameVersionMajor      : 'Android ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '2.12.423'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Presto 2.12.423'
      LayoutEngineNameVersionMajor         : 'Presto 2'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera Mini'
      AgentVersion                         : '7.6.40234'
      AgentVersionMajor                    : '7'
      AgentNameVersion                     : 'Opera Mini 7.6.40234'
      AgentNameVersionMajor                : 'Opera Mini 7'
      AgentLanguage                        : 'Dutch'
      AgentLanguageCode                    : 'nl'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      user_agent_string: 'Opera/9.80 (Windows NT 6.1; Opera Tablet/15165; U; en) Presto/2.8.149 Version/11.1'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '2.8.149'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Presto 2.8.149'
      LayoutEngineNameVersionMajor         : 'Presto 2'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera Tablet'
      AgentVersion                         : '11.1'
      AgentVersionMajor                    : '11'
      AgentNameVersion                     : 'Opera Tablet 11.1'
      AgentNameVersionMajor                : 'Opera Tablet 11'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Opera/9.80 (Android 1.0.3; Linux; Opera Tablet/ADR-1309251104) Presto/2.11.355 Version/12.10'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Android Mobile'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '1.0.3'
      OperatingSystemVersionMajor          : '1'
      OperatingSystemNameVersion           : 'Android 1.0.3'
      OperatingSystemNameVersionMajor      : 'Android 1'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '2.11.355'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Presto 2.11.355'
      LayoutEngineNameVersionMajor         : 'Presto 2'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera Tablet'
      AgentVersion                         : '12.10'
      AgentVersionMajor                    : '12'
      AgentNameVersion                     : 'Opera Tablet 12.10'
      AgentNameVersionMajor                : 'Opera Tablet 12'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPad; CPU OS 9_3_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) OPiOS/13.0.1.100754 Mobile/13E238 Safari/9537.53'
    expected:
      DeviceClass                          : 'Tablet'
      DeviceName                           : 'Apple iPad'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '13E238'
      DeviceVersion                        : 'iPad'
      OperatingSystemNameVersion           : 'iOS 9.3.1'
      OperatingSystemNameVersionMajor      : 'iOS 9'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '9.3.1'
      OperatingSystemVersionMajor          : '9'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '601.1.46'
      LayoutEngineVersionMajor             : '601'
      LayoutEngineNameVersion              : 'AppleWebKit 601.1.46'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 601'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera'
      AgentVersion                         : '13.0.1.100754'
      AgentVersionMajor                    : '13'
      AgentNameVersion                     : 'Opera 13.0.1.100754'
      AgentNameVersionMajor                : 'Opera 13'

- test:
    input:
      user_agent_string: 'Opera/9.80 (J2ME/MIDP; Opera Mini/4.2.16402/37.7936; U; en) Presto/2.12.423 Version/12.16'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Unknown' # TODO: Extract J2ME/MIDP
      OperatingSystemName                  : 'Unknown'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Unknown ??'
      OperatingSystemNameVersionMajor      : 'Unknown ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '2.12.423'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Presto 2.12.423'
      LayoutEngineNameVersionMajor         : 'Presto 2'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera Mini'
      AgentVersion                         : '4.2.16402'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Opera Mini 4.2.16402'
      AgentNameVersionMajor                : 'Opera Mini 4'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Opera/9.80 (MAUI Runtime; Opera Mini/4.4.39010/37.7936; U; nl) Presto/2.12.423 Version/12.16'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Unknown' # TODO: Extract MAUI Runtime
      OperatingSystemName                  : 'Unknown'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Unknown ??'
      OperatingSystemNameVersionMajor      : 'Unknown ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '2.12.423'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Presto 2.12.423'
      LayoutEngineNameVersionMajor         : 'Presto 2'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera Mini'
      AgentVersion                         : '4.4.39010'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Opera Mini 4.4.39010'
      AgentNameVersionMajor                : 'Opera Mini 4'
      AgentLanguage                        : 'Dutch'
      AgentLanguageCode                    : 'nl'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Opera/9.80 (SpreadTrum; Opera Mini/4.4.31492/37.7936; U; en) Presto/2.12.423 Version/12.16'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'SpreadTrum'
      DeviceBrand                          : 'SpreadTrum'
      OperatingSystemClass                 : 'Unknown'
      OperatingSystemName                  : 'Unknown'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Unknown ??'
      OperatingSystemNameVersionMajor      : 'Unknown ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '2.12.423'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Presto 2.12.423'
      LayoutEngineNameVersionMajor         : 'Presto 2'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera Mini'
      AgentVersion                         : '4.4.31492'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Opera Mini 4.4.31492'
      AgentNameVersionMajor                : 'Opera Mini 4'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.52 Safari/537.36 OPR/15.0.1147.100'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '28.0'
      LayoutEngineVersionMajor             : '28'
      LayoutEngineNameVersion              : 'Blink 28.0'
      LayoutEngineNameVersionMajor         : 'Blink 28'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera'
      AgentVersion                         : '15.0.1147.100'
      AgentVersionMajor                    : '15'
      AgentNameVersion                     : 'Opera 15.0.1147.100'
      AgentNameVersionMajor                : 'Opera 15'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 7.1.1; Nexus 6 Build/N6F27M; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/66.0.3359.126 Mobile Safari/537.36 OPT/1.0.9'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Google Nexus 6'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.1.1'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Android 7.1.1'
      OperatingSystemNameVersionMajor      : 'Android 7'
      OperatingSystemVersionBuild          : 'N6F27M'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '66.0'
      LayoutEngineVersionMajor             : '66'
      LayoutEngineNameVersion              : 'Blink 66.0'
      LayoutEngineNameVersionMajor         : 'Blink 66'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera Touch'
      AgentVersion                         : '1.0.9'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Opera Touch 1.0.9'
      AgentNameVersionMajor                : 'Opera Touch 1'

- test:
    input:
      user_agent_string: 'Opera/9.80 (X11; Linux x86_64; U; Ubuntu/10.10 (maverick); pl) Presto/2.7.62 Version/11.01'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '10.10'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Ubuntu 10.10'
      OperatingSystemNameVersionMajor      : 'Ubuntu 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '2.7.62'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Presto 2.7.62'
      LayoutEngineNameVersionMajor         : 'Presto 2'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera'
      AgentVersion                         : '11.01'
      AgentVersionMajor                    : '11'
      AgentNameVersion                     : 'Opera 11.01'
      AgentNameVersionMajor                : 'Opera 11'
      AgentLanguage                        : 'Polish'
      AgentLanguageCode                    : 'pl'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.21 Safari/537.36 MMS/1.0.2531.0'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '53.0'
      LayoutEngineVersionMajor             : '53'
      LayoutEngineNameVersion              : 'Blink 53.0'
      LayoutEngineNameVersionMajor         : 'Blink 53'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera Neon'
      AgentVersion                         : '1.0.2531.0'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Opera Neon 1.0.2531.0'
      AgentNameVersionMajor                : 'Opera Neon 1'


- test:
    input:
      User-Agent                           : 'Opera/9.80 (Android; Opera Mini/7.5.33135/191.273; U; ar) Presto/2.12.423 Version/12.16'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Android Mobile'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Android ??'
      OperatingSystemNameVersionMajor      : 'Android ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '2.12.423'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Presto 2.12.423'
      LayoutEngineNameVersionMajor         : 'Presto 2'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera Mini'
      AgentVersion                         : '7.5.33135'
      AgentVersionMajor                    : '7'
      AgentNameVersion                     : 'Opera Mini 7.5.33135'
      AgentNameVersionMajor                : 'Opera Mini 7'
      AgentLanguage                        : 'Arabic'
      AgentLanguageCode                    : 'ar'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      User-Agent                           : 'Opera/9.80 (Android; Opera Mini/7.5.33361/191.269; U; pt) Presto/2.12.423 Version/12.16'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Android Mobile'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Android ??'
      OperatingSystemNameVersionMajor      : 'Android ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '2.12.423'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Presto 2.12.423'
      LayoutEngineNameVersionMajor         : 'Presto 2'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera Mini'
      AgentVersion                         : '7.5.33361'
      AgentVersionMajor                    : '7'
      AgentNameVersion                     : 'Opera Mini 7.5.33361'
      AgentNameVersionMajor                : 'Opera Mini 7'
      AgentLanguage                        : 'Portuguese'
      AgentLanguageCode                    : 'pt'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      User-Agent                           : 'Opera/9.80 (MAUI Runtime; Opera Mini/4.4.39001/191.269; U; nl) Presto/2.12.423 Version/12.16'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Unknown'
      OperatingSystemName                  : 'Unknown'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Unknown ??'
      OperatingSystemNameVersionMajor      : 'Unknown ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '2.12.423'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Presto 2.12.423'
      LayoutEngineNameVersionMajor         : 'Presto 2'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera Mini'
      AgentVersion                         : '4.4.39001'
      AgentVersionMajor                    : '4'
      AgentNameVersion                     : 'Opera Mini 4.4.39001'
      AgentNameVersionMajor                : 'Opera Mini 4'
      AgentLanguage                        : 'Dutch'
      AgentLanguageCode                    : 'nl'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      User-Agent                           : 'Opera/9.80 (Windows 95; U; en) Presto/2.6.30 Version/10.71'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows 9x'
      OperatingSystemVersion               : '95'
      OperatingSystemVersionMajor          : '95'
      OperatingSystemNameVersion           : 'Windows 95'
      OperatingSystemNameVersionMajor      : 'Windows 95'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '2.6.30'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Presto 2.6.30'
      LayoutEngineNameVersionMajor         : 'Presto 2'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera'
      AgentVersion                         : '10.71'
      AgentVersionMajor                    : '10'
      AgentNameVersion                     : 'Opera 10.71'
      AgentNameVersionMajor                : 'Opera 10'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      User-Agent                           : 'Opera/9.80 (Windows NT 6.1; U; en) Presto/2.9.168 Version/11.52'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '2.9.168'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Presto 2.9.168'
      LayoutEngineNameVersionMajor         : 'Presto 2'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera'
      AgentVersion                         : '11.52'
      AgentVersionMajor                    : '11'
      AgentNameVersion                     : 'Opera 11.52'
      AgentNameVersionMajor                : 'Opera 11'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      User-Agent                           : 'Opera/9.80 Windows NT 6.1; U; en Presto/9.9.9 Version/66.0'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '9.9.9'
      LayoutEngineVersionMajor             : '9'
      LayoutEngineNameVersion              : 'Presto 9.9.9'
      LayoutEngineNameVersionMajor         : 'Presto 9'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera'
      AgentVersion                         : '66.0'
      AgentVersionMajor                    : '66'
      AgentNameVersion                     : 'Opera 66.0'
      AgentNameVersionMajor                : 'Opera 66'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      User-Agent                           : 'Opera/9.80 X11; U; Linux i686; en; rv:1.9.0.6 Presto/2.2.2 Version/65.0'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Linux ??'
      OperatingSystemNameVersionMajor      : 'Linux ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '2.2.2'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Presto 2.2.2'
      LayoutEngineNameVersionMajor         : 'Presto 2'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera'
      AgentVersion                         : '65.0'
      AgentVersionMajor                    : '65'
      AgentNameVersion                     : 'Opera 65.0'
      AgentNameVersionMajor                : 'Opera 65'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      User-Agent                           : 'Opera/9.80 (Windows NT 6.1; U; es-LA) Presto/2.6.30 Version/10.63,gzip(gfe) (via translate.google.com)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Google Desktop'
      DeviceBrand                          : 'Google'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '2.6.30'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Presto 2.6.30'
      LayoutEngineNameVersionMajor         : 'Presto 2'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera'
      AgentVersion                         : '10.63'
      AgentVersionMajor                    : '10'
      AgentNameVersion                     : 'Opera 10.63'
      AgentNameVersionMajor                : 'Opera 10'
      AgentLanguage                        : 'Spanish (Spanish)'
      AgentLanguageCode                    : 'es-la'
      AgentInformationUrl                  : 'translate.google.com'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      User-Agent                           : 'Opera/9.80 (Windows NT 6.1; U; en) Presto/2.7.62 Version/11.01,gzip(gfe) (via docs.google.com/viewer)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Google Desktop'
      DeviceBrand                          : 'Google'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '2.7.62'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Presto 2.7.62'
      LayoutEngineNameVersionMajor         : 'Presto 2'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera'
      AgentVersion                         : '11.01'
      AgentVersionMajor                    : '11'
      AgentNameVersion                     : 'Opera 11.01'
      AgentNameVersionMajor                : 'Opera 11'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'
      AgentInformationUrl                  : 'docs.google.com/viewer'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 Android; U; Android; pl; rv:1.9.2.8 Gecko/20100115 Opera 60.0'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Android Mobile'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Android ??'
      OperatingSystemNameVersionMajor      : 'Android ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '1'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Presto 1'
      LayoutEngineNameVersionMajor         : 'Presto 1'
      LayoutEngineBuild                    : '20100115'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera'
      AgentVersion                         : '60.0'
      AgentVersionMajor                    : '60'
      AgentNameVersion                     : 'Opera 60.0'
      AgentNameVersionMajor                : 'Opera 60'
      AgentLanguage                        : 'Polish'
      AgentLanguageCode                    : 'pl'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148 OPT/3.2.17'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Unknown'
      OperatingSystemName                  : 'Unknown'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Unknown ??'
      OperatingSystemNameVersionMajor      : 'Unknown ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera Touch'
      AgentVersion                         : '3.2.17'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Opera Touch 3.2.17'
      AgentNameVersionMajor                : 'Opera Touch 3'


- test:
    input:
      User-Agent                           : 'Opera/5.0 (Windows; Windows NT 6.1; ru-ru) Gecko/20180716 Chrome/34.8.129.13 Safari/501.78'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '1'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Presto 1'
      LayoutEngineNameVersionMajor         : 'Presto 1'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '34.8.129.13'
      AgentVersionMajor                    : '34'
      AgentNameVersion                     : 'Chrome 34.8.129.13'
      AgentNameVersionMajor                : 'Chrome 34'
      AgentLanguage                        : 'Russian (Russia)'
      AgentLanguageCode                    : 'ru-ru'


- test:
    input:
      User-Agent                           : 'Opera/5.0 (Windows; Windows NT 6.8; WOW64; en-US) Gecko/20091009 Chrome/41.8.244.782 Safari/601.39'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '6.8'
      OperatingSystemVersionMajor          : '6'
      OperatingSystemNameVersion           : 'Windows NT 6.8'
      OperatingSystemNameVersionMajor      : 'Windows NT 6'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '1'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Presto 1'
      LayoutEngineNameVersionMajor         : 'Presto 1'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '41.8.244.782'
      AgentVersionMajor                    : '41'
      AgentNameVersion                     : 'Chrome 41.8.244.782'
      AgentNameVersionMajor                : 'Chrome 41'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      RemarkablePattern                    : 'No such version: Windows NT'


- test:
    input:
      User-Agent                           : 'Opera/5.0 (compatible; Windows NT 6.6; x64; ru-ru) Gecko/20110121 Chrome/32.188.062'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '6.6'
      OperatingSystemVersionMajor          : '6'
      OperatingSystemNameVersion           : 'Windows NT 6.6'
      OperatingSystemNameVersionMajor      : 'Windows NT 6'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '1'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Presto 1'
      LayoutEngineNameVersionMajor         : 'Presto 1'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '32.188.062'
      AgentVersionMajor                    : '32'
      AgentNameVersion                     : 'Chrome 32.188.062'
      AgentNameVersionMajor                : 'Chrome 32'
      AgentLanguage                        : 'Russian (Russia)'
      AgentLanguageCode                    : 'ru-ru'
      RemarkablePattern                    : 'No such version: Windows NT'


- test:
    input:
      User-Agent                           : 'Opera/5.0 (compatible; Windows NT 7.2; AMD64; ru-ru) Gecko/20190306 Chrome/38.6.59.514 Safari/605.54'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'AMD64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7.2'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows NT 7.2'
      OperatingSystemNameVersionMajor      : 'Windows NT 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '1'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Presto 1'
      LayoutEngineNameVersionMajor         : 'Presto 1'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '38.6.59.514'
      AgentVersionMajor                    : '38'
      AgentNameVersion                     : 'Chrome 38.6.59.514'
      AgentNameVersionMajor                : 'Chrome 38'
      AgentLanguage                        : 'Russian (Russia)'
      AgentLanguageCode                    : 'ru-ru'
      RemarkablePattern                    : 'No such version: Windows NT'


- test:
    name: 'Opera 91 on Windows 10 (Reduced, Only User-Agent)'
    input:
      User-Agent                                 : 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/105.0.0.0 Safari/537.36 OPR/91.0.4516.16'
    expected:
      DeviceClass                                : 'Desktop'
      DeviceName                                 : 'Desktop'
      DeviceBrand                                : 'Unknown'
      DeviceCpu                                  : 'Intel x86_64'
      DeviceCpuBits                              : '64'
      OperatingSystemClass                       : 'Desktop'
      OperatingSystemName                        : 'Windows NT'
      OperatingSystemVersion                     : '??'
      OperatingSystemVersionMajor                : '??'
      OperatingSystemNameVersion                 : 'Windows NT ??'
      OperatingSystemNameVersionMajor            : 'Windows NT ??'
      LayoutEngineClass                          : 'Browser'
      LayoutEngineName                           : 'Blink'
      LayoutEngineVersion                        : '105'
      LayoutEngineVersionMajor                   : '105'
      LayoutEngineNameVersion                    : 'Blink 105'
      LayoutEngineNameVersionMajor               : 'Blink 105'
      AgentClass                                 : 'Browser'
      AgentName                                  : 'Opera'
      AgentVersion                               : '91.0.4516.16'
      AgentVersionMajor                          : '91'
      AgentNameVersion                           : 'Opera 91.0.4516.16'
      AgentNameVersionMajor                      : 'Opera 91'


# See: https://github.com/nielsbasjes/yauaa/issues/738
# Note that it incorrectly says: "Opera";v="105.0.5195.102" (already reported to Opera: ANDEX-99458)
- test:
    name: 'Opera 91 on Windows (Reduced, Full Client Hints)'
    input:
      User-Agent                                 : 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/105.0.0.0 Safari/537.36 OPR/91.0.4516.16'
      Sec-CH-UA                                  : '"Not-A.Brand";v="99", "Opera";v="91", "Chromium";v="105"'
      Sec-CH-UA-Arch                             : '"x86"'
      Sec-CH-UA-Bitness                          : '"64"'
      # Incorrect value ! "105.0.5195.102" --> Must be 91.0.4516.16
      Sec-CH-UA-Full-Version                     : '"105.0.5195.102"'
      # Incorrect value ! "Opera";v="105.0.5195.102"
      Sec-CH-UA-Full-Version-List                : '"Opera";v="105.0.5195.102", "Not)A;Brand";v="8.0.0.0", "Chromium";v="105.0.5195.102"'
      Sec-CH-UA-Model                            : '""'
      Sec-CH-UA-Mobile                           : '?0'
      Sec-CH-UA-Platform                         : '"Windows"'
      Sec-CH-UA-Platform-Version                 : '"10.0.0"'
      Sec-CH-UA-WoW64                            : '?0'
    expected:
      DeviceClass                                : 'Desktop'
      DeviceName                                 : 'Desktop'
      DeviceBrand                                : 'Unknown'
      DeviceCpu                                  : 'Intel x86_64'
      DeviceCpuBits                              : '64'
      OperatingSystemClass                       : 'Desktop'
      OperatingSystemName                        : 'Windows NT'
      OperatingSystemVersion                     : '10'
      OperatingSystemVersionMajor                : '10'
      OperatingSystemNameVersion                 : 'Windows 10'
      OperatingSystemNameVersionMajor            : 'Windows 10'
      LayoutEngineClass                          : 'Browser'
      LayoutEngineName                           : 'Blink'
      LayoutEngineVersion                        : '105.0'
      LayoutEngineVersionMajor                   : '105'
      LayoutEngineNameVersion                    : 'Blink 105.0'
      LayoutEngineNameVersionMajor               : 'Blink 105'
      AgentClass                                 : 'Browser'
      AgentName                                  : 'Opera'
      AgentVersion                               : '91.0.4516.16'
      AgentVersionMajor                          : '91'
      AgentNameVersion                           : 'Opera 91.0.4516.16'
      AgentNameVersionMajor                      : 'Opera 91'

      UAClientHintArchitecture                   : 'x86'
      UAClientHintBitness                        : '64'
      UAClientHintBrands_0_Brand                 : 'Opera'
      UAClientHintBrands_0_Version               : '91'
      UAClientHintBrands_1_Brand                 : 'Chromium'
      UAClientHintBrands_1_Version               : '105'
      UAClientHintFullVersion                    : '105.0.5195.102'
      UAClientHintFullVersionList_0_Brand        : 'Opera'
      UAClientHintFullVersionList_0_Version      : '105.0.5195.102'
      UAClientHintFullVersionList_1_Brand        : 'Chromium'
      UAClientHintFullVersionList_1_Version      : '105.0.5195.102'
      UAClientHintMobile                         : 'false'
      UAClientHintPlatform                       : 'Windows'
      UAClientHintPlatformVersion                : '10.0.0'
      UAClientHintWow64                          : 'false'


- test:
    name: 'Opera 91 on Windows (Reduced, Standard Client Hints)'
    input:
      User-Agent                                 : 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/105.0.0.0 Safari/537.36 OPR/91.0.4516.16'
      Sec-CH-UA                                  : '"Not-A.Brand";v="99", "Opera";v="91", "Chromium";v="105"'
      Sec-CH-UA-Mobile                           : '?0'
      Sec-CH-UA-Platform                         : '"Windows"'
    expected:
      DeviceClass                                : 'Desktop'
      DeviceName                                 : 'Desktop'
      DeviceBrand                                : 'Unknown'
      DeviceCpu                                  : 'Intel x86_64'
      DeviceCpuBits                              : '64'
      OperatingSystemClass                       : 'Desktop'
      OperatingSystemName                        : 'Windows NT'
      OperatingSystemVersion                     : '??'
      OperatingSystemVersionMajor                : '??'
      OperatingSystemNameVersion                 : 'Windows NT ??'
      OperatingSystemNameVersionMajor            : 'Windows NT ??'
      LayoutEngineClass                          : 'Browser'
      LayoutEngineName                           : 'Blink'
      LayoutEngineVersion                        : '105'
      LayoutEngineVersionMajor                   : '105'
      LayoutEngineNameVersion                    : 'Blink 105'
      LayoutEngineNameVersionMajor               : 'Blink 105'
      AgentClass                                 : 'Browser'
      AgentName                                  : 'Opera'
      AgentVersion                               : '91.0.4516.16'
      AgentVersionMajor                          : '91'
      AgentNameVersion                           : 'Opera 91.0.4516.16'
      AgentNameVersionMajor                      : 'Opera 91'

      UAClientHintBrands_0_Brand                 : 'Opera'
      UAClientHintBrands_0_Version               : '91'
      UAClientHintBrands_1_Brand                 : 'Chromium'
      UAClientHintBrands_1_Version               : '105'
      UAClientHintMobile                         : 'false'
      UAClientHintPlatform                       : 'Windows'


- test:
    input:
      User-Agent                                 : 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/105.0.0.0 Safari/537.36 OPR/91.0.4516.16'
      Sec-Ch-Ua                                  : '"Not-A.Brand";v="99", "Opera";v="91", "Chromium";v="105"'
      Sec-Ch-Ua-Arch                             : '"x86"'
      Sec-Ch-Ua-Bitness                          : '"64"'
      Sec-Ch-Ua-Full-Version                     : '"105.0.5195.102"'
      Sec-Ch-Ua-Full-Version-List                : '"Opera";v="105.0.5195.102", "Not)A;Brand";v="8.0.0.0", "Chromium";v="105.0.5195.102"'
      Sec-Ch-Ua-Mobile                           : '?0'
      Sec-Ch-Ua-Model                            : '""'
      Sec-Ch-Ua-Platform                         : '"Linux"'
      Sec-Ch-Ua-Platform-Version                 : '"5.15.0"'
      Sec-Ch-Ua-Wow64                            : '?0'
    expected:
      DeviceClass                                : 'Desktop'
      DeviceName                                 : 'Linux Desktop'
      DeviceBrand                                : 'Unknown'
      DeviceCpu                                  : 'Intel x86_64'
      DeviceCpuBits                              : '64'
      OperatingSystemClass                       : 'Desktop'
      OperatingSystemName                        : 'Linux'
      OperatingSystemVersion                     : '5.15.0'
      OperatingSystemVersionMajor                : '5'
      OperatingSystemNameVersion                 : 'Linux 5.15.0'
      OperatingSystemNameVersionMajor            : 'Linux 5'
      LayoutEngineClass                          : 'Browser'
      LayoutEngineName                           : 'Blink'
      LayoutEngineVersion                        : '105.0'
      LayoutEngineVersionMajor                   : '105'
      LayoutEngineNameVersion                    : 'Blink 105.0'
      LayoutEngineNameVersionMajor               : 'Blink 105'
      AgentClass                                 : 'Browser'
      AgentName                                  : 'Opera'
      AgentVersion                               : '91.0.4516.16'
      AgentVersionMajor                          : '91'
      AgentNameVersion                           : 'Opera 91.0.4516.16'
      AgentNameVersionMajor                      : 'Opera 91'

      UAClientHintArchitecture                   : 'x86'
      UAClientHintBitness                        : '64'
      UAClientHintBrands_0_Brand                 : 'Opera'
      UAClientHintBrands_0_Version               : '91'
      UAClientHintBrands_1_Brand                 : 'Chromium'
      UAClientHintBrands_1_Version               : '105'
      UAClientHintFullVersion                    : '105.0.5195.102'
      UAClientHintFullVersionList_0_Brand        : 'Opera'
      UAClientHintFullVersionList_0_Version      : '105.0.5195.102'
      UAClientHintFullVersionList_1_Brand        : 'Chromium'
      UAClientHintFullVersionList_1_Version      : '105.0.5195.102'
      UAClientHintMobile                         : 'false'
      UAClientHintPlatform                       : 'Linux'
      UAClientHintPlatformVersion                : '5.15.0'
      UAClientHintWow64                          : 'false'



- test:
    input:
      User-Agent                                 : 'Mozilla/5.0 (Linux; Android 11; Nokia 7.2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.5615.135 Mobile Safari/537.36 OPR/75.4.3978.72990'
      Sec-Ch-Ua                                  : '";Not A Brand";v="99", "OperaMobile";v="75", "Chromium";v="112", "Opera";v="98"'
      Sec-Ch-Ua-Arch                             : '""'
      Sec-Ch-Ua-Bitness                          : '""'
      Sec-Ch-Ua-Full-Version                     : '"75.4.3978.72990"'
      Sec-Ch-Ua-Full-Version-List                : '";Not A Brand";v="99.0.0.0", "OperaMobile";v="75.4.3978.72990", "Chromium";v="112.0.5615.135", "Opera";v="98.0.4759.15"'
      Sec-Ch-Ua-Mobile                           : '?1'
      Sec-Ch-Ua-Model                            : '"Nokia 7.2"'
      Sec-Ch-Ua-Platform                         : '"Android"'
      Sec-Ch-Ua-Platform-Version                 : '"11"'
      Sec-Ch-Ua-Wow64                            : '?0'
    expected:
      DeviceClass                                : 'Phone'
      DeviceName                                 : 'Nokia 7.2'
      DeviceBrand                                : 'Nokia'
      OperatingSystemClass                       : 'Mobile'
      OperatingSystemName                        : 'Android'
      OperatingSystemVersion                     : '11'
      OperatingSystemVersionMajor                : '11'
      OperatingSystemNameVersion                 : 'Android 11'
      OperatingSystemNameVersionMajor            : 'Android 11'
      LayoutEngineClass                          : 'Browser'
      LayoutEngineName                           : 'Blink'
      LayoutEngineVersion                        : '112.0'
      LayoutEngineVersionMajor                   : '112'
      LayoutEngineNameVersion                    : 'Blink 112.0'
      LayoutEngineNameVersionMajor               : 'Blink 112'
      AgentClass                                 : 'Browser'
      AgentName                                  : 'Opera Mobile'
      AgentVersion                               : '75.4.3978.72990'
      AgentVersionMajor                          : '75'
      AgentNameVersion                           : 'Opera Mobile 75.4.3978.72990'
      AgentNameVersionMajor                      : 'Opera Mobile 75'

      UAClientHintBrands_0_Brand                 : 'OperaMobile'
      UAClientHintBrands_0_Version               : '75'
      UAClientHintBrands_1_Brand                 : 'Chromium'
      UAClientHintBrands_1_Version               : '112'
      UAClientHintBrands_2_Brand                 : 'Opera'
      UAClientHintBrands_2_Version               : '98'
      UAClientHintFullVersion                    : '75.4.3978.72990'
      UAClientHintFullVersionList_0_Brand        : 'OperaMobile'
      UAClientHintFullVersionList_0_Version      : '75.4.3978.72990'
      UAClientHintFullVersionList_1_Brand        : 'Chromium'
      UAClientHintFullVersionList_1_Version      : '112.0.5615.135'
      UAClientHintFullVersionList_2_Brand        : 'Opera'
      UAClientHintFullVersionList_2_Version      : '98.0.4759.15'
      UAClientHintMobile                         : 'true'
      UAClientHintModel                          : 'Nokia 7.2'
      UAClientHintPlatform                       : 'Android'
      UAClientHintPlatformVersion                : '11'
      UAClientHintWow64                          : 'false'


# ================================================
# Opera GX

- test:
    input:
      User-Agent                                 : 'Mozilla/5.0 (Windows 11.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.5112.102 Safari/537.36 OPRGX/104.0.4480.100'
    expected:
      DeviceClass                                : 'Desktop'
      DeviceName                                 : 'Desktop'
      DeviceBrand                                : 'Unknown'
      DeviceCpu                                  : 'Intel x86_64'
      DeviceCpuBits                              : '64'
      OperatingSystemClass                       : 'Desktop'
      OperatingSystemName                        : 'Windows'
      OperatingSystemVersion                     : '??'
      OperatingSystemVersionMajor                : '??'
      OperatingSystemNameVersion                 : 'Windows ??'
      OperatingSystemNameVersionMajor            : 'Windows ??'
      LayoutEngineClass                          : 'Browser'
      LayoutEngineName                           : 'Blink'
      LayoutEngineVersion                        : '104.0'
      LayoutEngineVersionMajor                   : '104'
      LayoutEngineNameVersion                    : 'Blink 104.0'
      LayoutEngineNameVersionMajor               : 'Blink 104'
      AgentClass                                 : 'Browser'
      AgentName                                  : 'Opera GX'
      AgentVersion                               : '104.0.4480.100'
      AgentVersionMajor                          : '104'
      AgentNameVersion                           : 'Opera GX 104.0.4480.100'
      AgentNameVersionMajor                      : 'Opera GX 104'


- test:
    input:
      User-Agent                                 : 'Mozilla/5.0 (Windows NT 10.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4719.89 Safari/537.36 OPRGX/97.0.4719.89 OPR/97.0.4719.89'
    expected:
      DeviceClass                                : 'Desktop'
      DeviceName                                 : 'Desktop'
      DeviceBrand                                : 'Unknown'
      DeviceCpuBits                              : '32'
      OperatingSystemClass                       : 'Desktop'
      OperatingSystemName                        : 'Windows NT'
      OperatingSystemVersion                     : '10.0'
      OperatingSystemVersionMajor                : '10'
      OperatingSystemNameVersion                 : 'Windows 10.0'
      OperatingSystemNameVersionMajor            : 'Windows 10'
      LayoutEngineClass                          : 'Browser'
      LayoutEngineName                           : 'Blink'
      LayoutEngineVersion                        : '97.0'
      LayoutEngineVersionMajor                   : '97'
      LayoutEngineNameVersion                    : 'Blink 97.0'
      LayoutEngineNameVersionMajor               : 'Blink 97'
      AgentClass                                 : 'Browser'
      AgentName                                  : 'Opera GX'
      AgentVersion                               : '97.0.4719.89'
      AgentVersionMajor                          : '97'
      AgentNameVersion                           : 'Opera GX 97.0.4719.89'
      AgentNameVersionMajor                      : 'Opera GX 97'


- test:
    input:
      User-Agent                                 : 'Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.103 Safari/537.36 OPR/60.0.3255.50962 OPRGX/60.0.3255.50962 (Edition Campaign E7)'
    expected:
      DeviceClass                                : 'Desktop'
      DeviceName                                 : 'Desktop'
      DeviceBrand                                : 'Unknown'
      DeviceCpu                                  : 'Intel x86_64'
      DeviceCpuBits                              : '64'
      OperatingSystemClass                       : 'Desktop'
      OperatingSystemName                        : 'Windows NT'
      OperatingSystemVersion                     : '7'
      OperatingSystemVersionMajor                : '7'
      OperatingSystemNameVersion                 : 'Windows 7'
      OperatingSystemNameVersionMajor            : 'Windows 7'
      LayoutEngineClass                          : 'Browser'
      LayoutEngineName                           : 'Blink'
      LayoutEngineVersion                        : '73.0'
      LayoutEngineVersionMajor                   : '73'
      LayoutEngineNameVersion                    : 'Blink 73.0'
      LayoutEngineNameVersionMajor               : 'Blink 73'
      AgentClass                                 : 'Browser'
      AgentName                                  : 'Opera GX'
      AgentVersion                               : '60.0.3255.50962'
      AgentVersionMajor                          : '60'
      AgentNameVersion                           : 'Opera GX 60.0.3255.50962'
      AgentNameVersionMajor                      : 'Opera GX 60'


- test:
    input:
      User-Agent                                 : 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.0.0 Safari/537.36 OPR/96.0.0.0'
      Sec-Ch-Ua                                  : '"Not=A?Brand";v="8", "Chromium";v="110", "Opera GX";v="96"'
      Sec-Ch-Ua-Mobile                           : '?0'
      Sec-Ch-Ua-Platform                         : '"Windows"'
    expected:
      DeviceClass                                : 'Desktop'
      DeviceName                                 : 'Desktop'
      DeviceBrand                                : 'Unknown'
      DeviceCpu                                  : 'Intel x86_64'
      DeviceCpuBits                              : '64'
      OperatingSystemClass                       : 'Desktop'
      OperatingSystemName                        : 'Windows NT'
      OperatingSystemVersion                     : '??'
      OperatingSystemVersionMajor                : '??'
      OperatingSystemNameVersion                 : 'Windows NT ??'
      OperatingSystemNameVersionMajor            : 'Windows NT ??'
      LayoutEngineClass                          : 'Browser'
      LayoutEngineName                           : 'Blink'
      LayoutEngineVersion                        : '110'
      LayoutEngineVersionMajor                   : '110'
      LayoutEngineNameVersion                    : 'Blink 110'
      LayoutEngineNameVersionMajor               : 'Blink 110'
      AgentClass                                 : 'Browser'
      AgentName                                  : 'Opera GX'
      AgentVersion                               : '96'
      AgentVersionMajor                          : '96'
      AgentNameVersion                           : 'Opera GX 96'
      AgentNameVersionMajor                      : 'Opera GX 96'

      UAClientHintBrands_0_Brand                 : 'Chromium'
      UAClientHintBrands_0_Version               : '110'
      UAClientHintBrands_1_Brand                 : 'Opera GX'
      UAClientHintBrands_1_Version               : '96'
      UAClientHintMobile                         : 'false'
      UAClientHintPlatform                       : 'Windows'


- test:
    input:
      User-Agent                                 : 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.0.0 Safari/537.36 OPR/96.0.0.0'
      Sec-Ch-Ua                                  : '"Not=A?Brand";v="8", "Chromium";v="110", "Opera GX";v="96"'
      Sec-Ch-Ua-Arch                             : '"x86"'
      Sec-Ch-Ua-Bitness                          : '"64"'
      Sec-Ch-Ua-Full-Version                     : '"96.0.4693.117"'
      Sec-Ch-Ua-Full-Version-List                : '"Not=A?Brand";v="8.0.0.0", "Chromium";v="110.0.5481.192", "Opera GX";v="96.0.4693.117"'
      Sec-Ch-Ua-Mobile                           : '?0'
      Sec-Ch-Ua-Model                            : ''
      Sec-Ch-Ua-Platform                         : '"Windows"'
      Sec-Ch-Ua-Platform-Version                 : '"10.0.0"'
      Sec-Ch-Ua-Wow64                            : '?0'
    expected:
      DeviceClass                                : 'Desktop'
      DeviceName                                 : 'Desktop'
      DeviceBrand                                : 'Unknown'
      DeviceCpu                                  : 'Intel x86_64'
      DeviceCpuBits                              : '64'
      OperatingSystemClass                       : 'Desktop'
      OperatingSystemName                        : 'Windows NT'
      OperatingSystemVersion                     : '10'
      OperatingSystemVersionMajor                : '10'
      OperatingSystemNameVersion                 : 'Windows 10'
      OperatingSystemNameVersionMajor            : 'Windows 10'
      LayoutEngineClass                          : 'Browser'
      LayoutEngineName                           : 'Blink'
      LayoutEngineVersion                        : '110.0'
      LayoutEngineVersionMajor                   : '110'
      LayoutEngineNameVersion                    : 'Blink 110.0'
      LayoutEngineNameVersionMajor               : 'Blink 110'
      AgentClass                                 : 'Browser'
      AgentName                                  : 'Opera GX'
      AgentVersion                               : '96.0.4693.117'
      AgentVersionMajor                          : '96'
      AgentNameVersion                           : 'Opera GX 96.0.4693.117'
      AgentNameVersionMajor                      : 'Opera GX 96'

      UAClientHintArchitecture                   : 'x86'
      UAClientHintBitness                        : '64'
      UAClientHintBrands_0_Brand                 : 'Chromium'
      UAClientHintBrands_0_Version               : '110'
      UAClientHintBrands_1_Brand                 : 'Opera GX'
      UAClientHintBrands_1_Version               : '96'
      UAClientHintFullVersion                    : '96.0.4693.117'
      UAClientHintFullVersionList_0_Brand        : 'Chromium'
      UAClientHintFullVersionList_0_Version      : '110.0.5481.192'
      UAClientHintFullVersionList_1_Brand        : 'Opera GX'
      UAClientHintFullVersionList_1_Version      : '96.0.4693.117'
      UAClientHintMobile                         : 'false'
      UAClientHintPlatform                       : 'Windows'
      UAClientHintPlatformVersion                : '10.0.0'
      UAClientHintWow64                          : 'false'


- test:
    input:
      User-Agent                                 : 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.0.0 Safari/537.36 OPR/96.0.0.0 (Edition std-1)'
      Sec-Ch-Ua                                  : '"Not=A?Brand";v="8", "Chromium";v="110", "Opera GX";v="96"'
      Sec-Ch-Ua-Mobile                           : '?0'
      Sec-Ch-Ua-Platform                         : '"macOS"'
    expected:
      DeviceClass                                : 'Desktop'
      DeviceName                                 : 'Apple Macintosh'
      DeviceBrand                                : 'Apple'
      DeviceCpu                                  : 'Intel'
      DeviceCpuBits                              : '64'
      OperatingSystemClass                       : 'Desktop'
      OperatingSystemName                        : 'Mac OS'
      OperatingSystemVersion                     : '>=10.15.7'
      OperatingSystemVersionMajor                : '>=10.15'
      OperatingSystemNameVersion                 : 'Mac OS >=10.15.7'
      OperatingSystemNameVersionMajor            : 'Mac OS >=10.15'
      LayoutEngineClass                          : 'Browser'
      LayoutEngineName                           : 'Blink'
      LayoutEngineVersion                        : '110'
      LayoutEngineVersionMajor                   : '110'
      LayoutEngineNameVersion                    : 'Blink 110'
      LayoutEngineNameVersionMajor               : 'Blink 110'
      AgentClass                                 : 'Browser'
      AgentName                                  : 'Opera GX'
      AgentVersion                               : '96'
      AgentVersionMajor                          : '96'
      AgentNameVersion                           : 'Opera GX 96'
      AgentNameVersionMajor                      : 'Opera GX 96'

      UAClientHintBrands_0_Brand                 : 'Chromium'
      UAClientHintBrands_0_Version               : '110'
      UAClientHintBrands_1_Brand                 : 'Opera GX'
      UAClientHintBrands_1_Version               : '96'
      UAClientHintMobile                         : 'false'
      UAClientHintPlatform                       : 'macOS'


- test:
    input:
      User-Agent                                 : 'Mozilla/5.0 (Linux; Android 11; Nokia 7.2 Build/RKQ1.210607.001) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.5735.196 Mobile Safari/537.36 OPX/2.0'
    expected:
      DeviceClass                                : 'Phone'
      DeviceName                                 : 'Nokia 7.2'
      DeviceBrand                                : 'Nokia'
      OperatingSystemClass                       : 'Mobile'
      OperatingSystemName                        : 'Android'
      OperatingSystemVersion                     : '11'
      OperatingSystemVersionMajor                : '11'
      OperatingSystemNameVersion                 : 'Android 11'
      OperatingSystemNameVersionMajor            : 'Android 11'
      OperatingSystemVersionBuild                : 'RKQ1.210607.001'
      LayoutEngineClass                          : 'Browser'
      LayoutEngineName                           : 'Blink'
      LayoutEngineVersion                        : '114.0'
      LayoutEngineVersionMajor                   : '114'
      LayoutEngineNameVersion                    : 'Blink 114.0'
      LayoutEngineNameVersionMajor               : 'Blink 114'
      AgentClass                                 : 'Browser'
      AgentName                                  : 'Opera GX'
      AgentVersion                               : '2.0'
      AgentVersionMajor                          : '2'
      AgentNameVersion                           : 'Opera GX 2.0'
      AgentNameVersionMajor                      : 'Opera GX 2'


- test:
    input:
      User-Agent                                 : 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36 OPR/100.0.0.0'
      Sec-Ch-Ua                                  : '"Not.A/Brand";v="8", "Chromium";v="114", "Opera GX";v="100"'
      Sec-Ch-Ua-Mobile                           : '?0'
      Sec-Ch-Ua-Platform                         : '"Windows"'
    expected:
      DeviceClass                                : 'Desktop'
      DeviceName                                 : 'Desktop'
      DeviceBrand                                : 'Unknown'
      DeviceCpu                                  : 'Intel x86_64'
      DeviceCpuBits                              : '64'
      OperatingSystemClass                       : 'Desktop'
      OperatingSystemName                        : 'Windows NT'
      OperatingSystemVersion                     : '??'
      OperatingSystemVersionMajor                : '??'
      OperatingSystemNameVersion                 : 'Windows NT ??'
      OperatingSystemNameVersionMajor            : 'Windows NT ??'
      LayoutEngineClass                          : 'Browser'
      LayoutEngineName                           : 'Blink'
      LayoutEngineVersion                        : '114'
      LayoutEngineVersionMajor                   : '114'
      LayoutEngineNameVersion                    : 'Blink 114'
      LayoutEngineNameVersionMajor               : 'Blink 114'
      AgentClass                                 : 'Browser'
      AgentName                                  : 'Opera GX'
      AgentVersion                               : '100'
      AgentVersionMajor                          : '100'
      AgentNameVersion                           : 'Opera GX 100'
      AgentNameVersionMajor                      : 'Opera GX 100'

      UAClientHintBrands_0_Brand                 : 'Chromium'
      UAClientHintBrands_0_Version               : '114'
      UAClientHintBrands_1_Brand                 : 'Opera GX'
      UAClientHintBrands_1_Version               : '100'
      UAClientHintMobile                         : 'false'
      UAClientHintPlatform                       : 'Windows'


- test:
    input:
      User-Agent                                 : 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36 OPR/100.0.0.0'
      Sec-Ch-Ua                                  : '"Not.A/Brand";v="8", "Chromium";v="114", "Opera GX";v="100"'
      Sec-Ch-Ua-Arch                             : '"x86"'
      Sec-Ch-Ua-Bitness                          : '"64"'
      Sec-Ch-Ua-Full-Version                     : '"100.0.4815.82"'
      Sec-Ch-Ua-Full-Version-List                : '"Not.A/Brand";v="8.0.0.0", "Chromium";v="114.0.5735.199", "Opera GX";v="100.0.4815.82"'
      Sec-Ch-Ua-Mobile                           : '?0'
      Sec-Ch-Ua-Model                            : '""'
      Sec-Ch-Ua-Platform                         : '"Windows"'
      Sec-Ch-Ua-Platform-Version                 : '"10.0.0"'
      Sec-Ch-Ua-Wow64                            : '?0'
    expected:
      DeviceClass                                : 'Desktop'
      DeviceName                                 : 'Desktop'
      DeviceBrand                                : 'Unknown'
      DeviceCpu                                  : 'Intel x86_64'
      DeviceCpuBits                              : '64'
      OperatingSystemClass                       : 'Desktop'
      OperatingSystemName                        : 'Windows NT'
      OperatingSystemVersion                     : '10'
      OperatingSystemVersionMajor                : '10'
      OperatingSystemNameVersion                 : 'Windows 10'
      OperatingSystemNameVersionMajor            : 'Windows 10'
      LayoutEngineClass                          : 'Browser'
      LayoutEngineName                           : 'Blink'
      LayoutEngineVersion                        : '114.0'
      LayoutEngineVersionMajor                   : '114'
      LayoutEngineNameVersion                    : 'Blink 114.0'
      LayoutEngineNameVersionMajor               : 'Blink 114'
      AgentClass                                 : 'Browser'
      AgentName                                  : 'Opera GX'
      AgentVersion                               : '100.0.4815.82'
      AgentVersionMajor                          : '100'
      AgentNameVersion                           : 'Opera GX 100.0.4815.82'
      AgentNameVersionMajor                      : 'Opera GX 100'

      UAClientHintArchitecture                   : 'x86'
      UAClientHintBitness                        : '64'
      UAClientHintBrands_0_Brand                 : 'Chromium'
      UAClientHintBrands_0_Version               : '114'
      UAClientHintBrands_1_Brand                 : 'Opera GX'
      UAClientHintBrands_1_Version               : '100'
      UAClientHintFullVersion                    : '100.0.4815.82'
      UAClientHintFullVersionList_0_Brand        : 'Chromium'
      UAClientHintFullVersionList_0_Version      : '114.0.5735.199'
      UAClientHintFullVersionList_1_Brand        : 'Opera GX'
      UAClientHintFullVersionList_1_Version      : '100.0.4815.82'
      UAClientHintMobile                         : 'false'
      UAClientHintPlatform                       : 'Windows'
      UAClientHintPlatformVersion                : '10.0.0'
      UAClientHintWow64                          : 'false'

- test:
    input:
      User-Agent                                 : 'Mozilla/5.0 (Linux; Android 13; SM-S901B Build/TP1A.220624.014) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.5735.196 Mobile Safari/537.36 OPX/2.0'
    expected:
      DeviceClass                                : 'Phone'
      DeviceName                                 : 'Samsung SM-S901B'
      DeviceBrand                                : 'Samsung'
      OperatingSystemClass                       : 'Mobile'
      OperatingSystemName                        : 'Android'
      OperatingSystemVersion                     : '13'
      OperatingSystemVersionMajor                : '13'
      OperatingSystemNameVersion                 : 'Android 13'
      OperatingSystemNameVersionMajor            : 'Android 13'
      OperatingSystemVersionBuild                : 'TP1A.220624.014'
      LayoutEngineClass                          : 'Browser'
      LayoutEngineName                           : 'Blink'
      LayoutEngineVersion                        : '114.0'
      LayoutEngineVersionMajor                   : '114'
      LayoutEngineNameVersion                    : 'Blink 114.0'
      LayoutEngineNameVersionMajor               : 'Blink 114'
      AgentClass                                 : 'Browser'
      AgentName                                  : 'Opera GX'
      AgentVersion                               : '2.0'
      AgentVersionMajor                          : '2'
      AgentNameVersion                           : 'Opera GX 2.0'
      AgentNameVersionMajor                      : 'Opera GX 2'


- test:
    input:
      User-Agent                                 : 'Mozilla/5.0 (iPhone; CPU iPhone OS 16_0_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.0 Mobile/15E148 Safari/604.1 OPX/1.8.0'
    expected:
      DeviceClass                                : 'Phone'
      DeviceName                                 : 'Apple iPhone'
      DeviceBrand                                : 'Apple'
      DeviceFirmwareVersion                      : '15E148'
      DeviceVersion                              : 'iPhone'
      OperatingSystemClass                       : 'Mobile'
      OperatingSystemName                        : 'iOS'
      OperatingSystemVersion                     : '16.0.2'
      OperatingSystemVersionMajor                : '16'
      OperatingSystemNameVersion                 : 'iOS 16.0.2'
      OperatingSystemNameVersionMajor            : 'iOS 16'
      LayoutEngineClass                          : 'Browser'
      LayoutEngineName                           : 'AppleWebKit'
      LayoutEngineVersion                        : '605.1.15'
      LayoutEngineVersionMajor                   : '605'
      LayoutEngineNameVersion                    : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor               : 'AppleWebKit 605'
      AgentClass                                 : 'Browser'
      AgentName                                  : 'Opera GX'
      AgentVersion                               : '1.8.0'
      AgentVersionMajor                          : '1'
      AgentNameVersion                           : 'Opera GX 1.8.0'
      AgentNameVersionMajor                      : 'Opera GX 1'


# Opera with an incorrect version in th Client hints (bug fixed in Opera 98)
# Fixed in Opera 98.0.4725.0  2023-03-06
# https://blogs.opera.com/desktop/changelog-for-98/
#  DNA-105555 Opera version is wrong in Client Hints
- test:
    input:
      User-Agent                                 : 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36 OPR/94.0.0.0'
      Sec-Ch-Ua                                  : '"Chromium";v="108", "Opera";v="94", "Not)A;Brand";v="99"'
      Sec-Ch-Ua-Arch                             : '"x86"'
      Sec-Ch-Ua-Bitness                          : '"64"'
      Sec-Ch-Ua-Full-Version                     : '"108.0.5359.125"'
      Sec-Ch-Ua-Full-Version-List                : '"Not?A_Brand";v="8.0.0.0", "Chromium";v="108.0.5359.125", "Opera";v="108.0.5359.125"'
      Sec-Ch-Ua-Mobile                           : '?0'
      Sec-Ch-Ua-Model                            : ''
      Sec-Ch-Ua-Platform                         : '"Linux"'
      Sec-Ch-Ua-Platform-Version                 : '"5.15.0"'
      Sec-Ch-Ua-Wow64                            : '?0'
    expected:
      DeviceClass                                : 'Desktop'
      DeviceName                                 : 'Linux Desktop'
      DeviceBrand                                : 'Unknown'
      DeviceCpu                                  : 'Intel x86_64'
      DeviceCpuBits                              : '64'
      OperatingSystemClass                       : 'Desktop'
      OperatingSystemName                        : 'Linux'
      OperatingSystemVersion                     : '5.15.0'
      OperatingSystemVersionMajor                : '5'
      OperatingSystemNameVersion                 : 'Linux 5.15.0'
      OperatingSystemNameVersionMajor            : 'Linux 5'
      LayoutEngineClass                          : 'Browser'
      LayoutEngineName                           : 'Blink'
      LayoutEngineVersion                        : '108.0'
      LayoutEngineVersionMajor                   : '108'
      LayoutEngineNameVersion                    : 'Blink 108.0'
      LayoutEngineNameVersionMajor               : 'Blink 108'
      AgentClass                                 : 'Browser'
      AgentName                                  : 'Opera'
      AgentVersion                               : '94.0.0.0'
      AgentVersionMajor                          : '94'
      AgentNameVersion                           : 'Opera 94.0.0.0'
      AgentNameVersionMajor                      : 'Opera 94'

      UAClientHintArchitecture                   : 'x86'
      UAClientHintBitness                        : '64'
      UAClientHintBrands_0_Brand                 : 'Chromium'
      UAClientHintBrands_0_Version               : '108'
      UAClientHintBrands_1_Brand                 : 'Opera'
      UAClientHintBrands_1_Version               : '94'
      UAClientHintFullVersion                    : '108.0.5359.125'
      UAClientHintFullVersionList_0_Brand        : 'Chromium'
      UAClientHintFullVersionList_0_Version      : '108.0.5359.125'
      UAClientHintFullVersionList_1_Brand        : 'Opera'
      UAClientHintFullVersionList_1_Version      : '108.0.5359.125'
      UAClientHintMobile                         : 'false'
      UAClientHintPlatform                       : 'Linux'
      UAClientHintPlatformVersion                : '5.15.0'
      UAClientHintWow64                          : 'false'


# Opera with the full (non-reduced) useragent ( = non-standard setting)
- test:
    input:
      User-Agent                                 : 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.5735.199 Safari/537.36 OPR/100.0.4815.54'
      Sec-Ch-Ua                                  : '"Not.A/Brand";v="8", "Chromium";v="114", "Opera";v="100"'
      Sec-Ch-Ua-Arch                             : '"x86"'
      Sec-Ch-Ua-Bitness                          : '"64"'
      Sec-Ch-Ua-Full-Version                     : '"100.0.4815.54"'
      Sec-Ch-Ua-Full-Version-List                : '"Not.A/Brand";v="8.0.0.0", "Chromium";v="114.0.5735.199", "Opera";v="100.0.4815.54"'
      Sec-Ch-Ua-Mobile                           : '?0'
      Sec-Ch-Ua-Model                            : '""'
      Sec-Ch-Ua-Platform                         : '"Linux"'
      Sec-Ch-Ua-Platform-Version                 : '"5.15.0"'
      Sec-Ch-Ua-Wow64                            : '?0'
    expected:
      DeviceClass                                : 'Desktop'
      DeviceName                                 : 'Linux Desktop'
      DeviceBrand                                : 'Unknown'
      DeviceCpu                                  : 'Intel x86_64'
      DeviceCpuBits                              : '64'
      OperatingSystemClass                       : 'Desktop'
      OperatingSystemName                        : 'Linux'
      OperatingSystemVersion                     : '5.15.0'
      OperatingSystemVersionMajor                : '5'
      OperatingSystemNameVersion                 : 'Linux 5.15.0'
      OperatingSystemNameVersionMajor            : 'Linux 5'
      LayoutEngineClass                          : 'Browser'
      LayoutEngineName                           : 'Blink'
      LayoutEngineVersion                        : '114.0'
      LayoutEngineVersionMajor                   : '114'
      LayoutEngineNameVersion                    : 'Blink 114.0'
      LayoutEngineNameVersionMajor               : 'Blink 114'
      AgentClass                                 : 'Browser'
      AgentName                                  : 'Opera'
      AgentVersion                               : '100.0.4815.54'
      AgentVersionMajor                          : '100'
      AgentNameVersion                           : 'Opera 100.0.4815.54'
      AgentNameVersionMajor                      : 'Opera 100'

      UAClientHintArchitecture                   : 'x86'
      UAClientHintBitness                        : '64'
      UAClientHintBrands_0_Brand                 : 'Chromium'
      UAClientHintBrands_0_Version               : '114'
      UAClientHintBrands_1_Brand                 : 'Opera'
      UAClientHintBrands_1_Version               : '100'
      UAClientHintFullVersion                    : '100.0.4815.54'
      UAClientHintFullVersionList_0_Brand        : 'Chromium'
      UAClientHintFullVersionList_0_Version      : '114.0.5735.199'
      UAClientHintFullVersionList_1_Brand        : 'Opera'
      UAClientHintFullVersionList_1_Version      : '100.0.4815.54'
      UAClientHintMobile                         : 'false'
      UAClientHintPlatform                       : 'Linux'
      UAClientHintPlatformVersion                : '5.15.0'
      UAClientHintWow64                          : 'false'


# Opera with the default (reduced) User-Agent
# Note we now DO pick the version from the Client Hints as it is correct now (version >= 98)
- test:
    input:
      User-Agent                                 : 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36 OPR/100.0.0.0'
      Sec-Ch-Ua                                  : '"Not.A/Brand";v="8", "Chromium";v="114", "Opera";v="100"'
      Sec-Ch-Ua-Arch                             : '"x86"'
      Sec-Ch-Ua-Bitness                          : '"64"'
      Sec-Ch-Ua-Full-Version                     : '"100.0.4815.54"'
      Sec-Ch-Ua-Full-Version-List                : '"Not.A/Brand";v="8.0.0.0", "Chromium";v="114.0.5735.199", "Opera";v="100.0.4815.54"'
      Sec-Ch-Ua-Mobile                           : '?0'
      Sec-Ch-Ua-Model                            : '""'
      Sec-Ch-Ua-Platform                         : '"Linux"'
      Sec-Ch-Ua-Platform-Version                 : '"5.15.0"'
      Sec-Ch-Ua-Wow64                            : '?0'
    expected:
      DeviceClass                                : 'Desktop'
      DeviceName                                 : 'Linux Desktop'
      DeviceBrand                                : 'Unknown'
      DeviceCpu                                  : 'Intel x86_64'
      DeviceCpuBits                              : '64'
      OperatingSystemClass                       : 'Desktop'
      OperatingSystemName                        : 'Linux'
      OperatingSystemVersion                     : '5.15.0'
      OperatingSystemVersionMajor                : '5'
      OperatingSystemNameVersion                 : 'Linux 5.15.0'
      OperatingSystemNameVersionMajor            : 'Linux 5'
      LayoutEngineClass                          : 'Browser'
      LayoutEngineName                           : 'Blink'
      LayoutEngineVersion                        : '114.0'
      LayoutEngineVersionMajor                   : '114'
      LayoutEngineNameVersion                    : 'Blink 114.0'
      LayoutEngineNameVersionMajor               : 'Blink 114'
      AgentClass                                 : 'Browser'
      AgentName                                  : 'Opera'
      AgentVersion                               : '100.0.4815.54'
      AgentVersionMajor                          : '100'
      AgentNameVersion                           : 'Opera 100.0.4815.54'
      AgentNameVersionMajor                      : 'Opera 100'
      UAClientHintArchitecture                   : 'x86'
      UAClientHintBitness                        : '64'
      UAClientHintBrands_0_Brand                 : 'Chromium'
      UAClientHintBrands_0_Version               : '114'
      UAClientHintBrands_1_Brand                 : 'Opera'
      UAClientHintBrands_1_Version               : '100'
      UAClientHintFullVersion                    : '100.0.4815.54'
      UAClientHintFullVersionList_0_Brand        : 'Chromium'
      UAClientHintFullVersionList_0_Version      : '114.0.5735.199'
      UAClientHintFullVersionList_1_Brand        : 'Opera'
      UAClientHintFullVersionList_1_Version      : '100.0.4815.54'
      UAClientHintMobile                         : 'false'
      UAClientHintPlatform                       : 'Linux'
      UAClientHintPlatformVersion                : '5.15.0'
      UAClientHintWow64                          : 'false'


# Opera Mini 71 on Android 11
- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (Linux; U; Android 11; Nokia 7.2 Build/RKQ1.210607.001; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/114.0.5735.227 Mobile Safari/537.36 OPR/71.0.2254.67050'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Nokia 7.2'
      DeviceBrand                          : 'Nokia'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '11'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'Android 11'
      OperatingSystemNameVersionMajor      : 'Android 11'
      OperatingSystemVersionBuild          : 'RKQ1.210607.001'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '114.0'
      LayoutEngineVersionMajor             : '114'
      LayoutEngineNameVersion              : 'Blink 114.0'
      LayoutEngineNameVersionMajor         : 'Blink 114'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera Mini'
      AgentVersion                         : '71.0.2254.67050'
      AgentVersionMajor                    : '71'
      AgentNameVersion                     : 'Opera Mini 71.0.2254.67050'
      AgentNameVersionMajor                : 'Opera Mini 71'
      AgentSecurity                        : 'Strong security'


# Opera on iOS reports itself as "OPT" --> "Opera Touch"
- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (iPhone; CPU iPhone OS 16_6 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.6 Mobile/15E148 Safari/604.1 OPT/4.1.1'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15E148'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '16.6'
      OperatingSystemVersionMajor          : '16'
      OperatingSystemNameVersion           : 'iOS 16.6'
      OperatingSystemNameVersionMajor      : 'iOS 16'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Browser'                 #    12100
      AgentName                            : 'Opera Touch'             #    12100           | FAILED; Should be 'OPT'
      AgentVersion                         : '4.1.1'                   #    12100
      AgentVersionMajor                    : '4'                       #    12100
      AgentNameVersion                     : 'Opera Touch 4.1.1'       #    12100           | FAILED; Should be 'OPT 4.1.1'
      AgentNameVersionMajor                : 'Opera Touch 4'           #    12100           | FAILED; Should be 'OPT 4'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (iPhone; CPU iPhone OS 13_5_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148 OPT/2.6.1'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15E148'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '13.5.1'
      OperatingSystemVersionMajor          : '13'
      OperatingSystemNameVersion           : 'iOS 13.5.1'
      OperatingSystemNameVersionMajor      : 'iOS 13'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera Touch'
      AgentVersion                         : '2.6.1'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Opera Touch 2.6.1'
      AgentNameVersionMajor                : 'Opera Touch 2'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (iPhone; CPU iPhone OS 15_6 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148 OPT/3.2.17'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15E148'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '15.6'
      OperatingSystemVersionMajor          : '15'
      OperatingSystemNameVersion           : 'iOS 15.6'
      OperatingSystemNameVersionMajor      : 'iOS 15'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera Touch'
      AgentVersion                         : '3.2.17'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Opera Touch 3.2.17'
      AgentNameVersionMajor                : 'Opera Touch 3'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (iPhone; CPU iPhone OS 15_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.2 Mobile/15E148 Safari/604.1 OPT/3.2.11'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15E148'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '15.2'
      OperatingSystemVersionMajor          : '15'
      OperatingSystemNameVersion           : 'iOS 15.2'
      OperatingSystemNameVersionMajor      : 'iOS 15'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera Touch'
      AgentVersion                         : '3.2.11'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Opera Touch 3.2.11'
      AgentNameVersionMajor                : 'Opera Touch 3'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (iPhone; CPU iPhone OS 14_6 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) OPT/2.2.0 Mobile/15E148'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15E148'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '14.6'
      OperatingSystemVersionMajor          : '14'
      OperatingSystemNameVersion           : 'iOS 14.6'
      OperatingSystemNameVersionMajor      : 'iOS 14'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera Touch'
      AgentVersion                         : '2.2.0'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Opera Touch 2.2.0'
      AgentNameVersionMajor                : 'Opera Touch 2'


- test:
    input:
      User-Agent                                 : 'Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.5112.102 Mobile Safari/537.36'
      Sec-Ch-Ua                                  : '" Not A;Brand";v="99", "Chromium";v="104", "Opera";v="90"'
      Sec-Ch-Ua-Arch                             : '""'
      Sec-Ch-Ua-Bitness                          : '"64"'
      Sec-Ch-Ua-Full-Version                     : '"104.0.5112.102"'
      Sec-Ch-Ua-Full-Version-List                : '"Chromium";v="104.0.5112.102", " Not A;Brand";v="99.0.0.0", "Opera";v="104.0.5112.102"'
      Sec-Ch-Ua-Mobile                           : '?1'
      Sec-Ch-Ua-Model                            : '"Nexus 5"'
      Sec-Ch-Ua-Platform                         : '"Android"'
      Sec-Ch-Ua-Platform-Version                 : '"6.0"'
      Sec-Ch-Ua-Wow64                            : '?0'
    expected:
      DeviceClass                                : 'Phone'
      DeviceName                                 : 'Google Nexus 5'
      DeviceBrand                                : 'Google'
      DeviceCpuBits                              : '64'
      OperatingSystemClass                       : 'Mobile'
      OperatingSystemName                        : 'Android'
      OperatingSystemVersion                     : '6.0'
      OperatingSystemVersionMajor                : '6'
      OperatingSystemNameVersion                 : 'Android 6.0'
      OperatingSystemNameVersionMajor            : 'Android 6'
      OperatingSystemVersionBuild                : 'MRA58N'
      LayoutEngineClass                          : 'Browser'
      LayoutEngineName                           : 'Blink'
      LayoutEngineVersion                        : '104.0'
      LayoutEngineVersionMajor                   : '104'
      LayoutEngineNameVersion                    : 'Blink 104.0'
      LayoutEngineNameVersionMajor               : 'Blink 104'
      AgentClass                                 : 'Browser'
      AgentName                                  : 'Opera'
      AgentVersion                               : '104.0.5112.102' # The best guess version. NO Opera in the UA and in the CH we see 2 versions: '90' and '104.0.5112.102'
      AgentVersionMajor                          : '104'
      AgentNameVersion                           : 'Opera 104.0.5112.102'
      AgentNameVersionMajor                      : 'Opera 104'

      UAClientHintBitness                        : '64'
      UAClientHintBrands_0_Brand                 : 'Chromium'
      UAClientHintBrands_0_Version               : '104'
      UAClientHintBrands_1_Brand                 : 'Opera'
      UAClientHintBrands_1_Version               : '90'
      UAClientHintFullVersion                    : '104.0.5112.102'
      UAClientHintFullVersionList_0_Brand        : 'Chromium'
      UAClientHintFullVersionList_0_Version      : '104.0.5112.102'
      UAClientHintFullVersionList_1_Brand        : 'Opera'
      UAClientHintFullVersionList_1_Version      : '104.0.5112.102'
      UAClientHintMobile                         : 'true'
      UAClientHintModel                          : 'Nexus 5'
      UAClientHintPlatform                       : 'Android'
      UAClientHintPlatformVersion                : '6.0'
      UAClientHintWow64                          : 'false'

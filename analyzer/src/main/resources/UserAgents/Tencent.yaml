#
# Yet Another UserAgent Analyzer
# Copyright (C) 2013-2018 Niels Basjes
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an AS IS BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#
config:
# Testcases for the WeChat app

# Quote from from https://github.com/browscap/browscap/issues/587
#     MQQBrowser is Tencent's Cross Platform WebView Framework for WeChat & QQ inner WebView.

# As indicated by https://github.com/pkptzx
#    QQ Browser is Tencent's Browser product.
#    so , Tencent's else product with Browser ,all base QQ Browser.
#    if only have 'MQQBrowser' tag , then QQ Browser.
#    if 'MicroMessenger' then WeChat App.
#    if contain 'MQQBrowser' and 'QQ' then QQ app/windows client


# ************************************************************
# **** The useragent variations of this thing look like a big mess.
# **** It looks like every system/version combination uses a different pattern in the useragent string
# **** Sometimes with/without MQQBrowser, sometimes chrome webview, ...
# So for this thing I force it to be a MobileApp (without webview, which may actually be wrong)

#- matcher:
#    require:
#    - 'agent.product.(1)name="MQQBrowser"'
#    - 'agent.product.(1)name="Safari"'
#    extract:
#    - 'DeviceClass                 :   99:"Tablet"'

- matcher:
    require:
    - 'agent.product.(1)name="Mobile MQQBrowser"'
    - 'agent.product.(1)name="Safari"'
    extract:
    - 'DeviceClass                 :  1100:"Phone"'

- matcher:
    require:
    - 'IsNull[agent.product.(1)name="QQ"]'
    - 'IsNull[agent.product.(1)name="MicroMessenger"]'
    extract:
    - 'AgentClass                 :  15000:"Browser"'
    - 'AgentName                  :  15000:"QQ Browser"'
    - 'AgentVersion               :  15000:agent.product.(1)name="MQQBrowser"^.version'
    - 'WebviewAppName             :     12:"<<<null>>>"'
    - 'WebviewAppNameVersionMajor :     12:"<<<null>>>"'
    - 'WebviewAppVersion          :     12:"<<<null>>>"'
    - 'WebviewAppVersionMajor     :     12:"<<<null>>>"'

- matcher:
    extract:
    - 'AgentClass                 :  15001:"Browser"'
    - 'AgentName                  :  15001:"QQ Client"'
    - 'AgentVersion               :  15001:agent.product.(1)name="QQ"^.version'
    - 'WebviewAppName             :     12:"<<<null>>>"'
    - 'WebviewAppNameVersionMajor :     12:"<<<null>>>"'
    - 'WebviewAppVersion          :     12:"<<<null>>>"'
    - 'WebviewAppVersionMajor     :     12:"<<<null>>>"'

# For the " V1_AND_SQ_6.5.5_410_YYB_D QQ/6.5.5.2880 " case.
- matcher:
    extract:
    - 'AgentClass                 :  15002:"Browser"'
    - 'AgentName                  :  15002:"QQ Client"'
    - 'AgentVersion               :  15002:agent.product.(1)name}" QQ"^.version'
    - 'WebviewAppName             :     12:"<<<null>>>"'
    - 'WebviewAppNameVersionMajor :     12:"<<<null>>>"'
    - 'WebviewAppVersion          :     12:"<<<null>>>"'
    - 'WebviewAppVersionMajor     :     12:"<<<null>>>"'

- matcher:
    extract:
    - 'AgentClass                 :  15003:"Mobile App"'
    - 'AgentName                  :  15003:"WeChat"'
    - 'AgentVersion               :  15003:agent.product.(1)name="MicroMessenger"^.version'
    - 'WebviewAppName             :     12:"<<<null>>>"'
    - 'WebviewAppNameVersionMajor :     12:"<<<null>>>"'
    - 'WebviewAppVersion          :     12:"<<<null>>>"'
    - 'WebviewAppVersionMajor     :     12:"<<<null>>>"'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 4.4.2; zh-cn; PE-TL20 Build/HuaweiPE-TL20) AppleWebKit/533.1 (KHTML, like Gecko)Version/4.0 MQQBrowser/5.4 TBS/025440 Mobile Safari/533.1 MicroMessenger/6.2.5.53_r2565f18.621 NetType/WIFI Language/zh_CN'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Huawei PE-TL20'
      DeviceBrand                          : 'Huawei'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.4.2'
      OperatingSystemNameVersion           : 'Android 4.4.2'
      OperatingSystemVersionBuild          : 'HuaweiPE-TL20'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '533.1'
      LayoutEngineVersionMajor             : '533'
      LayoutEngineNameVersion              : 'AppleWebKit 533.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 533'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '6.2.5.53_r2565f18.621'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'WeChat 6.2.5.53_r2565f18.621'
      AgentNameVersionMajor                : 'WeChat 6'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 4.4.2; zh-cn; HM NOTE 1LTETD Build/KVT49L) AppleWebKit/533.1 (KHTML, like Gecko)Version/4.0 MQQBrowser/5.4 TBS/025410 Mobile Safari/533.1 MicroMessenger/6.1.0.66_r1062275.542 NetType/cmnet'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Xiaomi Redmi Note 4'
      DeviceBrand                          : 'Xiaomi'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.4.2'
      OperatingSystemNameVersion           : 'Android 4.4.2'
      OperatingSystemVersionBuild          : 'KVT49L'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '533.1'
      LayoutEngineVersionMajor             : '533'
      LayoutEngineNameVersion              : 'AppleWebKit 533.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 533'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '6.1.0.66_r1062275.542'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'WeChat 6.1.0.66_r1062275.542'
      AgentNameVersionMajor                : 'WeChat 6'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 7_0_2 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko) Mobile/11A501 MicroMessenger/6.1.1 NetType/2G'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '11A501'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '7.0.2'
      OperatingSystemNameVersion           : 'iOS 7.0.2'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.51.1'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.51.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '6.1.1'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'WeChat 6.1.1'
      AgentNameVersionMajor                : 'WeChat 6'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 4.4.2; zh-cn; SM-N9008V Build/KOT49H) AppleWebKit/533.1 (KHTML, like Gecko)Version/4.0 MQQBrowser/5.4 TBS/025410 Mobile Safari/533.1 MicroMessenger/6.1.0.66_r1062275.542 NetType/cmnet'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung SM-N9008V'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.4.2'
      OperatingSystemNameVersion           : 'Android 4.4.2'
      OperatingSystemVersionBuild          : 'KOT49H'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '533.1'
      LayoutEngineVersionMajor             : '533'
      LayoutEngineNameVersion              : 'AppleWebKit 533.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 533'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '6.1.0.66_r1062275.542'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'WeChat 6.1.0.66_r1062275.542'
      AgentNameVersionMajor                : 'WeChat 6'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      AgentSecurity                        : 'Strong security'



- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 4.4.4; zh-cn; HTC D820mu Build/KTU84P) AppleWebKit/533.1 (KHTML, like Gecko)Version/4.0 MQQBrowser/5.4 TBS/025410 Mobile Safari/533.1 MicroMessenger/6.1.0.66_r1062275.542 NetType/WIFI'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'HTC D820MU'
      DeviceBrand                          : 'HTC'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.4.4'
      OperatingSystemNameVersion           : 'Android 4.4.4'
      OperatingSystemVersionBuild          : 'KTU84P'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '533.1'
      LayoutEngineVersionMajor             : '533'
      LayoutEngineNameVersion              : 'AppleWebKit 533.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 533'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '6.1.0.66_r1062275.542'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'WeChat 6.1.0.66_r1062275.542'
      AgentNameVersionMajor                : 'WeChat 6'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 4.4.2; GT-N7100 Build/KOT49H) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/30.0.0.0 Mobile Safari/537.36 MicroMessenger/6.1.0.66_r1062275.542 NetType/cmnet'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung GT-N7100'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.4.2'
      OperatingSystemNameVersion           : 'Android 4.4.2'
      OperatingSystemVersionBuild          : 'KOT49H'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '30.0'
      LayoutEngineVersionMajor             : '30'
      LayoutEngineNameVersion              : 'Blink 30.0'
      LayoutEngineNameVersionMajor         : 'Blink 30'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '6.1.0.66_r1062275.542'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'WeChat 6.1.0.66_r1062275.542'
      AgentNameVersionMajor                : 'WeChat 6'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 4.4.4; zh-cn; N918St Build/KTU84P) AppleWebKit/533.1 (KHTML, like Gecko)Version/4.0 MQQBrowser/5.4 TBS/025410 Mobile Safari/533.1 MicroMessenger/6.1.0.66_r1062275.542 NetType/3gnet'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'N918ST'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.4.4'
      OperatingSystemNameVersion           : 'Android 4.4.4'
      OperatingSystemVersionBuild          : 'KTU84P'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '533.1'
      LayoutEngineVersionMajor             : '533'
      LayoutEngineNameVersion              : 'AppleWebKit 533.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 533'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '6.1.0.66_r1062275.542'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'WeChat 6.1.0.66_r1062275.542'
      AgentNameVersionMajor                : 'WeChat 6'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 4.3; zh-cn; HM 1SC Build/JLS36C) AppleWebKit/533.1 (KHTML, like Gecko)Version/4.0 MQQBrowser/5.4 TBS/025410 Mobile Safari/533.1 MicroMessenger/6.1.0.66_r1062275.542 NetType/#777'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Xiaomi Redmi Note 4'
      DeviceBrand                          : 'Xiaomi'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.3'
      OperatingSystemNameVersion           : 'Android 4.3'
      OperatingSystemVersionBuild          : 'JLS36C'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '533.1'
      LayoutEngineVersionMajor             : '533'
      LayoutEngineNameVersion              : 'AppleWebKit 533.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 533'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '6.1.0.66_r1062275.542'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'WeChat 6.1.0.66_r1062275.542'
      AgentNameVersionMajor                : 'WeChat 6'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 4.2.2; zh-cn; vivo Y22 Build/JDQ39) AppleWebKit/533.1 (KHTML, like Gecko)Version/4.0 MQQBrowser/5.4 TBS/025410 Mobile Safari/533.1 MicroMessenger/6.1.0.66_r1062275.542 NetType/WIFI'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Vivo Y22'
      DeviceBrand                          : 'Vivo'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.2.2'
      OperatingSystemNameVersion           : 'Android 4.2.2'
      OperatingSystemVersionBuild          : 'JDQ39'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '533.1'
      LayoutEngineVersionMajor             : '533'
      LayoutEngineNameVersion              : 'AppleWebKit 533.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 533'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '6.1.0.66_r1062275.542'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'WeChat 6.1.0.66_r1062275.542'
      AgentNameVersionMajor                : 'WeChat 6'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 4.1.2; zh-cn; GT-I9128V Build/JZO54K) AppleWebKit/533.1 (KHTML, like Gecko)Version/4.0 MQQBrowser/5.4 TBS/025410 Mobile Safari/533.1 MicroMessenger/6.1.0.66_r1062275.542 NetType/WIFI'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung GT-I9128V'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.1.2'
      OperatingSystemNameVersion           : 'Android 4.1.2'
      OperatingSystemVersionBuild          : 'JZO54K'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '533.1'
      LayoutEngineVersionMajor             : '533'
      LayoutEngineNameVersion              : 'AppleWebKit 533.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 533'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '6.1.0.66_r1062275.542'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'WeChat 6.1.0.66_r1062275.542'
      AgentNameVersionMajor                : 'WeChat 6'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 4.4.2; zh-cn; HUAWEI MT2-L01 Build/HuaweiMT2-L01) AppleWebKit/533.1 (KHTML, like Gecko)Version/4.0 MQQBrowser/5.7 Mobile Safari/533.1 MicroMessenger/6.0.2.56_r958800.520 NetType/cmnet'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Huawei MT2-L01'
      DeviceBrand                          : 'Huawei'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.4.2'
      OperatingSystemNameVersion           : 'Android 4.4.2'
      OperatingSystemVersionBuild          : 'HuaweiMT2-L01'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '533.1'
      LayoutEngineVersionMajor             : '533'
      LayoutEngineNameVersion              : 'AppleWebKit 533.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 533'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '6.0.2.56_r958800.520'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'WeChat 6.0.2.56_r958800.520'
      AgentNameVersionMajor                : 'WeChat 6'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.95 Safari/537.36 MicroMessenger/6.5.2.501 NetType/WIFI WindowsWechat QBCore/3.43.27.400 QQBrowser/9.0.2524.400'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : 'Windows 7'
      OperatingSystemNameVersion           : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '39.0'
      LayoutEngineVersionMajor             : '39'
      LayoutEngineNameVersion              : 'Blink 39.0'
      LayoutEngineNameVersionMajor         : 'Blink 39'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '6.5.2.501'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'WeChat 6.5.2.501'
      AgentNameVersionMajor                : 'WeChat 6'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 5.1.1; SM801 Build/LMY47V; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/53.0.2785.49 Mobile MQQBrowser/6.2 TBS/043024 Safari/537.36 MicroMessenger/6.5.4.1000 NetType/4G Language/zh_CN'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Smartisan SM801'
      DeviceBrand                          : 'Smartisan'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '5.1.1'
      OperatingSystemNameVersion           : 'Android 5.1.1'
      OperatingSystemVersionBuild          : 'LMY47V'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '53.0'
      LayoutEngineVersionMajor             : '53'
      LayoutEngineNameVersion              : 'Blink 53.0'
      LayoutEngineNameVersionMajor         : 'Blink 53'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '6.5.4.1000'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'WeChat 6.5.4.1000'
      AgentNameVersionMajor                : 'WeChat 6'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 6.0.1; SM919 Build/MXB48T; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/53.0.2785.49 Mobile MQQBrowser/6.2 TBS/043024 Safari/537.36 MicroMessenger/6.5.4.1000 NetType/WIFI Language/zh_CN'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Smartisan SM919'
      DeviceBrand                          : 'Smartisan'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '6.0.1'
      OperatingSystemNameVersion           : 'Android 6.0.1'
      OperatingSystemVersionBuild          : 'MXB48T'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '53.0'
      LayoutEngineVersionMajor             : '53'
      LayoutEngineNameVersion              : 'Blink 53.0'
      LayoutEngineNameVersionMajor         : 'Blink 53'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '6.5.4.1000'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'WeChat 6.5.4.1000'
      AgentNameVersionMajor                : 'WeChat 6'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 5.1.1; SM801 Build/LMY47V; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/53.0.2785.49 Mobile MQQBrowser/6.2 TBS/043024 Safari/537.36 MicroMessenger/6.5.4.1000 NetType/4G Language/zh_CN'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Smartisan SM801'
      DeviceBrand                          : 'Smartisan'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '5.1.1'
      OperatingSystemNameVersion           : 'Android 5.1.1'
      OperatingSystemVersionBuild          : 'LMY47V'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '53.0'
      LayoutEngineVersionMajor             : '53'
      LayoutEngineNameVersion              : 'Blink 53.0'
      LayoutEngineNameVersionMajor         : 'Blink 53'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '6.5.4.1000'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'WeChat 6.5.4.1000'
      AgentNameVersionMajor                : 'WeChat 6'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 9_3_4 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13G35 QQ/6.5.3.410 V1_IPH_SQ_6.5.3_1_APP_A Pixel/750 Core/UIWebView NetType/2G Mem/117'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '13G35'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '9.3.4'
      OperatingSystemNameVersion           : 'iOS 9.3.4'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '601.1.46'
      LayoutEngineVersionMajor             : '601'
      LayoutEngineNameVersion              : 'AppleWebKit 601.1.46'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 601'
      AgentClass                           : 'Browser'
      AgentName                            : 'QQ Client'
      AgentVersion                         : '6.5.3.410'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'QQ Client 6.5.3.410'
      AgentNameVersionMajor                : 'QQ Client 6'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 4.4.4; zh-cn; MX4 Pro Build/KTU84P) AppleWebKit/533.1 (KHTML, like Gecko)Version/4.0 MQQBrowser/5.4 TBS/025469 Mobile Safari/533.1 MicroMessenger/6.2.0.52_r1162382.561 NetType/WIFI Language/zh_CN QQ/6.6.0.2935'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Meizu MX4 PRO'
      DeviceBrand                          : 'Meizu'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.4.4'
      OperatingSystemNameVersion           : 'Android 4.4.4'
      OperatingSystemVersionBuild          : 'KTU84P'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '533.1'
      LayoutEngineVersionMajor             : '533'
      LayoutEngineNameVersion              : 'AppleWebKit 533.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 533'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '6.2.0.52_r1162382.561'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'WeChat 6.2.0.52_r1162382.561'
      AgentNameVersionMajor                : 'WeChat 6'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone 5SGLOBAL; CPU iPhone OS 10_0_2 like Mac OS X) AppleWebKit/602.1.50 (KHTML, like Gecko) Version/10.0 MQQBrowser/7.2.1 Mobile/14A456 Safari/8536.25 MttCustomUA/2 QBWebViewType/1'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : '5SGLOBAL'
      DeviceFirmwareVersion                : '14A456'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '10.0.2'
      OperatingSystemNameVersion           : 'iOS 10.0.2'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '602.1.50'
      LayoutEngineVersionMajor             : '602'
      LayoutEngineNameVersion              : 'AppleWebKit 602.1.50'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 602'
      AgentClass                           : 'Browser'
      AgentName                            : 'QQ Browser'
      AgentVersion                         : '7.2.1'
      AgentVersionMajor                    : '7'
      AgentNameVersion                     : 'QQ Browser 7.2.1'
      AgentNameVersionMajor                : 'QQ Browser 7'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 6.0; zh-cn; PLK-AL10 Build/HONORPLK-AL10) AppleWebKit/537.36 (KHTML, like Gecko)Version/4.0 Chrome/37.0.0.0 MQQBrowser/6.0 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Huawei PLK-AL10'
      DeviceBrand                          : 'Huawei'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '6.0'
      OperatingSystemNameVersion           : 'Android 6.0'
      OperatingSystemVersionBuild          : 'HONORPLK-AL10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '37.0'
      LayoutEngineVersionMajor             : '37'
      LayoutEngineNameVersion              : 'Blink 37.0'
      LayoutEngineNameVersionMajor         : 'Blink 37'
      AgentClass                           : 'Browser'
      AgentName                            : 'QQ Browser'
      AgentVersion                         : '6.0'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'QQ Browser 6.0'
      AgentNameVersionMajor                : 'QQ Browser 6'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 5.0.2; zh-cn; MI 2S Build/LRX22G) AppleWebKit/533.1 (KHTML, like Gecko)Version/4.0 MQQBrowser/5.4 TBS/025489 Mobile Safari/533.1 V1_AND_SQ_6.2.3_336_YYB_D QQ/6.2.3.2700 NetType/WIFI WebP/0.3.0 Pixel/720'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Xiaomi MI 2S'
      DeviceBrand                          : 'Xiaomi'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '5.0.2'
      OperatingSystemNameVersion           : 'Android 5.0.2'
      OperatingSystemVersionBuild          : 'LRX22G'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '533.1'
      LayoutEngineVersionMajor             : '533'
      LayoutEngineNameVersion              : 'AppleWebKit 533.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 533'
      AgentClass                           : 'Browser'
      AgentName                            : 'QQ Client'
      AgentVersion                         : '6.2.3.2700'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'QQ Client 6.2.3.2700'
      AgentNameVersionMajor                : 'QQ Client 6'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 6.0; HUAWEI VNS-DL00 Build/HUAWEIVNS-DL00; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/53.0.2785.49 Mobile MQQBrowser/6.2 TBS/043670 Safari/537.36 MicroMessenger/6.5.16.1120 NetType/WIFI Language/zh_CN'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Huawei VNS-DL00'
      DeviceBrand                          : 'Huawei'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '6.0'
      OperatingSystemNameVersion           : 'Android 6.0'
      OperatingSystemVersionBuild          : 'HUAWEIVNS-DL00'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '53.0'
      LayoutEngineVersionMajor             : '53'
      LayoutEngineNameVersion              : 'Blink 53.0'
      LayoutEngineNameVersionMajor         : 'Blink 53'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '6.5.16.1120'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'WeChat 6.5.16.1120'
      AgentNameVersionMajor                : 'WeChat 6'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 7.1.1; TA-1000 Build/NMF26F; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/53.0.2785.49 Mobile MQQBrowser/6.2 TBS/043128 Safari/537.36 MicroMessenger/6.5.7.1041 NetType/WIFI Language/zh_CN'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'TA 1000'
      DeviceBrand                          : 'TA'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.1.1'
      OperatingSystemNameVersion           : 'Android 7.1.1'
      OperatingSystemVersionBuild          : 'NMF26F'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '53.0'
      LayoutEngineVersionMajor             : '53'
      LayoutEngineNameVersion              : 'Blink 53.0'
      LayoutEngineNameVersionMajor         : 'Blink 53'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '6.5.7.1041'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'WeChat 6.5.7.1041'
      AgentNameVersionMajor                : 'WeChat 6'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 7.0; MHA-AL00 Build/HUAWEIMHA-AL00; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/53.0.2785.49 Mobile MQQBrowser/6.2 TBS/043613 Safari/537.36 V1_AND_SQ_6.6.9_482_YYB_D QQ/6.6.9.3060 NetType/2G WebP/0.3.0 Pixel/1080'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Huawei MHA-AL00'
      DeviceBrand                          : 'Huawei'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.0'
      OperatingSystemNameVersion           : 'Android 7.0'
      OperatingSystemVersionBuild          : 'HUAWEIMHA-AL00'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '53.0'
      LayoutEngineVersionMajor             : '53'
      LayoutEngineNameVersion              : 'Blink 53.0'
      LayoutEngineNameVersionMajor         : 'Blink 53'
      AgentClass                           : 'Browser'
      AgentName                            : 'QQ Client'
      AgentVersion                         : '6.6.9.3060'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'QQ Client 6.6.9.3060'
      AgentNameVersionMajor                : 'QQ Client 6'



- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 6.0; Le X620 Build/HEXCNFN5902303291S; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/53.0.2785.49 Mobile MQQBrowser/6.2 TBS/043128 Safari/537.36 MicroMessenger/6.5.7.1041 NetType/WIFI Language/zh_CN'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'LE X620'
      DeviceBrand                          : 'LE'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '6.0'
      OperatingSystemNameVersion           : 'Android 6.0'
      OperatingSystemVersionBuild          : 'HEXCNFN5902303291S'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '53.0'
      LayoutEngineVersionMajor             : '53'
      LayoutEngineNameVersion              : 'Blink 53.0'
      LayoutEngineNameVersionMajor         : 'Blink 53'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '6.5.7.1041'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'WeChat 6.5.7.1041'
      AgentNameVersionMajor                : 'WeChat 6'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 7.1.1; MI 6 Build/NMF26X; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/53.0.2785.49 Mobile MQQBrowser/6.2 TBS/043670 Safari/537.36 V1_AND_SQ_7.1.8_718_YYB_D QQ/7.1.8.3240 NetType/WIFI WebP/0.3.0 Pixel/1080'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Xiaomi MI 6'
      DeviceBrand                          : 'Xiaomi'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.1.1'
      OperatingSystemNameVersion           : 'Android 7.1.1'
      OperatingSystemVersionBuild          : 'NMF26X'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '53.0'
      LayoutEngineVersionMajor             : '53'
      LayoutEngineNameVersion              : 'Blink 53.0'
      LayoutEngineNameVersionMajor         : 'Blink 53'
      AgentClass                           : 'Browser'
      AgentName                            : 'QQ Client'
      AgentVersion                         : '7.1.8.3240'
      AgentVersionMajor                    : '7'
      AgentNameVersion                     : 'QQ Client 7.1.8.3240'
      AgentNameVersionMajor                : 'QQ Client 7'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 7.0; SM-C7000 Build/NRD90M; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/53.0.2785.49 Mobile MQQBrowser/6.2 TBS/043670 Safari/537.36 V1_AND_SQ_7.2.0_730_YYB_D QQ/7.2.0.3270 NetType/WIFI WebP/0.3.0 Pixel/1080'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung SM-C7000'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.0'
      OperatingSystemNameVersion           : 'Android 7.0'
      OperatingSystemVersionBuild          : 'NRD90M'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '53.0'
      LayoutEngineVersionMajor             : '53'
      LayoutEngineNameVersion              : 'Blink 53.0'
      LayoutEngineNameVersionMajor         : 'Blink 53'
      AgentClass                           : 'Browser'
      AgentName                            : 'QQ Client'
      AgentVersion                         : '7.2.0.3270'
      AgentVersionMajor                    : '7'
      AgentNameVersion                     : 'QQ Client 7.2.0.3270'
      AgentNameVersionMajor                : 'QQ Client 7'


# Phone classified as Unknown --> Caused by a new example of tagging iPhone versions.
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone1 01; CPU iPhone OS 11_2_5 like Mac OS X) AppleWebKit/604.3.5 (KHTML, like Gecko) Version/11.0 MQQBrowser/8.3.0 Mobile/15B87 Safari/604.1 MttCustomUA/2 QBWebViewType/1 WKType/1'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15B87'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '11.2.5'
      OperatingSystemNameVersion           : 'iOS 11.2.5'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '604.3.5'
      LayoutEngineVersionMajor             : '604'
      LayoutEngineNameVersion              : 'AppleWebKit 604.3.5'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 604'
      AgentClass                           : 'Browser'
      AgentName                            : 'QQ Browser'
      AgentVersion                         : '8.3.0'
      AgentVersionMajor                    : '8'
      AgentNameVersion                     : 'QQ Browser 8.3.0'
      AgentNameVersionMajor                : 'QQ Browser 8'

# Phone classified as Unknown --> Caused by a new example of tagging iPhone versions.
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone1 06; CPU iPhone OS 11_1 like Mac OS X) AppleWebKit/604.3.5 (KHTML, like Gecko) Version/11.0 MQQBrowser/8.0.2 Mobile/15B87 Safari/8536.25 MttCustomUA/2 QBWebViewType/1 WKType/1'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15B87'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '11.1'
      OperatingSystemNameVersion           : 'iOS 11.1'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '604.3.5'
      LayoutEngineVersionMajor             : '604'
      LayoutEngineNameVersion              : 'AppleWebKit 604.3.5'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 604'
      AgentClass                           : 'Browser'
      AgentName                            : 'QQ Browser'
      AgentVersion                         : '8.0.2'
      AgentVersionMajor                    : '8'
      AgentNameVersion                     : 'QQ Browser 8.0.2'
      AgentNameVersionMajor                : 'QQ Browser 8'

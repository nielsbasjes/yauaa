#
# Yet Another UserAgent Analyzer
# Copyright (C) 2013-2024 Niels Basjes
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# https://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an AS IS BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#
config:
# Testcases for the WeChat app

# Quote from from https://github.com/browscap/browscap/issues/587
#     MQQBrowser is Tencent's Cross Platform WebView Framework for WeChat & QQ inner WebView.

# As indicated by https://github.com/pkptzx
#    QQ Browser is Tencent's Browser product.
#    so , Tencent's else product with Browser ,all base QQ Browser.
#    if only have 'MQQBrowser' tag , then QQ Browser.
#    if 'MicroMessenger' then WeChat App.
#    if contain 'MQQBrowser' and 'QQ' then QQ app/windows client


# ************************************************************
# **** The useragent variations of this thing look like a big mess.
# **** It looks like every system/version combination uses a different pattern in the useragent string
# **** Sometimes with/without MQQBrowser, sometimes chrome webview, ...
# So for this thing I force it to be a MobileApp (without webview, which may actually be wrong)

#- matcher:
#    require:
#    - 'agent.product.name="MQQBrowser"'
#    - 'agent.product.name="Safari"'
#    extract:
#    - 'DeviceClass                 :   99:"Tablet"'

- matcher:
    require:
    - 'agent.product.name="Mobile MQQBrowser"'
    - 'agent.product.name="Safari"'
    extract:
    - 'DeviceClass                         :     1100 :"Phone"'

- matcher:
    require:
    - 'IsNull[agent.product.name="QQ"]'
    - 'IsNull[agent.product.name="MicroMessenger"]'
    extract:
    - 'AgentClass                          :    15000 :"Browser"'
    - 'AgentName                           :    15000 :"QQ Browser"'
    - 'AgentVersion                        :    15000 :agent.product.name="MQQBrowser"^.version'
    - 'WebviewAppName                      :       12 :"<<<null>>>"'
    - 'WebviewAppNameVersionMajor          :       12 :"<<<null>>>"'
    - 'WebviewAppVersion                   :       12 :"<<<null>>>"'
    - 'WebviewAppVersionMajor              :       12 :"<<<null>>>"'

- matcher:
    require:
    - 'IsNull[agent.product.name="QQ"]'
    - 'IsNull[agent.product.name="MicroMessenger"]'
    extract:
    - 'AgentClass                          :    15000 :"Browser"'
    - 'AgentName                           :    15000 :"QQ Browser"'
    - 'AgentVersion                        :    15000 :agent.product.name="QQBrowser"^.version'
    - 'WebviewAppName                      :       12 :"<<<null>>>"'
    - 'WebviewAppNameVersionMajor          :       12 :"<<<null>>>"'
    - 'WebviewAppVersion                   :       12 :"<<<null>>>"'
    - 'WebviewAppVersionMajor              :       12 :"<<<null>>>"'

- matcher:
    extract:
    - 'AgentClass                          :    15001 :"Browser"'
    - 'AgentName                           :    15001 :"QQ Client"'
    - 'AgentVersion                        :    15001 :agent.product.name="QQ"^.version'
    - 'WebviewAppName                      :       12 :"<<<null>>>"'
    - 'WebviewAppNameVersionMajor          :       12 :"<<<null>>>"'
    - 'WebviewAppVersion                   :       12 :"<<<null>>>"'
    - 'WebviewAppVersionMajor              :       12 :"<<<null>>>"'

# For the " V1_AND_SQ_6.5.5_410_YYB_D QQ/6.5.5.2880 " case.
- matcher:
    extract:
    - 'AgentClass                          :    15002 :"Browser"'
    - 'AgentName                           :    15002 :"QQ Client"'
    - 'AgentVersion                        :    15002 :agent.product.name}" QQ"^.version'
    - 'WebviewAppName                      :       12 :"<<<null>>>"'
    - 'WebviewAppNameVersionMajor          :       12 :"<<<null>>>"'
    - 'WebviewAppVersion                   :       12 :"<<<null>>>"'
    - 'WebviewAppVersionMajor              :       12 :"<<<null>>>"'

- matcher:
    extract:
    - 'AgentClass                          :    15003 :"Mobile App"'
    - 'AgentName                           :    15003 :"WeChat"'
    - 'AgentVersion                        :    15003 :agent.product.name="MicroMessenger"^.version'
    - 'WebviewAppName                      :       12 :"<<<null>>>"'
    - 'WebviewAppNameVersionMajor          :       12 :"<<<null>>>"'
    - 'WebviewAppVersion                   :       12 :"<<<null>>>"'
    - 'WebviewAppVersionMajor              :       12 :"<<<null>>>"'

- matcher:
    extract:
    - 'NetworkType                         :        1 :agent.(1-15)product.name="NetType"^.version'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 4.4.2; zh-cn; PE-TL20 Build/HuaweiPE-TL20) AppleWebKit/533.1 (KHTML, like Gecko)Version/4.0 MQQBrowser/5.4 TBS/025440 Mobile Safari/533.1 MicroMessenger/6.2.5.53_r2565f18.621 NetType/WIFI Language/zh_CN'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Huawei PE-TL20'
      DeviceBrand                          : 'Huawei'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.4.2'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.4.2'
      OperatingSystemNameVersionMajor      : 'Android 4'
      OperatingSystemVersionBuild          : 'HuaweiPE-TL20'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '533.1'
      LayoutEngineVersionMajor             : '533'
      LayoutEngineNameVersion              : 'AppleWebKit 533.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 533'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '6.2.5.53_r2565f18.621'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'WeChat 6.2.5.53_r2565f18.621'
      AgentNameVersionMajor                : 'WeChat 6'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      AgentSecurity                        : 'Strong security'
      NetworkType                          : 'Wifi'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 4.4.2; zh-cn; HM NOTE 1LTETD Build/KVT49L) AppleWebKit/533.1 (KHTML, like Gecko)Version/4.0 MQQBrowser/5.4 TBS/025410 Mobile Safari/533.1 MicroMessenger/6.1.0.66_r1062275.542 NetType/cmnet'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Xiaomi Redmi Note 4'
      DeviceBrand                          : 'Xiaomi'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.4.2'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.4.2'
      OperatingSystemNameVersionMajor      : 'Android 4'
      OperatingSystemVersionBuild          : 'KVT49L'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '533.1'
      LayoutEngineVersionMajor             : '533'
      LayoutEngineNameVersion              : 'AppleWebKit 533.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 533'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '6.1.0.66_r1062275.542'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'WeChat 6.1.0.66_r1062275.542'
      AgentNameVersionMajor                : 'WeChat 6'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      AgentSecurity                        : 'Strong security'
      NetworkType                          : 'Cmnet'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 7_0_2 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko) Mobile/11A501 MicroMessenger/6.1.1 NetType/2G'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '11A501'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '7.0.2'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'iOS 7.0.2'
      OperatingSystemNameVersionMajor      : 'iOS 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.51.1'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.51.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '6.1.1'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'WeChat 6.1.1'
      AgentNameVersionMajor                : 'WeChat 6'
      NetworkType                          : '2G'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 4.4.2; zh-cn; SM-N9008V Build/KOT49H) AppleWebKit/533.1 (KHTML, like Gecko)Version/4.0 MQQBrowser/5.4 TBS/025410 Mobile Safari/533.1 MicroMessenger/6.1.0.66_r1062275.542 NetType/cmnet'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung SM-N9008V'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.4.2'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.4.2'
      OperatingSystemNameVersionMajor      : 'Android 4'
      OperatingSystemVersionBuild          : 'KOT49H'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '533.1'
      LayoutEngineVersionMajor             : '533'
      LayoutEngineNameVersion              : 'AppleWebKit 533.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 533'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '6.1.0.66_r1062275.542'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'WeChat 6.1.0.66_r1062275.542'
      AgentNameVersionMajor                : 'WeChat 6'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      AgentSecurity                        : 'Strong security'
      NetworkType                          : 'Cmnet'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 4.4.4; zh-cn; HTC D820mu Build/KTU84P) AppleWebKit/533.1 (KHTML, like Gecko)Version/4.0 MQQBrowser/5.4 TBS/025410 Mobile Safari/533.1 MicroMessenger/6.1.0.66_r1062275.542 NetType/WIFI'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'HTC D820MU'
      DeviceBrand                          : 'HTC'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.4.4'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.4.4'
      OperatingSystemNameVersionMajor      : 'Android 4'
      OperatingSystemVersionBuild          : 'KTU84P'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '533.1'
      LayoutEngineVersionMajor             : '533'
      LayoutEngineNameVersion              : 'AppleWebKit 533.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 533'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '6.1.0.66_r1062275.542'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'WeChat 6.1.0.66_r1062275.542'
      AgentNameVersionMajor                : 'WeChat 6'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      AgentSecurity                        : 'Strong security'
      NetworkType                          : 'Wifi'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 4.4.2; GT-N7100 Build/KOT49H) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/30.0.0.0 Mobile Safari/537.36 MicroMessenger/6.1.0.66_r1062275.542 NetType/cmnet'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung GT-N7100'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.4.2'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.4.2'
      OperatingSystemNameVersionMajor      : 'Android 4'
      OperatingSystemVersionBuild          : 'KOT49H'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '30.0'
      LayoutEngineVersionMajor             : '30'
      LayoutEngineNameVersion              : 'Blink 30.0'
      LayoutEngineNameVersionMajor         : 'Blink 30'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '6.1.0.66_r1062275.542'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'WeChat 6.1.0.66_r1062275.542'
      AgentNameVersionMajor                : 'WeChat 6'
      NetworkType                          : 'Cmnet'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 4.4.4; zh-cn; N918St Build/KTU84P) AppleWebKit/533.1 (KHTML, like Gecko)Version/4.0 MQQBrowser/5.4 TBS/025410 Mobile Safari/533.1 MicroMessenger/6.1.0.66_r1062275.542 NetType/3gnet'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'N918ST'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.4.4'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.4.4'
      OperatingSystemNameVersionMajor      : 'Android 4'
      OperatingSystemVersionBuild          : 'KTU84P'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '533.1'
      LayoutEngineVersionMajor             : '533'
      LayoutEngineNameVersion              : 'AppleWebKit 533.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 533'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '6.1.0.66_r1062275.542'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'WeChat 6.1.0.66_r1062275.542'
      AgentNameVersionMajor                : 'WeChat 6'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      AgentSecurity                        : 'Strong security'
      NetworkType                          : '3GNET'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 4.3; zh-cn; HM 1SC Build/JLS36C) AppleWebKit/533.1 (KHTML, like Gecko)Version/4.0 MQQBrowser/5.4 TBS/025410 Mobile Safari/533.1 MicroMessenger/6.1.0.66_r1062275.542 NetType/#777'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Xiaomi Redmi Note 4'
      DeviceBrand                          : 'Xiaomi'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.3'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.3'
      OperatingSystemNameVersionMajor      : 'Android 4'
      OperatingSystemVersionBuild          : 'JLS36C'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '533.1'
      LayoutEngineVersionMajor             : '533'
      LayoutEngineNameVersion              : 'AppleWebKit 533.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 533'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '6.1.0.66_r1062275.542'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'WeChat 6.1.0.66_r1062275.542'
      AgentNameVersionMajor                : 'WeChat 6'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      AgentSecurity                        : 'Strong security'
      NetworkType                          : '#777'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 4.2.2; zh-cn; vivo Y22 Build/JDQ39) AppleWebKit/533.1 (KHTML, like Gecko)Version/4.0 MQQBrowser/5.4 TBS/025410 Mobile Safari/533.1 MicroMessenger/6.1.0.66_r1062275.542 NetType/WIFI'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Vivo Y22'
      DeviceBrand                          : 'Vivo'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.2.2'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.2.2'
      OperatingSystemNameVersionMajor      : 'Android 4'
      OperatingSystemVersionBuild          : 'JDQ39'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '533.1'
      LayoutEngineVersionMajor             : '533'
      LayoutEngineNameVersion              : 'AppleWebKit 533.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 533'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '6.1.0.66_r1062275.542'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'WeChat 6.1.0.66_r1062275.542'
      AgentNameVersionMajor                : 'WeChat 6'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      AgentSecurity                        : 'Strong security'
      NetworkType                          : 'Wifi'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 4.1.2; zh-cn; GT-I9128V Build/JZO54K) AppleWebKit/533.1 (KHTML, like Gecko)Version/4.0 MQQBrowser/5.4 TBS/025410 Mobile Safari/533.1 MicroMessenger/6.1.0.66_r1062275.542 NetType/WIFI'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung GT-I9128V'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.1.2'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.1.2'
      OperatingSystemNameVersionMajor      : 'Android 4'
      OperatingSystemVersionBuild          : 'JZO54K'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '533.1'
      LayoutEngineVersionMajor             : '533'
      LayoutEngineNameVersion              : 'AppleWebKit 533.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 533'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '6.1.0.66_r1062275.542'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'WeChat 6.1.0.66_r1062275.542'
      AgentNameVersionMajor                : 'WeChat 6'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      AgentSecurity                        : 'Strong security'
      NetworkType                          : 'Wifi'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 4.4.2; zh-cn; HUAWEI MT2-L01 Build/HuaweiMT2-L01) AppleWebKit/533.1 (KHTML, like Gecko)Version/4.0 MQQBrowser/5.7 Mobile Safari/533.1 MicroMessenger/6.0.2.56_r958800.520 NetType/cmnet'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Huawei MT2-L01'
      DeviceBrand                          : 'Huawei'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.4.2'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.4.2'
      OperatingSystemNameVersionMajor      : 'Android 4'
      OperatingSystemVersionBuild          : 'HuaweiMT2-L01'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '533.1'
      LayoutEngineVersionMajor             : '533'
      LayoutEngineNameVersion              : 'AppleWebKit 533.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 533'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '6.0.2.56_r958800.520'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'WeChat 6.0.2.56_r958800.520'
      AgentNameVersionMajor                : 'WeChat 6'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      AgentSecurity                        : 'Strong security'
      NetworkType                          : 'Cmnet'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.95 Safari/537.36 MicroMessenger/6.5.2.501 NetType/WIFI WindowsWechat QBCore/3.43.27.400 QQBrowser/9.0.2524.400'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '39.0'
      LayoutEngineVersionMajor             : '39'
      LayoutEngineNameVersion              : 'Blink 39.0'
      LayoutEngineNameVersionMajor         : 'Blink 39'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '6.5.2.501'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'WeChat 6.5.2.501'
      AgentNameVersionMajor                : 'WeChat 6'
      NetworkType                          : 'Wifi'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 5.1.1; SM801 Build/LMY47V; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/53.0.2785.49 Mobile MQQBrowser/6.2 TBS/043024 Safari/537.36 MicroMessenger/6.5.4.1000 NetType/4G Language/zh_CN'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Smartisan SM801'
      DeviceBrand                          : 'Smartisan'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '5.1.1'
      OperatingSystemVersionMajor          : '5'
      OperatingSystemNameVersion           : 'Android 5.1.1'
      OperatingSystemNameVersionMajor      : 'Android 5'
      OperatingSystemVersionBuild          : 'LMY47V'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '53.0'
      LayoutEngineVersionMajor             : '53'
      LayoutEngineNameVersion              : 'Blink 53.0'
      LayoutEngineNameVersionMajor         : 'Blink 53'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '6.5.4.1000'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'WeChat 6.5.4.1000'
      AgentNameVersionMajor                : 'WeChat 6'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      NetworkType                          : '4G'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 6.0.1; SM919 Build/MXB48T; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/53.0.2785.49 Mobile MQQBrowser/6.2 TBS/043024 Safari/537.36 MicroMessenger/6.5.4.1000 NetType/WIFI Language/zh_CN'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Smartisan SM919'
      DeviceBrand                          : 'Smartisan'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '6.0.1'
      OperatingSystemVersionMajor          : '6'
      OperatingSystemNameVersion           : 'Android 6.0.1'
      OperatingSystemNameVersionMajor      : 'Android 6'
      OperatingSystemVersionBuild          : 'MXB48T'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '53.0'
      LayoutEngineVersionMajor             : '53'
      LayoutEngineNameVersion              : 'Blink 53.0'
      LayoutEngineNameVersionMajor         : 'Blink 53'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '6.5.4.1000'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'WeChat 6.5.4.1000'
      AgentNameVersionMajor                : 'WeChat 6'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      NetworkType                          : 'Wifi'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 9_3_4 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13G35 QQ/6.5.3.410 V1_IPH_SQ_6.5.3_1_APP_A Pixel/750 Core/UIWebView NetType/2G Mem/117'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '13G35'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '9.3.4'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'iOS 9.3.4'
      OperatingSystemNameVersionMajor      : 'iOS 9'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '601.1.46'
      LayoutEngineVersionMajor             : '601'
      LayoutEngineNameVersion              : 'AppleWebKit 601.1.46'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 601'
      AgentClass                           : 'Browser'
      AgentName                            : 'QQ Client'
      AgentVersion                         : '6.5.3.410'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'QQ Client 6.5.3.410'
      AgentNameVersionMajor                : 'QQ Client 6'
      NetworkType                          : '2G'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 4.4.4; zh-cn; MX4 Pro Build/KTU84P) AppleWebKit/533.1 (KHTML, like Gecko)Version/4.0 MQQBrowser/5.4 TBS/025469 Mobile Safari/533.1 MicroMessenger/6.2.0.52_r1162382.561 NetType/WIFI Language/zh_CN QQ/6.6.0.2935'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Meizu MX4 PRO'
      DeviceBrand                          : 'Meizu'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.4.4'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.4.4'
      OperatingSystemNameVersionMajor      : 'Android 4'
      OperatingSystemVersionBuild          : 'KTU84P'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '533.1'
      LayoutEngineVersionMajor             : '533'
      LayoutEngineNameVersion              : 'AppleWebKit 533.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 533'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '6.2.0.52_r1162382.561'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'WeChat 6.2.0.52_r1162382.561'
      AgentNameVersionMajor                : 'WeChat 6'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      AgentSecurity                        : 'Strong security'
      NetworkType                          : 'Wifi'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone 5SGLOBAL; CPU iPhone OS 10_0_2 like Mac OS X) AppleWebKit/602.1.50 (KHTML, like Gecko) Version/10.0 MQQBrowser/7.2.1 Mobile/14A456 Safari/8536.25 MttCustomUA/2 QBWebViewType/1'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceVersion                        : '5SGLOBAL'
      DeviceFirmwareVersion                : '14A456'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '10.0.2'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'iOS 10.0.2'
      OperatingSystemNameVersionMajor      : 'iOS 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '602.1.50'
      LayoutEngineVersionMajor             : '602'
      LayoutEngineNameVersion              : 'AppleWebKit 602.1.50'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 602'
      AgentClass                           : 'Browser'
      AgentName                            : 'QQ Browser'
      AgentVersion                         : '7.2.1'
      AgentVersionMajor                    : '7'
      AgentNameVersion                     : 'QQ Browser 7.2.1'
      AgentNameVersionMajor                : 'QQ Browser 7'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 6.0; zh-cn; PLK-AL10 Build/HONORPLK-AL10) AppleWebKit/537.36 (KHTML, like Gecko)Version/4.0 Chrome/37.0.0.0 MQQBrowser/6.0 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Huawei PLK-AL10'
      DeviceBrand                          : 'Huawei'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '6.0'
      OperatingSystemVersionMajor          : '6'
      OperatingSystemNameVersion           : 'Android 6.0'
      OperatingSystemNameVersionMajor      : 'Android 6'
      OperatingSystemVersionBuild          : 'HONORPLK-AL10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '37.0'
      LayoutEngineVersionMajor             : '37'
      LayoutEngineNameVersion              : 'Blink 37.0'
      LayoutEngineNameVersionMajor         : 'Blink 37'
      AgentClass                           : 'Browser'
      AgentName                            : 'QQ Browser'
      AgentVersion                         : '6.0'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'QQ Browser 6.0'
      AgentNameVersionMajor                : 'QQ Browser 6'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 5.0.2; zh-cn; MI 2S Build/LRX22G) AppleWebKit/533.1 (KHTML, like Gecko)Version/4.0 MQQBrowser/5.4 TBS/025489 Mobile Safari/533.1 V1_AND_SQ_6.2.3_336_YYB_D QQ/6.2.3.2700 NetType/WIFI WebP/0.3.0 Pixel/720'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Xiaomi MI 2S'
      DeviceBrand                          : 'Xiaomi'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '5.0.2'
      OperatingSystemVersionMajor          : '5'
      OperatingSystemNameVersion           : 'Android 5.0.2'
      OperatingSystemNameVersionMajor      : 'Android 5'
      OperatingSystemVersionBuild          : 'LRX22G'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '533.1'
      LayoutEngineVersionMajor             : '533'
      LayoutEngineNameVersion              : 'AppleWebKit 533.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 533'
      AgentClass                           : 'Browser'
      AgentName                            : 'QQ Client'
      AgentVersion                         : '6.2.3.2700'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'QQ Client 6.2.3.2700'
      AgentNameVersionMajor                : 'QQ Client 6'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      AgentSecurity                        : 'Strong security'
      NetworkType                          : 'Wifi'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 6.0; HUAWEI VNS-DL00 Build/HUAWEIVNS-DL00; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/53.0.2785.49 Mobile MQQBrowser/6.2 TBS/043670 Safari/537.36 MicroMessenger/6.5.16.1120 NetType/WIFI Language/zh_CN'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Huawei VNS-DL00'
      DeviceBrand                          : 'Huawei'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '6.0'
      OperatingSystemVersionMajor          : '6'
      OperatingSystemNameVersion           : 'Android 6.0'
      OperatingSystemNameVersionMajor      : 'Android 6'
      OperatingSystemVersionBuild          : 'HUAWEIVNS-DL00'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '53.0'
      LayoutEngineVersionMajor             : '53'
      LayoutEngineNameVersion              : 'Blink 53.0'
      LayoutEngineNameVersionMajor         : 'Blink 53'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '6.5.16.1120'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'WeChat 6.5.16.1120'
      AgentNameVersionMajor                : 'WeChat 6'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      NetworkType                          : 'Wifi'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 7.1.1; TA-1000 Build/NMF26F; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/53.0.2785.49 Mobile MQQBrowser/6.2 TBS/043128 Safari/537.36 MicroMessenger/6.5.7.1041 NetType/WIFI Language/zh_CN'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Nokia TA-1000'
      DeviceBrand                          : 'Nokia'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.1.1'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Android 7.1.1'
      OperatingSystemNameVersionMajor      : 'Android 7'
      OperatingSystemVersionBuild          : 'NMF26F'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '53.0'
      LayoutEngineVersionMajor             : '53'
      LayoutEngineNameVersion              : 'Blink 53.0'
      LayoutEngineNameVersionMajor         : 'Blink 53'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '6.5.7.1041'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'WeChat 6.5.7.1041'
      AgentNameVersionMajor                : 'WeChat 6'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      NetworkType                          : 'Wifi'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 7.0; MHA-AL00 Build/HUAWEIMHA-AL00; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/53.0.2785.49 Mobile MQQBrowser/6.2 TBS/043613 Safari/537.36 V1_AND_SQ_6.6.9_482_YYB_D QQ/6.6.9.3060 NetType/2G WebP/0.3.0 Pixel/1080'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Huawei MHA-AL00'
      DeviceBrand                          : 'Huawei'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.0'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Android 7.0'
      OperatingSystemNameVersionMajor      : 'Android 7'
      OperatingSystemVersionBuild          : 'HUAWEIMHA-AL00'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '53.0'
      LayoutEngineVersionMajor             : '53'
      LayoutEngineNameVersion              : 'Blink 53.0'
      LayoutEngineNameVersionMajor         : 'Blink 53'
      AgentClass                           : 'Browser'
      AgentName                            : 'QQ Client'
      AgentVersion                         : '6.6.9.3060'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'QQ Client 6.6.9.3060'
      AgentNameVersionMajor                : 'QQ Client 6'
      NetworkType                          : '2G'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 6.0; Le X620 Build/HEXCNFN5902303291S; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/53.0.2785.49 Mobile MQQBrowser/6.2 TBS/043128 Safari/537.36 MicroMessenger/6.5.7.1041 NetType/WIFI Language/zh_CN'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'LE X620'
      DeviceBrand                          : 'LE'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '6.0'
      OperatingSystemVersionMajor          : '6'
      OperatingSystemNameVersion           : 'Android 6.0'
      OperatingSystemNameVersionMajor      : 'Android 6'
      OperatingSystemVersionBuild          : 'HEXCNFN5902303291S'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '53.0'
      LayoutEngineVersionMajor             : '53'
      LayoutEngineNameVersion              : 'Blink 53.0'
      LayoutEngineNameVersionMajor         : 'Blink 53'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '6.5.7.1041'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'WeChat 6.5.7.1041'
      AgentNameVersionMajor                : 'WeChat 6'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      NetworkType                          : 'Wifi'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 7.1.1; MI 6 Build/NMF26X; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/53.0.2785.49 Mobile MQQBrowser/6.2 TBS/043670 Safari/537.36 V1_AND_SQ_7.1.8_718_YYB_D QQ/7.1.8.3240 NetType/WIFI WebP/0.3.0 Pixel/1080'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Xiaomi MI 6'
      DeviceBrand                          : 'Xiaomi'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.1.1'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Android 7.1.1'
      OperatingSystemNameVersionMajor      : 'Android 7'
      OperatingSystemVersionBuild          : 'NMF26X'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '53.0'
      LayoutEngineVersionMajor             : '53'
      LayoutEngineNameVersion              : 'Blink 53.0'
      LayoutEngineNameVersionMajor         : 'Blink 53'
      AgentClass                           : 'Browser'
      AgentName                            : 'QQ Client'
      AgentVersion                         : '7.1.8.3240'
      AgentVersionMajor                    : '7'
      AgentNameVersion                     : 'QQ Client 7.1.8.3240'
      AgentNameVersionMajor                : 'QQ Client 7'
      NetworkType                          : 'Wifi'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 7.0; SM-C7000 Build/NRD90M; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/53.0.2785.49 Mobile MQQBrowser/6.2 TBS/043670 Safari/537.36 V1_AND_SQ_7.2.0_730_YYB_D QQ/7.2.0.3270 NetType/WIFI WebP/0.3.0 Pixel/1080'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Samsung SM-C7000'
      DeviceBrand                          : 'Samsung'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.0'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Android 7.0'
      OperatingSystemNameVersionMajor      : 'Android 7'
      OperatingSystemVersionBuild          : 'NRD90M'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '53.0'
      LayoutEngineVersionMajor             : '53'
      LayoutEngineNameVersion              : 'Blink 53.0'
      LayoutEngineNameVersionMajor         : 'Blink 53'
      AgentClass                           : 'Browser'
      AgentName                            : 'QQ Client'
      AgentVersion                         : '7.2.0.3270'
      AgentVersionMajor                    : '7'
      AgentNameVersion                     : 'QQ Client 7.2.0.3270'
      AgentNameVersionMajor                : 'QQ Client 7'
      NetworkType                          : 'Wifi'


# Phone classified as Unknown --> Caused by a new example of tagging iPhone versions.
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone1 01; CPU iPhone OS 11_2_5 like Mac OS X) AppleWebKit/604.3.5 (KHTML, like Gecko) Version/11.0 MQQBrowser/8.3.0 Mobile/15B87 Safari/604.1 MttCustomUA/2 QBWebViewType/1 WKType/1'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15B87'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '11.2.5'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'iOS 11.2.5'
      OperatingSystemNameVersionMajor      : 'iOS 11'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '604.3.5'
      LayoutEngineVersionMajor             : '604'
      LayoutEngineNameVersion              : 'AppleWebKit 604.3.5'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 604'
      AgentClass                           : 'Browser'
      AgentName                            : 'QQ Browser'
      AgentVersion                         : '8.3.0'
      AgentVersionMajor                    : '8'
      AgentNameVersion                     : 'QQ Browser 8.3.0'
      AgentNameVersionMajor                : 'QQ Browser 8'

# Phone classified as Unknown --> Caused by a new example of tagging iPhone versions.
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone1 06; CPU iPhone OS 11_1 like Mac OS X) AppleWebKit/604.3.5 (KHTML, like Gecko) Version/11.0 MQQBrowser/8.0.2 Mobile/15B87 Safari/8536.25 MttCustomUA/2 QBWebViewType/1 WKType/1'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15B87'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '11.1'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'iOS 11.1'
      OperatingSystemNameVersionMajor      : 'iOS 11'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '604.3.5'
      LayoutEngineVersionMajor             : '604'
      LayoutEngineNameVersion              : 'AppleWebKit 604.3.5'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 604'
      AgentClass                           : 'Browser'
      AgentName                            : 'QQ Browser'
      AgentVersion                         : '8.0.2'
      AgentVersionMajor                    : '8'
      AgentNameVersion                     : 'QQ Browser 8.0.2'
      AgentNameVersionMajor                : 'QQ Browser 8'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 8.0; MHA-AL00 Build/HUAWEIMHA-AL00; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/57.0.2987.132 MQQBrowser/6.2 TBS/044109 Mobile Safari/537.36 MicroMessenger/6.6.7.1321(0x26060739) NetType/4G Language/zh_CN'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Huawei MHA-AL00'
      DeviceBrand                          : 'Huawei'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '8.0'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Android 8.0'
      OperatingSystemNameVersionMajor      : 'Android 8'
      OperatingSystemVersionBuild          : 'HUAWEIMHA-AL00'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '57.0'
      LayoutEngineVersionMajor             : '57'
      LayoutEngineNameVersion              : 'Blink 57.0'
      LayoutEngineNameVersionMajor         : 'Blink 57'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '6.6.7.1321'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'WeChat 6.6.7.1321'
      AgentNameVersionMajor                : 'WeChat 6'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      NetworkType                          : '4G'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 10_2_1 like Mac OS X) AppleWebKit/602.4.6 (KHTML, like Gecko) Mobile/14D27 QQ/6.6.9.412 V1_IPH_SQ_6.6.9_1_APP_A Pixel/750 Core/UIWebView NetType/WIFI'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '14D27'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '10.2.1'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'iOS 10.2.1'
      OperatingSystemNameVersionMajor      : 'iOS 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '602.4.6'
      LayoutEngineVersionMajor             : '602'
      LayoutEngineNameVersion              : 'AppleWebKit 602.4.6'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 602'
      AgentClass                           : 'Browser'
      AgentName                            : 'QQ Client'
      AgentVersion                         : '6.6.9.412'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'QQ Client 6.6.9.412'
      AgentNameVersionMajor                : 'QQ Client 6'
      NetworkType                          : 'Wifi'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 10_2_1 like Mac OS X) AppleWebKit/602.4.6 (KHTML, like Gecko) Mobile/14D27 QQ/7.3.5.473 V1_IPH_SQ_7.3.5_1_APP_A Pixel/750 Core/UIWebView Device/Apple(iPhone 6) NetType/4G QBWebViewType/1'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '14D27'
      DeviceVersion                        : '6'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '10.2.1'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'iOS 10.2.1'
      OperatingSystemNameVersionMajor      : 'iOS 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '602.4.6'
      LayoutEngineVersionMajor             : '602'
      LayoutEngineNameVersion              : 'AppleWebKit 602.4.6'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 602'
      AgentClass                           : 'Browser'
      AgentName                            : 'QQ Client'
      AgentVersion                         : '7.3.5.473'
      AgentVersionMajor                    : '7'
      AgentNameVersion                     : 'QQ Client 7.3.5.473'
      AgentNameVersionMajor                : 'QQ Client 7'
      NetworkType                          : '4G'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 11_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E302 QQ/7.2.8.478 V1_IPH_SQ_7.2.8_1_APP_A Pixel/1125 Core/UIWebView Device/Apple(iPhone X) NetType/WIFI QBWebViewType/1'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15E302'
      DeviceVersion                        : 'iPhone X (A1901)'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '11.3'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'iOS 11.3'
      OperatingSystemNameVersionMajor      : 'iOS 11'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Browser'
      AgentName                            : 'QQ Client'
      AgentVersion                         : '7.2.8.478'
      AgentVersionMajor                    : '7'
      AgentNameVersion                     : 'QQ Client 7.2.8.478'
      AgentNameVersionMajor                : 'QQ Client 7'
      NetworkType                          : 'Wifi'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 11_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E302 QQ/7.5.8.422 V1_IPH_SQ_7.5.8_1_APP_A Pixel/1080 Core/UIWebView Device/Apple(iPhone 6sPlus) NetType/WIFI QBWebViewType/1'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15E302'
      DeviceVersion                        : '6sPlus'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '11.3'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'iOS 11.3'
      OperatingSystemNameVersionMajor      : 'iOS 11'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Browser'
      AgentName                            : 'QQ Client'
      AgentVersion                         : '7.5.8.422'
      AgentVersionMajor                    : '7'
      AgentNameVersion                     : 'QQ Client 7.5.8.422'
      AgentNameVersionMajor                : 'QQ Client 7'
      NetworkType                          : 'Wifi'


# This happens quite often:
#       NetType/WIFI Language/zh_CN
#       NetType/cmnet Language/zh_CN
# The effect is that the parse tree gets a bit messy because everything is text (no numbers)
- matcher:
    variable:
    - 'AgentLanguageCode                   :agent.product[-3]="NetType/WIFI Language".(2)version'
    - 'Language                            :LookUp[ISOLanguageCodes;@AgentLanguageCode]'
    extract:
    - 'AgentLanguageCode                   :     3000 :@Language[[1]]'
    - 'AgentLanguage                       :     3000 :@Language[[2]]'

- matcher:
    variable:
    - 'AgentLanguageCode                   :agent.product[-3]="NetType/WIFI Language">'
    - 'Language                            :LookUp[ISOLanguageCodes;@AgentLanguageCode]'
    require:
    - 'IsNull[@AgentLanguageCode.(2)version]'
    extract:
    - 'AgentLanguageCode                   :     3000 :@Language[[1]]'
    - 'AgentLanguage                       :     3000 :@Language[[2]]'

- matcher:
    variable:
    - 'AgentLanguageCode                   :agent.product[-3]="NetType/cmnet Language".(2)version'
    - 'Language                            :LookUp[ISOLanguageCodes;@AgentLanguageCode]'
    extract:
    - 'AgentLanguageCode                   :     3000 :@Language[[1]]'
    - 'AgentLanguage                       :     3000 :@Language[[2]]'

- matcher:
    variable:
    - 'AgentLanguageCode                   :agent.product[-3]="NetType/cmnet Language">'
    - 'Language                            :LookUp[ISOLanguageCodes;@AgentLanguageCode]'
    require:
    - 'IsNull[@AgentLanguageCode.(2)version]'
    extract:
    - 'AgentLanguageCode                   :     3000 :@Language[[1]]'
    - 'AgentLanguage                       :     3000 :@Language[[2]]'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 4.4.2; PE-TL20 Build/HuaweiPE-TL20) AppleWebKit/533.1 (KHTML, like Gecko)Version/4.0 MQQBrowser/5.4 TBS/025440 Mobile Safari/533.1 MicroMessenger/6.2.5.53_r2565f18.621 NetType/3G Language/zh_CN'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Huawei PE-TL20'
      DeviceBrand                          : 'Huawei'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.4.2'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.4.2'
      OperatingSystemNameVersionMajor      : 'Android 4'
      OperatingSystemVersionBuild          : 'HuaweiPE-TL20'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '533.1'
      LayoutEngineVersionMajor             : '533'
      LayoutEngineNameVersion              : 'AppleWebKit 533.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 533'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '6.2.5.53_r2565f18.621'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'WeChat 6.2.5.53_r2565f18.621'
      AgentNameVersionMajor                : 'WeChat 6'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      AgentSecurity                        : 'Strong security'
      NetworkType                          : '3G'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 4.4.2; PE-TL20 Build/HuaweiPE-TL20) AppleWebKit/533.1 (KHTML, like Gecko)Version/4.0 MQQBrowser/5.4 TBS/025440 Mobile Safari/533.1 MicroMessenger/6.2.5.53_r2565f18.621 NetType/WIFI Language/zh_CN'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Huawei PE-TL20'
      DeviceBrand                          : 'Huawei'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.4.2'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.4.2'
      OperatingSystemNameVersionMajor      : 'Android 4'
      OperatingSystemVersionBuild          : 'HuaweiPE-TL20'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '533.1'
      LayoutEngineVersionMajor             : '533'
      LayoutEngineNameVersion              : 'AppleWebKit 533.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 533'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '6.2.5.53_r2565f18.621'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'WeChat 6.2.5.53_r2565f18.621'
      AgentNameVersionMajor                : 'WeChat 6'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      AgentSecurity                        : 'Strong security'
      NetworkType                          : 'Wifi'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 4.4.2; HM NOTE 1LTETD Build/KVT49L) AppleWebKit/533.1 (KHTML, like Gecko)Version/4.0 MQQBrowser/5.4 TBS/025410 Mobile Safari/533.1 MicroMessenger/6.1.0.66_r1062275.542 NetType/cmnet Language/zh_CN'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Xiaomi Redmi Note 4'
      DeviceBrand                          : 'Xiaomi'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.4.2'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.4.2'
      OperatingSystemNameVersionMajor      : 'Android 4'
      OperatingSystemVersionBuild          : 'KVT49L'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '533.1'
      LayoutEngineVersionMajor             : '533'
      LayoutEngineNameVersion              : 'AppleWebKit 533.1'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 533'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '6.1.0.66_r1062275.542'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'WeChat 6.1.0.66_r1062275.542'
      AgentNameVersionMajor                : 'WeChat 6'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      AgentSecurity                        : 'Strong security'
      NetworkType                          : 'Cmnet'

# This seems hacked together manually: Nested useragent, "QQDownload"
- test:
    input:
      user_agent_string: 'Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; GTB6.5; QQDownload 534; Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1) ; SLCC2; .NET CLR 2.0.50727; Media Center PC 6.0; .NET CLR 3.5.30729; .NET CLR 3.0.30729)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Trident'
      LayoutEngineVersion                  : '4.0'
      LayoutEngineVersionMajor             : '4'
      LayoutEngineNameVersion              : 'Trident 4.0'
      LayoutEngineNameVersionMajor         : 'Trident 4'
      AgentClass                           : 'Browser'
      AgentName                            : 'Qqdownload'
      AgentVersion                         : '534'
      AgentVersionMajor                    : '534'
      AgentNameVersion                     : 'Qqdownload 534'
      AgentNameVersionMajor                : 'Qqdownload 534'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 12_1_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/16C101 MicroMessenger/7.0.5(0x17000523) NetType/2G Language/zh_CN'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '16C101'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '12.1.2'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'iOS 12.1.2'
      OperatingSystemNameVersionMajor      : 'iOS 12'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '7.0.5'
      AgentVersionMajor                    : '7'
      AgentNameVersion                     : 'WeChat 7.0.5'
      AgentNameVersionMajor                : 'WeChat 7'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      NetworkType                          : '2G'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 6.0.1; vivo Y66L Build/MMB29M; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/62.0.3202.84 Mobile Safari/537.36  TTWebView/0621100004002 JsSdk/2 NewsArticle/7.2.7 NetType/4g  TTWebView/0621100004002'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Vivo Y66L'
      DeviceBrand                          : 'Vivo'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '6.0.1'
      OperatingSystemVersionMajor          : '6'
      OperatingSystemNameVersion           : 'Android 6.0.1'
      OperatingSystemNameVersionMajor      : 'Android 6'
      OperatingSystemVersionBuild          : 'MMB29M'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '62.0'
      LayoutEngineVersionMajor             : '62'
      LayoutEngineNameVersion              : 'Blink 62.0'
      LayoutEngineNameVersionMajor         : 'Blink 62'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '62.0.3202.84'
      AgentVersionMajor                    : '62'
      AgentNameVersion                     : 'Chrome Webview 62.0.3202.84'
      AgentNameVersionMajor                : 'Chrome Webview 62'
      WebviewAppName                       : 'Ttwebview'
      WebviewAppVersion                    : '0621100004002'
      WebviewAppVersionMajor               : '0621100004002'
      WebviewAppNameVersion                : 'Ttwebview 0621100004002'
      WebviewAppNameVersionMajor           : 'Ttwebview 0621100004002'
      NetworkType                          : '4G'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 9; VOG-L29 Build/HUAWEIVOG-L29; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/77.0.3865.116 Mobile Safari/537.36 JsSdk/2 NewsArticle/7.3.6 NetType/4g TTPreload'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Huawei VOG-L29'
      DeviceBrand                          : 'Huawei'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '9'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'Android 9'
      OperatingSystemNameVersionMajor      : 'Android 9'
      OperatingSystemVersionBuild          : 'HUAWEIVOG-L29'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '77.0'
      LayoutEngineVersionMajor             : '77'
      LayoutEngineNameVersion              : 'Blink 77.0'
      LayoutEngineNameVersionMajor         : 'Blink 77'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '77.0.3865.116'
      AgentVersionMajor                    : '77'
      AgentNameVersion                     : 'Chrome Webview 77.0.3865.116'
      AgentNameVersionMajor                : 'Chrome Webview 77'
      WebviewAppName                       : 'Jssdk'
      WebviewAppVersion                    : '2'
      WebviewAppVersionMajor               : '2'
      WebviewAppNameVersion                : 'Jssdk 2'
      WebviewAppNameVersionMajor           : 'Jssdk 2'
      NetworkType                          : '4G'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 8.0.0; ANE-AL00 Build/HUAWEIANE-AL00; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/66.0.3359.126 MQQBrowser/6.2 TBS/045005 Mobile Safari/537.36 MMWEBID/2744 MicroMessenger/7.0.7.1521(0x2700073A) Process/tools NetType/NON_NETWORK Language/zh_CN'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Huawei ANE-AL00'
      DeviceBrand                          : 'Huawei'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '8.0.0'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Android 8.0.0'
      OperatingSystemNameVersionMajor      : 'Android 8'
      OperatingSystemVersionBuild          : 'HUAWEIANE-AL00'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '66.0'
      LayoutEngineVersionMajor             : '66'
      LayoutEngineNameVersion              : 'Blink 66.0'
      LayoutEngineNameVersionMajor         : 'Blink 66'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '7.0.7.1521'
      AgentVersionMajor                    : '7'
      AgentNameVersion                     : 'WeChat 7.0.7.1521'
      AgentNameVersionMajor                : 'WeChat 7'
      NetworkType                          : 'NON_Network'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 5.1; HUAWEI TIT-AL00 Build/HUAWEITIT-AL00; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/62.0.3202.84 Mobile Safari/537.36 JsSdk/2 NewsArticle/7.4.3 NetType/wifi  TTWebView/0621110013013'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Huawei TIT-AL00'
      DeviceBrand                          : 'Huawei'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '5.1'
      OperatingSystemVersionMajor          : '5'
      OperatingSystemNameVersion           : 'Android 5.1'
      OperatingSystemNameVersionMajor      : 'Android 5'
      OperatingSystemVersionBuild          : 'HUAWEITIT-AL00'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '62.0'
      LayoutEngineVersionMajor             : '62'
      LayoutEngineNameVersion              : 'Blink 62.0'
      LayoutEngineNameVersionMajor         : 'Blink 62'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '62.0.3202.84'
      AgentVersionMajor                    : '62'
      AgentNameVersion                     : 'Chrome Webview 62.0.3202.84'
      AgentNameVersionMajor                : 'Chrome Webview 62'
      WebviewAppName                       : 'Jssdk'
      WebviewAppVersion                    : '2'
      WebviewAppVersionMajor               : '2'
      WebviewAppNameVersion                : 'Jssdk 2'
      WebviewAppNameVersionMajor           : 'Jssdk 2'
      NetworkType                          : 'Wifi'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 5.1; OPPO A37m Build/LMY47I; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/69.0.3497.100 Mobile Safari/537.36 MMWEBID/4907 MicroMessenger/7.0.7.1521(0x27000736) Process/tools NetType/portalmmm.nl Language/zh_CN'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Oppo A37M'
      DeviceBrand                          : 'Oppo'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '5.1'
      OperatingSystemVersionMajor          : '5'
      OperatingSystemNameVersion           : 'Android 5.1'
      OperatingSystemNameVersionMajor      : 'Android 5'
      OperatingSystemVersionBuild          : 'LMY47I'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '69.0'
      LayoutEngineVersionMajor             : '69'
      LayoutEngineNameVersion              : 'Blink 69.0'
      LayoutEngineNameVersionMajor         : 'Blink 69'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '7.0.7.1521'
      AgentVersionMajor                    : '7'
      AgentNameVersion                     : 'WeChat 7.0.7.1521'
      AgentNameVersionMajor                : 'WeChat 7'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      NetworkType                          : 'Portalmmm.nl'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 9; MI 9 SE Build/PKQ1.181121.001; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/74.0.3729.136 Mobile Safari/537.36 MMWEBID/9817 MicroMessenger/7.0.9.1560(0x27000935) Process/tools NetType/WIFI Language/zh_CN ABI/arm64'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Xiaomi MI 9 SE'
      DeviceBrand                          : 'Xiaomi'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '9'
      OperatingSystemVersionMajor          : '9'
      OperatingSystemNameVersion           : 'Android 9'
      OperatingSystemNameVersionMajor      : 'Android 9'
      OperatingSystemVersionBuild          : 'PKQ1.181121.001'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '74.0'
      LayoutEngineVersionMajor             : '74'
      LayoutEngineNameVersion              : 'Blink 74.0'
      LayoutEngineNameVersionMajor         : 'Blink 74'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '7.0.9.1560'
      AgentVersionMajor                    : '7'
      AgentNameVersion                     : 'WeChat 7.0.9.1560'
      AgentNameVersionMajor                : 'WeChat 7'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      NetworkType                          : 'Wifi'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (Linux; Android 12; ANY-AN00 Build/HONORANY-AN00; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/107.0.5304.141 Mobile Safari/537.36 XWEB/5049 MMWEBSDK/20230405 MMWEBID/7761 MicroMessenger/8.0.35.2360(0x28002353) WeChat/arm64 Weixin NetType/5G Language/zh_CN ABI/arm64'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Huawei ANY-AN00'
      DeviceBrand                          : 'Huawei'
      DeviceCpu                            : 'ARM64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '12'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'Android 12'
      OperatingSystemNameVersionMajor      : 'Android 12'
      OperatingSystemVersionBuild          : 'HONORANY-AN00'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '107.0'
      LayoutEngineVersionMajor             : '107'
      LayoutEngineNameVersion              : 'Blink 107.0'
      LayoutEngineNameVersionMajor         : 'Blink 107'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '8.0.35.2360'
      AgentVersionMajor                    : '8'
      AgentNameVersion                     : 'WeChat 8.0.35.2360'
      AgentNameVersionMajor                : 'WeChat 8'
      NetworkType                          : '5G'


- test:
    input:
      User-Agent                           : 'Language/zh ColorScheme/Light DistType/publish wxwork/4.0.20 (MicroMessenger/6.2) WeChat/2.0.4'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Unknown'
      OperatingSystemName                  : 'Unknown'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Unknown ??'
      OperatingSystemNameVersionMajor      : 'Unknown ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '2.0.4'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'WeChat 2.0.4'
      AgentNameVersionMajor                : 'WeChat 2'


- test:
    input:
      User-Agent                           : 'Language/zh ColorScheme/Light DistType/publish wxwork/4.1.3 (MicroMessenger/6.2) WeChat/2.0.4 Safari/605.1.15'
    expected:
      DeviceClass                          : 'Mobile'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Unknown'
      OperatingSystemName                  : 'Unknown'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Unknown ??'
      OperatingSystemNameVersionMajor      : 'Unknown ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      LayoutEngineNameVersion              : 'Unknown ??'
      LayoutEngineNameVersionMajor         : 'Unknown ??'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '2.0.4'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'WeChat 2.0.4'
      AgentNameVersionMajor                : 'WeChat 2'


# QQBrowser with "Chromium" client hints.
- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/94.0.4606.71 Safari/537.36 Core/1.94.197.400 QQBrowser/11.6.5265.400'
      Sec-Ch-Ua                            : '";Not A Brand";v="99", "Chromium";v="94"'
      Sec-Ch-Ua-Mobile                     : '?0'
      Sec-Ch-Ua-Platform                   : '"Windows"'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '94.0'
      LayoutEngineVersionMajor             : '94'
      LayoutEngineNameVersion              : 'Blink 94.0'
      LayoutEngineNameVersionMajor         : 'Blink 94'
      AgentClass                           : 'Browser'
      AgentName                            : 'QQ Browser'
      AgentVersion                         : '11.6.5265.400'
      AgentVersionMajor                    : '11'
      AgentNameVersion                     : 'QQ Browser 11.6.5265.400'
      AgentNameVersionMajor                : 'QQ Browser 11'
      UAClientHintBrands_0_Brand           : 'Chromium'
      UAClientHintBrands_0_Version         : '94'
      UAClientHintMobile                   : 'false'
      UAClientHintPlatform                 : 'Windows'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (iPhone; CPU iPhone OS 16_6 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148 MicroMessenger/8.0.49(0x18003135) NetType/4G Language/zh_CN'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15E148'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '16.6'
      OperatingSystemVersionMajor          : '16'
      OperatingSystemNameVersion           : 'iOS 16.6'
      OperatingSystemNameVersionMajor      : 'iOS 16'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '8.0.49'
      AgentVersionMajor                    : '8'
      AgentNameVersion                     : 'WeChat 8.0.49'
      AgentNameVersionMajor                : 'WeChat 8'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      NetworkType                          : '4G'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (iPhone; CPU iPhone OS 16_6_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148 MicroMessenger/8.0.28(0x18001c2e) NetType/WIFI Language/zh_CN'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15E148'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '16.6.1'
      OperatingSystemVersionMajor          : '16'
      OperatingSystemNameVersion           : 'iOS 16.6.1'
      OperatingSystemNameVersionMajor      : 'iOS 16'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Mobile App'
      AgentName                            : 'WeChat'
      AgentVersion                         : '8.0.28'
      AgentVersionMajor                    : '8'
      AgentNameVersion                     : 'WeChat 8.0.28'
      AgentNameVersionMajor                : 'WeChat 8'
      AgentLanguage                        : 'Chinese (S)'
      AgentLanguageCode                    : 'zh-cn'
      NetworkType                          : 'Wifi'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/94.0.4606.71 Safari/537.36 Core/1.94.202.400 QQBrowser/11.9.5355.400'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '94.0'
      LayoutEngineVersionMajor             : '94'
      LayoutEngineNameVersion              : 'Blink 94.0'
      LayoutEngineNameVersionMajor         : 'Blink 94'
      AgentClass                           : 'Browser'
      AgentName                            : 'QQ Browser'
      AgentVersion                         : '11.9.5355.400'
      AgentVersionMajor                    : '11'
      AgentNameVersion                     : 'QQ Browser 11.9.5355.400'
      AgentNameVersionMajor                : 'QQ Browser 11'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (iPhone; CPU iPhone OS 17_2_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148 QQ/9.0.17.638 V1_IPH_SQ_9.0.17_1_APP_A Pixel/1170 MiniAppEnable SimpleUISwitch/0 StudyMode/0 CurrentMode/0 CurrentFontScale/1.000000 QQTheme/1000 AppId/537203242 Core/WKWebView Device/Apple(iPhone 12) NetType/WIFI QBWebViewType/1 WKType/1'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15E148'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '17.2.1'
      OperatingSystemVersionMajor          : '17'
      OperatingSystemNameVersion           : 'iOS 17.2.1'
      OperatingSystemNameVersionMajor      : 'iOS 17'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Browser'
      AgentName                            : 'QQ Client'
      AgentVersion                         : '9.0.17.638'
      AgentVersionMajor                    : '9'
      AgentNameVersion                     : 'QQ Client 9.0.17.638'
      AgentNameVersionMajor                : 'QQ Client 9'
      NetworkType                          : 'Wifi'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (iPhone; CPU iPhone OS 17_3_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148 QQ/9.0.17.638 V1_IPH_SQ_9.0.17_1_APP_A Pixel/1179 MiniAppEnable SimpleUISwitch/0 StudyMode/0 CurrentMode/0 CurrentFontScale/1.000000 QQTheme/1000 AppId/537203242 Core/WKWebView Device/Apple(iPhone X) NetType/WIFI QBWebViewType/1 WKType/1'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Apple iPhone'
      DeviceBrand                          : 'Apple'
      DeviceFirmwareVersion                : '15E148'
      DeviceVersion                        : 'iPhone'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'iOS'
      OperatingSystemVersion               : '17.3.1'
      OperatingSystemVersionMajor          : '17'
      OperatingSystemNameVersion           : 'iOS 17.3.1'
      OperatingSystemNameVersionMajor      : 'iOS 17'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '605.1.15'
      LayoutEngineVersionMajor             : '605'
      LayoutEngineNameVersion              : 'AppleWebKit 605.1.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 605'
      AgentClass                           : 'Browser'
      AgentName                            : 'QQ Client'
      AgentVersion                         : '9.0.17.638'
      AgentVersionMajor                    : '9'
      AgentNameVersion                     : 'QQ Client 9.0.17.638'
      AgentNameVersionMajor                : 'QQ Client 9'
      NetworkType                          : 'Wifi'

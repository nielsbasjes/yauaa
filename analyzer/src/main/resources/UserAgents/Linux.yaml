#
# Yet Another UserAgent Analyzer
# Copyright (C) 2013-2016 Niels Basjes
#
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
#

config:

# We see the following patterns
# Linux <version>
# Linux <cpu>
# Linux <version> <cpu>

- matcher:
    extract:
    - 'DeviceClass           :   5:"Desktop"'
    - 'DeviceName            :   5:"Linux Desktop"'
    - 'OperatingSystemClass  :   5:"Desktop"'
    - 'OperatingSystemName   :   5:"Linux"'
    - 'OperatingSystemVersion:   6:LookUp[CPUArchitectures;agent.(1)product.(1)comments.entry.product.name="Linux"^.version]'

- matcher:
    extract:
    - 'DeviceClass           :   5:"Desktop"'
    - 'DeviceName            :   5:"Linux Desktop"'
    - 'OperatingSystemClass  :   5:"Desktop"'
    - 'OperatingSystemName   :   5:"Linux"'
    - 'OperatingSystemVersion:   6:LookUp[CPUArchitectures;agent.(1)product.(1)comments.entry.text[1]="Linux"@[2]]'

- matcher:
    extract:
    - 'DeviceClass           :   5:"Desktop"'
    - 'DeviceName            :   5:"Linux Desktop"'
    - 'OperatingSystemClass  :   5:"Desktop"'
    - 'OperatingSystemName   :   5:"Linux"'
    - 'OperatingSystemVersion:   4:agent.(1)product.(1)comments.entry.product.name="Linux"^.version'

- matcher:
    extract:
    - 'DeviceClass           :   5:"Desktop"'
    - 'DeviceName            :   5:"Linux Desktop"'
    - 'OperatingSystemClass  :   5:"Desktop"'
    - 'OperatingSystemName   :   5:"Linux"'
    - 'OperatingSystemVersion:   3:agent.product.(1)name="Linux"^.version'

- matcher:
    require:
    - 'agent.(1)product.(1)comments.entry.text[1]="Linux"'
    extract:
    - 'DeviceClass           :   5:"Desktop"'
    - 'DeviceName            :   5:"Linux Desktop"'
    - 'OperatingSystemClass  :   5:"Desktop"'
    - 'OperatingSystemName   :   5:"Linux"'
    - 'OperatingSystemVersion:   1:"??"'

- matcher:
    require:
    - 'IsNull[LookUp[CPUArchitectures;agent.(1)product.(1)comments.entry.product.name="Linux"^.(1)version]]'
    extract:
#        - 'DeviceCpu             :   1:"??"'
    - 'OperatingSystemVersion:   5:agent.(1)product.(1)comments.entry.product.name="Linux"^.(1)version'

- matcher:
    require:
    - 'agent.(1)product.(1)comments.entry.product.name="Linux"'
    extract:
    - 'DeviceCpu             :   15:LookUp[CPUArchitectures;agent.(1)product.(1)comments.entry.product.name="Linux"^.(2)version]'
    - 'OperatingSystemVersion:   15:agent.(1)product.(1)comments.entry.product.name="Linux"^.(1)version'

- test:
    input:
      user_agent_string: 'Links (2.1pre15; Linux 2.4.26 i686; 128x48)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '2.4.26'
      OperatingSystemNameVersion           : 'Linux 2.4.26'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'Links'
      AgentVersion                         : '2.1pre15'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Links 2.1pre15'
      AgentNameVersionMajor                : 'Links 2'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; U; Linux i686; rv:1.7.3) Gecko/20040919 Firefox/0.10'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : 'Intel i686'
      OperatingSystemNameVersion           : 'Linux Intel i686'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '1.7.3'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Gecko 1.7.3'
      LayoutEngineNameVersionMajor         : 'Gecko 1'
      LayoutEngineBuild                    : '20040919'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '0.10'
      AgentVersionMajor                    : '0'
      AgentNameVersion                     : 'Firefox 0.10'
      AgentNameVersionMajor                : 'Firefox 0'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Opera/7.54 (Linux 2.4.18-xfs i686; U)  [en]'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '2.4.18-xfs'
      OperatingSystemNameVersion           : 'Linux 2.4.18-xfs'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '1'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Presto 1'
      LayoutEngineNameVersionMajor         : 'Presto 1'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera'
      AgentVersion                         : '7.54'
      AgentVersionMajor                    : '7'
      AgentNameVersion                     : 'Opera 7.54'
      AgentNameVersionMajor                : 'Opera 7'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Mozilla/4.0 (compatible; MSIE 6.0; X11; Linux ppc; en) Opera 8.0'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'PowerPC'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : 'PowerPC'
      OperatingSystemNameVersion           : 'Linux PowerPC'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '1'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Presto 1'
      LayoutEngineNameVersionMajor         : 'Presto 1'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera'
      AgentVersion                         : '8.0'
      AgentVersionMajor                    : '8'
      AgentNameVersion                     : 'Opera 8.0'
      AgentNameVersionMajor                : 'Opera 8'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux x86_64; U) Opera 7.54  [en]'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : 'Intel x86_64'
      OperatingSystemNameVersion           : 'Linux Intel x86_64'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '1'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Presto 1'
      LayoutEngineNameVersionMajor         : 'Presto 1'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera'
      AgentVersion                         : '7.54'
      AgentVersionMajor                    : '7'
      AgentNameVersion                     : 'Opera 7.54'
      AgentNameVersionMajor                : 'Opera 7'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Links (2.1pre17; Linux 2.4.18-rmk7-pxa3-embedix armv5tel; 73x33)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'ARMv5tel'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '2.4.18-rmk7-pxa3-embedix'
      OperatingSystemNameVersion           : 'Linux 2.4.18-rmk7-pxa3-embedix'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'Links'
      AgentVersion                         : '2.1pre17'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Links 2.1pre17'
      AgentNameVersionMajor                : 'Links 2'

- test:
    input:
      user_agent_string: 'Mozilla/4.0 (compatible; MSIE 6.0; Qt embedded; Linux armv5tel; 640x480) Opera 7.30  [en]'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'ARMv5tel'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : 'ARMv5tel'
      OperatingSystemNameVersion           : 'Linux ARMv5tel'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '1'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Presto 1'
      LayoutEngineNameVersionMajor         : 'Presto 1'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera'
      AgentVersion                         : '7.30'
      AgentVersionMajor                    : '7'
      AgentNameVersion                     : 'Opera 7.30'
      AgentNameVersionMajor                : 'Opera 7'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:35.0) Gecko/20100101 Firefox/35.0'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '??'
      OperatingSystemNameVersion           : 'Ubuntu ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '35.0'
      LayoutEngineVersionMajor             : '35'
      LayoutEngineNameVersion              : 'Gecko 35.0'
      LayoutEngineNameVersionMajor         : 'Gecko 35'
      LayoutEngineBuild                    : '20100101'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '35.0'
      AgentVersionMajor                    : '35'
      AgentNameVersion                     : 'Firefox 35.0'
      AgentNameVersionMajor                : 'Firefox 35'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Ubuntu Chromium/39.0.2171.65 Chrome/39.0.2171.65 Safari/537.36'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '??'
      OperatingSystemNameVersion           : 'Ubuntu ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '39.0'
      LayoutEngineVersionMajor             : '39'
      LayoutEngineNameVersion              : 'Blink 39.0'
      LayoutEngineNameVersionMajor         : 'Blink 39'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '39.0.2171.65'
      AgentVersionMajor                    : '39'
      AgentNameVersion                     : 'Chrome 39.0.2171.65'
      AgentNameVersionMajor                : 'Chrome 39'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux i686) AppleWebKit/538.15 (KHTML, like Gecko) Version/8.0 Safari/538.15 Ubuntu/14.10 (3.10.3-0ubuntu3) Epiphany/3.10.3'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '14.10'
      OperatingSystemNameVersion           : 'Ubuntu 14.10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '538.15'
      LayoutEngineVersionMajor             : '538'
      LayoutEngineNameVersion              : 'AppleWebKit 538.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 538'
      AgentClass                           : 'Browser'
      AgentName                            : 'Safari'
      AgentVersion                         : '8.0'
      AgentVersionMajor                    : '8'
      AgentNameVersion                     : 'Safari 8.0'
      AgentNameVersionMajor                : 'Safari 8'

- test:
    input:
      user_agent_string: 'Opera/9.80 (X11; FreeBSD 9.1-RELEASE-p7 amd64) Presto/2.12.388 Version/12.16'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'FreeBSD Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'AMD64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'FreeBSD'
      OperatingSystemVersion               : '9.1-RELEASE-p7'
      OperatingSystemNameVersion           : 'FreeBSD 9.1-RELEASE-p7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '2.12.388'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Presto 2.12.388'
      LayoutEngineNameVersionMajor         : 'Presto 2'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera'
      AgentVersion                         : '12.16'
      AgentVersionMajor                    : '12'
      AgentNameVersion                     : 'Opera 12.16'
      AgentNameVersionMajor                : 'Opera 12'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; OpenBSD i386; rv:34.0) Gecko/20100101 Firefox/34.0'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'OpenBSD Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i386'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'OpenBSD'
      OperatingSystemVersion               : 'i386'
      OperatingSystemNameVersion           : 'OpenBSD i386'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '34.0'
      LayoutEngineVersionMajor             : '34'
      LayoutEngineNameVersion              : 'Gecko 34.0'
      LayoutEngineNameVersionMajor         : 'Gecko 34'
      LayoutEngineBuild                    : '20100101'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '34.0'
      AgentVersionMajor                    : '34'
      AgentNameVersion                     : 'Firefox 34.0'
      AgentNameVersionMajor                : 'Firefox 34'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; NetBSD i386; rv:17.0) Gecko/20121224 Firefox/17.0'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'NetBSD Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i386'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'NetBSD'
      OperatingSystemVersion               : 'i386'
      OperatingSystemNameVersion           : 'NetBSD i386'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '17.0'
      LayoutEngineVersionMajor             : '17'
      LayoutEngineNameVersion              : 'Gecko 17.0'
      LayoutEngineNameVersionMajor         : 'Gecko 17'
      LayoutEngineBuild                    : '20121224'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '17.0'
      AgentVersionMajor                    : '17'
      AgentNameVersion                     : 'Firefox 17.0'
      AgentNameVersionMajor                : 'Firefox 17'

- matcher:
    extract:
    - 'LayoutEngineClass     :   3:"Browser"'
    - 'LayoutEngineName      :   3:"Mozilla"'
    - 'LayoutEngineVersion   :   3:agent.(1)product.(1)name="Mozilla"^.version'
    - 'AgentClass            :   3:"Browser"'
    - 'AgentName             :   3:"Netscape"'
    - 'AgentVersion          :   3:agent.(1)product.(1)name="Mozilla"^.version'

- test:
    input:
      user_agent_string: 'Mozilla 1.7.2 (FreeBSD 5.2.1) [en]'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'FreeBSD Desktop'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'FreeBSD'
      OperatingSystemVersion               : '5.2.1'
      OperatingSystemNameVersion           : 'FreeBSD 5.2.1'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '1.7.2'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Mozilla 1.7.2'
      LayoutEngineNameVersionMajor         : 'Mozilla 1'
      AgentClass                           : 'Browser'
      AgentName                            : 'Netscape'
      AgentVersion                         : '1.7.2'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Netscape 1.7.2'
      AgentNameVersionMajor                : 'Netscape 1'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'

# Joli
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Jolicloud Linux i686) AppleWebKit/537.6 (KHTML, like Gecko) Joli OS/1.2 Chromium/23.0.1240.0 Chrome/23.0.1240.0 Safari/537.6'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Joli OS'
      OperatingSystemVersion               : '1.2'
      OperatingSystemNameVersion           : 'Joli OS 1.2'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.6'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.6'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '23.0.1240.0'
      AgentVersionMajor                    : '23'
      AgentNameVersion                     : 'Chrome 23.0.1240.0'
      AgentNameVersionMajor                : 'Chrome 23'

# Linux Mint
- test:
    input:
      user_agent_string: 'Opera/9.80 (X11; Linux i686; Edition Linux Mint) Presto/2.12.388 Version/12.16'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Edition Linux Mint'
      OperatingSystemVersion               : '??'
      OperatingSystemNameVersion           : 'Edition Linux Mint ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '2.12.388'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Presto 2.12.388'
      LayoutEngineNameVersionMajor         : 'Presto 2'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera'
      AgentVersion                         : '12.16'
      AgentVersionMajor                    : '12'
      AgentNameVersion                     : 'Opera 12.16'
      AgentNameVersionMajor                : 'Opera 12'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.1.3) Gecko/20091020 Linux Mint/8 (Helena) Firefox/3.5.3'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux Mint'
      OperatingSystemVersion               : '8'
      OperatingSystemNameVersion           : 'Linux Mint 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '1.9.1.3'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Gecko 1.9.1.3'
      LayoutEngineNameVersionMajor         : 'Gecko 1'
      LayoutEngineBuild                    : '20091020'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '3.5.3'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Firefox 3.5.3'
      AgentNameVersionMajor                : 'Firefox 3'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.2.10) Gecko/20100922 Linux Mint/10 (Julia) Firefox/3.6.10'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux Mint'
      OperatingSystemVersion               : '10'
      OperatingSystemNameVersion           : 'Linux Mint 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '1.9.2.10'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Gecko 1.9.2.10'
      LayoutEngineNameVersionMajor         : 'Gecko 1'
      LayoutEngineBuild                    : '20100922'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '3.6.10'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Firefox 3.6.10'
      AgentNameVersionMajor                : 'Firefox 3'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'

#TODO All Ubuntu variants (Kubuntu)
#- test:
#    input:
#      user_agent_string: 'Mozilla/5.0 (compatible; Konqueror/3.5; Linux) KHTML/3.5.9 (like Gecko) (Kubuntu)'
#
#- test:
#    input:
#      user_agent_string: 'Mozilla/5.0 (compatible; Konqueror/4.4; Linux) KHTML/4.4.5 (like Gecko) Kubuntu'
#
#- test:
#    input:
#      user_agent_string: 'Mozilla/5.0 (X11; Linux x86_64; ChaletOS based on Xubuntu 14.04.1 LTS) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/33.0.1750.0 Maxthon/1.0.5.3 Safari/537.36'

#
#  - matcher:
#      require:
#        - 'agent.(1)product.(1)comments.entry.text="Fedora"'
#      extract:
#        - 'DeviceClass           :   5:"Desktop"'
#        - 'DeviceName            :   5:"Linux Desktop"'
#        - 'OperatingSystemClass  :   100:"Desktop"'
#        - 'OperatingSystemName   :   100:"Fedora Linux"'
#        - 'OperatingSystemVersion:   100:"??"'
#
#  - matcher:
#      extract:
#        - 'DeviceClass           :   5:"Desktop"'
#        - 'DeviceName            :   5:"Linux Desktop"'
#        - 'OperatingSystemClass  :   100:"Desktop"'
#        - 'OperatingSystemName   :   100:"Fedora Linux"'
#        - 'OperatingSystemVersion:   100:agent.(1)product.(1)comments.entry.product.name="Fedora"^.version'
#
#  - matcher:
#      extract:
#        - 'DeviceClass           :   5:"Desktop"'
#        - 'DeviceName            :   5:"Linux Desktop"'
#        - 'OperatingSystemClass  :   100:"Desktop"'
#        - 'OperatingSystemName   :   100:"Fedora Linux"'
#        - 'OperatingSystemVersion:   100:agent.product.name="Fedora"^.version'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Fedora; Linux x86_64; rv:36.0) Gecko/20100101 Firefox/36.0'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Fedora'
      OperatingSystemVersion               : '??'
      OperatingSystemNameVersion           : 'Fedora ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '36.0'
      LayoutEngineVersionMajor             : '36'
      LayoutEngineNameVersion              : 'Gecko 36.0'
      LayoutEngineNameVersionMajor         : 'Gecko 36'
      LayoutEngineBuild                    : '20100101'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '36.0'
      AgentVersionMajor                    : '36'
      AgentNameVersion                     : 'Firefox 36.0'
      AgentNameVersionMajor                : 'Firefox 36'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Fedora 20; rv:31.0) Gecko/31.0 Firefox/31.0'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Fedora'
      OperatingSystemVersion               : '20'
      OperatingSystemNameVersion           : 'Fedora 20'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '31.0'
      LayoutEngineVersionMajor             : '31'
      LayoutEngineNameVersion              : 'Gecko 31.0'
      LayoutEngineNameVersionMajor         : 'Gecko 31'
      LayoutEngineBuild                    : '31.0'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '31.0'
      AgentVersionMajor                    : '31'
      AgentNameVersion                     : 'Firefox 31.0'
      AgentNameVersionMajor                : 'Firefox 31'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.2.17) Gecko/20110428 Fedora/3.6.17-1.fc13 Firefox/3.6.17'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Fedora'
      OperatingSystemVersion               : '3.6.17-1.fc13'
      OperatingSystemNameVersion           : 'Fedora 3.6.17-1.fc13'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '1.9.2.17'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Gecko 1.9.2.17'
      LayoutEngineNameVersionMajor         : 'Gecko 1'
      LayoutEngineBuild                    : '20110428'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '3.6.17'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Firefox 3.6.17'
      AgentNameVersionMajor                : 'Firefox 3'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'

#Centos
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2.15) Gecko/20110330 CentOS/3.6-1.el5.centos Firefox/3.6.15'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'CentOS'
      OperatingSystemVersion               : '3.6-1.el5.centos'
      OperatingSystemNameVersion           : 'CentOS 3.6-1.el5.centos'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '1.9.2.15'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Gecko 1.9.2.15'
      LayoutEngineNameVersionMajor         : 'Gecko 1'
      LayoutEngineBuild                    : '20110330'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '3.6.15'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Firefox 3.6.15'
      AgentNameVersionMajor                : 'Firefox 3'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'

#Suse
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; U; Linux i686; nl; rv:1.9.2.3) Gecko/20100401 SUSE/3.6.3-1.2 Firefox/3.6.3'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'SUSE'
      OperatingSystemVersion               : '3.6.3-1.2'
      OperatingSystemNameVersion           : 'SUSE 3.6.3-1.2'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '1.9.2.3'
      LayoutEngineVersionMajor             : '1'
      LayoutEngineNameVersion              : 'Gecko 1.9.2.3'
      LayoutEngineNameVersionMajor         : 'Gecko 1'
      LayoutEngineBuild                    : '20100401'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '3.6.3'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Firefox 3.6.3'
      AgentNameVersionMajor                : 'Firefox 3'
      AgentLanguage                        : 'Dutch'
      AgentLanguageCode                    : 'nl'
      AgentSecurity                        : 'Strong security'

#26	63	Mozilla/5.0 (X11; U; Linux i686; nl; rv:1.9.0.4) Gecko/2008103100 SUSE/3.0.4-4.6 Firefox/3.0.4
#21	149	Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.1.4) Gecko/20091016 SUSE/3.5.4-1.1.2 Firefox/3.5.4
#18	593	Mozilla/5.0 (X11; U; Linux i686; nl; rv:1.9.2.24) Gecko/20111101 SUSE/3.6.24-0.2.1 Firefox/3.6.24
#12	87	Mozilla/5.0 (X11; Linux i686) AppleWebKit/537.32 (KHTML, like Gecko) Chrome/27.0.1425.0 Safari/537.32 SUSE/27.0.1425.0
#Opera/9.80 (X11; Linux x86_64; Suse) Presto/2.12.388 Version/12.16

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Macintosh; ARM Mac OS X) AppleWebKit/538.15 (KHTML, like Gecko) Safari/538.15 Version/6.0 Debian/7.8 (3.8.2.0-0rpi18rpi1) Epiphany/3.8.2'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'ARM'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Debian'
      OperatingSystemVersion               : '7.8'
      OperatingSystemNameVersion           : 'Debian 7.8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '538.15'
      LayoutEngineVersionMajor             : '538'
      AgentClass                           : 'Browser'
      AgentName                            : 'Safari'
      AgentVersion                         : '6.0'
      AgentVersionMajor                    : '6'
      AgentNameVersion                     : 'Safari 6.0'
      AgentNameVersionMajor                : 'Safari 6'
      LayoutEngineNameVersion              : 'AppleWebKit 538.15'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 538'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux i686; Debian GNU/Linux 7.8 (wheezy)) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/33.0.1750.0 Maxthon/1.0.5.3 Safari/537.36'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Debian GNU'
      OperatingSystemVersion               : '7.8'
      OperatingSystemNameVersion           : 'Debian GNU 7.8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '33.0'
      LayoutEngineVersionMajor             : '33'
      LayoutEngineNameVersion              : 'Blink 33.0'
      LayoutEngineNameVersionMajor         : 'Blink 33'
      AgentClass                           : 'Browser'
      AgentName                            : 'Maxthon'
      AgentVersion                         : '1.0.5.3'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Maxthon 1.0.5.3'
      AgentNameVersionMajor                : 'Maxthon 1'

#Mozilla/5.0 (X11; U; Linux i686; nl-nl) AppleWebKit/531.2+ (KHTML, like Gecko) Version/5.0 Safari/531.2+ Debian/squeeze (2.30.6-1) Epiphany/2.30.6
#Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.0.16) Gecko/2009121609 Iceweasel/3.0.6 (Debian-3.0.6-3)

#34      228     Mozilla/5.0 (X11; Linux x86_64) KHTML/4.8.5 (like Gecko) Konqueror/4.8 Fedora/4.8.5-2.fc16
#18      91      Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.21 (KHTML, like Gecko) konqueror/4.14.3 Safari/537.21
#8       24      Mozilla/5.0 (X11; Linux x86_64) KHTML/4.8.4 (like Gecko) Konqueror/4.8
#7       67      Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.21 (KHTML, like Gecko) konqueror/4.14.4 Safari/537.21
#6       35      Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.21 (KHTML, like Gecko) konqueror/4.14.2 Safari/537.21
#5       86      Mozilla/5.0 (X11; Linux i686) AppleWebKit/534.34 (KHTML, like Gecko) konqueror/4.10.5 Safari/534.34
#5       14      Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/534.34 (KHTML, like Gecko) konqueror/4.10.5 Safari/534.34
#5       13      Mozilla/5.0 (compatible; Konqueror/4.4; Linux) KHTML/4.4.5 (like Gecko)
#5       12      Mozilla/5.0 (X11; Linux 3.8-6.dmz.1-liquorix-686) KHTML/4.8.4 (like Gecko) Konqueror/4.8
#4       8       Mozilla/5.0 (X11; Linux x86_64) KHTML/4.14.2 (like Gecko) Konqueror/4.14
#4       6       Mozilla/5.0 (compatible; Konqueror/4.4; Linux 2.6.32-22-generic; X11; en_US) KHTML/4.4.3 (like Gecko) Kubuntu
#4       5       Mozilla/5.0 (X11; FreeBSD) KHTML/4.9.1 (like Gecko) Konqueror/4.9
#4       4       Mozilla/5.0 (compatible; Konqueror/3.2; FreeBSD) (KHTML, like Gecko)
#3       7       Mozilla/5.0 (X11; Linux x86_64) KHTML/4.13.3 (like Gecko) Konqueror/4.13
#3       7       Mozilla/5.0 (X11; Linux i686) KHTML/4.13.3 (like Gecko) Konqueror/4.13
#3       6       Mozilla/5.0 (compatible; Konqueror/3.5; Darwin)  KHTML/3.5.6 (like Gecko)
#Opera/9.80 (X11; FreeBSD 10.1-RELEASE-p17 amd64) Presto/2.12.388 Version/12.16
#Opera/9.80 (X11; FreeBSD 10.1-RELEASE-p5 amd64) Presto/2.12.388 Version/12.16
#Opera/9.80 (X11; FreeBSD 7.4-RELEASE amd64) Presto/2.12.388 Version/12.14
#Opera/9.80 (X11; FreeBSD 8.1-RELEASE i386; Edition Next) Presto/2.12.388 Version/12.10
#Opera/9.80 (X11; FreeBSD 8.4-RELEASE amd64) Presto/2.12.388 Version/12.16


<!doctype html><html lang=en-us dir=ltr itemscope itemtype=http://schema.org/Article><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.136.3"><meta name=generator content="Relearn 7.0.1"><meta name=description content="Introduction User Defined Function (ingest processor) for Elastic Search
STATUS: … EXPERIMENTAL … The ElasticSearch ingest plugin is very new.
And yes it is similar to https://www.elastic.co/guide/en/elasticsearch/reference/master/user-agent-processor.html
Getting the UDF Starting with 7.31.0 the prebuilt UDF is no longer distributed by me.
The ONLY reason for this change is that Elastic Search is VERY picky about the version of ES the Plugin was built for. If you have a Yauaa Plugin that was built against ES 8.17.1 then that plugin will not load in ES 8.17.2."><meta name=author content="Niels Basjes"><meta name=twitter:card content="summary"><meta name=twitter:title content="Elastic Search  |  Yauaa - Yet Another UserAgent Analyzer"><meta name=twitter:description content="Introduction User Defined Function (ingest processor) for Elastic Search
STATUS: … EXPERIMENTAL … The ElasticSearch ingest plugin is very new.
And yes it is similar to https://www.elastic.co/guide/en/elasticsearch/reference/master/user-agent-processor.html
Getting the UDF Starting with 7.31.0 the prebuilt UDF is no longer distributed by me.
The ONLY reason for this change is that Elastic Search is VERY picky about the version of ES the Plugin was built for. If you have a Yauaa Plugin that was built against ES 8.17.1 then that plugin will not load in ES 8.17.2."><meta property="og:url" content="/udf/elastic-search/index.html"><meta property="og:site_name" content="Yauaa - Yet Another UserAgent Analyzer"><meta property="og:title" content="Elastic Search  |  Yauaa - Yet Another UserAgent Analyzer"><meta property="og:description" content="Introduction User Defined Function (ingest processor) for Elastic Search
STATUS: … EXPERIMENTAL … The ElasticSearch ingest plugin is very new.
And yes it is similar to https://www.elastic.co/guide/en/elasticsearch/reference/master/user-agent-processor.html
Getting the UDF Starting with 7.31.0 the prebuilt UDF is no longer distributed by me.
The ONLY reason for this change is that Elastic Search is VERY picky about the version of ES the Plugin was built for. If you have a Yauaa Plugin that was built against ES 8.17.1 then that plugin will not load in ES 8.17.2."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="User Defined Functions"><meta itemprop=name content="Elastic Search  |  Yauaa - Yet Another UserAgent Analyzer"><meta itemprop=description content="Introduction User Defined Function (ingest processor) for Elastic Search
STATUS: … EXPERIMENTAL … The ElasticSearch ingest plugin is very new.
And yes it is similar to https://www.elastic.co/guide/en/elasticsearch/reference/master/user-agent-processor.html
Getting the UDF Starting with 7.31.0 the prebuilt UDF is no longer distributed by me.
The ONLY reason for this change is that Elastic Search is VERY picky about the version of ES the Plugin was built for. If you have a Yauaa Plugin that was built against ES 8.17.1 then that plugin will not load in ES 8.17.2."><meta itemprop=wordCount content="876"><title>Elastic Search | Yauaa - Yet Another UserAgent Analyzer</title><link rel=apple-touch-icon sizes=180x180 href=/favicon/apple-touch-icon.png>
<link rel=icon type=image/png sizes=32x32 href=/favicon/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon/favicon-16x16.png><link rel=manifest href=/favicon/manifest.json><link rel=mask-icon href=/favicon/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#2d89ef"><meta name=msapplication-TileImage content="/favicon/mstile-144x144.png"><meta name=theme-color content="#ffffff"><link href=/css/fontawesome-all.min.css?1758619091 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/fontawesome-all.min.css?1758619091 rel=stylesheet></noscript><link href=/css/nucleus.css?1758619091 rel=stylesheet><link href=/css/auto-complete.css?1758619091 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/auto-complete.css?1758619091 rel=stylesheet></noscript><link href=/css/perfect-scrollbar.min.css?1758619091 rel=stylesheet><link href=/css/fonts.css?1758619091 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/fonts.css?1758619091 rel=stylesheet></noscript><link href=/css/theme.css?1758619091 rel=stylesheet><link href=/css/theme-yauaa.css?1758619091 rel=stylesheet id=R-variant-style><link href=/css/chroma-relearn-light.css?1758619091 rel=stylesheet id=R-variant-chroma-style><link href=/css/print.css?1758619091 rel=stylesheet media=print><script src=/js/variant.js?1758619091></script><script>window.relearn=window.relearn||{},window.relearn.relBasePath="../..",window.relearn.relBaseUri="../..",window.relearn.absBaseUri="",window.relearn.disableAnchorCopy=!1,window.relearn.disableAnchorScrolling=!1,window.variants&&variants.init(["yauaa"]),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`</script><script type=text/javascript>var _paq=window._paq=window._paq||[];_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){t="https://wa.basjes.nl/",_paq.push(["setTrackerUrl",t+"wa.php"]),_paq.push(["setSiteId","1"]);var t,n=document,e=n.createElement("script"),s=n.getElementsByTagName("script")[0];e.type="text/javascript",e.async=!0,e.src=t+"wa.js",s.parentNode.insertBefore(e,s)}()</script></head><body class="mobile-support html disableInlineCopyToClipboard" data-url=/udf/elastic-search/index.html><div id=R-body class=default-animation><div id=R-body-overlay></div><nav id=R-topbar><div class=topbar-wrapper><div class=topbar-sidebar-divider></div><div class="topbar-area topbar-area-start" data-area=start><div class="topbar-button topbar-button-sidebar" data-content-empty=disable data-width-s=show data-width-m=hide data-width-l=hide><button class=topbar-control onclick=toggleNav() type=button title="Menu (CTRL+ALT+n)"><i class="fa-fw fas fa-bars"></i></button></div><div class="topbar-button topbar-button-toc" data-content-empty=hide data-width-s=show data-width-m=show data-width-l=show><button class=topbar-control onclick=toggleTopbarFlyout(this) type=button title="Table of Contents (CTRL+ALT+t)"><i class="fa-fw fas fa-list-alt"></i></button><div class=topbar-content><div class=topbar-content-wrapper><nav class=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#status--experimental->STATUS: &mldr; EXPERIMENTAL &mldr;</a></li><li><a href=#getting-the-udf>Getting the UDF</a></li><li><a href=#installing-the-plugin>Installing the plugin</a></li><li><a href=#usage>Usage</a></li><li><a href=#example-usage>Example usage</a><ul><li><a href=#basic-pipeline>Basic pipeline</a></li><li><a href=#common-pipeline>Common pipeline</a></li><li><a href=#advanced-pipeline>Advanced pipeline</a></li></ul></li><li><a href=#put-record>Put record</a></li><li><a href=#notes-for-developers>NOTES for developers</a></li></ul></nav></div></div></div></div><ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/index.html><span itemprop=name>Yauaa</span></a><meta itemprop=position content="1">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/udf/index.html><span itemprop=name>User Defined Functions</span></a><meta itemprop=position content="2">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>Elastic Search</span><meta itemprop=position content="3"></li></ol><div class="topbar-area topbar-area-end" data-area=end><div class="topbar-button topbar-button-edit" data-content-empty=disable data-width-s=area-more data-width-m=show data-width-l=show><a class=topbar-control href=https://github.com/nielsbasjes/yauaa/tree/main/documentation/content/udf/Elastic-Search.md target=_blank title="Edit (CTRL+ALT+w)"><i class="fa-fw fas fa-pen"></i></a></div><div class="topbar-button topbar-button-more" data-content-empty=hide data-width-s=show data-width-m=show data-width-l=show><button class=topbar-control onclick=toggleTopbarFlyout(this) type=button title=More><i class="fa-fw fas fa-ellipsis-v"></i></button><div class=topbar-content><div class=topbar-content-wrapper><div class="topbar-area topbar-area-more" data-area=more></div></div></div></div></div></div></nav><div id=R-main-overlay></div><main id=R-body-inner class="highlightable udf" tabindex=-1><div class=flex-block-wrapper><article class=default><header class=headline></header><h1 id=elastic-search>Elastic Search</h1><h2 id=introduction>Introduction</h2><p>User Defined Function (ingest processor) for <a href=https://www.elastic.co/guide/en/elasticsearch/plugins/current/intro.html rel=external target=_blank>Elastic Search</a></p><h2 id=status--experimental->STATUS: &mldr; EXPERIMENTAL &mldr;</h2><p>The ElasticSearch ingest plugin is very new.</p><p>And yes it is similar to <a href=https://www.elastic.co/guide/en/elasticsearch/reference/master/user-agent-processor.html rel=external target=_blank>https://www.elastic.co/guide/en/elasticsearch/reference/master/user-agent-processor.html</a></p><h2 id=getting-the-udf>Getting the UDF</h2><p>Starting with 7.31.0 the prebuilt UDF is no longer distributed by me.</p><p>The <strong>ONLY</strong> reason for this change is that Elastic Search is VERY picky about the version of ES the Plugin was built for. If you have a Yauaa Plugin that was built against ES 8.17.1 then that plugin will not load in ES 8.17.2.</p><p>The way now for you to get the right version of the plugin for your installation is to build de UDF yourself.</p><ol><li><p>Get a Linux machine (I use Ubuntu 24.04 LTS) with docker and git installed. Running this in a VM or a recent WSL (running on Windows 11) is fine.</p></li><li><p>Get the sourcecode and open the latest released version</p><div class="highlight wrap-code"><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span> git clone https://github.com/nielsbasjes/yauaa
</span></span><span style=display:flex><span> cd yauaa
</span></span><span style=display:flex><span> git checkout v7.31.0</span></span></code></pre></div></li><li><p>Change to the exact version you need. Edit in the <code>pom.xml</code> the property for the version you need. Assume you want it for ES 8.17.3 then change the <code>elasticsearch-8.version</code> property to that version.
This command does that:</p><div class="highlight wrap-code"><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sed -i <span style=color:#e6db74>&#39;s@&lt;elasticsearch-8.version&gt;[^&lt;]\+&lt;/elasticsearch-8.version&gt;@&lt;elasticsearch-8.version&gt;8.17.3&lt;/elasticsearch-8.version&gt;@g&#39;</span>  pom.xml</span></span></code></pre></div><p>In this example it will look like this <code>&lt;elasticsearch-8.version>8.17.3&lt;/elasticsearch-8.version></code>.</p></li><li><p>Start the docker based build environment.</p><div class="highlight wrap-code"><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./start-docker.sh</span></span></code></pre></div></li><li><p>In this environment build the plugin</p><div class="highlight wrap-code"><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mvn package -pl :yauaa-devtools,:yauaa-elasticsearch-8</span></span></code></pre></div></li><li><p>Exit the docker based environment again</p><div class="highlight wrap-code"><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>exit</span></span></code></pre></div></li><li><p>Now you should have the file <code>udfs/elastic/elasticsearch-8/target/yauaa-elasticsearch-8-7.31.0.zip</code> which you can install on your installation.</p></li></ol><p>Replace <code>elasticsearch-8</code> with <code>elasticsearch-9</code> in the above example incase you have an ElasticSearch 9.x installation.</p><h2 id=installing-the-plugin>Installing the plugin</h2><p>You only need to install it into your Elastic Search once</p><p>On Elastic Search 7.x:</p><div class="highlight wrap-code"><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>bin/elasticsearch-plugin install file:///path/to/yauaa-elasticsearch-7.31.0.zip</span></span></code></pre></div><p>On Elastic Search 8.x</p><div class="highlight wrap-code"><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>bin/elasticsearch-plugin install file:///path/to/yauaa-elasticsearch-8-7.31.0.zip</span></span></code></pre></div><p>On Elastic Search 9.x</p><div class="highlight wrap-code"><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>bin/elasticsearch-plugin install file:///path/to/yauaa-elasticsearch-9-7.31.0.zip</span></span></code></pre></div><h2 id=usage>Usage</h2><p>This plugin is intended to be used in an <code>ingest pipeline</code>.</p><p>You have to specify the name of the input <code>field</code> and the place where
the possible configuration flags are:</p><table><thead><tr><th>Name</th><th>Mandatory/Optional</th><th>Description</th><th>Default</th><th>Example</th></tr></thead><tbody><tr><td>field_to_header_mapping</td><td>M</td><td>The mapping from the input field name to the <code>original</code> request header name of this field</td><td>-</td><td><code>"field_to_header_mapping" : { "ua": "User-Agent" }</code></td></tr><tr><td>target_field</td><td>M</td><td>The name of the output structure that will be filled with the parse results</td><td><code>"user_agent"</code></td><td><code>"parsed_ua"</code></td></tr><tr><td>fieldNames</td><td>O</td><td>A list of Yauaa fieldnames that are desired. When specified the system will limit processing to what is needed to get these. This means faster and less memory used.</td><td>All possible fields</td><td><code>[ "DeviceClass", "DeviceBrand", "DeviceName", "AgentNameVersionMajor" ]</code></td></tr><tr><td>cacheSize</td><td>O</td><td>The number of entries in the LRU cache of the parser</td><td><code>10000</code></td><td><code>100</code></td></tr><tr><td>preheat</td><td>O</td><td>How many testcases are put through the parser at startup to warmup the JVM</td><td><code>0</code></td><td><code>1000</code></td></tr><tr><td>extraRules</td><td>O</td><td>A yaml expression that is a set of extra rules and testcases.</td><td>-</td><td><code>"config:\n- matcher:\n extract:\n - '"'"'FirstProductName : 1 :agent.(1)product.(1)name'"'"'\n"</code></td></tr></tbody></table><h2 id=example-usage>Example usage</h2><h3 id=basic-pipeline>Basic pipeline</h3><p>Create a pipeline that just extracts everything using the default settings:</p><div class="highlight wrap-code"><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -H <span style=color:#e6db74>&#39;Content-Type: application/json&#39;</span> -X PUT <span style=color:#e6db74>&#39;localhost:9200/_ingest/pipeline/yauaa-test-pipeline_basic&#39;</span> -d <span style=color:#e6db74>&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>{
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  &#34;description&#34;: &#34;A pipeline to do whatever&#34;,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  &#34;processors&#34;: [
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    {
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      &#34;yauaa&#34; : {
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        &#34;field_to_header_mapping&#34; : {
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            &#34;useragent&#34;:                &#34;User-Agent&#34;,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            &#34;uach_platform&#34;:            &#34;Sec-CH-UA-Platform&#34;,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            &#34;uach_platform_version&#34;:    &#34;Sec-CH-UA-Platform-Version&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        },
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        &#34;target_field&#34;  : &#34;parsed&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      }
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    }
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  ]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#39;</span></span></span></code></pre></div><h3 id=common-pipeline>Common pipeline</h3><p>In this example a pipeline is created that only gets the fields that are actually desired.</p><div class="highlight wrap-code"><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -H <span style=color:#e6db74>&#39;Content-Type: application/json&#39;</span> -X PUT <span style=color:#e6db74>&#39;localhost:9200/_ingest/pipeline/yauaa-test-pipeline_some&#39;</span> -d <span style=color:#e6db74>&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>{
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  &#34;description&#34;: &#34;A pipeline to do whatever&#34;,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  &#34;processors&#34;: [
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    {
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      &#34;yauaa&#34; : {
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        &#34;field_to_header_mapping&#34; : {
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            &#34;useragent&#34;:                &#34;User-Agent&#34;,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            &#34;uach_platform&#34;:            &#34;Sec-CH-UA-Platform&#34;,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            &#34;uach_platform_version&#34;:    &#34;Sec-CH-UA-Platform-Version&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        },
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        &#34;target_field&#34;  : &#34;parsed&#34;,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        &#34;fieldNames&#34;    : [ &#34;DeviceClass&#34;, &#34;DeviceBrand&#34;, &#34;DeviceName&#34;, &#34;AgentNameVersionMajor&#34;, &#34;FirstProductName&#34; ],
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      }
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    }
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  ]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#39;</span></span></span></code></pre></div><h3 id=advanced-pipeline>Advanced pipeline</h3><p>In this example a pipeline is created that includes an example of a custom rule.
The hardest part is making the yaml (with quotes, newlines and the needed indentation) encode correctly inside a JSon structure.</p><div class="highlight wrap-code"><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -H <span style=color:#e6db74>&#39;Content-Type: application/json&#39;</span> -X PUT <span style=color:#e6db74>&#39;localhost:9200/_ingest/pipeline/yauaa-test-pipeline_full&#39;</span> -d <span style=color:#e6db74>&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>{
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  &#34;description&#34;: &#34;A pipeline to do whatever&#34;,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  &#34;processors&#34;: [
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    {
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      &#34;yauaa&#34; : {
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        &#34;field_to_header_mapping&#34; : {
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            &#34;useragent&#34;:                &#34;User-Agent&#34;,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            &#34;uach_platform&#34;:            &#34;Sec-CH-UA-Platform&#34;,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            &#34;uach_platform_version&#34;:    &#34;Sec-CH-UA-Platform-Version&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        },
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        &#34;target_field&#34;  : &#34;parsed&#34;,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        &#34;fieldNames&#34;    : [ &#34;DeviceClass&#34;, &#34;DeviceBrand&#34;, &#34;DeviceName&#34;, &#34;AgentNameVersionMajor&#34;, &#34;FirstProductName&#34; ],
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        &#34;cacheSize&#34; : 10,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        &#34;preheat&#34;   : 10,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        &#34;extraRules&#34; : &#34;config:\n- matcher:\n    extract:\n      - &#39;</span><span style=color:#e6db74>&#34;&#39;&#34;</span><span style=color:#e6db74>&#39;FirstProductName     : 1 :agent.(1)product.(1)name&#39;</span><span style=color:#e6db74>&#34;&#39;&#34;</span><span style=color:#e6db74>&#39;\n&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      }
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    }
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  ]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#39;</span></span></span></code></pre></div><h2 id=put-record>Put record</h2><p>I put a record in ElasticSearch using the above mentioned <code>Advanced pipeline</code></p><div class="highlight wrap-code"><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -H <span style=color:#e6db74>&#39;Content-Type: application/json&#39;</span> -X PUT <span style=color:#e6db74>&#39;localhost:9200/my-index/my-type/1?pipeline=yauaa-test-pipeline_full&#39;</span> -d <span style=color:#e6db74>&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>{
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  &#34;useragent&#34; : &#34;Mozilla/5.0 (Linux; Android 7.0; Nexus 6 Build/NBD90Z) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.124 Mobile Safari/537.36&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#39;</span></span></span></code></pre></div><p>which returns</p><div class="highlight wrap-code"><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{<span style=color:#f92672>&#34;_index&#34;</span>:<span style=color:#e6db74>&#34;my-index&#34;</span>,<span style=color:#f92672>&#34;_type&#34;</span>:<span style=color:#e6db74>&#34;my-type&#34;</span>,<span style=color:#f92672>&#34;_id&#34;</span>:<span style=color:#e6db74>&#34;1&#34;</span>,<span style=color:#f92672>&#34;_version&#34;</span>:<span style=color:#ae81ff>1</span>,<span style=color:#f92672>&#34;result&#34;</span>:<span style=color:#e6db74>&#34;created&#34;</span>,<span style=color:#f92672>&#34;_shards&#34;</span>:{<span style=color:#f92672>&#34;total&#34;</span>:<span style=color:#ae81ff>2</span>,<span style=color:#f92672>&#34;successful&#34;</span>:<span style=color:#ae81ff>1</span>,<span style=color:#f92672>&#34;failed&#34;</span>:<span style=color:#ae81ff>0</span>},<span style=color:#f92672>&#34;_seq_no&#34;</span>:<span style=color:#ae81ff>0</span>,<span style=color:#f92672>&#34;_primary_term&#34;</span>:<span style=color:#ae81ff>1</span>}</span></span></code></pre></div><p>then I retrieve the record from elasticsearch and the additional parse results are now part of the indexed record.</p><pre><code>curl -s -H 'Content-Type: application/json' -X GET 'localhost:9200/my-index/my-type/1' | python -m json.tool
</code></pre><p>results in</p><pre><code>{
    &quot;_id&quot;: &quot;1&quot;,
    &quot;_index&quot;: &quot;my-index&quot;,
    &quot;_primary_term&quot;: 1,
    &quot;_seq_no&quot;: 0,
    &quot;_source&quot;: {
        &quot;parsed&quot;: {
            &quot;AgentName&quot;: &quot;Chrome&quot;,
            &quot;AgentNameVersionMajor&quot;: &quot;Chrome 53&quot;,
            &quot;AgentVersion&quot;: &quot;53.0.2785.124&quot;,
            &quot;AgentVersionMajor&quot;: &quot;53&quot;,
            &quot;DeviceBrand&quot;: &quot;Google&quot;,
            &quot;DeviceClass&quot;: &quot;Phone&quot;,
            &quot;DeviceName&quot;: &quot;Google Nexus 6&quot;,
            &quot;FirstProductName&quot;: &quot;Mozilla&quot;
        },
        &quot;useragent&quot;: &quot;Mozilla/5.0 (Linux; Android 7.0; Nexus 6 Build/NBD90Z) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.124 Mobile Safari/537.36&quot;
    },
    &quot;_type&quot;: &quot;my-type&quot;,
    &quot;_version&quot;: 1,
    &quot;found&quot;: true
}
</code></pre><h2 id=notes-for-developers>NOTES for developers</h2><p>The ElasticSearch testing tools are quick to complain about jar classloading issues: &ldquo;jar hell&rdquo;.</p><p>To make it possible to test this in IntelliJ you&rsquo;ll need to set a custom property</p><ol><li>Help &ndash;> Edit Custom properties</li><li>Make sure there is a line with <code>idea.no.launcher=true</code></li><li>Restart IntelliJ</li></ol><p>See also <a href=https://stackoverflow.com/questions/51045201/using-the-elasticsearch-test-framework-in-intellij-how-to-resolve-the-jar-hell/51045272 rel=external target=_blank>https://stackoverflow.com/questions/51045201/using-the-elasticsearch-test-framework-in-intellij-how-to-resolve-the-jar-hell/51045272</a></p><footer class=footline></footer></article></div></main></div><aside id=R-sidebar class=default-animation><div id=R-header-topbar class=default-animation></div><div id=R-header-wrapper class=default-animation><div id=R-header class=default-animation><a id=logo href=/><p class=logo-bar>Yauaa</p></a></div><script>window.index_js_url="/searchindex.js?1758619091"</script><search><form action=/search/index.html method=get><div class="searchbox default-animation"><button class=search-detail type=submit title="Search (CTRL+ALT+f)"><i class="fas fa-search"></i></button>
<label class=a11y-only for=R-search-by>Search</label>
<input data-search-input id=R-search-by name=search-by class=search-by type=search placeholder=Search...>
<button class=search-clear type=button data-search-clear title="Clear search"><i class="fas fa-times" title="Clear search"></i></button></div></form></search><script>var contentLangs=["en"]</script><script src=/js/auto-complete.js?1758619091 defer></script><script src=/js/lunr/lunr.min.js?1758619091 defer></script><script src=/js/lunr/lunr.stemmer.support.min.js?1758619091 defer></script><script src=/js/lunr/lunr.multi.min.js?1758619091 defer></script><script src=/js/lunr/lunr.en.min.js?1758619091 defer></script><script src=/js/search.js?1758619091 defer></script></div><div id=R-homelinks class="default-animation homelinks"><ul><li><a class=padding href=/index.html><i class='fas fa-home'></i> Yauaa</a></li></ul><hr class=padding></div><div id=R-content-wrapper class=highlightable><div id=R-topics><ul class="enlarge morespace collapsible-menu"><li data-nav-id=/expect/index.html><a class=padding href=/expect/index.html>What to expect</a><ul id=R-subsections-0cc162f4d70118f5b01edda6c8732e77 class=collapsible-menu></ul></li><li data-nav-id=/using/index.html><a class=padding href=/using/index.html>Using Yauaa</a><ul id=R-subsections-790b0ab426eab6dc92cf29e810f15854 class=collapsible-menu></ul></li><li class=parent data-nav-id=/udf/index.html><a class=padding href=/udf/index.html>User Defined Functions</a><ul id=R-subsections-b853d96ac1607b20a47f0b01f30f143a class=collapsible-menu><li data-nav-id=/udf/apache-beam/index.html><a class=padding href=/udf/apache-beam/index.html>Apache Beam</a></li><li data-nav-id=/udf/apache-beam-sql/index.html><a class=padding href=/udf/apache-beam-sql/index.html>Apache Beam SQL</a></li><li data-nav-id=/udf/apache-drill/index.html><a class=padding href=/udf/apache-drill/index.html>Apache Drill</a></li><li data-nav-id=/udf/apache-flink/index.html><a class=padding href=/udf/apache-flink/index.html>Apache Flink</a></li><li data-nav-id=/udf/apache-flink-table/index.html><a class=padding href=/udf/apache-flink-table/index.html>Apache Flink Table/SQL</a></li><li data-nav-id=/udf/apache-hive/index.html><a class=padding href=/udf/apache-hive/index.html>Apache Hive</a></li><li data-nav-id=/udf/apache-nifi/index.html><a class=padding href=/udf/apache-nifi/index.html>Apache Nifi</a></li><li data-nav-id=/udf/apache-pig/index.html><a class=padding href=/udf/apache-pig/index.html>Apache Pig</a></li><li data-nav-id=/udf/commandline/index.html><a class=padding href=/udf/commandline/index.html>Commandline usage</a></li><li data-nav-id=/udf/elastic-logstash/index.html><a class=padding href=/udf/elastic-logstash/index.html>Elastic LogStash</a></li><li class=active data-nav-id=/udf/elastic-search/index.html><a class=padding href=/udf/elastic-search/index.html>Elastic Search</a></li><li data-nav-id=/udf/logparser/index.html><a class=padding href=/udf/logparser/index.html>LogParser</a></li><li data-nav-id=/udf/snowflake/index.html><a class=padding href=/udf/snowflake/index.html>Snowflake</a></li><li data-nav-id=/udf/snowplow/index.html><a class=padding href=/udf/snowplow/index.html>Snowplow</a></li><li data-nav-id=/udf/trino/index.html><a class=padding href=/udf/trino/index.html>Trino</a></li></ul></li><li data-nav-id=/developer/index.html><a class=padding href=/developer/index.html>Development</a><ul id=R-subsections-f87f59ebc94679f99e2683cdd4170483 class=collapsible-menu></ul></li><li data-nav-id=/other/index.html><a class=padding href=/other/index.html>Other</a><ul id=R-subsections-dd17f32865650128ca32bc9ce5ee4fdf class=collapsible-menu></ul></li></ul></div><div id=R-shortcuts><div class="nav-title padding">More</div><ul class=space><li><a class=padding href=https://github.com/nielsbasjes/yauaa><i class='fab fa-git-square'></i> Git repo</a></li><li><a class=padding href=https://github.com/nielsbasjes/yauaa/discussions><i class='fa fa-comment-alt'></i> Discussions</a></li><li><a class=padding href=https://github.com/nielsbasjes/yauaa/blob/main/CHANGELOG.md><i class='fa fa-file-alt'></i> Changelog</a></li><li><a class=padding href=https://github.com/nielsbasjes/yauaa/issues><i class='fa fa-bug'></i> Issue tracker</a></li><li><a class=padding href=https://github.com/nielsbasjes/yauaa/actions><img alt="Github actions Build status" src="https://img.shields.io/github/actions/workflow/status/nielsbasjes/yauaa/build.yml?branch=main"></a></li><li><a class=padding href=https://app.codecov.io/gh/nielsbasjes/yauaa><img alt="Coverage Status" src=https://img.shields.io/codecov/c/github/nielsbasjes/yauaa></a></li><li><a class=padding href=https://www.apache.org/licenses/LICENSE-2.0.html><img alt=License src=https://img.shields.io/:license-apache-blue.svg></a></li><li><a class=padding href=https://central.sonatype.com/namespace/nl.basjes.parse.useragent><img alt="Maven Central" src="https://img.shields.io/maven-central/v/nl.basjes.parse.useragent/yauaa-parent.svg?label=Maven%20central"></a></li><li><a class=padding href=https://github.com/jvm-repo-rebuild/reproducible-central#nl.basjes.parse.useragent:yauaa><img alt="Reproducible Builds" src="https://img.shields.io/badge/Reproducible_Builds-ok-success?labelColor=1e5b96"></a></li><li><a class=padding href=https://github.com/nielsbasjes/yauaa/stargazers><img alt="GitHub stars" src="https://img.shields.io/github/stars/nielsbasjes/yauaa?label=GitHub%20stars"></a></li><li><a class=padding href=https://hub.docker.com/r/nielsbasjes/yauaa><img alt="Docker Image" src="https://img.shields.io/docker/v/nielsbasjes/yauaa/latest?arch=amd64&label=Docker%20image"></a></li><li><a class=padding href=https://hub.docker.com/r/nielsbasjes/yauaa><img alt="Docker Pulls" src="https://img.shields.io/docker/pulls/nielsbasjes/yauaa?label=Docker%20pulls"></a></li><li><a class=padding href=https://github.com/sponsors/nielsbasjes><img alt="If this project has business value for you then dont hesitate to support me with a small donation." src=https://img.shields.io/badge/Sponsor%20me-via%20Github-darkgreen.svg></a></li><li><a class=padding href=https://www.paypal.me/nielsbasjes><img alt="If this project has business value for you then dont hesitate to support me with a small donation." src=https://img.shields.io/badge/Donations-via%20Paypal-red.svg></a></li></ul></div><div class="padding footermargin footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showFooter"></div><div id=R-menu-footer><hr class="padding default-animation footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showFooter"><div id=R-prefooter class="footerLangSwitch footerVariantSwitch footerVisitedLinks"><ul><li id=R-select-language-container class=footerLangSwitch><div class="padding menu-control"><i class="fa-fw fas fa-language"></i>
<span>&nbsp;</span><div class=control-style><label class=a11y-only for=R-select-language>Language</label>
<select id=R-select-language onchange="location=this.querySelector(this.value).dataset.url"><option id=R-select-language-en value=#R-select-language-en data-url=/udf/elastic-search/index.html lang=en-us selected></option></select></div><div class=clear></div></div></li><li id=R-select-variant-container class=footerVariantSwitch><div class="padding menu-control"><i class="fa-fw fas fa-paint-brush"></i>
<span>&nbsp;</span><div class=control-style><label class=a11y-only for=R-select-variant>Theme</label>
<select id=R-select-variant onchange=window.variants&&variants.changeVariant(this.value)><option id=R-select-variant-yauaa value=yauaa selected>Yauaa</option></select></div><div class=clear></div></div><script>window.variants&&variants.markSelectedVariant()</script></li><li class=footerVisitedLinks><div class="padding menu-control"><i class="fa-fw fas fa-history"></i>
<span>&nbsp;</span><div class=control-style><button onclick=clearHistory()>Clear History</button></div><div class=clear></div></div></li></ul></div><div id=R-footer class="footerFooter showFooter"><p><img alt="NO AI: Deterministic, Predictable, Secure, Private, Offline, Safe, Fast" src=/NoAI_DeterministicPrivateFast-250x250.png></p><p><b>Yauaa does not use any AI at runtime.</b></p><p><i>This makes it Deterministic, Predictable, Offline, Secure, Private, Safe and Fast</i></p><p>&copy;2013-2025 by <a href=https://niels.basjes.nl>Niels Basjes</a></p></div></div></div></aside><script src=/js/clipboard.min.js?1758619091 defer></script><script src=/js/perfect-scrollbar.min.js?1758619091 defer></script><script src=/js/theme.js?1758619091 defer></script></body></html>
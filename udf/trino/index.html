<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.134.2"><meta name=description content="This is a java library that tries to parse and analyze the useragent string (and when available the User-Agent Client Hints) and extract as many relevant attributes as possible."><meta name=author content="Niels Basjes"><link rel=apple-touch-icon sizes=180x180 href=/favicon/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon/favicon-16x16.png><link rel=manifest href=/favicon/manifest.json><link rel=mask-icon href=/favicon/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#2d89ef"><meta name=msapplication-TileImage content="/favicon/mstile-144x144.png"><meta name=theme-color content="#ffffff"><title>Trino | Yauaa - Yet Another UserAgent Analyzer</title>
<link href=/css/nucleus.css?1726765846 rel=stylesheet><link href=/css/fontawesome-all.min.css?1726765846 rel=stylesheet><link href=/css/hybrid.css?1726765846 rel=stylesheet><link href=/css/featherlight.min.css?1726765846 rel=stylesheet><link href=/css/perfect-scrollbar.min.css?1726765846 rel=stylesheet><link href=/css/auto-complete.css?1726765846 rel=stylesheet><link href=/css/atom-one-dark-reasonable.css?1726765846 rel=stylesheet><link href=/css/theme.css?1726765846 rel=stylesheet><link href=/css/tabs.css?1726765846 rel=stylesheet><link href=/css/hugo-theme.css?1726765846 rel=stylesheet><link href=/css/theme-yauaa.css?1726765846 rel=stylesheet><script src=/js/jquery-3.3.1.min.js?1726765846></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}:not(pre)>code+span.copy-to-clipboard{display:none}</style><script type=text/javascript>var _paq=window._paq=window._paq||[];_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){t="https://wa.basjes.nl/",_paq.push(["setTrackerUrl",t+"wa.php"]),_paq.push(["setSiteId","1"]);var t,n=document,e=n.createElement("script"),s=n.getElementsByTagName("script")[0];e.type="text/javascript",e.async=!0,e.src=t+"wa.js",s.parentNode.insertBefore(e,s)}()</script></head><body data-url=/udf/trino/><nav id=sidebar><div id=header-wrapper><div id=header><a id=logo href=/><p class=logo-bar>Yauaa</p></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=/js/lunr.min.js?1726765846></script><script type=text/javascript src=/js/auto-complete.js?1726765846></script><script type=text/javascript>var baseurl="/"</script><script type=text/javascript src=/js/search.js?1726765846></script></div><section id=homelinks><ul><li><a class=padding href=/><i class='fas fa-home'></i> Yauaa</a></li></ul></section><div class=highlightable><ul class=topics><li data-nav-id=/expect/ title="What to expect" class=dd-item><a href=/expect/>What to expect</a><ul><li data-nav-id=/expect/fieldvalues/ title="Field values" class=dd-item><a href=/expect/fieldvalues/>Field values</a></li><li data-nav-id=/expect/performance/ title=Performance class=dd-item><a href=/expect/performance/>Performance</a></li><li data-nav-id=/expect/limitations/ title=Limitations class=dd-item><a href=/expect/limitations/>Limitations</a></li><li data-nav-id=/expect/manipulations/ title=Manipulations class=dd-item><a href=/expect/manipulations/>Manipulations</a></li><li data-nav-id=/expect/tryit/ title="Try it!" class=dd-item><a href=/expect/tryit/>Try it!</a></li></ul></li><li data-nav-id=/using/ title="Using the analyzer" class=dd-item><a href=/using/>Using Yauaa</a><ul><li data-nav-id=/using/clienthints/ title="User-Agent Client Hints" class=dd-item><a href=/using/clienthints/>User-Agent Client Hints</a></li><li data-nav-id=/using/memoryusage/ title="Memory usage" class=dd-item><a href=/using/memoryusage/>Memory usage</a></li><li data-nav-id=/using/webservlet/ title="The demonstration webservlet" class=dd-item><a href=/using/webservlet/>Webservlet</a></li><li data-nav-id=/using/kubernetes/ title=Kubernetes class=dd-item><a href=/using/kubernetes/>Kubernetes</a></li><li data-nav-id=/using/license/ title=Licence class=dd-item><a href=/using/license/>Licence</a></li></ul></li><li data-nav-id=/udf/ title="User Defined Functions" class="dd-item
parent"><a href=/udf/>User Defined Functions</a><ul><li data-nav-id=/udf/apache-beam/ title="Apache Beam" class=dd-item><a href=/udf/apache-beam/>Apache Beam</a></li><li data-nav-id=/udf/apache-beam-sql/ title="Apache Beam SQL" class=dd-item><a href=/udf/apache-beam-sql/>Apache Beam SQL</a></li><li data-nav-id=/udf/apache-drill/ title="Apache Drill" class=dd-item><a href=/udf/apache-drill/>Apache Drill</a></li><li data-nav-id=/udf/apache-flink/ title="Apache Flink" class=dd-item><a href=/udf/apache-flink/>Apache Flink</a></li><li data-nav-id=/udf/apache-flink-table/ title="Apache Flink Table/SQL" class=dd-item><a href=/udf/apache-flink-table/>Apache Flink Table/SQL</a></li><li data-nav-id=/udf/apache-hive/ title="Apache Hive" class=dd-item><a href=/udf/apache-hive/>Apache Hive</a></li><li data-nav-id=/udf/apache-nifi/ title="Apache Nifi" class=dd-item><a href=/udf/apache-nifi/>Apache Nifi</a></li><li data-nav-id=/udf/apache-pig/ title="Apache Pig" class=dd-item><a href=/udf/apache-pig/>Apache Pig</a></li><li data-nav-id=/udf/commandline/ title="Commandline usage" class=dd-item><a href=/udf/commandline/>Commandline usage</a></li><li data-nav-id=/udf/elastic-logstash/ title="Elastic LogStash" class=dd-item><a href=/udf/elastic-logstash/>Elastic LogStash</a></li><li data-nav-id=/udf/elastic-search/ title="Elastic Search" class=dd-item><a href=/udf/elastic-search/>Elastic Search</a></li><li data-nav-id=/udf/logparser/ title=LogParser class=dd-item><a href=/udf/logparser/>LogParser</a></li><li data-nav-id=/udf/snowflake/ title=Snowflake class=dd-item><a href=/udf/snowflake/>Snowflake</a></li><li data-nav-id=/udf/snowplow/ title=Snowplow class=dd-item><a href=/udf/snowplow/>Snowplow</a></li><li data-nav-id=/udf/trino/ title=Trino class="dd-item active"><a href=/udf/trino/>Trino</a></li></ul></li><li data-nav-id=/developer/ title=Development class=dd-item><a href=/developer/>Development</a><ul><li data-nav-id=/developer/building/ title="Building from source" class=dd-item><a href=/developer/building/>Building from source</a></li><li data-nav-id=/developer/basedesign/ title="Base Design" class=dd-item><a href=/developer/basedesign/>Base Design</a></li><li data-nav-id=/developer/makingnewrules/ title="Making new rules" class=dd-item><a href=/developer/makingnewrules/>Making new rules</a></li><li data-nav-id=/developer/shadingdependencies/ title="Shading dependencies" class=dd-item><a href=/developer/shadingdependencies/>Shading dependencies</a></li><li data-nav-id=/developer/reportingissues/ title="Reporting issues" class=dd-item><a href=/developer/reportingissues/>Reporting issues</a></li></ul></li><li data-nav-id=/other/ title=Other class=dd-item><a href=/other/>Other</a><ul><li data-nav-id=/other/article/ title=Blogpost class=dd-item><a href=/other/article/>Blogpost</a></li><li data-nav-id=/other/relatedprojects/ title="Related projects" class=dd-item><a href=/other/relatedprojects/>Related projects</a></li></ul></li></ul><section id=shortcuts><h3>More</h3><ul><li><a class=padding href=https://github.com/nielsbasjes/yauaa><i class='fab fa-git-square'></i> Git repo</a></li><li><a class=padding href=https://github.com/nielsbasjes/yauaa/discussions><i class='fa fa-comment-alt'></i> Discussions</a></li><li><a class=padding href=https://github.com/nielsbasjes/yauaa/blob/main/CHANGELOG.md><i class='fa fa-file-alt'></i> Changelog</a></li><li><a class=padding href=https://github.com/nielsbasjes/yauaa/issues><i class='fa fa-bug'></i> Issue tracker</a></li><li><a class=padding href=https://github.com/nielsbasjes/yauaa/actions><img alt="Github actions Build status" src="https://img.shields.io/github/actions/workflow/status/nielsbasjes/yauaa/build.yml?branch=main"></a></li><li><a class=padding href=https://app.codecov.io/gh/nielsbasjes/yauaa><img alt="Coverage Status" src=https://img.shields.io/codecov/c/github/nielsbasjes/yauaa></a></li><li><a class=padding href=https://www.apache.org/licenses/LICENSE-2.0.html><img alt=License src=https://img.shields.io/:license-apache-blue.svg></a></li><li><a class=padding href=https://central.sonatype.com/namespace/nl.basjes.parse.useragent><img alt="Maven Central" src=https://img.shields.io/maven-central/v/nl.basjes.parse.useragent/yauaa-parent.svg></a></li><li><a class=padding href=https://github.com/jvm-repo-rebuild/reproducible-central#nl.basjes.parse.useragent:yauaa><img alt="Reproducible Builds" src="https://img.shields.io/badge/Reproducible_Builds-ok-success?labelColor=1e5b96"></a></li><li><a class=padding href=https://github.com/nielsbasjes/yauaa/stargazers><img alt="GitHub stars" src="https://img.shields.io/github/stars/nielsbasjes/yauaa?label=GitHub%20stars"></a></li><li><a class=padding href=https://hub.docker.com/r/nielsbasjes/yauaa><img alt="Docker Hub" src=https://img.shields.io/docker/pulls/nielsbasjes/yauaa></a></li><li><a class=padding href=https://github.com/sponsors/nielsbasjes><img alt="If this project has business value for you then dont hesitate to support me with a small donation." src=https://img.shields.io/badge/Sponsor%20me-via%20Github-red.svg></a></li><li><a class=padding href=https://www.paypal.me/nielsbasjes><img alt="If this project has business value for you then dont hesitate to support me with a small donation." src=https://img.shields.io/badge/Donations-via%20Paypal-red.svg></a></li></ul></section><section id=footer><p>&copy;2013-2023 by <a href=https://niels.basjes.nl>Niels Basjes</a></p></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=top-github-link><a class=github-link title='Edit this page' href=https://github.com/nielsbasjes/yauaa/tree/main/documentation/content/udf/Trino.md target=blank><i class="fas fa-code-branch"></i>
<span id=top-github-link-text>Edit this page</span></a></div><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i>
</a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links><a href=/>Yauaa: Yet Another UserAgent Analyzer</a> > <a href=/udf/>User Defined Functions</a> > Trino</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#status--experimental->STATUS: &mldr; EXPERIMENTAL &mldr;</a></li><li><a href=#installation>Installation</a></li><li><a href=#usage>Usage</a><ul><li><a href=#example--just-the-user-agent-string>Example : Just the User-Agent string.</a></li><li><a href=#example--user-agent-string-and-clienthints>Example : User-Agent string and ClientHints.</a></li></ul></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Trino</h1><h2 id=introduction>Introduction</h2><p>This is a User Defined Function for <a href=https://trino.io>Trino</a> (a.k.a. Presto SQL)</p><h2 id=status--experimental->STATUS: &mldr; EXPERIMENTAL &mldr;</h2><p>The Trino plugin is very new.
Please tell if it works or not in your case.</p><p>Trino now requires Java 22 (which is non-LTS) which is not readily available for installation in Ubuntu using a normal package manager.
This means that I have chosen to no longer let the build fail if you do not have Java 22 installed.
The CI build does do Java 22 so any breaking API changes should be detected there.</p><p>This UDF will simply not be built if Java 22 is missing (and thus may go missing in some releases).</p><p>If you have Java 22 installed (and added it to your toolchains.xml) you can still build it.</p><h2 id=installation>Installation</h2><p>You can get the prebuilt UDF from <a href=https://repo1.maven.org/maven2/nl/basjes/parse/useragent/yauaa-trino/7.28.1/yauaa-trino-7.28.1-udf.jar>maven central (yauaa-trino-7.28.1-udf.jar)</a>.</p><p>NOTE: You MUST use the <code>-udf.jar</code>: yauaa-trino-7.28.1-udf.jar</p><p>In the plugin directory of your Trino server create a subdirectory and copy the <code>yauaa-trino-7.28.1-udf.jar</code> to that new directory.</p><p>In the trino docker image this is <code>/usr/lib/trino/plugin/</code> so putting the jar in something like <code>/usr/lib/trino/plugin/yauaa</code> is a fine choice.</p><p><strong>Important note:</strong> This directory may only contain this jar file; no other files may be present!</p><h2 id=usage>Usage</h2><p>This UDF provides two new functions <code>parse_user_agent(&lt;useragent>)</code> and <code>parse_user_agent(array(&lt;parameters>))</code>.</p><p>This first function needs one input which is the UserAgent string that needs to be analyzed.</p><p>The return value is a <code>map(varchar, varchar)</code> which is a key value map of all possible properties.</p><p>The second function needs a list of <code>header name, value</code> pairs to define the headers on which the provided values were originally received.</p><h3 id=example--just-the-user-agent-string>Example : Just the User-Agent string.</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> parsedUseragent[<span style=color:#e6db74>&#39;DeviceClass&#39;</span>]                   <span style=color:#66d9ef>AS</span> DeviceClass,
</span></span><span style=display:flex><span>       parsedUseragent[<span style=color:#e6db74>&#39;AgentNameVersionMajor&#39;</span>]         <span style=color:#66d9ef>AS</span> AgentNameVersionMajor,
</span></span><span style=display:flex><span>       parsedUseragent[<span style=color:#e6db74>&#39;OperatingSystemNameVersion&#39;</span>]    <span style=color:#66d9ef>AS</span> OperatingSystemNameVersion
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> (
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>SELECT</span>  useragent,
</span></span><span style=display:flex><span>        parse_user_agent(useragent) <span style=color:#66d9ef>AS</span> parsedUseragent
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>FROM</span> (
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>SELECT</span> useragent
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>FROM</span> (
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>VALUES</span> (<span style=color:#e6db74>&#39;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.60 Safari/537.36&#39;</span>)
</span></span><span style=display:flex><span>        ) <span style=color:#66d9ef>AS</span> t (useragent)
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>);
</span></span></code></pre></div><p>Outputs:</p><pre tabindex=0><code> DeviceClass | AgentNameVersionMajor | OperatingSystemNameVersion
-------------+-----------------------+----------------------------
 Desktop     | Chrome 100            | Mac OS &gt;=10.15.7
(1 row)
</code></pre><h3 id=example--user-agent-string-and-clienthints>Example : User-Agent string and ClientHints.</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> parsedUseragent[<span style=color:#e6db74>&#39;DeviceClass&#39;</span>]                   <span style=color:#66d9ef>AS</span> DeviceClass,
</span></span><span style=display:flex><span>       parsedUseragent[<span style=color:#e6db74>&#39;AgentNameVersionMajor&#39;</span>]         <span style=color:#66d9ef>AS</span> AgentNameVersionMajor,
</span></span><span style=display:flex><span>       parsedUseragent[<span style=color:#e6db74>&#39;OperatingSystemNameVersion&#39;</span>]    <span style=color:#66d9ef>AS</span> OperatingSystemNameVersion
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> (
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>SELECT</span>  useragent, chPlatform, chPlatformVersion,
</span></span><span style=display:flex><span>        parse_user_agent(
</span></span><span style=display:flex><span>            ARRAY[
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;user-Agent&#39;</span>,                  useragent,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;sec-CH-UA-Platform&#39;</span>,          chPlatform,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;sec-CH-UA-Platform-Version&#39;</span>,  chPlatformVersion
</span></span><span style=display:flex><span>            ]
</span></span><span style=display:flex><span>        ) <span style=color:#66d9ef>AS</span> parsedUseragent
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>FROM</span> (
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>SELECT</span> useragent, chPlatform, chPlatformVersion
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>FROM</span> (
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>VALUES</span> (<span style=color:#e6db74>&#39;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.60 Safari/537.36&#39;</span>,
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#39;&#34;macOS&#34;&#39;</span>,
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#39;&#34;12.3.1&#34;&#39;</span>)
</span></span><span style=display:flex><span>        ) <span style=color:#66d9ef>AS</span> t (useragent, chPlatform, chPlatformVersion)
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>);
</span></span></code></pre></div><p>Outputs:</p><pre tabindex=0><code> DeviceClass | AgentNameVersionMajor | OperatingSystemNameVersion
-------------+-----------------------+----------------------------
 Desktop     | Chrome 100            | Mac OS 12.3.1
(1 row)
</code></pre><footer class=footline></footer></div></div><div id=navigation></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/js/clipboard.min.js?1726765846></script><script src=/js/perfect-scrollbar.min.js?1726765846></script><script src=/js/perfect-scrollbar.jquery.min.js?1726765846></script><script src=/js/jquery.sticky.js?1726765846></script><script src=/js/featherlight.min.js?1726765846></script><script src=/js/highlight.pack.js?1726765846></script><script>hljs.initHighlightingOnLoad()</script><script src=/js/modernizr.custom-3.6.0.js?1726765846></script><script src=/js/learn.js?1726765846></script><script src=/js/hugo-learn.js?1726765846></script></body></html>
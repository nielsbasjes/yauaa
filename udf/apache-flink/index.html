<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.135.0"><meta name=description content="This is a java library that tries to parse and analyze the useragent string (and when available the User-Agent Client Hints) and extract as many relevant attributes as possible."><meta name=author content="Niels Basjes"><link rel=apple-touch-icon sizes=180x180 href=/favicon/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon/favicon-16x16.png><link rel=manifest href=/favicon/manifest.json><link rel=mask-icon href=/favicon/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#2d89ef"><meta name=msapplication-TileImage content="/favicon/mstile-144x144.png"><meta name=theme-color content="#ffffff"><title>Apache Flink | Yauaa - Yet Another UserAgent Analyzer</title>
<link href=/css/nucleus.css?1727853054 rel=stylesheet><link href=/css/fontawesome-all.min.css?1727853054 rel=stylesheet><link href=/css/hybrid.css?1727853054 rel=stylesheet><link href=/css/featherlight.min.css?1727853054 rel=stylesheet><link href=/css/perfect-scrollbar.min.css?1727853054 rel=stylesheet><link href=/css/auto-complete.css?1727853054 rel=stylesheet><link href=/css/atom-one-dark-reasonable.css?1727853054 rel=stylesheet><link href=/css/theme.css?1727853054 rel=stylesheet><link href=/css/tabs.css?1727853054 rel=stylesheet><link href=/css/hugo-theme.css?1727853054 rel=stylesheet><link href=/css/theme-yauaa.css?1727853054 rel=stylesheet><script src=/js/jquery-3.3.1.min.js?1727853054></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}:not(pre)>code+span.copy-to-clipboard{display:none}</style><script type=text/javascript>var _paq=window._paq=window._paq||[];_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){t="https://wa.basjes.nl/",_paq.push(["setTrackerUrl",t+"wa.php"]),_paq.push(["setSiteId","1"]);var t,n=document,e=n.createElement("script"),s=n.getElementsByTagName("script")[0];e.type="text/javascript",e.async=!0,e.src=t+"wa.js",s.parentNode.insertBefore(e,s)}()</script></head><body data-url=/udf/apache-flink/><nav id=sidebar><div id=header-wrapper><div id=header><a id=logo href=/><p class=logo-bar>Yauaa</p></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=/js/lunr.min.js?1727853054></script><script type=text/javascript src=/js/auto-complete.js?1727853054></script><script type=text/javascript>var baseurl="/"</script><script type=text/javascript src=/js/search.js?1727853054></script></div><section id=homelinks><ul><li><a class=padding href=/><i class='fas fa-home'></i> Yauaa</a></li></ul></section><div class=highlightable><ul class=topics><li data-nav-id=/expect/ title="What to expect" class=dd-item><a href=/expect/>What to expect</a><ul><li data-nav-id=/expect/fieldvalues/ title="Field values" class=dd-item><a href=/expect/fieldvalues/>Field values</a></li><li data-nav-id=/expect/performance/ title=Performance class=dd-item><a href=/expect/performance/>Performance</a></li><li data-nav-id=/expect/limitations/ title=Limitations class=dd-item><a href=/expect/limitations/>Limitations</a></li><li data-nav-id=/expect/manipulations/ title=Manipulations class=dd-item><a href=/expect/manipulations/>Manipulations</a></li><li data-nav-id=/expect/tryit/ title="Try it!" class=dd-item><a href=/expect/tryit/>Try it!</a></li></ul></li><li data-nav-id=/using/ title="Using the analyzer" class=dd-item><a href=/using/>Using Yauaa</a><ul><li data-nav-id=/using/clienthints/ title="User-Agent Client Hints" class=dd-item><a href=/using/clienthints/>User-Agent Client Hints</a></li><li data-nav-id=/using/memoryusage/ title="Memory usage" class=dd-item><a href=/using/memoryusage/>Memory usage</a></li><li data-nav-id=/using/webservlet/ title="The demonstration webservlet" class=dd-item><a href=/using/webservlet/>Webservlet</a></li><li data-nav-id=/using/kubernetes/ title=Kubernetes class=dd-item><a href=/using/kubernetes/>Kubernetes</a></li><li data-nav-id=/using/license/ title=Licence class=dd-item><a href=/using/license/>Licence</a></li></ul></li><li data-nav-id=/udf/ title="User Defined Functions" class="dd-item
parent"><a href=/udf/>User Defined Functions</a><ul><li data-nav-id=/udf/apache-beam/ title="Apache Beam" class=dd-item><a href=/udf/apache-beam/>Apache Beam</a></li><li data-nav-id=/udf/apache-beam-sql/ title="Apache Beam SQL" class=dd-item><a href=/udf/apache-beam-sql/>Apache Beam SQL</a></li><li data-nav-id=/udf/apache-drill/ title="Apache Drill" class=dd-item><a href=/udf/apache-drill/>Apache Drill</a></li><li data-nav-id=/udf/apache-flink/ title="Apache Flink" class="dd-item active"><a href=/udf/apache-flink/>Apache Flink</a></li><li data-nav-id=/udf/apache-flink-table/ title="Apache Flink Table/SQL" class=dd-item><a href=/udf/apache-flink-table/>Apache Flink Table/SQL</a></li><li data-nav-id=/udf/apache-hive/ title="Apache Hive" class=dd-item><a href=/udf/apache-hive/>Apache Hive</a></li><li data-nav-id=/udf/apache-nifi/ title="Apache Nifi" class=dd-item><a href=/udf/apache-nifi/>Apache Nifi</a></li><li data-nav-id=/udf/apache-pig/ title="Apache Pig" class=dd-item><a href=/udf/apache-pig/>Apache Pig</a></li><li data-nav-id=/udf/commandline/ title="Commandline usage" class=dd-item><a href=/udf/commandline/>Commandline usage</a></li><li data-nav-id=/udf/elastic-logstash/ title="Elastic LogStash" class=dd-item><a href=/udf/elastic-logstash/>Elastic LogStash</a></li><li data-nav-id=/udf/elastic-search/ title="Elastic Search" class=dd-item><a href=/udf/elastic-search/>Elastic Search</a></li><li data-nav-id=/udf/logparser/ title=LogParser class=dd-item><a href=/udf/logparser/>LogParser</a></li><li data-nav-id=/udf/snowflake/ title=Snowflake class=dd-item><a href=/udf/snowflake/>Snowflake</a></li><li data-nav-id=/udf/snowplow/ title=Snowplow class=dd-item><a href=/udf/snowplow/>Snowplow</a></li><li data-nav-id=/udf/trino/ title=Trino class=dd-item><a href=/udf/trino/>Trino</a></li></ul></li><li data-nav-id=/developer/ title=Development class=dd-item><a href=/developer/>Development</a><ul><li data-nav-id=/developer/building/ title="Building from source" class=dd-item><a href=/developer/building/>Building from source</a></li><li data-nav-id=/developer/basedesign/ title="Base Design" class=dd-item><a href=/developer/basedesign/>Base Design</a></li><li data-nav-id=/developer/makingnewrules/ title="Making new rules" class=dd-item><a href=/developer/makingnewrules/>Making new rules</a></li><li data-nav-id=/developer/shadingdependencies/ title="Shading dependencies" class=dd-item><a href=/developer/shadingdependencies/>Shading dependencies</a></li><li data-nav-id=/developer/reportingissues/ title="Reporting issues" class=dd-item><a href=/developer/reportingissues/>Reporting issues</a></li></ul></li><li data-nav-id=/other/ title=Other class=dd-item><a href=/other/>Other</a><ul><li data-nav-id=/other/article/ title=Blogpost class=dd-item><a href=/other/article/>Blogpost</a></li><li data-nav-id=/other/relatedprojects/ title="Related projects" class=dd-item><a href=/other/relatedprojects/>Related projects</a></li></ul></li></ul><section id=shortcuts><h3>More</h3><ul><li><a class=padding href=https://github.com/nielsbasjes/yauaa><i class='fab fa-git-square'></i> Git repo</a></li><li><a class=padding href=https://github.com/nielsbasjes/yauaa/discussions><i class='fa fa-comment-alt'></i> Discussions</a></li><li><a class=padding href=https://github.com/nielsbasjes/yauaa/blob/main/CHANGELOG.md><i class='fa fa-file-alt'></i> Changelog</a></li><li><a class=padding href=https://github.com/nielsbasjes/yauaa/issues><i class='fa fa-bug'></i> Issue tracker</a></li><li><a class=padding href=https://github.com/nielsbasjes/yauaa/actions><img alt="Github actions Build status" src="https://img.shields.io/github/actions/workflow/status/nielsbasjes/yauaa/build.yml?branch=main"></a></li><li><a class=padding href=https://app.codecov.io/gh/nielsbasjes/yauaa><img alt="Coverage Status" src=https://img.shields.io/codecov/c/github/nielsbasjes/yauaa></a></li><li><a class=padding href=https://www.apache.org/licenses/LICENSE-2.0.html><img alt=License src=https://img.shields.io/:license-apache-blue.svg></a></li><li><a class=padding href=https://central.sonatype.com/namespace/nl.basjes.parse.useragent><img alt="Maven Central" src=https://img.shields.io/maven-central/v/nl.basjes.parse.useragent/yauaa-parent.svg></a></li><li><a class=padding href=https://github.com/jvm-repo-rebuild/reproducible-central#nl.basjes.parse.useragent:yauaa><img alt="Reproducible Builds" src="https://img.shields.io/badge/Reproducible_Builds-ok-success?labelColor=1e5b96"></a></li><li><a class=padding href=https://github.com/nielsbasjes/yauaa/stargazers><img alt="GitHub stars" src="https://img.shields.io/github/stars/nielsbasjes/yauaa?label=GitHub%20stars"></a></li><li><a class=padding href=https://hub.docker.com/r/nielsbasjes/yauaa><img alt="Docker Hub" src=https://img.shields.io/docker/pulls/nielsbasjes/yauaa></a></li><li><a class=padding href=https://github.com/sponsors/nielsbasjes><img alt="If this project has business value for you then dont hesitate to support me with a small donation." src=https://img.shields.io/badge/Sponsor%20me-via%20Github-red.svg></a></li><li><a class=padding href=https://www.paypal.me/nielsbasjes><img alt="If this project has business value for you then dont hesitate to support me with a small donation." src=https://img.shields.io/badge/Donations-via%20Paypal-red.svg></a></li></ul></section><section id=footer><p>&copy;2013-2023 by <a href=https://niels.basjes.nl>Niels Basjes</a></p></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=top-github-link><a class=github-link title='Edit this page' href=https://github.com/nielsbasjes/yauaa/tree/main/documentation/content/udf/Apache-Flink.md target=blank><i class="fas fa-code-branch"></i>
<span id=top-github-link-text>Edit this page</span></a></div><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i>
</a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links><a href=/>Yauaa: Yet Another UserAgent Analyzer</a> > <a href=/udf/>User Defined Functions</a> > Apache Flink</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#getting-the-udf>Getting the UDF</a><ul><li><a href=#usage>Usage</a></li><li><a href=#example-only-user-agent>Example: Only User-Agent</a></li><li><a href=#example-user-agent-client-hints>Example: User-Agent Client Hints</a></li></ul></li><li><a href=#notes-on-defining-it-as-an-anonymous-class>NOTES on defining it as an anonymous class</a></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Apache Flink</h1><h2 id=introduction>Introduction</h2><p>This is a User Defined Function for <a href=https://flink.apache.org>Apache Flink</a></p><h2 id=getting-the-udf>Getting the UDF</h2><p>You can get the prebuilt UDF from <a href=https://central.sonatype.com/artifact/nl.basjes.parse.useragent/yauaa-flink/7.28.1/jar>maven central</a>.</p><p>If you use a maven based project simply add this dependency to your project.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#f92672>&lt;dependency&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;groupId&gt;</span>nl.basjes.parse.useragent<span style=color:#f92672>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;artifactId&gt;</span>yauaa-flink<span style=color:#f92672>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;version&gt;</span>7.28.1<span style=color:#f92672>&lt;/version&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/dependency&gt;</span>
</span></span></code></pre></div><h3 id=usage>Usage</h3><p>Assume you have a DataSet or DataStream with your records.
In most cases I see (clickstream data) these records (In this example this class is called &ldquo;TestRecord&rdquo;) contain the useragent string in a field and the parsed results must be added to these fields.</p><p>Now you must do two things:</p><ul><li>Determine the names of the fields you need.</li><li>Add an instance of the (abstract) UserAgentAnalysisMapper mapper and implement the functions as shown in the example below. Use the Field annotation to get the setter for the requested fields.</li></ul><p>Note that the name of the setters is not important, the system looks at the annotation.</p><h3 id=example-only-user-agent>Example: Only User-Agent</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>.<span style=color:#a6e22e>map</span>(<span style=color:#66d9ef>new</span> UserAgentAnalysisMapper<span style=color:#f92672>&lt;</span>TestRecord<span style=color:#f92672>&gt;</span>(15000) { <span style=color:#75715e>// Setting the cacheSize</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> String <span style=color:#a6e22e>getUserAgentString</span>(TestRecord record) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> record.<span style=color:#a6e22e>useragent</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@SuppressWarnings</span>(<span style=color:#e6db74>&#34;unused&#34;</span>) <span style=color:#75715e>// Called via the annotation</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@YauaaField</span>(<span style=color:#e6db74>&#34;DeviceClass&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>setDC</span>(TestRecord record, String value) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>record</span><span style=color:#960050;background-color:#1e0010>.</span><span style=color:#a6e22e>deviceClass</span> <span style=color:#f92672>=</span> value;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@SuppressWarnings</span>(<span style=color:#e6db74>&#34;unused&#34;</span>) <span style=color:#75715e>// Called via the annotation</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@YauaaField</span>(<span style=color:#e6db74>&#34;AgentNameVersion&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>setANV</span>(TestRecord record, String value) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>record</span><span style=color:#960050;background-color:#1e0010>.</span><span style=color:#a6e22e>agentNameVersion</span> <span style=color:#f92672>=</span> value;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@SuppressWarnings</span>(<span style=color:#e6db74>&#34;unused&#34;</span>) <span style=color:#75715e>// Called via the annotation</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@YauaaField</span>(<span style=color:#e6db74>&#34;OperatingSystemNameVersion&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>setOSNV</span>(TestRecord record, String value) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>record</span><span style=color:#960050;background-color:#1e0010>.</span><span style=color:#a6e22e>operatingSystemNameVersion</span> <span style=color:#f92672>=</span> value;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>})
</span></span></code></pre></div><h3 id=example-user-agent-client-hints>Example: User-Agent Client Hints</h3><p>The only difference with the &ldquo;Only User-Agent&rdquo; implementation is that the <code>getRequestHeaders</code> is overridden.
The resulting map should have the <code>original request header names</code> as keys and the actual <code>header value</code> as the value.</p><p>To illustrate:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>Map<span style=color:#f92672>&lt;</span>String, String<span style=color:#f92672>&gt;</span> requestHeaders <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> TreeMap<span style=color:#f92672>&lt;&gt;</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>requestHeaders.<span style=color:#a6e22e>put</span>(<span style=color:#e6db74>&#34;User-Agent&#34;</span>,                       <span style=color:#e6db74>&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.0.0 Safari/537.36&#34;</span>);
</span></span><span style=display:flex><span>requestHeaders.<span style=color:#a6e22e>put</span>(<span style=color:#e6db74>&#34;Sec-Ch-Ua&#34;</span>,                        <span style=color:#e6db74>&#34;\&#34; Not A;Brand\&#34;;v=\&#34;99\&#34;, \&#34;Chromium\&#34;;v=\&#34;100\&#34;, \&#34;Google Chrome\&#34;;v=\&#34;100\&#34;&#34;</span>);
</span></span><span style=display:flex><span>requestHeaders.<span style=color:#a6e22e>put</span>(<span style=color:#e6db74>&#34;Sec-Ch-Ua-Arch&#34;</span>,                   <span style=color:#e6db74>&#34;\&#34;x86\&#34;&#34;</span>);
</span></span><span style=display:flex><span>requestHeaders.<span style=color:#a6e22e>put</span>(<span style=color:#e6db74>&#34;Sec-Ch-Ua-Full-Version-List&#34;</span>,      <span style=color:#e6db74>&#34;\&#34; Not A;Brand\&#34;;v=\&#34;99.0.0.0\&#34;, \&#34;Chromium\&#34;;v=\&#34;100.0.4896.75\&#34;, \&#34;Google Chrome\&#34;;v=\&#34;100.0.4896.75\&#34;&#34;</span>);
</span></span><span style=display:flex><span>requestHeaders.<span style=color:#a6e22e>put</span>(<span style=color:#e6db74>&#34;Sec-Ch-Ua-Mobile&#34;</span>,                 <span style=color:#e6db74>&#34;?0&#34;</span>);
</span></span><span style=display:flex><span>requestHeaders.<span style=color:#a6e22e>put</span>(<span style=color:#e6db74>&#34;Sec-Ch-Ua-Model&#34;</span>,                  <span style=color:#e6db74>&#34;\&#34;\&#34;&#34;</span>);
</span></span><span style=display:flex><span>requestHeaders.<span style=color:#a6e22e>put</span>(<span style=color:#e6db74>&#34;Sec-Ch-Ua-Platform&#34;</span>,               <span style=color:#e6db74>&#34;\&#34;Windows\&#34;&#34;</span>);
</span></span><span style=display:flex><span>requestHeaders.<span style=color:#a6e22e>put</span>(<span style=color:#e6db74>&#34;Sec-Ch-Ua-Platform-Version&#34;</span>,       <span style=color:#e6db74>&#34;\&#34;0.1.0\&#34;&#34;</span>);
</span></span><span style=display:flex><span>requestHeaders.<span style=color:#a6e22e>put</span>(<span style=color:#e6db74>&#34;Sec-Ch-Ua-Wow64&#34;</span>,                  <span style=color:#e6db74>&#34;?0&#34;</span>);
</span></span></code></pre></div><p>Using the analyzer whould then be something like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>.<span style=color:#a6e22e>map</span>(<span style=color:#66d9ef>new</span> UserAgentAnalysisMapper<span style=color:#f92672>&lt;</span>TestRecord<span style=color:#f92672>&gt;</span>(15000) { <span style=color:#75715e>// Setting the cacheSize</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> Map<span style=color:#f92672>&lt;</span>String, String<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>getRequestHeaders</span>(TestRecord element) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> element.<span style=color:#a6e22e>getHeaders</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@SuppressWarnings</span>(<span style=color:#e6db74>&#34;unused&#34;</span>) <span style=color:#75715e>// Called via the annotation</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@YauaaField</span>(<span style=color:#e6db74>&#34;DeviceClass&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>setDC</span>(TestRecord record, String value) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>record</span><span style=color:#960050;background-color:#1e0010>.</span><span style=color:#a6e22e>deviceClass</span> <span style=color:#f92672>=</span> value;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@SuppressWarnings</span>(<span style=color:#e6db74>&#34;unused&#34;</span>) <span style=color:#75715e>// Called via the annotation</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@YauaaField</span>(<span style=color:#e6db74>&#34;AgentNameVersion&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>setANV</span>(TestRecord record, String value) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>record</span><span style=color:#960050;background-color:#1e0010>.</span><span style=color:#a6e22e>agentNameVersion</span> <span style=color:#f92672>=</span> value;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@SuppressWarnings</span>(<span style=color:#e6db74>&#34;unused&#34;</span>) <span style=color:#75715e>// Called via the annotation</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@YauaaField</span>(<span style=color:#e6db74>&#34;OperatingSystemNameVersion&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>setOSNV</span>(TestRecord record, String value) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>record</span><span style=color:#960050;background-color:#1e0010>.</span><span style=color:#a6e22e>operatingSystemNameVersion</span> <span style=color:#f92672>=</span> value;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>})
</span></span></code></pre></div><h2 id=notes-on-defining-it-as-an-anonymous-class>NOTES on defining it as an anonymous class</h2><p>An anonymous inner class in Java is <a href=https://stackoverflow.com/questions/319765/accessing-inner-anonymous-class-members>by default private</a>.</p><p>If you define it as an anonymous inner class as shown above then the system will try to make this class to become public by means of the method .setAccessible(true).
There are situations in which this will fail (amongst others the SecurityManager can block this). If you run into such a scenario then simply &rsquo;not&rsquo; define it inline as an anonymous class and define it as a named (public) class instead.</p><p>So the earlier example will look something like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MyUserAgentAnalysisMapper</span> <span style=color:#66d9ef>extends</span> UserAgentAnalysisMapper<span style=color:#f92672>&lt;</span>TestRecord<span style=color:#f92672>&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> Map<span style=color:#f92672>&lt;</span>String, String<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>getRequestHeaders</span>(TestRecord element) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> element.<span style=color:#a6e22e>getHeaders</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@SuppressWarnings</span>(<span style=color:#e6db74>&#34;unused&#34;</span>) <span style=color:#75715e>// Called via the annotation</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@YauaaField</span>(<span style=color:#e6db74>&#34;DeviceClass&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>setDC</span>(TestRecord record, String value) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>record</span><span style=color:#960050;background-color:#1e0010>.</span><span style=color:#a6e22e>deviceClass</span> <span style=color:#f92672>=</span> value;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@SuppressWarnings</span>(<span style=color:#e6db74>&#34;unused&#34;</span>) <span style=color:#75715e>// Called via the annotation</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@YauaaField</span>(<span style=color:#e6db74>&#34;AgentNameVersion&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>setANV</span>(TestRecord record, String value) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>record</span><span style=color:#960050;background-color:#1e0010>.</span><span style=color:#a6e22e>agentNameVersion</span> <span style=color:#f92672>=</span> value;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@SuppressWarnings</span>(<span style=color:#e6db74>&#34;unused&#34;</span>) <span style=color:#75715e>// Called via the annotation</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@YauaaField</span>(<span style=color:#e6db74>&#34;OperatingSystemNameVersion&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>setOSNV</span>(TestRecord record, String value) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>record</span><span style=color:#960050;background-color:#1e0010>.</span><span style=color:#a6e22e>operatingSystemNameVersion</span> <span style=color:#f92672>=</span> value;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>and then in the topology simply do this</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>.<span style=color:#a6e22e>map</span>(<span style=color:#66d9ef>new</span> MyUserAgentAnalysisMapper())
</span></span></code></pre></div><footer class=footline></footer></div></div><div id=navigation></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/js/clipboard.min.js?1727853054></script><script src=/js/perfect-scrollbar.min.js?1727853054></script><script src=/js/perfect-scrollbar.jquery.min.js?1727853054></script><script src=/js/jquery.sticky.js?1727853054></script><script src=/js/featherlight.min.js?1727853054></script><script src=/js/highlight.pack.js?1727853054></script><script>hljs.initHighlightingOnLoad()</script><script src=/js/modernizr.custom-3.6.0.js?1727853054></script><script src=/js/learn.js?1727853054></script><script src=/js/hugo-learn.js?1727853054></script></body></html>